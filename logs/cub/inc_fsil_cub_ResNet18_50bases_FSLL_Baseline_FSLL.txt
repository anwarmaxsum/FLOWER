/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-06 06:49:12,425 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-06 06:49:12,426 INFO: 
  name: FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug
  model_type: FSLLModel
  gpu: 1
  manual_seed: 1997
  use_cosine: False
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  datasets:[
    train:[
      name: cub
      type: NormalDataset
      total_classes: 200
      dataroot: DataSet/CUB_200_2011/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: None
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    val:[
      name: cub
      type: NormalDataset
      total_classes: 200
      dataroot: DataSet/CUB_200_2011/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    test:[
      name: cub
      type: NormalDataset
      total_classes: 200
      dataroot: DataSet/CUB_200_2011/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
  ]
  network_g:[
    type: Resnet18_softmax
    Embed_dim: 512
    pretrained: False
    norm: False
    num_classes: 50
    adopt_classifier: False
    addition_net: False
    flatten: True
    cut_at_pooling: False
  ]
  path:[
    pretrain_model_g: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
    base_model: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug
    training_states: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/training_states
    log: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug
    models: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.0005
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [160]
      gamma: 0.1
    ]
    fine_tune: True
    fine_tune_epoch: 10
    threshold: 0.15
    warmup_iter: -1
    bases: 50
    tasks: 11
    shots: 5
    novel_exemplars: 5
    num_test: 5
    metric_opt:[
      type: TripletLossNoHardMining
      margin: 0.0
      num_instances: 5
    ]
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
    regularization:[
      type: IncrementalNetworkFixLoss
      w: 5.0
    ]
  ]
  val:[
    val_freq: 2000
    test_type: NCM
    p_norm: None
  ]
  logger:[
    print_freq: 2
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cub-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-06 06:49:12,426 INFO: Random seed: 1997
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:181: UserWarning: nn.init.kaiming_normal is now deprecated in favor of nn.init.kaiming_normal_.
  init.kaiming_normal(m.weight, mode='fan_out')
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:188: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  init.normal(m.weight, std=0.001)
2022-11-06 06:49:15,072 INFO: Network: Resnet18_softmax, with parameters: 11,689,512
2022-11-06 06:49:15,072 INFO: Resnet18_softmax(
  (func): ResNet_pytorch(
    (base): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=1000, bias=True)
    )
  )
)
2022-11-06 06:49:15,072 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:49:15,134 WARNING: Current net - loaded net:
2022-11-06 06:49:15,134 WARNING: Loaded net - current net:
2022-11-06 06:49:15,134 WARNING:   func.classifier.bias
2022-11-06 06:49:15,134 WARNING:   func.classifier.weight
2022-11-06 06:49:15,146 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:49:15,194 WARNING: Current net - loaded net:
2022-11-06 06:49:15,195 WARNING: Loaded net - current net:
2022-11-06 06:49:15,195 WARNING:   func.classifier.bias
2022-11-06 06:49:15,195 WARNING:   func.classifier.weight
2022-11-06 06:49:15,235 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:49:15,236 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:49:15,237 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:49:15,237 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:49:15,238 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:49:15,239 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:49:15,240 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:49:15,241 INFO: Model [FSLLModel] is created.
2022-11-06 06:49:34,697 INFO: [Test_acc of task 0 on test 0: 0.77610][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.77610]
2022-11-06 06:49:34,970 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:49:35,007 WARNING: Current net - loaded net:
2022-11-06 06:49:35,007 WARNING: Loaded net - current net:
2022-11-06 06:49:35,007 WARNING:   func.classifier.bias
2022-11-06 06:49:35,007 WARNING:   func.classifier.weight
2022-11-06 06:49:35,016 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth.
2022-11-06 06:49:35,050 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:49:35,078 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:49:35,079 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:49:35,079 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:49:35,080 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:49:35,081 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:49:35,082 INFO: Model [FSLLModel] is created.
2022-11-06 06:49:35,087 INFO: Dataset NormalDataset - cub is created.
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
/workspace/FLOWER/f2m/methods/losses/losses.py:736: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1005.)
  dist.addmm_(1, -2, inputs, inputs.t())
2022-11-06 06:49:37,112 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2995, Pos_dist: 16.6357, Neg_dist: 25.4519, Acc: 0.9067, PTFixPNLoss: 3.8936, NetFixLoss: 0.0000, ]
2022-11-06 06:49:38,507 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.8463, Pos_dist: 15.9140, Neg_dist: 20.9624, Acc: 0.9333, PTFixPNLoss: 3.8932, NetFixLoss: 1.5796, ]
2022-11-06 06:49:39,893 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4597, Pos_dist: 16.0176, Neg_dist: 22.6479, Acc: 0.9600, PTFixPNLoss: 3.8803, NetFixLoss: 4.4752, ]
2022-11-06 06:49:41,281 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.8764, Pos_dist: 16.0106, Neg_dist: 20.8922, Acc: 0.8933, PTFixPNLoss: 3.8868, NetFixLoss: 8.0094, ]
2022-11-06 06:49:42,496 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3812, Pos_dist: 16.0917, Neg_dist: 22.2077, Acc: 0.9200, PTFixPNLoss: 3.8846, NetFixLoss: 12.1511, ]
2022-11-06 06:49:43,537 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0466, Pos_dist: 15.6211, Neg_dist: 24.9702, Acc: 0.9333, PTFixPNLoss: 3.8797, NetFixLoss: 16.4649, ]
2022-11-06 06:49:44,684 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0971, Pos_dist: 15.6801, Neg_dist: 23.6076, Acc: 0.9467, PTFixPNLoss: 3.8758, NetFixLoss: 20.7385, ]
2022-11-06 06:49:45,916 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.6248, Pos_dist: 15.5097, Neg_dist: 21.2519, Acc: 0.9733, PTFixPNLoss: 3.8770, NetFixLoss: 24.8171, ]
2022-11-06 06:49:47,196 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3415, Pos_dist: 15.5676, Neg_dist: 22.4225, Acc: 0.9600, PTFixPNLoss: 3.8761, NetFixLoss: 28.8253, ]
2022-11-06 06:49:48,503 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3897, Pos_dist: 15.7330, Neg_dist: 22.0580, Acc: 0.9467, PTFixPNLoss: 3.8752, NetFixLoss: 32.7288, ]
2022-11-06 06:49:48,658 INFO: fine-tune procedure is finished!
2022-11-06 06:50:09,229 INFO: [Test_acc of task 1 on test 0: 0.65772][acc of former classes: 0.74298][acc of former samples in all classes: 0.70698]
[acc of novel samples in all classes: 0.50114]
2022-11-06 06:50:09,543 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:50:09,585 WARNING: Current net - loaded net:
2022-11-06 06:50:09,586 WARNING: Loaded net - current net:
2022-11-06 06:50:09,586 WARNING:   func.classifier.bias
2022-11-06 06:50:09,586 WARNING:   func.classifier.weight
2022-11-06 06:50:09,601 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_1.pth.
2022-11-06 06:50:09,663 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:50:09,684 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:50:09,685 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:50:09,685 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:50:09,685 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:50:09,685 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:50:09,686 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:50:09,687 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:50:09,688 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:50:09,688 INFO: Model [FSLLModel] is created.
2022-11-06 06:50:09,693 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:50:09,697 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_1.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 06:50:11,286 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3121, Pos_dist: 15.4806, Neg_dist: 23.4284, Acc: 0.9533, PTFixPNLoss: 4.0748, NetFixLoss: 0.0000, ]
2022-11-06 06:50:13,397 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1893, Pos_dist: 15.3639, Neg_dist: 24.0542, Acc: 0.9400, PTFixPNLoss: 4.0783, NetFixLoss: 1.2846, ]
2022-11-06 06:50:15,406 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3144, Pos_dist: 15.4382, Neg_dist: 22.9663, Acc: 0.9133, PTFixPNLoss: 4.0796, NetFixLoss: 2.8421, ]
2022-11-06 06:50:17,515 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3415, Pos_dist: 15.4766, Neg_dist: 21.6872, Acc: 0.9467, PTFixPNLoss: 4.0769, NetFixLoss: 4.6403, ]
2022-11-06 06:50:19,628 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3606, Pos_dist: 15.4499, Neg_dist: 22.2061, Acc: 0.9600, PTFixPNLoss: 4.0787, NetFixLoss: 6.8256, ]
2022-11-06 06:50:21,887 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1305, Pos_dist: 15.4102, Neg_dist: 24.2034, Acc: 0.9333, PTFixPNLoss: 4.0754, NetFixLoss: 9.3183, ]
2022-11-06 06:50:24,185 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1824, Pos_dist: 15.6814, Neg_dist: 24.3184, Acc: 0.9467, PTFixPNLoss: 4.0783, NetFixLoss: 11.8372, ]
2022-11-06 06:50:26,157 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2597, Pos_dist: 15.4805, Neg_dist: 23.0498, Acc: 0.9467, PTFixPNLoss: 4.0733, NetFixLoss: 14.2871, ]
2022-11-06 06:50:28,348 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1946, Pos_dist: 15.5053, Neg_dist: 22.4512, Acc: 0.9600, PTFixPNLoss: 4.0815, NetFixLoss: 16.7728, ]
2022-11-06 06:50:30,650 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3901, Pos_dist: 15.5643, Neg_dist: 22.7691, Acc: 0.8933, PTFixPNLoss: 4.0756, NetFixLoss: 19.2592, ]
2022-11-06 06:50:30,795 INFO: fine-tune procedure is finished!
2022-11-06 06:50:55,580 INFO: [Test_acc of task 2 on test 0: 0.60343][acc of former classes: 0.73722][acc of former samples in all classes: 0.67459]
[acc of novel samples in all classes: 0.49151]
2022-11-06 06:50:55,984 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:50:56,022 WARNING: Current net - loaded net:
2022-11-06 06:50:56,022 WARNING: Loaded net - current net:
2022-11-06 06:50:56,022 WARNING:   func.classifier.bias
2022-11-06 06:50:56,022 WARNING:   func.classifier.weight
2022-11-06 06:50:56,035 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_2.pth.
2022-11-06 06:50:56,091 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:50:56,111 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:50:56,112 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:50:56,112 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:50:56,113 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:50:56,114 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:50:56,115 INFO: Model [FSLLModel] is created.
2022-11-06 06:50:56,119 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:50:56,123 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:50:56,127 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_2.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-06 06:50:58,576 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0907, Pos_dist: 15.4510, Neg_dist: 24.6969, Acc: 0.9378, PTFixPNLoss: 4.2530, NetFixLoss: 0.0000, ]
2022-11-06 06:51:01,404 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3405, Pos_dist: 15.5179, Neg_dist: 21.9460, Acc: 0.9111, PTFixPNLoss: 4.2562, NetFixLoss: 0.5400, ]
2022-11-06 06:51:03,947 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0982, Pos_dist: 15.2720, Neg_dist: 23.7456, Acc: 0.9511, PTFixPNLoss: 4.2460, NetFixLoss: 1.9961, ]
2022-11-06 06:51:06,726 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.5932, Pos_dist: 15.4979, Neg_dist: 20.8085, Acc: 0.9156, PTFixPNLoss: 4.2556, NetFixLoss: 3.6272, ]
2022-11-06 06:51:08,960 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3009, Pos_dist: 15.4334, Neg_dist: 22.2955, Acc: 0.9333, PTFixPNLoss: 4.2507, NetFixLoss: 5.7019, ]
2022-11-06 06:51:11,532 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1845, Pos_dist: 15.4293, Neg_dist: 22.7769, Acc: 0.9200, PTFixPNLoss: 4.2538, NetFixLoss: 8.0919, ]
2022-11-06 06:51:13,932 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0456, Pos_dist: 15.4141, Neg_dist: 24.1377, Acc: 0.9200, PTFixPNLoss: 4.2520, NetFixLoss: 10.5813, ]
2022-11-06 06:51:16,270 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4814, Pos_dist: 15.2692, Neg_dist: 20.9218, Acc: 0.9289, PTFixPNLoss: 4.2489, NetFixLoss: 12.9834, ]
2022-11-06 06:51:18,801 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1423, Pos_dist: 15.1110, Neg_dist: 23.3764, Acc: 0.9111, PTFixPNLoss: 4.2456, NetFixLoss: 15.4813, ]
2022-11-06 06:51:21,303 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2678, Pos_dist: 15.1936, Neg_dist: 21.8779, Acc: 0.9422, PTFixPNLoss: 4.2431, NetFixLoss: 17.9915, ]
2022-11-06 06:51:21,438 INFO: fine-tune procedure is finished!
2022-11-06 06:51:52,508 INFO: [Test_acc of task 3 on test 0: 0.59595][acc of former classes: 0.74802][acc of former samples in all classes: 0.66379]
[acc of novel samples in all classes: 0.52489]
2022-11-06 06:51:53,079 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:51:53,118 WARNING: Current net - loaded net:
2022-11-06 06:51:53,119 WARNING: Loaded net - current net:
2022-11-06 06:51:53,119 WARNING:   func.classifier.bias
2022-11-06 06:51:53,119 WARNING:   func.classifier.weight
2022-11-06 06:51:53,130 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_3.pth.
2022-11-06 06:51:53,170 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:51:53,189 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:51:53,189 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:51:53,189 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:51:53,189 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:51:53,190 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:51:53,190 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:51:53,190 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:51:53,190 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:51:53,190 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:51:53,190 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:51:53,190 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:51:53,190 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:51:53,190 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:51:53,190 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:51:53,191 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:51:53,192 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:51:53,193 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:51:53,193 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:51:53,193 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:51:53,193 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:51:53,193 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:51:53,193 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:51:53,193 INFO: Model [FSLLModel] is created.
2022-11-06 06:51:53,197 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:51:53,199 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:51:53,202 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:51:53,204 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_3.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-06 06:51:56,023 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2180, Pos_dist: 15.1074, Neg_dist: 22.8683, Acc: 0.9533, PTFixPNLoss: 4.3842, NetFixLoss: 0.0000, ]
2022-11-06 06:51:59,510 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3349, Pos_dist: 15.4275, Neg_dist: 22.5933, Acc: 0.9233, PTFixPNLoss: 4.3965, NetFixLoss: 1.1558, ]
2022-11-06 06:52:02,507 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0434, Pos_dist: 15.0688, Neg_dist: 25.2169, Acc: 0.9433, PTFixPNLoss: 4.3853, NetFixLoss: 2.7599, ]
2022-11-06 06:52:05,911 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1379, Pos_dist: 15.3119, Neg_dist: 23.6347, Acc: 0.9100, PTFixPNLoss: 4.3898, NetFixLoss: 4.4356, ]
2022-11-06 06:52:09,187 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1301, Pos_dist: 15.2204, Neg_dist: 23.8046, Acc: 0.9167, PTFixPNLoss: 4.3911, NetFixLoss: 6.0545, ]
2022-11-06 06:52:12,026 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2319, Pos_dist: 15.0504, Neg_dist: 22.0813, Acc: 0.9367, PTFixPNLoss: 4.3824, NetFixLoss: 7.6783, ]
2022-11-06 06:52:15,119 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1376, Pos_dist: 15.1763, Neg_dist: 23.8770, Acc: 0.9333, PTFixPNLoss: 4.3867, NetFixLoss: 9.3948, ]
2022-11-06 06:52:18,352 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2225, Pos_dist: 15.0870, Neg_dist: 23.0952, Acc: 0.9367, PTFixPNLoss: 4.3872, NetFixLoss: 11.1238, ]
2022-11-06 06:52:21,500 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0841, Pos_dist: 14.9398, Neg_dist: 24.1017, Acc: 0.9500, PTFixPNLoss: 4.3846, NetFixLoss: 12.8407, ]
2022-11-06 06:52:25,266 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1121, Pos_dist: 14.9571, Neg_dist: 23.4807, Acc: 0.9433, PTFixPNLoss: 4.3833, NetFixLoss: 14.5328, ]
2022-11-06 06:52:25,445 INFO: fine-tune procedure is finished!
2022-11-06 06:53:00,819 INFO: [Test_acc of task 4 on test 0: 0.56157][acc of former classes: 0.75162][acc of former samples in all classes: 0.65515]
[acc of novel samples in all classes: 0.48746]
2022-11-06 06:53:01,211 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:53:01,259 WARNING: Current net - loaded net:
2022-11-06 06:53:01,259 WARNING: Loaded net - current net:
2022-11-06 06:53:01,259 WARNING:   func.classifier.bias
2022-11-06 06:53:01,259 WARNING:   func.classifier.weight
2022-11-06 06:53:01,270 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_4.pth.
2022-11-06 06:53:01,309 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:53:01,325 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:53:01,325 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:53:01,325 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:53:01,325 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:53:01,326 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:53:01,327 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:53:01,328 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:53:01,329 INFO: Model [FSLLModel] is created.
2022-11-06 06:53:01,334 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:53:01,338 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:53:01,342 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:53:01,346 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:53:01,350 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_4.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
2022-11-06 06:53:04,788 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2151, Pos_dist: 15.3841, Neg_dist: 23.3806, Acc: 0.9147, PTFixPNLoss: 4.5232, NetFixLoss: 0.0000, ]
2022-11-06 06:53:08,415 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2298, Pos_dist: 15.2929, Neg_dist: 22.7476, Acc: 0.9173, PTFixPNLoss: 4.5204, NetFixLoss: 1.1425, ]
2022-11-06 06:53:12,010 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2282, Pos_dist: 15.1667, Neg_dist: 22.3457, Acc: 0.9387, PTFixPNLoss: 4.5228, NetFixLoss: 2.5880, ]
2022-11-06 06:53:15,586 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2623, Pos_dist: 15.1364, Neg_dist: 21.7740, Acc: 0.9413, PTFixPNLoss: 4.5196, NetFixLoss: 4.2671, ]
2022-11-06 06:53:19,275 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3679, Pos_dist: 15.1793, Neg_dist: 21.7861, Acc: 0.9067, PTFixPNLoss: 4.5217, NetFixLoss: 6.1551, ]
2022-11-06 06:53:23,033 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3484, Pos_dist: 15.2333, Neg_dist: 22.3291, Acc: 0.9013, PTFixPNLoss: 4.5232, NetFixLoss: 8.2683, ]
2022-11-06 06:53:26,525 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3084, Pos_dist: 15.1075, Neg_dist: 22.3359, Acc: 0.9093, PTFixPNLoss: 4.5158, NetFixLoss: 10.4616, ]
2022-11-06 06:53:30,360 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1081, Pos_dist: 15.3060, Neg_dist: 23.8692, Acc: 0.9253, PTFixPNLoss: 4.5205, NetFixLoss: 12.6585, ]
2022-11-06 06:53:34,319 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0726, Pos_dist: 15.5176, Neg_dist: 25.9344, Acc: 0.9013, PTFixPNLoss: 4.5222, NetFixLoss: 14.7788, ]
2022-11-06 06:53:37,928 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1319, Pos_dist: 15.2982, Neg_dist: 25.1967, Acc: 0.9147, PTFixPNLoss: 4.5202, NetFixLoss: 16.8147, ]
2022-11-06 06:53:38,018 INFO: fine-tune procedure is finished!
2022-11-06 06:54:18,032 INFO: [Test_acc of task 5 on test 0: 0.51984][acc of former classes: 0.75882][acc of former samples in all classes: 0.66235]
[acc of novel samples in all classes: 0.42942]
2022-11-06 06:54:18,384 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:54:18,424 WARNING: Current net - loaded net:
2022-11-06 06:54:18,424 WARNING: Loaded net - current net:
2022-11-06 06:54:18,424 WARNING:   func.classifier.bias
2022-11-06 06:54:18,424 WARNING:   func.classifier.weight
2022-11-06 06:54:18,436 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_5.pth.
2022-11-06 06:54:18,479 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:54:18,496 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:54:18,497 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:54:18,497 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:54:18,498 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:54:18,499 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:54:18,499 INFO: Model [FSLLModel] is created.
2022-11-06 06:54:18,504 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:54:18,507 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:54:18,511 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:54:18,514 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:54:18,517 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:54:18,520 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_5.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-06 06:54:23,186 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0833, Pos_dist: 15.2538, Neg_dist: 25.0531, Acc: 0.9311, PTFixPNLoss: 4.6393, NetFixLoss: 0.0000, ]
2022-11-06 06:54:27,751 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1846, Pos_dist: 15.2853, Neg_dist: 22.9197, Acc: 0.9067, PTFixPNLoss: 4.6410, NetFixLoss: 0.5295, ]
2022-11-06 06:54:32,124 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2522, Pos_dist: 15.2620, Neg_dist: 21.8131, Acc: 0.8956, PTFixPNLoss: 4.6397, NetFixLoss: 1.4763, ]
2022-11-06 06:54:36,523 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0928, Pos_dist: 15.2907, Neg_dist: 25.4800, Acc: 0.8956, PTFixPNLoss: 4.6418, NetFixLoss: 2.9335, ]
2022-11-06 06:54:40,753 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0482, Pos_dist: 15.3146, Neg_dist: 25.0476, Acc: 0.8844, PTFixPNLoss: 4.6397, NetFixLoss: 4.5122, ]
2022-11-06 06:54:45,631 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0772, Pos_dist: 15.3236, Neg_dist: 25.9271, Acc: 0.9022, PTFixPNLoss: 4.6414, NetFixLoss: 6.0293, ]
2022-11-06 06:54:50,206 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1755, Pos_dist: 15.1615, Neg_dist: 22.8695, Acc: 0.9200, PTFixPNLoss: 4.6362, NetFixLoss: 7.4763, ]
2022-11-06 06:54:54,494 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1632, Pos_dist: 15.1738, Neg_dist: 23.4750, Acc: 0.9022, PTFixPNLoss: 4.6390, NetFixLoss: 8.9072, ]
2022-11-06 06:54:59,032 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0776, Pos_dist: 15.4337, Neg_dist: 25.8655, Acc: 0.9022, PTFixPNLoss: 4.6409, NetFixLoss: 10.3649, ]
2022-11-06 06:55:03,195 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0278, Pos_dist: 15.2799, Neg_dist: 26.6646, Acc: 0.9022, PTFixPNLoss: 4.6380, NetFixLoss: 11.8007, ]
2022-11-06 06:55:03,362 INFO: fine-tune procedure is finished!
2022-11-06 06:55:47,647 INFO: [Test_acc of task 6 on test 0: 0.48312][acc of former classes: 0.75090][acc of former samples in all classes: 0.63427]
[acc of novel samples in all classes: 0.40356]
2022-11-06 06:55:48,125 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:55:48,169 WARNING: Current net - loaded net:
2022-11-06 06:55:48,170 WARNING: Loaded net - current net:
2022-11-06 06:55:48,170 WARNING:   func.classifier.bias
2022-11-06 06:55:48,170 WARNING:   func.classifier.weight
2022-11-06 06:55:48,184 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_6.pth.
2022-11-06 06:55:48,233 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:55:48,249 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:55:48,249 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:55:48,249 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:55:48,249 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:55:48,249 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:55:48,250 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:55:48,250 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:55:48,250 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:55:48,250 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:55:48,250 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:55:48,250 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:55:48,250 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:55:48,251 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:55:48,252 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:55:48,253 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:55:48,253 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:55:48,253 INFO: Model [FSLLModel] is created.
2022-11-06 06:55:48,257 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:55:48,261 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:55:48,264 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:55:48,268 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:55:48,271 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:55:48,274 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:55:48,278 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_6.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
2022-11-06 06:55:52,750 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0775, Pos_dist: 15.2485, Neg_dist: 25.3025, Acc: 0.8819, PTFixPNLoss: 4.7444, NetFixLoss: 0.0000, ]
2022-11-06 06:55:57,679 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1524, Pos_dist: 15.3072, Neg_dist: 24.5211, Acc: 0.8876, PTFixPNLoss: 4.7428, NetFixLoss: 0.3405, ]
2022-11-06 06:56:02,792 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0685, Pos_dist: 15.2705, Neg_dist: 24.5874, Acc: 0.9162, PTFixPNLoss: 4.7414, NetFixLoss: 1.0576, ]
2022-11-06 06:56:07,504 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2408, Pos_dist: 15.2483, Neg_dist: 22.7927, Acc: 0.8990, PTFixPNLoss: 4.7409, NetFixLoss: 1.8924, ]
2022-11-06 06:56:12,116 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.6252, Pos_dist: 15.2168, Neg_dist: 20.6860, Acc: 0.9181, PTFixPNLoss: 4.7427, NetFixLoss: 2.9379, ]
2022-11-06 06:56:16,880 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0725, Pos_dist: 15.1284, Neg_dist: 25.1283, Acc: 0.8990, PTFixPNLoss: 4.7378, NetFixLoss: 4.4629, ]
2022-11-06 06:56:21,822 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0818, Pos_dist: 15.1884, Neg_dist: 25.1222, Acc: 0.8990, PTFixPNLoss: 4.7408, NetFixLoss: 6.1842, ]
2022-11-06 06:56:26,192 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2966, Pos_dist: 15.2955, Neg_dist: 21.9603, Acc: 0.9086, PTFixPNLoss: 4.7435, NetFixLoss: 7.8798, ]
2022-11-06 06:56:30,761 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1961, Pos_dist: 15.2588, Neg_dist: 24.1367, Acc: 0.8933, PTFixPNLoss: 4.7417, NetFixLoss: 9.6016, ]
2022-11-06 06:56:35,691 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1358, Pos_dist: 15.2511, Neg_dist: 24.6531, Acc: 0.8895, PTFixPNLoss: 4.7421, NetFixLoss: 11.3513, ]
2022-11-06 06:56:35,870 INFO: fine-tune procedure is finished!
2022-11-06 06:57:22,891 INFO: [Test_acc of task 7 on test 0: 0.44738][acc of former classes: 0.74658][acc of former samples in all classes: 0.60835]
[acc of novel samples in all classes: 0.37472]
2022-11-06 06:57:23,368 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:57:23,406 WARNING: Current net - loaded net:
2022-11-06 06:57:23,406 WARNING: Loaded net - current net:
2022-11-06 06:57:23,406 WARNING:   func.classifier.bias
2022-11-06 06:57:23,406 WARNING:   func.classifier.weight
2022-11-06 06:57:23,417 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_7.pth.
2022-11-06 06:57:23,455 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:57:23,468 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:57:23,469 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:57:23,469 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:57:23,470 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:57:23,471 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:57:23,471 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:57:23,471 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:57:23,471 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:57:23,471 INFO: Model [FSLLModel] is created.
2022-11-06 06:57:23,474 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:57:23,477 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:57:23,479 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:57:23,481 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:57:23,484 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:57:23,486 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:57:23,489 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:57:23,491 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_7.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-06 06:57:29,396 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1954, Pos_dist: 15.1835, Neg_dist: 22.5831, Acc: 0.8983, PTFixPNLoss: 4.8353, NetFixLoss: 0.0000, ]
2022-11-06 06:57:35,286 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1084, Pos_dist: 15.2946, Neg_dist: 24.1751, Acc: 0.8783, PTFixPNLoss: 4.8398, NetFixLoss: 1.0326, ]
2022-11-06 06:57:40,595 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2948, Pos_dist: 15.3355, Neg_dist: 23.5214, Acc: 0.8933, PTFixPNLoss: 4.8399, NetFixLoss: 2.0954, ]
2022-11-06 06:57:46,395 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0881, Pos_dist: 15.2589, Neg_dist: 24.4435, Acc: 0.8783, PTFixPNLoss: 4.8383, NetFixLoss: 3.3284, ]
2022-11-06 06:57:51,600 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1445, Pos_dist: 15.3411, Neg_dist: 23.5898, Acc: 0.8933, PTFixPNLoss: 4.8364, NetFixLoss: 4.6318, ]
2022-11-06 06:57:57,142 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2434, Pos_dist: 15.2615, Neg_dist: 22.6271, Acc: 0.8917, PTFixPNLoss: 4.8345, NetFixLoss: 6.0048, ]
2022-11-06 06:58:03,452 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0954, Pos_dist: 15.2039, Neg_dist: 24.5851, Acc: 0.9033, PTFixPNLoss: 4.8348, NetFixLoss: 7.4754, ]
2022-11-06 06:58:08,992 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1899, Pos_dist: 15.2064, Neg_dist: 22.9825, Acc: 0.8983, PTFixPNLoss: 4.8361, NetFixLoss: 9.0088, ]
2022-11-06 06:58:14,158 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2455, Pos_dist: 15.2429, Neg_dist: 22.6002, Acc: 0.8883, PTFixPNLoss: 4.8338, NetFixLoss: 10.5718, ]
2022-11-06 06:58:19,002 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1279, Pos_dist: 15.0780, Neg_dist: 23.4849, Acc: 0.8867, PTFixPNLoss: 4.8313, NetFixLoss: 12.1775, ]
2022-11-06 06:58:19,128 INFO: fine-tune procedure is finished!
2022-11-06 06:59:10,277 INFO: [Test_acc of task 8 on test 0: 0.44187][acc of former classes: 0.74730][acc of former samples in all classes: 0.59611]
[acc of novel samples in all classes: 0.38103]
2022-11-06 06:59:10,672 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 06:59:10,711 WARNING: Current net - loaded net:
2022-11-06 06:59:10,712 WARNING: Loaded net - current net:
2022-11-06 06:59:10,712 WARNING:   func.classifier.bias
2022-11-06 06:59:10,712 WARNING:   func.classifier.weight
2022-11-06 06:59:10,723 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_8.pth.
2022-11-06 06:59:10,762 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 06:59:10,781 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 06:59:10,782 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 06:59:10,782 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 06:59:10,782 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 06:59:10,782 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 06:59:10,783 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 06:59:10,784 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 06:59:10,785 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 06:59:10,786 INFO: Model [FSLLModel] is created.
2022-11-06 06:59:10,791 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,795 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,799 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,801 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,804 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,806 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,809 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,811 INFO: Dataset NormalDataset - cub is created.
2022-11-06 06:59:10,814 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_8.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
2022-11-06 06:59:16,756 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1866, Pos_dist: 15.2313, Neg_dist: 22.7241, Acc: 0.8711, PTFixPNLoss: 4.9283, NetFixLoss: 0.0000, ]
2022-11-06 06:59:23,055 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2124, Pos_dist: 15.2401, Neg_dist: 22.7452, Acc: 0.8726, PTFixPNLoss: 4.9269, NetFixLoss: 0.9675, ]
2022-11-06 06:59:29,059 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2906, Pos_dist: 15.2212, Neg_dist: 21.9647, Acc: 0.8667, PTFixPNLoss: 4.9266, NetFixLoss: 2.2041, ]
2022-11-06 06:59:34,811 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2859, Pos_dist: 15.3405, Neg_dist: 22.0631, Acc: 0.8874, PTFixPNLoss: 4.9296, NetFixLoss: 3.7535, ]
2022-11-06 06:59:41,054 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3738, Pos_dist: 15.1882, Neg_dist: 21.8064, Acc: 0.8889, PTFixPNLoss: 4.9258, NetFixLoss: 5.5647, ]
2022-11-06 06:59:47,627 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2103, Pos_dist: 15.1770, Neg_dist: 22.3363, Acc: 0.8919, PTFixPNLoss: 4.9238, NetFixLoss: 7.6051, ]
2022-11-06 06:59:55,376 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1743, Pos_dist: 15.1894, Neg_dist: 23.2062, Acc: 0.8859, PTFixPNLoss: 4.9241, NetFixLoss: 9.7243, ]
2022-11-06 07:00:03,711 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2189, Pos_dist: 15.0214, Neg_dist: 23.4126, Acc: 0.8815, PTFixPNLoss: 4.9204, NetFixLoss: 11.8799, ]
2022-11-06 07:00:11,493 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4143, Pos_dist: 15.0702, Neg_dist: 21.7171, Acc: 0.8785, PTFixPNLoss: 4.9199, NetFixLoss: 13.9916, ]
2022-11-06 07:00:18,663 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3306, Pos_dist: 15.0553, Neg_dist: 21.4528, Acc: 0.8889, PTFixPNLoss: 4.9228, NetFixLoss: 16.0782, ]
2022-11-06 07:00:18,754 INFO: fine-tune procedure is finished!
2022-11-06 07:01:18,402 INFO: [Test_acc of task 9 on test 0: 0.42035][acc of former classes: 0.74514][acc of former samples in all classes: 0.58315]
[acc of novel samples in all classes: 0.36334]
2022-11-06 07:01:18,836 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:01:18,866 WARNING: Current net - loaded net:
2022-11-06 07:01:18,867 WARNING: Loaded net - current net:
2022-11-06 07:01:18,867 WARNING:   func.classifier.bias
2022-11-06 07:01:18,867 WARNING:   func.classifier.weight
2022-11-06 07:01:18,884 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_9.pth.
2022-11-06 07:01:18,924 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:01:18,937 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:01:18,938 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:01:18,938 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:01:18,938 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:01:18,938 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:01:18,938 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:01:18,938 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:01:18,938 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:01:18,938 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:01:18,938 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:01:18,939 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:01:18,940 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:01:18,941 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:01:18,941 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:01:18,941 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:01:18,941 INFO: Model [FSLLModel] is created.
2022-11-06 07:01:18,946 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,950 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,955 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,958 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,962 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,966 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,970 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,974 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,979 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:01:18,983 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_9.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-06 07:01:27,422 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0281, Pos_dist: 15.1389, Neg_dist: 26.7136, Acc: 0.8680, PTFixPNLoss: 5.0030, NetFixLoss: 0.0000, ]
2022-11-06 07:01:35,780 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0997, Pos_dist: 14.9401, Neg_dist: 23.6505, Acc: 0.8867, PTFixPNLoss: 4.9970, NetFixLoss: 0.1957, ]
2022-11-06 07:01:44,171 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3908, Pos_dist: 15.0228, Neg_dist: 21.6935, Acc: 0.9067, PTFixPNLoss: 5.0000, NetFixLoss: 0.7786, ]
2022-11-06 07:01:52,553 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1713, Pos_dist: 15.1215, Neg_dist: 22.4480, Acc: 0.8880, PTFixPNLoss: 5.0021, NetFixLoss: 1.9646, ]
2022-11-06 07:02:00,110 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1058, Pos_dist: 15.1234, Neg_dist: 23.9168, Acc: 0.8800, PTFixPNLoss: 5.0037, NetFixLoss: 3.4621, ]
2022-11-06 07:02:08,458 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3013, Pos_dist: 15.0726, Neg_dist: 22.8541, Acc: 0.8720, PTFixPNLoss: 5.0004, NetFixLoss: 5.0391, ]
2022-11-06 07:02:16,697 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3006, Pos_dist: 15.0857, Neg_dist: 21.8622, Acc: 0.8653, PTFixPNLoss: 4.9984, NetFixLoss: 6.6807, ]
2022-11-06 07:02:24,130 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4368, Pos_dist: 15.1886, Neg_dist: 21.6832, Acc: 0.8813, PTFixPNLoss: 5.0030, NetFixLoss: 8.4817, ]
2022-11-06 07:02:31,926 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4298, Pos_dist: 15.0741, Neg_dist: 21.5655, Acc: 0.8720, PTFixPNLoss: 5.0016, NetFixLoss: 10.4546, ]
2022-11-06 07:02:38,356 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2920, Pos_dist: 15.1998, Neg_dist: 22.2089, Acc: 0.8627, PTFixPNLoss: 5.0040, NetFixLoss: 12.5625, ]
2022-11-06 07:02:38,467 INFO: fine-tune procedure is finished!
2022-11-06 07:03:42,318 INFO: [Test_acc of task 10 on test 0: 0.42320][acc of former classes: 0.74298][acc of former samples in all classes: 0.56587]
[acc of novel samples in all classes: 0.37821]
2022-11-06 07:03:42,722 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:03:42,839 WARNING: Current net - loaded net:
2022-11-06 07:03:42,839 WARNING: Loaded net - current net:
2022-11-06 07:03:42,839 WARNING:   func.classifier.bias
2022-11-06 07:03:42,839 WARNING:   func.classifier.weight
2022-11-06 07:03:42,859 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth.
2022-11-06 07:03:42,924 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:03:42,961 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:03:42,962 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:03:42,962 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:03:42,962 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:03:42,962 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:03:42,963 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:03:42,964 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:03:42,965 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:03:42,965 INFO: Model [FSLLModel] is created.
2022-11-06 07:03:42,970 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-06 07:03:44,342 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3770, Pos_dist: 16.3178, Neg_dist: 24.8553, Acc: 0.9200, PTFixPNLoss: 3.8958, NetFixLoss: 0.0000, ]
2022-11-06 07:03:45,889 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 1.0269, Pos_dist: 16.1367, Neg_dist: 21.2013, Acc: 0.9067, PTFixPNLoss: 3.8980, NetFixLoss: 1.7193, ]
2022-11-06 07:03:47,543 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4969, Pos_dist: 15.9965, Neg_dist: 22.8774, Acc: 0.9067, PTFixPNLoss: 3.8928, NetFixLoss: 4.5819, ]
2022-11-06 07:03:49,110 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.8385, Pos_dist: 16.0864, Neg_dist: 21.4270, Acc: 0.9333, PTFixPNLoss: 3.8896, NetFixLoss: 8.1530, ]
2022-11-06 07:03:52,671 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3687, Pos_dist: 15.6437, Neg_dist: 22.2808, Acc: 0.9467, PTFixPNLoss: 3.8853, NetFixLoss: 12.3782, ]
2022-11-06 07:03:54,220 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4416, Pos_dist: 16.2460, Neg_dist: 24.5147, Acc: 0.8800, PTFixPNLoss: 3.8960, NetFixLoss: 16.7058, ]
2022-11-06 07:03:55,420 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1981, Pos_dist: 15.6909, Neg_dist: 23.3245, Acc: 0.9467, PTFixPNLoss: 3.8844, NetFixLoss: 21.1156, ]
2022-11-06 07:03:56,943 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2029, Pos_dist: 15.5573, Neg_dist: 24.5727, Acc: 0.8800, PTFixPNLoss: 3.8807, NetFixLoss: 25.5522, ]
2022-11-06 07:03:58,528 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4310, Pos_dist: 15.4816, Neg_dist: 21.7021, Acc: 0.9600, PTFixPNLoss: 3.8765, NetFixLoss: 29.8725, ]
2022-11-06 07:03:59,757 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1254, Pos_dist: 15.8564, Neg_dist: 24.5473, Acc: 0.9200, PTFixPNLoss: 3.8717, NetFixLoss: 34.1866, ]
2022-11-06 07:03:59,834 INFO: fine-tune procedure is finished!
2022-11-06 07:04:22,121 INFO: [Test_acc of task 1 on test 1: 0.67196][acc of former classes: 0.75522][acc of former samples in all classes: 0.72786]
[acc of novel samples in all classes: 0.49428]
2022-11-06 07:04:22,485 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:04:22,513 WARNING: Current net - loaded net:
2022-11-06 07:04:22,513 WARNING: Loaded net - current net:
2022-11-06 07:04:22,513 WARNING:   func.classifier.bias
2022-11-06 07:04:22,513 WARNING:   func.classifier.weight
2022-11-06 07:04:22,528 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_1.pth.
2022-11-06 07:04:22,568 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:04:22,667 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:04:22,668 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:04:22,668 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:04:22,668 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:04:22,669 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:04:22,670 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:04:22,671 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:04:22,671 INFO: Model [FSLLModel] is created.
2022-11-06 07:04:22,676 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:04:22,680 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_1.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 07:04:24,825 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3479, Pos_dist: 15.7314, Neg_dist: 23.4230, Acc: 0.9067, PTFixPNLoss: 4.0878, NetFixLoss: 0.0000, ]
2022-11-06 07:04:26,891 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0295, Pos_dist: 15.6906, Neg_dist: 26.0548, Acc: 0.9067, PTFixPNLoss: 4.0838, NetFixLoss: 1.5094, ]
2022-11-06 07:04:28,907 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4993, Pos_dist: 15.6334, Neg_dist: 22.9756, Acc: 0.9067, PTFixPNLoss: 4.0844, NetFixLoss: 2.9255, ]
2022-11-06 07:04:31,023 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.4902, Pos_dist: 15.5484, Neg_dist: 21.6041, Acc: 0.9133, PTFixPNLoss: 4.0813, NetFixLoss: 4.7382, ]
2022-11-06 07:04:33,592 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4145, Pos_dist: 15.5568, Neg_dist: 21.8249, Acc: 0.9067, PTFixPNLoss: 4.0822, NetFixLoss: 7.0362, ]
2022-11-06 07:04:35,797 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4333, Pos_dist: 15.7810, Neg_dist: 22.1475, Acc: 0.8733, PTFixPNLoss: 4.0863, NetFixLoss: 9.7156, ]
2022-11-06 07:04:37,965 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3243, Pos_dist: 15.5528, Neg_dist: 22.6451, Acc: 0.9267, PTFixPNLoss: 4.0796, NetFixLoss: 12.9041, ]
2022-11-06 07:04:40,258 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1484, Pos_dist: 15.3513, Neg_dist: 24.0406, Acc: 0.9333, PTFixPNLoss: 4.0768, NetFixLoss: 16.2362, ]
2022-11-06 07:04:42,661 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3755, Pos_dist: 15.2977, Neg_dist: 21.5103, Acc: 0.9467, PTFixPNLoss: 4.0769, NetFixLoss: 19.4706, ]
2022-11-06 07:04:45,096 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3099, Pos_dist: 15.2990, Neg_dist: 21.7902, Acc: 0.9067, PTFixPNLoss: 4.0721, NetFixLoss: 22.5971, ]
2022-11-06 07:04:45,218 INFO: fine-tune procedure is finished!
2022-11-06 07:05:12,418 INFO: [Test_acc of task 2 on test 1: 0.61620][acc of former classes: 0.76602][acc of former samples in all classes: 0.70338]
[acc of novel samples in all classes: 0.47905]
2022-11-06 07:05:12,842 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:05:12,881 WARNING: Current net - loaded net:
2022-11-06 07:05:12,881 WARNING: Loaded net - current net:
2022-11-06 07:05:12,881 WARNING:   func.classifier.bias
2022-11-06 07:05:12,881 WARNING:   func.classifier.weight
2022-11-06 07:05:12,904 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_2.pth.
2022-11-06 07:05:12,963 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:05:12,977 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:05:12,977 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:05:12,978 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:05:12,978 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:05:12,978 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:05:12,979 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:05:12,980 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:05:12,980 INFO: Model [FSLLModel] is created.
2022-11-06 07:05:12,983 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:05:12,986 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:05:12,988 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_2.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-06 07:05:15,720 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1493, Pos_dist: 15.4077, Neg_dist: 24.3678, Acc: 0.9244, PTFixPNLoss: 4.2500, NetFixLoss: 0.0000, ]
2022-11-06 07:05:18,773 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3213, Pos_dist: 15.4581, Neg_dist: 22.0417, Acc: 0.9022, PTFixPNLoss: 4.2516, NetFixLoss: 0.7762, ]
2022-11-06 07:05:21,845 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.5211, Pos_dist: 15.6682, Neg_dist: 21.5389, Acc: 0.8844, PTFixPNLoss: 4.2569, NetFixLoss: 2.3232, ]
2022-11-06 07:05:24,674 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3414, Pos_dist: 15.3026, Neg_dist: 22.2774, Acc: 0.9156, PTFixPNLoss: 4.2480, NetFixLoss: 4.4180, ]
2022-11-06 07:05:27,290 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2360, Pos_dist: 15.3899, Neg_dist: 23.4470, Acc: 0.9289, PTFixPNLoss: 4.2514, NetFixLoss: 6.7955, ]
2022-11-06 07:05:30,228 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.5289, Pos_dist: 15.3318, Neg_dist: 21.4820, Acc: 0.9244, PTFixPNLoss: 4.2488, NetFixLoss: 9.3172, ]
2022-11-06 07:05:33,351 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1801, Pos_dist: 15.4128, Neg_dist: 23.4523, Acc: 0.8978, PTFixPNLoss: 4.2508, NetFixLoss: 11.9016, ]
2022-11-06 07:05:36,256 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3691, Pos_dist: 15.4449, Neg_dist: 21.7318, Acc: 0.8889, PTFixPNLoss: 4.2539, NetFixLoss: 14.6407, ]
2022-11-06 07:05:39,091 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3624, Pos_dist: 15.2338, Neg_dist: 21.6878, Acc: 0.9244, PTFixPNLoss: 4.2454, NetFixLoss: 17.3770, ]
2022-11-06 07:05:41,914 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1806, Pos_dist: 15.3621, Neg_dist: 23.3335, Acc: 0.9378, PTFixPNLoss: 4.2468, NetFixLoss: 20.1762, ]
2022-11-06 07:05:42,199 INFO: fine-tune procedure is finished!
2022-11-06 07:06:12,888 INFO: [Test_acc of task 3 on test 1: 0.60037][acc of former classes: 0.75954][acc of former samples in all classes: 0.68467]
[acc of novel samples in all classes: 0.51207]
2022-11-06 07:06:13,270 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:06:13,313 WARNING: Current net - loaded net:
2022-11-06 07:06:13,314 WARNING: Loaded net - current net:
2022-11-06 07:06:13,314 WARNING:   func.classifier.bias
2022-11-06 07:06:13,314 WARNING:   func.classifier.weight
2022-11-06 07:06:13,329 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_3.pth.
2022-11-06 07:06:13,478 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:06:13,494 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:06:13,494 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:06:13,495 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:06:13,495 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:06:13,495 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:06:13,496 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:06:13,497 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:06:13,497 INFO: Model [FSLLModel] is created.
2022-11-06 07:06:13,501 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:06:13,503 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:06:13,506 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:06:13,509 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_3.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-06 07:06:17,026 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1950, Pos_dist: 15.0300, Neg_dist: 22.4981, Acc: 0.9067, PTFixPNLoss: 4.3884, NetFixLoss: 0.0000, ]
2022-11-06 07:06:20,167 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1741, Pos_dist: 15.1808, Neg_dist: 23.1791, Acc: 0.9167, PTFixPNLoss: 4.3903, NetFixLoss: 0.9118, ]
2022-11-06 07:06:24,478 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2771, Pos_dist: 15.3383, Neg_dist: 22.7600, Acc: 0.9100, PTFixPNLoss: 4.3938, NetFixLoss: 1.9742, ]
2022-11-06 07:06:28,404 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0713, Pos_dist: 15.4666, Neg_dist: 24.9145, Acc: 0.9133, PTFixPNLoss: 4.3974, NetFixLoss: 3.2665, ]
2022-11-06 07:06:32,218 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1435, Pos_dist: 15.2584, Neg_dist: 24.1209, Acc: 0.9033, PTFixPNLoss: 4.3916, NetFixLoss: 4.6362, ]
2022-11-06 07:06:35,979 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1976, Pos_dist: 15.3105, Neg_dist: 23.0080, Acc: 0.9067, PTFixPNLoss: 4.3937, NetFixLoss: 6.0324, ]
2022-11-06 07:06:39,551 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2634, Pos_dist: 15.1618, Neg_dist: 22.3431, Acc: 0.8933, PTFixPNLoss: 4.3900, NetFixLoss: 7.5095, ]
2022-11-06 07:06:43,573 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0317, Pos_dist: 15.0480, Neg_dist: 26.3834, Acc: 0.9100, PTFixPNLoss: 4.3898, NetFixLoss: 9.0592, ]
2022-11-06 07:06:47,880 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1178, Pos_dist: 15.1757, Neg_dist: 24.0230, Acc: 0.9067, PTFixPNLoss: 4.3890, NetFixLoss: 10.6465, ]
2022-11-06 07:06:51,561 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0853, Pos_dist: 15.0346, Neg_dist: 23.2469, Acc: 0.9067, PTFixPNLoss: 4.3866, NetFixLoss: 12.2034, ]
2022-11-06 07:06:51,839 INFO: fine-tune procedure is finished!
2022-11-06 07:07:26,686 INFO: [Test_acc of task 4 on test 1: 0.56220][acc of former classes: 0.76314][acc of former samples in all classes: 0.66379]
[acc of novel samples in all classes: 0.48176]
2022-11-06 07:07:27,062 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:07:27,091 WARNING: Current net - loaded net:
2022-11-06 07:07:27,091 WARNING: Loaded net - current net:
2022-11-06 07:07:27,091 WARNING:   func.classifier.bias
2022-11-06 07:07:27,091 WARNING:   func.classifier.weight
2022-11-06 07:07:27,108 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_4.pth.
2022-11-06 07:07:27,156 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:07:27,169 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:07:27,170 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:07:27,170 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:07:27,171 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:07:27,172 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:07:27,172 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:07:27,172 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:07:27,172 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:07:27,172 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:07:27,172 INFO: Model [FSLLModel] is created.
2022-11-06 07:07:27,175 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:07:27,178 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:07:27,181 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:07:27,184 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:07:27,187 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_4.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
2022-11-06 07:07:30,939 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3375, Pos_dist: 15.2648, Neg_dist: 22.4369, Acc: 0.8960, PTFixPNLoss: 4.5257, NetFixLoss: 0.0000, ]
2022-11-06 07:07:35,339 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0915, Pos_dist: 15.3526, Neg_dist: 24.8157, Acc: 0.9067, PTFixPNLoss: 4.5296, NetFixLoss: 1.1549, ]
2022-11-06 07:07:39,729 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.5512, Pos_dist: 15.3091, Neg_dist: 21.1395, Acc: 0.8827, PTFixPNLoss: 4.5292, NetFixLoss: 2.2817, ]
2022-11-06 07:07:44,506 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.5126, Pos_dist: 15.3101, Neg_dist: 20.9009, Acc: 0.8987, PTFixPNLoss: 4.5284, NetFixLoss: 3.8165, ]
2022-11-06 07:07:49,229 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4910, Pos_dist: 15.2489, Neg_dist: 21.2721, Acc: 0.8987, PTFixPNLoss: 4.5225, NetFixLoss: 5.8835, ]
2022-11-06 07:07:54,121 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2591, Pos_dist: 15.0985, Neg_dist: 23.5224, Acc: 0.8987, PTFixPNLoss: 4.5198, NetFixLoss: 8.2708, ]
2022-11-06 07:07:57,846 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1287, Pos_dist: 15.4880, Neg_dist: 24.2171, Acc: 0.8987, PTFixPNLoss: 4.5248, NetFixLoss: 10.7584, ]
2022-11-06 07:08:02,010 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2811, Pos_dist: 15.2607, Neg_dist: 22.4198, Acc: 0.9280, PTFixPNLoss: 4.5212, NetFixLoss: 13.2042, ]
2022-11-06 07:08:06,721 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1271, Pos_dist: 15.3687, Neg_dist: 23.6139, Acc: 0.8960, PTFixPNLoss: 4.5258, NetFixLoss: 15.6024, ]
2022-11-06 07:08:10,670 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2332, Pos_dist: 15.1739, Neg_dist: 22.9270, Acc: 0.8773, PTFixPNLoss: 4.5247, NetFixLoss: 17.8928, ]
2022-11-06 07:08:10,807 INFO: fine-tune procedure is finished!
2022-11-06 07:08:51,520 INFO: [Test_acc of task 5 on test 1: 0.52152][acc of former classes: 0.76890][acc of former samples in all classes: 0.65947]
[acc of novel samples in all classes: 0.43399]
2022-11-06 07:08:52,121 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:08:52,152 WARNING: Current net - loaded net:
2022-11-06 07:08:52,152 WARNING: Loaded net - current net:
2022-11-06 07:08:52,152 WARNING:   func.classifier.bias
2022-11-06 07:08:52,152 WARNING:   func.classifier.weight
2022-11-06 07:08:52,170 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_5.pth.
2022-11-06 07:08:52,205 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:08:52,223 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:08:52,223 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:08:52,223 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:08:52,223 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:08:52,223 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:08:52,223 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:08:52,223 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:08:52,224 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:08:52,225 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:08:52,226 INFO: Model [FSLLModel] is created.
2022-11-06 07:08:52,229 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:08:52,232 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:08:52,234 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:08:52,237 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:08:52,240 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:08:52,243 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_5.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-06 07:08:57,372 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1546, Pos_dist: 15.1922, Neg_dist: 24.0571, Acc: 0.8978, PTFixPNLoss: 4.6403, NetFixLoss: 0.0000, ]
2022-11-06 07:09:02,435 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0762, Pos_dist: 15.5116, Neg_dist: 25.6177, Acc: 0.8667, PTFixPNLoss: 4.6495, NetFixLoss: 0.7552, ]
2022-11-06 07:09:07,493 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1885, Pos_dist: 15.2578, Neg_dist: 23.2125, Acc: 0.8711, PTFixPNLoss: 4.6429, NetFixLoss: 1.5774, ]
2022-11-06 07:09:12,792 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0889, Pos_dist: 15.1588, Neg_dist: 24.7464, Acc: 0.9022, PTFixPNLoss: 4.6395, NetFixLoss: 2.6637, ]
2022-11-06 07:09:18,294 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.5026, Pos_dist: 15.3640, Neg_dist: 21.8727, Acc: 0.9022, PTFixPNLoss: 4.6402, NetFixLoss: 3.8725, ]
2022-11-06 07:09:23,729 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1206, Pos_dist: 15.1394, Neg_dist: 23.7092, Acc: 0.8778, PTFixPNLoss: 4.6391, NetFixLoss: 5.3640, ]
2022-11-06 07:09:29,061 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3001, Pos_dist: 15.0155, Neg_dist: 22.3434, Acc: 0.9133, PTFixPNLoss: 4.6392, NetFixLoss: 6.9987, ]
2022-11-06 07:09:34,247 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1582, Pos_dist: 15.4237, Neg_dist: 23.8554, Acc: 0.8600, PTFixPNLoss: 4.6452, NetFixLoss: 8.6902, ]
2022-11-06 07:09:39,453 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0992, Pos_dist: 15.2462, Neg_dist: 24.1728, Acc: 0.8978, PTFixPNLoss: 4.6387, NetFixLoss: 10.4976, ]
2022-11-06 07:09:43,621 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2445, Pos_dist: 15.2744, Neg_dist: 23.2748, Acc: 0.8600, PTFixPNLoss: 4.6400, NetFixLoss: 12.3118, ]
2022-11-06 07:09:43,770 INFO: fine-tune procedure is finished!
2022-11-06 07:10:29,469 INFO: [Test_acc of task 6 on test 1: 0.48535][acc of former classes: 0.75666][acc of former samples in all classes: 0.62203]
[acc of novel samples in all classes: 0.41341]
2022-11-06 07:10:29,794 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:10:29,824 WARNING: Current net - loaded net:
2022-11-06 07:10:29,824 WARNING: Loaded net - current net:
2022-11-06 07:10:29,825 WARNING:   func.classifier.bias
2022-11-06 07:10:29,825 WARNING:   func.classifier.weight
2022-11-06 07:10:29,866 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_6.pth.
2022-11-06 07:10:29,959 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:10:29,975 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:10:29,975 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:10:29,975 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:10:29,976 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:10:29,977 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:10:29,977 INFO: Model [FSLLModel] is created.
2022-11-06 07:10:29,981 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:10:29,983 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:10:29,986 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:10:29,989 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:10:29,991 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:10:29,994 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:10:29,997 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_6.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
2022-11-06 07:10:35,875 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3968, Pos_dist: 15.1734, Neg_dist: 21.9017, Acc: 0.8648, PTFixPNLoss: 4.7427, NetFixLoss: 0.0000, ]
2022-11-06 07:10:43,410 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3596, Pos_dist: 15.1824, Neg_dist: 21.9598, Acc: 0.8781, PTFixPNLoss: 4.7422, NetFixLoss: 1.4285, ]
2022-11-06 07:10:49,452 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1066, Pos_dist: 15.2769, Neg_dist: 25.7977, Acc: 0.8667, PTFixPNLoss: 4.7450, NetFixLoss: 3.1797, ]
2022-11-06 07:10:55,500 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3958, Pos_dist: 15.3092, Neg_dist: 22.3049, Acc: 0.8610, PTFixPNLoss: 4.7450, NetFixLoss: 4.9742, ]
2022-11-06 07:11:01,184 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2926, Pos_dist: 15.2829, Neg_dist: 22.3328, Acc: 0.8762, PTFixPNLoss: 4.7471, NetFixLoss: 6.8629, ]
2022-11-06 07:11:07,461 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3645, Pos_dist: 15.1848, Neg_dist: 21.6013, Acc: 0.8743, PTFixPNLoss: 4.7412, NetFixLoss: 8.8493, ]
2022-11-06 07:11:13,481 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2114, Pos_dist: 15.1974, Neg_dist: 23.4345, Acc: 0.8895, PTFixPNLoss: 4.7401, NetFixLoss: 10.9388, ]
2022-11-06 07:11:19,542 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3305, Pos_dist: 15.1910, Neg_dist: 21.6006, Acc: 0.8590, PTFixPNLoss: 4.7408, NetFixLoss: 13.1326, ]
2022-11-06 07:11:25,787 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3028, Pos_dist: 15.2204, Neg_dist: 21.5767, Acc: 0.8743, PTFixPNLoss: 4.7441, NetFixLoss: 15.3471, ]
2022-11-06 07:11:31,423 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2893, Pos_dist: 15.2794, Neg_dist: 22.2451, Acc: 0.8648, PTFixPNLoss: 4.7430, NetFixLoss: 17.6591, ]
2022-11-06 07:11:31,539 INFO: fine-tune procedure is finished!
2022-11-06 07:12:23,352 INFO: [Test_acc of task 7 on test 1: 0.46708][acc of former classes: 0.75306][acc of former samples in all classes: 0.59971]
[acc of novel samples in all classes: 0.40721]
2022-11-06 07:12:23,695 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:12:23,725 WARNING: Current net - loaded net:
2022-11-06 07:12:23,726 WARNING: Loaded net - current net:
2022-11-06 07:12:23,726 WARNING:   func.classifier.bias
2022-11-06 07:12:23,726 WARNING:   func.classifier.weight
2022-11-06 07:12:23,741 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_7.pth.
2022-11-06 07:12:23,779 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:12:23,796 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:12:23,796 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:12:23,796 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:12:23,796 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:12:23,796 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:12:23,796 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:12:23,797 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:12:23,798 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:12:23,799 INFO: Model [FSLLModel] is created.
2022-11-06 07:12:23,802 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:12:23,804 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:12:23,807 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:12:23,810 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:12:23,813 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:12:23,817 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:12:23,821 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:12:23,824 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_7.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-06 07:12:30,485 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2644, Pos_dist: 15.0920, Neg_dist: 21.8351, Acc: 0.8783, PTFixPNLoss: 4.8367, NetFixLoss: 0.0000, ]
2022-11-06 07:12:37,152 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2118, Pos_dist: 15.1788, Neg_dist: 22.4938, Acc: 0.8500, PTFixPNLoss: 4.8357, NetFixLoss: 1.0161, ]
2022-11-06 07:12:44,000 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1616, Pos_dist: 15.1471, Neg_dist: 23.6660, Acc: 0.8750, PTFixPNLoss: 4.8336, NetFixLoss: 2.2741, ]
2022-11-06 07:12:51,161 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2244, Pos_dist: 15.1685, Neg_dist: 22.4562, Acc: 0.8583, PTFixPNLoss: 4.8367, NetFixLoss: 3.6384, ]
2022-11-06 07:12:57,931 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2579, Pos_dist: 15.0848, Neg_dist: 22.5182, Acc: 0.8833, PTFixPNLoss: 4.8330, NetFixLoss: 5.1820, ]
2022-11-06 07:13:04,636 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1569, Pos_dist: 14.9531, Neg_dist: 23.0526, Acc: 0.8667, PTFixPNLoss: 4.8325, NetFixLoss: 6.8725, ]
2022-11-06 07:13:11,042 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1534, Pos_dist: 15.1259, Neg_dist: 23.1358, Acc: 0.8733, PTFixPNLoss: 4.8355, NetFixLoss: 8.5977, ]
2022-11-06 07:13:17,181 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1631, Pos_dist: 15.1258, Neg_dist: 23.7442, Acc: 0.8600, PTFixPNLoss: 4.8344, NetFixLoss: 10.3136, ]
2022-11-06 07:13:23,832 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3212, Pos_dist: 15.0419, Neg_dist: 21.8049, Acc: 0.8683, PTFixPNLoss: 4.8339, NetFixLoss: 11.9970, ]
2022-11-06 07:13:30,293 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0442, Pos_dist: 15.0508, Neg_dist: 26.2581, Acc: 0.8667, PTFixPNLoss: 4.8322, NetFixLoss: 13.7337, ]
2022-11-06 07:13:30,480 INFO: fine-tune procedure is finished!
2022-11-06 07:14:25,024 INFO: [Test_acc of task 8 on test 1: 0.45144][acc of former classes: 0.74946][acc of former samples in all classes: 0.57739]
[acc of novel samples in all classes: 0.40176]
2022-11-06 07:14:25,362 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:14:25,400 WARNING: Current net - loaded net:
2022-11-06 07:14:25,400 WARNING: Loaded net - current net:
2022-11-06 07:14:25,400 WARNING:   func.classifier.bias
2022-11-06 07:14:25,400 WARNING:   func.classifier.weight
2022-11-06 07:14:25,420 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_8.pth.
2022-11-06 07:14:25,460 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:14:25,474 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:14:25,474 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:14:25,474 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:14:25,474 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:14:25,474 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:14:25,474 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:14:25,474 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:14:25,475 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:14:25,476 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:14:25,477 INFO: Model [FSLLModel] is created.
2022-11-06 07:14:25,480 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,483 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,486 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,488 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,491 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,493 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,496 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,499 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:14:25,501 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_8.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
2022-11-06 07:14:32,446 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2433, Pos_dist: 15.0334, Neg_dist: 22.3201, Acc: 0.8563, PTFixPNLoss: 4.9211, NetFixLoss: 0.0000, ]
2022-11-06 07:14:39,487 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1461, Pos_dist: 15.0014, Neg_dist: 23.4726, Acc: 0.8696, PTFixPNLoss: 4.9187, NetFixLoss: 0.9387, ]
2022-11-06 07:14:47,649 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2401, Pos_dist: 15.0130, Neg_dist: 22.2448, Acc: 0.8652, PTFixPNLoss: 4.9185, NetFixLoss: 1.9834, ]
2022-11-06 07:14:55,040 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1628, Pos_dist: 15.0526, Neg_dist: 23.0985, Acc: 0.8785, PTFixPNLoss: 4.9204, NetFixLoss: 3.3216, ]
2022-11-06 07:15:01,447 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1386, Pos_dist: 15.1061, Neg_dist: 23.8747, Acc: 0.8756, PTFixPNLoss: 4.9182, NetFixLoss: 4.8208, ]
2022-11-06 07:15:08,318 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4129, Pos_dist: 15.0913, Neg_dist: 21.8778, Acc: 0.8548, PTFixPNLoss: 4.9224, NetFixLoss: 6.3446, ]
2022-11-06 07:15:15,692 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3189, Pos_dist: 15.0309, Neg_dist: 22.0799, Acc: 0.8830, PTFixPNLoss: 4.9193, NetFixLoss: 7.9811, ]
2022-11-06 07:15:23,327 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3450, Pos_dist: 14.9720, Neg_dist: 21.7950, Acc: 0.8741, PTFixPNLoss: 4.9196, NetFixLoss: 9.7808, ]
2022-11-06 07:15:30,293 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3218, Pos_dist: 15.0400, Neg_dist: 21.9489, Acc: 0.8622, PTFixPNLoss: 4.9219, NetFixLoss: 11.7149, ]
2022-11-06 07:15:37,918 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2927, Pos_dist: 15.1518, Neg_dist: 22.2719, Acc: 0.8519, PTFixPNLoss: 4.9215, NetFixLoss: 13.7396, ]
2022-11-06 07:15:38,131 INFO: fine-tune procedure is finished!
2022-11-06 07:16:36,588 INFO: [Test_acc of task 9 on test 1: 0.42353][acc of former classes: 0.74442][acc of former samples in all classes: 0.56443]
[acc of novel samples in all classes: 0.37418]
2022-11-06 07:16:36,969 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:16:37,002 WARNING: Current net - loaded net:
2022-11-06 07:16:37,002 WARNING: Loaded net - current net:
2022-11-06 07:16:37,002 WARNING:   func.classifier.bias
2022-11-06 07:16:37,002 WARNING:   func.classifier.weight
2022-11-06 07:16:37,022 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_9.pth.
2022-11-06 07:16:37,063 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:16:37,088 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:16:37,093 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:16:37,093 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:16:37,094 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:16:37,095 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:16:37,096 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:16:37,096 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:16:37,096 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:16:37,096 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:16:37,096 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:16:37,096 INFO: Model [FSLLModel] is created.
2022-11-06 07:16:37,120 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,124 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,128 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,132 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,137 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,140 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,144 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,148 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,151 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:16:37,154 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_9.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-06 07:16:45,894 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2825, Pos_dist: 15.0950, Neg_dist: 22.4609, Acc: 0.8800, PTFixPNLoss: 4.9991, NetFixLoss: 0.0000, ]
2022-11-06 07:16:54,552 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0822, Pos_dist: 15.0673, Neg_dist: 23.9921, Acc: 0.8693, PTFixPNLoss: 4.9990, NetFixLoss: 0.9535, ]
2022-11-06 07:17:03,244 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3240, Pos_dist: 14.9964, Neg_dist: 22.1338, Acc: 0.8760, PTFixPNLoss: 4.9980, NetFixLoss: 1.9684, ]
2022-11-06 07:17:11,065 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1030, Pos_dist: 15.0237, Neg_dist: 23.9809, Acc: 0.8707, PTFixPNLoss: 4.9993, NetFixLoss: 3.2664, ]
2022-11-06 07:17:18,902 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2901, Pos_dist: 15.1446, Neg_dist: 22.4381, Acc: 0.8693, PTFixPNLoss: 5.0010, NetFixLoss: 4.6742, ]
2022-11-06 07:17:26,567 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2658, Pos_dist: 15.0213, Neg_dist: 22.3595, Acc: 0.8640, PTFixPNLoss: 4.9997, NetFixLoss: 6.1626, ]
2022-11-06 07:17:36,816 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0888, Pos_dist: 15.0386, Neg_dist: 24.2534, Acc: 0.8547, PTFixPNLoss: 5.0030, NetFixLoss: 7.8224, ]
2022-11-06 07:17:44,561 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0956, Pos_dist: 14.9232, Neg_dist: 23.6115, Acc: 0.8733, PTFixPNLoss: 4.9968, NetFixLoss: 9.5677, ]
2022-11-06 07:17:52,564 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0935, Pos_dist: 14.9796, Neg_dist: 23.7067, Acc: 0.8760, PTFixPNLoss: 4.9980, NetFixLoss: 11.2714, ]
2022-11-06 07:18:00,505 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1783, Pos_dist: 14.9734, Neg_dist: 22.8806, Acc: 0.8600, PTFixPNLoss: 4.9993, NetFixLoss: 12.9394, ]
2022-11-06 07:18:00,632 INFO: fine-tune procedure is finished!
2022-11-06 07:19:09,687 INFO: [Test_acc of task 10 on test 1: 0.42579][acc of former classes: 0.74298][acc of former samples in all classes: 0.54356]
[acc of novel samples in all classes: 0.38865]
2022-11-06 07:19:10,103 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:19:10,144 WARNING: Current net - loaded net:
2022-11-06 07:19:10,144 WARNING: Loaded net - current net:
2022-11-06 07:19:10,144 WARNING:   func.classifier.bias
2022-11-06 07:19:10,144 WARNING:   func.classifier.weight
2022-11-06 07:19:10,155 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth.
2022-11-06 07:19:10,186 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:19:10,200 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:19:10,200 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:19:10,200 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:19:10,200 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:19:10,200 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:19:10,200 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:19:10,200 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:19:10,201 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:19:10,202 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:19:10,203 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:19:10,203 INFO: Model [FSLLModel] is created.
2022-11-06 07:19:10,207 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test1_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-06 07:19:11,493 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.5888, Pos_dist: 15.9827, Neg_dist: 22.2187, Acc: 0.9200, PTFixPNLoss: 3.9007, NetFixLoss: 0.0000, ]
2022-11-06 07:19:13,150 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.8414, Pos_dist: 16.0090, Neg_dist: 21.3517, Acc: 0.8800, PTFixPNLoss: 3.8998, NetFixLoss: 2.2387, ]
2022-11-06 07:19:14,782 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.6976, Pos_dist: 15.8887, Neg_dist: 21.1661, Acc: 0.9333, PTFixPNLoss: 3.8932, NetFixLoss: 5.2234, ]
2022-11-06 07:19:16,412 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2753, Pos_dist: 15.9996, Neg_dist: 23.8043, Acc: 0.9467, PTFixPNLoss: 3.8966, NetFixLoss: 8.8329, ]
2022-11-06 07:19:18,047 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3830, Pos_dist: 15.8486, Neg_dist: 24.0007, Acc: 0.9467, PTFixPNLoss: 3.8875, NetFixLoss: 12.7233, ]
2022-11-06 07:19:19,816 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.7870, Pos_dist: 15.6720, Neg_dist: 20.3052, Acc: 0.9333, PTFixPNLoss: 3.8895, NetFixLoss: 16.6909, ]
2022-11-06 07:19:21,562 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.8303, Pos_dist: 15.9175, Neg_dist: 20.5102, Acc: 0.9200, PTFixPNLoss: 3.8963, NetFixLoss: 21.0094, ]
2022-11-06 07:19:23,113 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1393, Pos_dist: 15.3940, Neg_dist: 22.7845, Acc: 0.9867, PTFixPNLoss: 3.8806, NetFixLoss: 25.5980, ]
2022-11-06 07:19:24,781 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4424, Pos_dist: 15.4801, Neg_dist: 21.9774, Acc: 0.9467, PTFixPNLoss: 3.8817, NetFixLoss: 30.3751, ]
2022-11-06 07:19:26,766 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2497, Pos_dist: 15.4224, Neg_dist: 22.1202, Acc: 0.9467, PTFixPNLoss: 3.8751, NetFixLoss: 35.0893, ]
2022-11-06 07:19:26,965 INFO: fine-tune procedure is finished!
2022-11-06 07:19:49,831 INFO: [Test_acc of task 1 on test 2: 0.65717][acc of former classes: 0.75234][acc of former samples in all classes: 0.72498]
[acc of novel samples in all classes: 0.44165]
2022-11-06 07:19:50,206 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:19:50,246 WARNING: Current net - loaded net:
2022-11-06 07:19:50,246 WARNING: Loaded net - current net:
2022-11-06 07:19:50,246 WARNING:   func.classifier.bias
2022-11-06 07:19:50,246 WARNING:   func.classifier.weight
2022-11-06 07:19:50,324 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_1.pth.
2022-11-06 07:19:50,378 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:19:50,393 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:19:50,393 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:19:50,393 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:19:50,394 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:19:50,395 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:19:50,396 INFO: Model [FSLLModel] is created.
2022-11-06 07:19:50,401 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:19:50,405 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_1.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 07:19:52,606 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.4742, Pos_dist: 15.9358, Neg_dist: 22.2108, Acc: 0.8933, PTFixPNLoss: 4.0931, NetFixLoss: 0.0000, ]
2022-11-06 07:19:54,904 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1873, Pos_dist: 15.6866, Neg_dist: 23.9355, Acc: 0.9133, PTFixPNLoss: 4.0890, NetFixLoss: 1.8518, ]
2022-11-06 07:19:57,383 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3786, Pos_dist: 15.6371, Neg_dist: 22.5051, Acc: 0.9133, PTFixPNLoss: 4.0874, NetFixLoss: 3.8554, ]
2022-11-06 07:20:01,324 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.4655, Pos_dist: 15.3500, Neg_dist: 22.7343, Acc: 0.9400, PTFixPNLoss: 4.0834, NetFixLoss: 6.0162, ]
2022-11-06 07:20:03,979 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2875, Pos_dist: 15.7258, Neg_dist: 22.5289, Acc: 0.9067, PTFixPNLoss: 4.0908, NetFixLoss: 8.4332, ]
2022-11-06 07:20:06,008 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4716, Pos_dist: 15.4523, Neg_dist: 21.4504, Acc: 0.9200, PTFixPNLoss: 4.0801, NetFixLoss: 11.0202, ]
2022-11-06 07:20:07,915 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3151, Pos_dist: 15.2824, Neg_dist: 21.6105, Acc: 0.9400, PTFixPNLoss: 4.0823, NetFixLoss: 13.7560, ]
2022-11-06 07:20:10,237 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0447, Pos_dist: 15.6050, Neg_dist: 26.6428, Acc: 0.9067, PTFixPNLoss: 4.0812, NetFixLoss: 16.5771, ]
2022-11-06 07:20:12,658 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2300, Pos_dist: 15.4466, Neg_dist: 22.3529, Acc: 0.9067, PTFixPNLoss: 4.0785, NetFixLoss: 19.3629, ]
2022-11-06 07:20:15,340 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2016, Pos_dist: 15.5702, Neg_dist: 22.6607, Acc: 0.9333, PTFixPNLoss: 4.0849, NetFixLoss: 22.0491, ]
2022-11-06 07:20:15,561 INFO: fine-tune procedure is finished!
2022-11-06 07:20:43,450 INFO: [Test_acc of task 2 on test 2: 0.59419][acc of former classes: 0.74946][acc of former samples in all classes: 0.70338]
[acc of novel samples in all classes: 0.42242]
2022-11-06 07:20:43,990 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:20:44,026 WARNING: Current net - loaded net:
2022-11-06 07:20:44,027 WARNING: Loaded net - current net:
2022-11-06 07:20:44,027 WARNING:   func.classifier.bias
2022-11-06 07:20:44,027 WARNING:   func.classifier.weight
2022-11-06 07:20:44,045 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_2.pth.
2022-11-06 07:20:44,086 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:20:44,110 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:20:44,111 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:20:44,111 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:20:44,111 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:20:44,111 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:20:44,112 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:20:44,113 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:20:44,114 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:20:44,115 INFO: Model [FSLLModel] is created.
2022-11-06 07:20:44,120 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:20:44,124 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:20:44,128 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_2.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-06 07:20:47,104 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1544, Pos_dist: 15.6345, Neg_dist: 24.0427, Acc: 0.9244, PTFixPNLoss: 4.2567, NetFixLoss: 0.0000, ]
2022-11-06 07:20:50,682 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1436, Pos_dist: 15.4202, Neg_dist: 24.1356, Acc: 0.9156, PTFixPNLoss: 4.2593, NetFixLoss: 0.6924, ]
2022-11-06 07:20:54,407 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2623, Pos_dist: 15.6969, Neg_dist: 22.8679, Acc: 0.9156, PTFixPNLoss: 4.2622, NetFixLoss: 1.7074, ]
2022-11-06 07:20:58,754 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3658, Pos_dist: 15.4663, Neg_dist: 21.7660, Acc: 0.9111, PTFixPNLoss: 4.2613, NetFixLoss: 3.1968, ]
2022-11-06 07:21:02,278 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1915, Pos_dist: 15.5004, Neg_dist: 22.9994, Acc: 0.9067, PTFixPNLoss: 4.2577, NetFixLoss: 5.1932, ]
2022-11-06 07:21:05,180 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4485, Pos_dist: 15.6314, Neg_dist: 21.8411, Acc: 0.9111, PTFixPNLoss: 4.2591, NetFixLoss: 7.4323, ]
2022-11-06 07:21:08,509 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2360, Pos_dist: 15.7589, Neg_dist: 23.0784, Acc: 0.8889, PTFixPNLoss: 4.2593, NetFixLoss: 9.8600, ]
2022-11-06 07:21:11,952 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4375, Pos_dist: 15.7279, Neg_dist: 21.6620, Acc: 0.8711, PTFixPNLoss: 4.2575, NetFixLoss: 12.3895, ]
2022-11-06 07:21:15,171 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2924, Pos_dist: 15.4465, Neg_dist: 22.3298, Acc: 0.9333, PTFixPNLoss: 4.2546, NetFixLoss: 15.1014, ]
2022-11-06 07:21:18,628 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2319, Pos_dist: 15.4670, Neg_dist: 23.5933, Acc: 0.9244, PTFixPNLoss: 4.2585, NetFixLoss: 17.9103, ]
2022-11-06 07:21:18,903 INFO: fine-tune procedure is finished!
2022-11-06 07:21:52,064 INFO: [Test_acc of task 3 on test 2: 0.57274][acc of former classes: 0.74370][acc of former samples in all classes: 0.68898]
[acc of novel samples in all classes: 0.45098]
2022-11-06 07:21:52,517 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:21:52,592 WARNING: Current net - loaded net:
2022-11-06 07:21:52,593 WARNING: Loaded net - current net:
2022-11-06 07:21:52,593 WARNING:   func.classifier.bias
2022-11-06 07:21:52,593 WARNING:   func.classifier.weight
2022-11-06 07:21:52,610 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_3.pth.
2022-11-06 07:21:52,655 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:21:52,673 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:21:52,673 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:21:52,673 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:21:52,673 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:21:52,674 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:21:52,674 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:21:52,674 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:21:52,674 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:21:52,674 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:21:52,674 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:21:52,674 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:21:52,674 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:21:52,674 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:21:52,674 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:21:52,674 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:21:52,674 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:21:52,675 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:21:52,676 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:21:52,677 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:21:52,677 INFO: Model [FSLLModel] is created.
2022-11-06 07:21:52,683 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:21:52,687 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:21:52,691 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:21:52,695 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_3.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-06 07:21:57,161 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1812, Pos_dist: 15.4897, Neg_dist: 23.6926, Acc: 0.9033, PTFixPNLoss: 4.3995, NetFixLoss: 0.0000, ]
2022-11-06 07:22:01,238 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1836, Pos_dist: 15.5433, Neg_dist: 22.8398, Acc: 0.9200, PTFixPNLoss: 4.4042, NetFixLoss: 0.9709, ]
2022-11-06 07:22:05,097 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2215, Pos_dist: 15.4879, Neg_dist: 22.6757, Acc: 0.9267, PTFixPNLoss: 4.3998, NetFixLoss: 2.3086, ]
2022-11-06 07:22:09,345 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2672, Pos_dist: 15.4674, Neg_dist: 22.7729, Acc: 0.9133, PTFixPNLoss: 4.3989, NetFixLoss: 3.9072, ]
2022-11-06 07:22:13,595 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1341, Pos_dist: 15.3465, Neg_dist: 24.3649, Acc: 0.9300, PTFixPNLoss: 4.3946, NetFixLoss: 5.7880, ]
2022-11-06 07:22:17,533 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2779, Pos_dist: 15.4540, Neg_dist: 22.7944, Acc: 0.9033, PTFixPNLoss: 4.3997, NetFixLoss: 7.7621, ]
2022-11-06 07:22:21,462 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2632, Pos_dist: 15.3497, Neg_dist: 22.6179, Acc: 0.9267, PTFixPNLoss: 4.3937, NetFixLoss: 9.8024, ]
2022-11-06 07:22:24,947 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2347, Pos_dist: 15.3327, Neg_dist: 22.9763, Acc: 0.9133, PTFixPNLoss: 4.3933, NetFixLoss: 11.9668, ]
2022-11-06 07:22:28,975 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3045, Pos_dist: 15.3197, Neg_dist: 22.2174, Acc: 0.9033, PTFixPNLoss: 4.3952, NetFixLoss: 14.1734, ]
2022-11-06 07:22:32,931 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3811, Pos_dist: 15.3582, Neg_dist: 21.7857, Acc: 0.9067, PTFixPNLoss: 4.4000, NetFixLoss: 16.4036, ]
2022-11-06 07:22:33,200 INFO: fine-tune procedure is finished!
2022-11-06 07:23:10,663 INFO: [Test_acc of task 4 on test 2: 0.55870][acc of former classes: 0.75594][acc of former samples in all classes: 0.68035]
[acc of novel samples in all classes: 0.46237]
2022-11-06 07:23:11,094 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:23:11,133 WARNING: Current net - loaded net:
2022-11-06 07:23:11,134 WARNING: Loaded net - current net:
2022-11-06 07:23:11,134 WARNING:   func.classifier.bias
2022-11-06 07:23:11,134 WARNING:   func.classifier.weight
2022-11-06 07:23:11,153 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_4.pth.
2022-11-06 07:23:11,200 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:23:11,220 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:23:11,220 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:23:11,220 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:23:11,220 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:23:11,221 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:23:11,221 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:23:11,221 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:23:11,221 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:23:11,221 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:23:11,221 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:23:11,221 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:23:11,221 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:23:11,221 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:23:11,221 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:23:11,221 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:23:11,221 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:23:11,222 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:23:11,223 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:23:11,224 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:23:11,224 INFO: Model [FSLLModel] is created.
2022-11-06 07:23:11,230 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:23:11,233 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:23:11,238 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:23:11,241 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:23:11,245 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_4.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
2022-11-06 07:23:16,003 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1438, Pos_dist: 15.6643, Neg_dist: 24.3889, Acc: 0.9067, PTFixPNLoss: 4.5327, NetFixLoss: 0.0000, ]
2022-11-06 07:23:21,413 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1350, Pos_dist: 15.6207, Neg_dist: 24.7695, Acc: 0.9040, PTFixPNLoss: 4.5333, NetFixLoss: 0.8382, ]
2022-11-06 07:23:26,380 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1888, Pos_dist: 15.4898, Neg_dist: 23.9456, Acc: 0.9067, PTFixPNLoss: 4.5299, NetFixLoss: 1.8338, ]
2022-11-06 07:23:31,449 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0720, Pos_dist: 15.5147, Neg_dist: 24.4825, Acc: 0.9173, PTFixPNLoss: 4.5306, NetFixLoss: 3.1307, ]
2022-11-06 07:23:35,836 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3839, Pos_dist: 15.4095, Neg_dist: 22.1798, Acc: 0.9173, PTFixPNLoss: 4.5288, NetFixLoss: 4.4903, ]
2022-11-06 07:23:40,331 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0622, Pos_dist: 15.4185, Neg_dist: 24.7924, Acc: 0.9147, PTFixPNLoss: 4.5312, NetFixLoss: 6.0868, ]
2022-11-06 07:23:44,875 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1293, Pos_dist: 15.3736, Neg_dist: 23.6457, Acc: 0.9120, PTFixPNLoss: 4.5295, NetFixLoss: 7.7711, ]
2022-11-06 07:23:49,575 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1745, Pos_dist: 15.4583, Neg_dist: 23.9280, Acc: 0.9013, PTFixPNLoss: 4.5302, NetFixLoss: 9.4654, ]
2022-11-06 07:23:54,152 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2496, Pos_dist: 15.5885, Neg_dist: 22.9198, Acc: 0.9093, PTFixPNLoss: 4.5309, NetFixLoss: 11.1456, ]
2022-11-06 07:23:58,565 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3752, Pos_dist: 15.3427, Neg_dist: 22.2151, Acc: 0.8827, PTFixPNLoss: 4.5284, NetFixLoss: 12.8011, ]
2022-11-06 07:23:58,707 INFO: fine-tune procedure is finished!
2022-11-06 07:24:39,324 INFO: [Test_acc of task 5 on test 2: 0.51845][acc of former classes: 0.76098][acc of former samples in all classes: 0.68323]
[acc of novel samples in all classes: 0.41389]
2022-11-06 07:24:39,756 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:24:39,798 WARNING: Current net - loaded net:
2022-11-06 07:24:39,798 WARNING: Loaded net - current net:
2022-11-06 07:24:39,798 WARNING:   func.classifier.bias
2022-11-06 07:24:39,798 WARNING:   func.classifier.weight
2022-11-06 07:24:39,818 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_5.pth.
2022-11-06 07:24:39,865 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:24:39,884 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:24:39,884 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:24:39,885 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:24:39,886 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:24:39,887 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:24:39,888 INFO: Model [FSLLModel] is created.
2022-11-06 07:24:39,893 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:24:39,897 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:24:39,900 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:24:39,904 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:24:39,908 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:24:39,912 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_5.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-06 07:24:45,004 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2752, Pos_dist: 15.3663, Neg_dist: 22.4108, Acc: 0.8911, PTFixPNLoss: 4.6446, NetFixLoss: 0.0000, ]
2022-11-06 07:24:50,494 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0721, Pos_dist: 15.5614, Neg_dist: 25.9215, Acc: 0.8822, PTFixPNLoss: 4.6514, NetFixLoss: 1.2563, ]
2022-11-06 07:24:56,090 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1953, Pos_dist: 15.4937, Neg_dist: 23.4351, Acc: 0.8756, PTFixPNLoss: 4.6518, NetFixLoss: 2.4762, ]
2022-11-06 07:25:02,047 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0761, Pos_dist: 15.4881, Neg_dist: 25.3526, Acc: 0.9156, PTFixPNLoss: 4.6428, NetFixLoss: 3.8685, ]
2022-11-06 07:25:07,444 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3972, Pos_dist: 15.3449, Neg_dist: 21.8081, Acc: 0.8933, PTFixPNLoss: 4.6444, NetFixLoss: 5.3396, ]
2022-11-06 07:25:12,988 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3536, Pos_dist: 15.4790, Neg_dist: 22.1703, Acc: 0.8867, PTFixPNLoss: 4.6469, NetFixLoss: 6.9661, ]
2022-11-06 07:25:17,653 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1515, Pos_dist: 15.1939, Neg_dist: 23.0758, Acc: 0.9089, PTFixPNLoss: 4.6397, NetFixLoss: 8.8986, ]
2022-11-06 07:25:23,292 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1775, Pos_dist: 15.2296, Neg_dist: 22.9902, Acc: 0.9044, PTFixPNLoss: 4.6444, NetFixLoss: 11.0159, ]
2022-11-06 07:25:29,172 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3487, Pos_dist: 15.4705, Neg_dist: 21.6360, Acc: 0.8844, PTFixPNLoss: 4.6469, NetFixLoss: 13.1534, ]
2022-11-06 07:25:34,548 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.5341, Pos_dist: 15.5316, Neg_dist: 21.5939, Acc: 0.9133, PTFixPNLoss: 4.6472, NetFixLoss: 15.3338, ]
2022-11-06 07:25:34,677 INFO: fine-tune procedure is finished!
2022-11-06 07:26:20,829 INFO: [Test_acc of task 6 on test 2: 0.47964][acc of former classes: 0.76170][acc of former samples in all classes: 0.65371]
[acc of novel samples in all classes: 0.38803]
2022-11-06 07:26:21,252 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:26:21,289 WARNING: Current net - loaded net:
2022-11-06 07:26:21,289 WARNING: Loaded net - current net:
2022-11-06 07:26:21,289 WARNING:   func.classifier.bias
2022-11-06 07:26:21,289 WARNING:   func.classifier.weight
2022-11-06 07:26:21,309 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_6.pth.
2022-11-06 07:26:21,354 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:26:21,378 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:26:21,378 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:26:21,378 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:26:21,379 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:26:21,379 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:26:21,379 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:26:21,379 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:26:21,379 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:26:21,379 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:26:21,379 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:26:21,379 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:26:21,379 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:26:21,380 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:26:21,381 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:26:21,381 INFO: Model [FSLLModel] is created.
2022-11-06 07:26:21,385 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:26:21,388 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:26:21,391 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:26:21,393 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:26:21,396 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:26:21,399 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:26:21,401 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_6.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
2022-11-06 07:26:27,141 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1141, Pos_dist: 15.5662, Neg_dist: 24.3024, Acc: 0.8705, PTFixPNLoss: 4.7532, NetFixLoss: 0.0000, ]
2022-11-06 07:26:33,001 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1883, Pos_dist: 15.3829, Neg_dist: 23.1892, Acc: 0.9067, PTFixPNLoss: 4.7489, NetFixLoss: 0.6406, ]
2022-11-06 07:26:39,289 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1436, Pos_dist: 15.7425, Neg_dist: 25.0206, Acc: 0.8724, PTFixPNLoss: 4.7574, NetFixLoss: 1.6973, ]
2022-11-06 07:26:45,902 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3971, Pos_dist: 15.5732, Neg_dist: 21.9659, Acc: 0.8724, PTFixPNLoss: 4.7522, NetFixLoss: 2.9352, ]
2022-11-06 07:26:51,822 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2727, Pos_dist: 15.5402, Neg_dist: 23.5461, Acc: 0.8781, PTFixPNLoss: 4.7531, NetFixLoss: 4.5530, ]
2022-11-06 07:26:58,032 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3351, Pos_dist: 15.4837, Neg_dist: 22.1536, Acc: 0.8743, PTFixPNLoss: 4.7508, NetFixLoss: 6.4605, ]
2022-11-06 07:27:04,410 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1963, Pos_dist: 15.3954, Neg_dist: 23.7641, Acc: 0.8610, PTFixPNLoss: 4.7499, NetFixLoss: 8.4991, ]
2022-11-06 07:27:10,274 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1763, Pos_dist: 15.3796, Neg_dist: 23.3499, Acc: 0.8781, PTFixPNLoss: 4.7488, NetFixLoss: 10.5944, ]
2022-11-06 07:27:15,156 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2662, Pos_dist: 15.3702, Neg_dist: 22.5112, Acc: 0.8838, PTFixPNLoss: 4.7462, NetFixLoss: 12.6870, ]
2022-11-06 07:27:21,640 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2855, Pos_dist: 15.4405, Neg_dist: 22.7105, Acc: 0.8819, PTFixPNLoss: 4.7472, NetFixLoss: 14.7932, ]
2022-11-06 07:27:21,866 INFO: fine-tune procedure is finished!
2022-11-06 07:28:11,874 INFO: [Test_acc of task 7 on test 2: 0.46104][acc of former classes: 0.75666][acc of former samples in all classes: 0.62347]
[acc of novel samples in all classes: 0.38772]
2022-11-06 07:28:12,326 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:28:12,369 WARNING: Current net - loaded net:
2022-11-06 07:28:12,369 WARNING: Loaded net - current net:
2022-11-06 07:28:12,369 WARNING:   func.classifier.bias
2022-11-06 07:28:12,369 WARNING:   func.classifier.weight
2022-11-06 07:28:12,387 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_7.pth.
2022-11-06 07:28:12,434 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:28:12,454 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:28:12,454 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:28:12,455 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:28:12,456 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:28:12,457 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:28:12,458 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:28:12,458 INFO: Model [FSLLModel] is created.
2022-11-06 07:28:12,463 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:28:12,467 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:28:12,471 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:28:12,476 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:28:12,480 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:28:12,484 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:28:12,488 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:28:12,491 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_7.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-06 07:28:18,991 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1263, Pos_dist: 15.1601, Neg_dist: 23.6383, Acc: 0.8683, PTFixPNLoss: 4.8390, NetFixLoss: 0.0000, ]
2022-11-06 07:28:25,582 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2951, Pos_dist: 15.3127, Neg_dist: 23.1808, Acc: 0.8717, PTFixPNLoss: 4.8402, NetFixLoss: 0.7962, ]
2022-11-06 07:28:32,596 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1095, Pos_dist: 15.1756, Neg_dist: 24.3924, Acc: 0.8867, PTFixPNLoss: 4.8399, NetFixLoss: 1.9719, ]
2022-11-06 07:28:39,156 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1283, Pos_dist: 15.4285, Neg_dist: 24.4939, Acc: 0.8717, PTFixPNLoss: 4.8424, NetFixLoss: 3.2365, ]
2022-11-06 07:28:45,863 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2811, Pos_dist: 15.2092, Neg_dist: 22.3451, Acc: 0.8683, PTFixPNLoss: 4.8408, NetFixLoss: 4.5862, ]
2022-11-06 07:28:52,564 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2282, Pos_dist: 15.3689, Neg_dist: 22.8034, Acc: 0.8733, PTFixPNLoss: 4.8416, NetFixLoss: 6.0861, ]
2022-11-06 07:28:59,163 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2047, Pos_dist: 15.2573, Neg_dist: 23.0490, Acc: 0.8783, PTFixPNLoss: 4.8388, NetFixLoss: 7.7281, ]
2022-11-06 07:29:05,848 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2262, Pos_dist: 15.2285, Neg_dist: 22.6263, Acc: 0.8933, PTFixPNLoss: 4.8378, NetFixLoss: 9.4628, ]
2022-11-06 07:29:12,463 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3579, Pos_dist: 15.2703, Neg_dist: 22.4814, Acc: 0.8867, PTFixPNLoss: 4.8403, NetFixLoss: 11.2922, ]
2022-11-06 07:29:19,549 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1493, Pos_dist: 15.3030, Neg_dist: 23.5932, Acc: 0.8700, PTFixPNLoss: 4.8375, NetFixLoss: 13.2029, ]
2022-11-06 07:29:19,739 INFO: fine-tune procedure is finished!
2022-11-06 07:30:14,967 INFO: [Test_acc of task 8 on test 2: 0.45469][acc of former classes: 0.75810][acc of former samples in all classes: 0.61843]
[acc of novel samples in all classes: 0.39012]
2022-11-06 07:30:15,384 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:30:15,414 WARNING: Current net - loaded net:
2022-11-06 07:30:15,414 WARNING: Loaded net - current net:
2022-11-06 07:30:15,414 WARNING:   func.classifier.bias
2022-11-06 07:30:15,414 WARNING:   func.classifier.weight
2022-11-06 07:30:15,429 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_8.pth.
2022-11-06 07:30:15,465 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:30:15,490 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:30:15,490 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:30:15,490 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:30:15,490 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:30:15,490 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:30:15,490 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:30:15,490 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:30:15,491 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:30:15,491 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:30:15,491 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:30:15,491 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:30:15,491 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:30:15,492 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:30:15,493 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:30:15,494 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:30:15,494 INFO: Model [FSLLModel] is created.
2022-11-06 07:30:15,499 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,503 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,508 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,512 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,516 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,520 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,524 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,528 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:30:15,532 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_8.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
2022-11-06 07:30:22,903 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2729, Pos_dist: 15.2487, Neg_dist: 22.3070, Acc: 0.8785, PTFixPNLoss: 4.9279, NetFixLoss: 0.0000, ]
2022-11-06 07:30:30,716 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4216, Pos_dist: 15.2608, Neg_dist: 21.6185, Acc: 0.8770, PTFixPNLoss: 4.9262, NetFixLoss: 1.0385, ]
2022-11-06 07:30:38,524 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1070, Pos_dist: 15.3304, Neg_dist: 24.3859, Acc: 0.8830, PTFixPNLoss: 4.9312, NetFixLoss: 2.6442, ]
2022-11-06 07:30:46,550 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2890, Pos_dist: 15.3552, Neg_dist: 22.5837, Acc: 0.8637, PTFixPNLoss: 4.9306, NetFixLoss: 4.4041, ]
2022-11-06 07:30:53,160 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1709, Pos_dist: 15.2115, Neg_dist: 23.0909, Acc: 0.8696, PTFixPNLoss: 4.9243, NetFixLoss: 6.2978, ]
2022-11-06 07:31:01,257 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2793, Pos_dist: 15.3272, Neg_dist: 22.0472, Acc: 0.8563, PTFixPNLoss: 4.9303, NetFixLoss: 8.2802, ]
2022-11-06 07:31:08,875 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2619, Pos_dist: 15.2908, Neg_dist: 22.6250, Acc: 0.8696, PTFixPNLoss: 4.9292, NetFixLoss: 10.4448, ]
2022-11-06 07:31:16,328 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2199, Pos_dist: 15.1226, Neg_dist: 23.3337, Acc: 0.8681, PTFixPNLoss: 4.9262, NetFixLoss: 12.6610, ]
2022-11-06 07:31:23,832 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3467, Pos_dist: 15.2591, Neg_dist: 22.2982, Acc: 0.8607, PTFixPNLoss: 4.9285, NetFixLoss: 14.8479, ]
2022-11-06 07:31:31,777 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2361, Pos_dist: 15.2689, Neg_dist: 22.5619, Acc: 0.8459, PTFixPNLoss: 4.9289, NetFixLoss: 17.0418, ]
2022-11-06 07:31:31,978 INFO: fine-tune procedure is finished!
2022-11-06 07:32:31,940 INFO: [Test_acc of task 9 on test 2: 0.43697][acc of former classes: 0.75738][acc of former samples in all classes: 0.60619]
[acc of novel samples in all classes: 0.37771]
2022-11-06 07:32:32,286 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:32:32,314 WARNING: Current net - loaded net:
2022-11-06 07:32:32,314 WARNING: Loaded net - current net:
2022-11-06 07:32:32,314 WARNING:   func.classifier.bias
2022-11-06 07:32:32,314 WARNING:   func.classifier.weight
2022-11-06 07:32:32,335 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_9.pth.
2022-11-06 07:32:32,373 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:32:32,394 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:32:32,395 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:32:32,395 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:32:32,396 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:32:32,397 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:32:32,398 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:32:32,398 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:32:32,398 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:32:32,398 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:32:32,398 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:32:32,398 INFO: Model [FSLLModel] is created.
2022-11-06 07:32:32,403 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,407 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,411 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,415 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,418 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,422 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,426 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,430 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,434 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:32:32,438 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_9.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-06 07:32:40,591 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2995, Pos_dist: 15.1731, Neg_dist: 21.7216, Acc: 0.8667, PTFixPNLoss: 5.0041, NetFixLoss: 0.0000, ]
2022-11-06 07:32:48,628 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0544, Pos_dist: 15.1851, Neg_dist: 25.7638, Acc: 0.8667, PTFixPNLoss: 5.0059, NetFixLoss: 1.2202, ]
2022-11-06 07:32:57,068 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1283, Pos_dist: 15.1797, Neg_dist: 23.9321, Acc: 0.8893, PTFixPNLoss: 5.0045, NetFixLoss: 2.3967, ]
2022-11-06 07:33:05,818 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0287, Pos_dist: 15.2380, Neg_dist: 27.0993, Acc: 0.8627, PTFixPNLoss: 5.0065, NetFixLoss: 3.6137, ]
2022-11-06 07:33:13,839 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2445, Pos_dist: 15.2410, Neg_dist: 22.2519, Acc: 0.8720, PTFixPNLoss: 5.0072, NetFixLoss: 4.8165, ]
2022-11-06 07:33:21,112 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4578, Pos_dist: 15.1835, Neg_dist: 21.6013, Acc: 0.8760, PTFixPNLoss: 5.0012, NetFixLoss: 6.1430, ]
2022-11-06 07:33:28,851 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0982, Pos_dist: 15.1865, Neg_dist: 25.0854, Acc: 0.8653, PTFixPNLoss: 5.0066, NetFixLoss: 7.6948, ]
2022-11-06 07:33:37,170 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1311, Pos_dist: 15.2136, Neg_dist: 23.5290, Acc: 0.8680, PTFixPNLoss: 5.0049, NetFixLoss: 9.3451, ]
2022-11-06 07:33:44,780 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1606, Pos_dist: 15.1312, Neg_dist: 22.9539, Acc: 0.8720, PTFixPNLoss: 5.0036, NetFixLoss: 10.9845, ]
2022-11-06 07:33:52,525 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4867, Pos_dist: 15.1815, Neg_dist: 20.9547, Acc: 0.8827, PTFixPNLoss: 5.0042, NetFixLoss: 12.6279, ]
2022-11-06 07:33:52,644 INFO: fine-tune procedure is finished!
2022-11-06 07:34:54,042 INFO: [Test_acc of task 10 on test 2: 0.42561][acc of former classes: 0.75666][acc of former samples in all classes: 0.59179]
[acc of novel samples in all classes: 0.37321]
2022-11-06 07:34:54,440 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:34:54,469 WARNING: Current net - loaded net:
2022-11-06 07:34:54,469 WARNING: Loaded net - current net:
2022-11-06 07:34:54,469 WARNING:   func.classifier.bias
2022-11-06 07:34:54,469 WARNING:   func.classifier.weight
2022-11-06 07:34:54,482 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth.
2022-11-06 07:34:54,520 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:34:54,536 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:34:54,537 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:34:54,537 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:34:54,538 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:34:54,539 INFO: Model [FSLLModel] is created.
2022-11-06 07:34:54,543 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test2_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-06 07:34:55,638 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.8312, Pos_dist: 15.9075, Neg_dist: 21.7378, Acc: 0.9333, PTFixPNLoss: 3.8830, NetFixLoss: 0.0000, ]
2022-11-06 07:34:57,058 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.7274, Pos_dist: 15.7669, Neg_dist: 21.6547, Acc: 0.9467, PTFixPNLoss: 3.8802, NetFixLoss: 2.6296, ]
2022-11-06 07:34:58,490 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3330, Pos_dist: 15.8277, Neg_dist: 22.4708, Acc: 0.9067, PTFixPNLoss: 3.8877, NetFixLoss: 6.1241, ]
2022-11-06 07:34:59,955 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1798, Pos_dist: 15.5505, Neg_dist: 23.3940, Acc: 0.9333, PTFixPNLoss: 3.8800, NetFixLoss: 10.0771, ]
2022-11-06 07:35:01,378 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.6968, Pos_dist: 15.8855, Neg_dist: 21.3799, Acc: 0.9467, PTFixPNLoss: 3.8831, NetFixLoss: 14.0589, ]
2022-11-06 07:35:02,826 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.6800, Pos_dist: 15.5796, Neg_dist: 21.0544, Acc: 0.9467, PTFixPNLoss: 3.8841, NetFixLoss: 18.2620, ]
2022-11-06 07:35:04,423 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0567, Pos_dist: 15.5271, Neg_dist: 25.9309, Acc: 0.9600, PTFixPNLoss: 3.8806, NetFixLoss: 22.6344, ]
2022-11-06 07:35:05,817 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4149, Pos_dist: 15.5371, Neg_dist: 22.8747, Acc: 0.9733, PTFixPNLoss: 3.8808, NetFixLoss: 26.9131, ]
2022-11-06 07:35:07,128 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4948, Pos_dist: 15.2998, Neg_dist: 21.2224, Acc: 0.9733, PTFixPNLoss: 3.8701, NetFixLoss: 31.0812, ]
2022-11-06 07:35:08,547 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4505, Pos_dist: 15.4869, Neg_dist: 22.6165, Acc: 0.9733, PTFixPNLoss: 3.8686, NetFixLoss: 35.0904, ]
2022-11-06 07:35:08,699 INFO: fine-tune procedure is finished!
2022-11-06 07:35:29,943 INFO: [Test_acc of task 1 on test 3: 0.64951][acc of former classes: 0.74442][acc of former samples in all classes: 0.71562]
[acc of novel samples in all classes: 0.43936]
2022-11-06 07:35:30,225 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:35:30,254 WARNING: Current net - loaded net:
2022-11-06 07:35:30,255 WARNING: Loaded net - current net:
2022-11-06 07:35:30,255 WARNING:   func.classifier.bias
2022-11-06 07:35:30,255 WARNING:   func.classifier.weight
2022-11-06 07:35:30,263 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_1.pth.
2022-11-06 07:35:30,301 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:35:30,314 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:35:30,315 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:35:30,315 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:35:30,315 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:35:30,316 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:35:30,317 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:35:30,317 INFO: Model [FSLLModel] is created.
2022-11-06 07:35:30,321 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:35:30,323 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_1.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 07:35:31,730 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2069, Pos_dist: 15.8408, Neg_dist: 24.7030, Acc: 0.9333, PTFixPNLoss: 4.0838, NetFixLoss: 0.0000, ]
2022-11-06 07:35:33,466 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2538, Pos_dist: 15.8461, Neg_dist: 23.1397, Acc: 0.9000, PTFixPNLoss: 4.0916, NetFixLoss: 1.1843, ]
2022-11-06 07:35:35,235 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2255, Pos_dist: 15.9069, Neg_dist: 24.1329, Acc: 0.8933, PTFixPNLoss: 4.0853, NetFixLoss: 2.7457, ]
2022-11-06 07:35:36,977 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3197, Pos_dist: 15.9347, Neg_dist: 23.8120, Acc: 0.8933, PTFixPNLoss: 4.0853, NetFixLoss: 4.5827, ]
2022-11-06 07:35:38,879 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1608, Pos_dist: 15.6756, Neg_dist: 23.7826, Acc: 0.9267, PTFixPNLoss: 4.0826, NetFixLoss: 6.7027, ]
2022-11-06 07:35:40,545 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4194, Pos_dist: 15.5288, Neg_dist: 22.0916, Acc: 0.9333, PTFixPNLoss: 4.0824, NetFixLoss: 8.9122, ]
2022-11-06 07:35:42,323 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3032, Pos_dist: 15.3737, Neg_dist: 21.9970, Acc: 0.9133, PTFixPNLoss: 4.0774, NetFixLoss: 11.2684, ]
2022-11-06 07:35:44,087 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1547, Pos_dist: 15.5327, Neg_dist: 24.2964, Acc: 0.9533, PTFixPNLoss: 4.0780, NetFixLoss: 13.9026, ]
2022-11-06 07:35:45,787 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0962, Pos_dist: 15.4690, Neg_dist: 24.7098, Acc: 0.9333, PTFixPNLoss: 4.0772, NetFixLoss: 16.6270, ]
2022-11-06 07:35:47,530 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2371, Pos_dist: 15.6012, Neg_dist: 22.9764, Acc: 0.9400, PTFixPNLoss: 4.0825, NetFixLoss: 19.3192, ]
2022-11-06 07:35:47,678 INFO: fine-tune procedure is finished!
2022-11-06 07:36:12,942 INFO: [Test_acc of task 2 on test 3: 0.60167][acc of former classes: 0.74514][acc of former samples in all classes: 0.69042]
[acc of novel samples in all classes: 0.46206]
2022-11-06 07:36:13,394 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:36:13,432 WARNING: Current net - loaded net:
2022-11-06 07:36:13,433 WARNING: Loaded net - current net:
2022-11-06 07:36:13,433 WARNING:   func.classifier.bias
2022-11-06 07:36:13,433 WARNING:   func.classifier.weight
2022-11-06 07:36:13,443 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_2.pth.
2022-11-06 07:36:13,482 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:36:13,501 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:36:13,501 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:36:13,501 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:36:13,501 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:36:13,501 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:36:13,502 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:36:13,502 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:36:13,502 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:36:13,502 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:36:13,502 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:36:13,502 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:36:13,502 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:36:13,502 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:36:13,502 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:36:13,502 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:36:13,502 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:36:13,502 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:36:13,503 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:36:13,504 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:36:13,505 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:36:13,506 INFO: Model [FSLLModel] is created.
2022-11-06 07:36:13,511 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:36:13,515 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:36:13,519 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_2.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-06 07:36:15,792 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0466, Pos_dist: 15.4660, Neg_dist: 25.1714, Acc: 0.9378, PTFixPNLoss: 4.2594, NetFixLoss: 0.0000, ]
2022-11-06 07:36:18,352 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1935, Pos_dist: 15.4950, Neg_dist: 23.8877, Acc: 0.9333, PTFixPNLoss: 4.2586, NetFixLoss: 0.3907, ]
2022-11-06 07:36:20,768 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2583, Pos_dist: 15.6450, Neg_dist: 23.1237, Acc: 0.9156, PTFixPNLoss: 4.2542, NetFixLoss: 1.4325, ]
2022-11-06 07:36:23,332 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.4386, Pos_dist: 15.3795, Neg_dist: 21.4007, Acc: 0.9289, PTFixPNLoss: 4.2538, NetFixLoss: 2.8800, ]
2022-11-06 07:36:25,995 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4109, Pos_dist: 15.5535, Neg_dist: 21.8898, Acc: 0.9022, PTFixPNLoss: 4.2578, NetFixLoss: 4.6830, ]
2022-11-06 07:36:28,782 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2684, Pos_dist: 15.5093, Neg_dist: 22.4199, Acc: 0.9022, PTFixPNLoss: 4.2576, NetFixLoss: 6.8538, ]
2022-11-06 07:36:31,168 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2924, Pos_dist: 15.5061, Neg_dist: 22.4913, Acc: 0.9067, PTFixPNLoss: 4.2603, NetFixLoss: 9.3105, ]
2022-11-06 07:36:33,600 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1910, Pos_dist: 15.5088, Neg_dist: 22.5374, Acc: 0.9378, PTFixPNLoss: 4.2566, NetFixLoss: 11.8057, ]
2022-11-06 07:36:36,117 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1271, Pos_dist: 15.4648, Neg_dist: 24.4594, Acc: 0.9244, PTFixPNLoss: 4.2535, NetFixLoss: 14.3161, ]
2022-11-06 07:36:38,593 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1778, Pos_dist: 15.5866, Neg_dist: 23.4045, Acc: 0.9200, PTFixPNLoss: 4.2544, NetFixLoss: 16.7643, ]
2022-11-06 07:36:38,701 INFO: fine-tune procedure is finished!
2022-11-06 07:37:09,396 INFO: [Test_acc of task 3 on test 3: 0.57864][acc of former classes: 0.73578][acc of former samples in all classes: 0.66739]
[acc of novel samples in all classes: 0.48567]
2022-11-06 07:37:09,994 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:37:10,023 WARNING: Current net - loaded net:
2022-11-06 07:37:10,023 WARNING: Loaded net - current net:
2022-11-06 07:37:10,023 WARNING:   func.classifier.bias
2022-11-06 07:37:10,023 WARNING:   func.classifier.weight
2022-11-06 07:37:10,032 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_3.pth.
2022-11-06 07:37:10,059 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:37:10,072 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:37:10,072 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:37:10,072 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:37:10,073 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:37:10,074 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:37:10,074 INFO: Model [FSLLModel] is created.
2022-11-06 07:37:10,077 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:37:10,080 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:37:10,082 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:37:10,085 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_3.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-06 07:37:13,017 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2766, Pos_dist: 15.5893, Neg_dist: 22.8333, Acc: 0.8967, PTFixPNLoss: 4.3987, NetFixLoss: 0.0000, ]
2022-11-06 07:37:16,252 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3309, Pos_dist: 15.4328, Neg_dist: 21.8996, Acc: 0.9267, PTFixPNLoss: 4.3968, NetFixLoss: 1.1800, ]
2022-11-06 07:37:19,295 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2034, Pos_dist: 15.3438, Neg_dist: 22.6452, Acc: 0.8900, PTFixPNLoss: 4.3912, NetFixLoss: 2.7681, ]
2022-11-06 07:37:22,217 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2346, Pos_dist: 15.4206, Neg_dist: 23.3149, Acc: 0.8967, PTFixPNLoss: 4.3923, NetFixLoss: 4.5392, ]
2022-11-06 07:37:25,597 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0759, Pos_dist: 15.3722, Neg_dist: 24.7285, Acc: 0.8900, PTFixPNLoss: 4.3956, NetFixLoss: 6.4311, ]
2022-11-06 07:37:28,787 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2583, Pos_dist: 15.3819, Neg_dist: 21.8800, Acc: 0.8967, PTFixPNLoss: 4.3972, NetFixLoss: 8.3396, ]
2022-11-06 07:37:31,820 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1424, Pos_dist: 15.3870, Neg_dist: 22.9882, Acc: 0.9033, PTFixPNLoss: 4.3965, NetFixLoss: 10.2486, ]
2022-11-06 07:37:34,790 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2030, Pos_dist: 15.1591, Neg_dist: 22.9864, Acc: 0.9133, PTFixPNLoss: 4.3933, NetFixLoss: 12.2895, ]
2022-11-06 07:37:37,480 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3852, Pos_dist: 15.3554, Neg_dist: 21.7899, Acc: 0.9033, PTFixPNLoss: 4.3970, NetFixLoss: 14.2914, ]
2022-11-06 07:37:40,582 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1169, Pos_dist: 15.2485, Neg_dist: 25.3943, Acc: 0.9333, PTFixPNLoss: 4.3925, NetFixLoss: 16.3237, ]
2022-11-06 07:37:40,698 INFO: fine-tune procedure is finished!
2022-11-06 07:38:13,604 INFO: [Test_acc of task 4 on test 3: 0.55838][acc of former classes: 0.75018][acc of former samples in all classes: 0.65875]
[acc of novel samples in all classes: 0.47891]
2022-11-06 07:38:13,958 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:38:13,986 WARNING: Current net - loaded net:
2022-11-06 07:38:13,986 WARNING: Loaded net - current net:
2022-11-06 07:38:13,986 WARNING:   func.classifier.bias
2022-11-06 07:38:13,986 WARNING:   func.classifier.weight
2022-11-06 07:38:13,998 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_4.pth.
2022-11-06 07:38:14,042 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:38:14,054 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:38:14,054 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:38:14,054 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:38:14,054 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:38:14,054 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:38:14,055 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:38:14,055 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:38:14,055 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:38:14,055 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:38:14,055 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:38:14,055 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:38:14,055 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:38:14,056 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:38:14,057 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:38:14,057 INFO: Model [FSLLModel] is created.
2022-11-06 07:38:14,060 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:38:14,063 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:38:14,065 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:38:14,068 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:38:14,070 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_4.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
2022-11-06 07:38:17,569 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1884, Pos_dist: 15.3075, Neg_dist: 23.3383, Acc: 0.9120, PTFixPNLoss: 4.5248, NetFixLoss: 0.0000, ]
2022-11-06 07:38:21,278 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2466, Pos_dist: 15.5006, Neg_dist: 22.9278, Acc: 0.8800, PTFixPNLoss: 4.5266, NetFixLoss: 0.9356, ]
2022-11-06 07:38:24,802 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2519, Pos_dist: 15.4074, Neg_dist: 22.4736, Acc: 0.8907, PTFixPNLoss: 4.5244, NetFixLoss: 2.2261, ]
2022-11-06 07:38:28,416 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1239, Pos_dist: 15.4731, Neg_dist: 23.7684, Acc: 0.8853, PTFixPNLoss: 4.5250, NetFixLoss: 3.8671, ]
2022-11-06 07:38:32,130 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2149, Pos_dist: 15.4151, Neg_dist: 23.2691, Acc: 0.9013, PTFixPNLoss: 4.5289, NetFixLoss: 5.6102, ]
2022-11-06 07:38:35,717 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1515, Pos_dist: 15.3905, Neg_dist: 24.5313, Acc: 0.9040, PTFixPNLoss: 4.5211, NetFixLoss: 7.4307, ]
2022-11-06 07:38:39,091 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1559, Pos_dist: 15.2921, Neg_dist: 23.3262, Acc: 0.9147, PTFixPNLoss: 4.5255, NetFixLoss: 9.2457, ]
2022-11-06 07:38:42,527 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2664, Pos_dist: 15.3748, Neg_dist: 22.4950, Acc: 0.8907, PTFixPNLoss: 4.5258, NetFixLoss: 11.0224, ]
2022-11-06 07:38:46,163 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1560, Pos_dist: 15.2434, Neg_dist: 23.7553, Acc: 0.8880, PTFixPNLoss: 4.5218, NetFixLoss: 12.7868, ]
2022-11-06 07:38:49,725 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1805, Pos_dist: 15.2918, Neg_dist: 22.7805, Acc: 0.9200, PTFixPNLoss: 4.5229, NetFixLoss: 14.5414, ]
2022-11-06 07:38:49,853 INFO: fine-tune procedure is finished!
2022-11-06 07:39:27,126 INFO: [Test_acc of task 5 on test 3: 0.51286][acc of former classes: 0.76530][acc of former samples in all classes: 0.65659]
[acc of novel samples in all classes: 0.42165]
2022-11-06 07:39:27,551 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:39:27,579 WARNING: Current net - loaded net:
2022-11-06 07:39:27,579 WARNING: Loaded net - current net:
2022-11-06 07:39:27,579 WARNING:   func.classifier.bias
2022-11-06 07:39:27,580 WARNING:   func.classifier.weight
2022-11-06 07:39:27,588 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_5.pth.
2022-11-06 07:39:27,639 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:39:27,658 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:39:27,659 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:39:27,659 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:39:27,660 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:39:27,661 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:39:27,662 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:39:27,662 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:39:27,662 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:39:27,662 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:39:27,662 INFO: Model [FSLLModel] is created.
2022-11-06 07:39:27,667 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:39:27,671 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:39:27,675 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:39:27,679 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:39:27,682 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:39:27,686 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_5.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-06 07:39:31,479 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1209, Pos_dist: 15.1857, Neg_dist: 23.7642, Acc: 0.9044, PTFixPNLoss: 4.6380, NetFixLoss: 0.0000, ]
2022-11-06 07:39:35,359 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3091, Pos_dist: 15.3495, Neg_dist: 22.5121, Acc: 0.8956, PTFixPNLoss: 4.6442, NetFixLoss: 0.6522, ]
2022-11-06 07:39:39,427 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3240, Pos_dist: 15.4479, Neg_dist: 22.7852, Acc: 0.8867, PTFixPNLoss: 4.6445, NetFixLoss: 1.9234, ]
2022-11-06 07:39:43,705 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1962, Pos_dist: 15.2527, Neg_dist: 23.1143, Acc: 0.9044, PTFixPNLoss: 4.6397, NetFixLoss: 3.6624, ]
2022-11-06 07:39:47,756 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0803, Pos_dist: 15.4049, Neg_dist: 24.7878, Acc: 0.8756, PTFixPNLoss: 4.6458, NetFixLoss: 5.5733, ]
2022-11-06 07:39:52,059 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3409, Pos_dist: 15.1955, Neg_dist: 22.9705, Acc: 0.8978, PTFixPNLoss: 4.6375, NetFixLoss: 7.4861, ]
2022-11-06 07:39:56,348 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3684, Pos_dist: 15.2370, Neg_dist: 22.7384, Acc: 0.9000, PTFixPNLoss: 4.6417, NetFixLoss: 9.3806, ]
2022-11-06 07:40:00,713 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3676, Pos_dist: 15.2756, Neg_dist: 22.0964, Acc: 0.8889, PTFixPNLoss: 4.6430, NetFixLoss: 11.3137, ]
2022-11-06 07:40:04,725 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2572, Pos_dist: 15.2551, Neg_dist: 22.5474, Acc: 0.8822, PTFixPNLoss: 4.6421, NetFixLoss: 13.4111, ]
2022-11-06 07:40:08,693 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0971, Pos_dist: 15.1913, Neg_dist: 23.5267, Acc: 0.9022, PTFixPNLoss: 4.6343, NetFixLoss: 15.5482, ]
2022-11-06 07:40:08,834 INFO: fine-tune procedure is finished!
2022-11-06 07:40:49,662 INFO: [Test_acc of task 6 on test 3: 0.48610][acc of former classes: 0.76026][acc of former samples in all classes: 0.63571]
[acc of novel samples in all classes: 0.40735]
2022-11-06 07:40:50,110 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:40:50,140 WARNING: Current net - loaded net:
2022-11-06 07:40:50,140 WARNING: Loaded net - current net:
2022-11-06 07:40:50,140 WARNING:   func.classifier.bias
2022-11-06 07:40:50,140 WARNING:   func.classifier.weight
2022-11-06 07:40:50,150 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_6.pth.
2022-11-06 07:40:50,188 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:40:50,206 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:40:50,206 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:40:50,206 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:40:50,206 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:40:50,207 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:40:50,208 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:40:50,209 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:40:50,210 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:40:50,210 INFO: Model [FSLLModel] is created.
2022-11-06 07:40:50,215 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:40:50,219 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:40:50,222 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:40:50,226 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:40:50,230 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:40:50,234 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:40:50,238 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_6.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
2022-11-06 07:40:54,558 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1608, Pos_dist: 15.3257, Neg_dist: 23.0327, Acc: 0.8762, PTFixPNLoss: 4.7441, NetFixLoss: 0.0000, ]
2022-11-06 07:40:59,594 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0856, Pos_dist: 15.2418, Neg_dist: 24.5598, Acc: 0.8800, PTFixPNLoss: 4.7407, NetFixLoss: 0.8999, ]
2022-11-06 07:41:04,180 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4531, Pos_dist: 15.3828, Neg_dist: 21.4876, Acc: 0.8743, PTFixPNLoss: 4.7451, NetFixLoss: 1.8662, ]
2022-11-06 07:41:08,335 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0760, Pos_dist: 15.2165, Neg_dist: 25.2376, Acc: 0.8990, PTFixPNLoss: 4.7418, NetFixLoss: 3.3007, ]
2022-11-06 07:41:12,787 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0269, Pos_dist: 15.3317, Neg_dist: 27.9289, Acc: 0.8895, PTFixPNLoss: 4.7450, NetFixLoss: 4.8738, ]
2022-11-06 07:41:18,024 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2564, Pos_dist: 15.4071, Neg_dist: 23.3534, Acc: 0.8933, PTFixPNLoss: 4.7462, NetFixLoss: 6.3753, ]
2022-11-06 07:41:23,309 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1006, Pos_dist: 15.2370, Neg_dist: 24.4679, Acc: 0.8724, PTFixPNLoss: 4.7436, NetFixLoss: 7.8853, ]
2022-11-06 07:41:27,665 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1616, Pos_dist: 15.1851, Neg_dist: 23.8502, Acc: 0.8876, PTFixPNLoss: 4.7409, NetFixLoss: 9.4229, ]
2022-11-06 07:41:32,330 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2438, Pos_dist: 15.1994, Neg_dist: 22.4791, Acc: 0.8857, PTFixPNLoss: 4.7435, NetFixLoss: 10.9726, ]
2022-11-06 07:41:36,769 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1648, Pos_dist: 15.2568, Neg_dist: 23.8218, Acc: 0.8838, PTFixPNLoss: 4.7414, NetFixLoss: 12.5305, ]
2022-11-06 07:41:36,917 INFO: fine-tune procedure is finished!
2022-11-06 07:42:21,314 INFO: [Test_acc of task 7 on test 3: 0.45746][acc of former classes: 0.74514][acc of former samples in all classes: 0.60475]
[acc of novel samples in all classes: 0.39097]
2022-11-06 07:42:21,700 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:42:21,741 WARNING: Current net - loaded net:
2022-11-06 07:42:21,741 WARNING: Loaded net - current net:
2022-11-06 07:42:21,741 WARNING:   func.classifier.bias
2022-11-06 07:42:21,741 WARNING:   func.classifier.weight
2022-11-06 07:42:21,752 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_7.pth.
2022-11-06 07:42:21,807 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:42:21,823 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:42:21,823 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:42:21,823 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:42:21,823 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:42:21,823 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:42:21,823 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:42:21,823 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:42:21,824 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:42:21,824 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:42:21,824 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:42:21,824 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:42:21,824 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:42:21,825 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:42:21,826 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:42:21,827 INFO: Model [FSLLModel] is created.
2022-11-06 07:42:21,831 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:42:21,833 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:42:21,835 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:42:21,838 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:42:21,840 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:42:21,843 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:42:21,846 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:42:21,851 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_7.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-06 07:42:26,732 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2619, Pos_dist: 15.2679, Neg_dist: 22.4226, Acc: 0.8550, PTFixPNLoss: 4.8399, NetFixLoss: 0.0000, ]
2022-11-06 07:42:32,306 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1548, Pos_dist: 15.3993, Neg_dist: 23.8505, Acc: 0.8800, PTFixPNLoss: 4.8390, NetFixLoss: 1.2654, ]
2022-11-06 07:42:37,751 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2545, Pos_dist: 15.2115, Neg_dist: 22.7870, Acc: 0.8967, PTFixPNLoss: 4.8339, NetFixLoss: 2.5757, ]
2022-11-06 07:42:42,607 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1952, Pos_dist: 15.3231, Neg_dist: 23.4238, Acc: 0.8600, PTFixPNLoss: 4.8346, NetFixLoss: 4.0799, ]
2022-11-06 07:42:48,545 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3400, Pos_dist: 15.4424, Neg_dist: 22.2895, Acc: 0.8650, PTFixPNLoss: 4.8406, NetFixLoss: 5.6975, ]
2022-11-06 07:42:53,963 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1044, Pos_dist: 15.1552, Neg_dist: 24.0331, Acc: 0.8650, PTFixPNLoss: 4.8353, NetFixLoss: 7.3849, ]
2022-11-06 07:42:59,080 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3680, Pos_dist: 15.2417, Neg_dist: 21.4326, Acc: 0.8817, PTFixPNLoss: 4.8349, NetFixLoss: 9.1119, ]
2022-11-06 07:43:04,385 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2459, Pos_dist: 15.3112, Neg_dist: 23.1740, Acc: 0.8650, PTFixPNLoss: 4.8362, NetFixLoss: 10.9080, ]
2022-11-06 07:43:09,364 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0690, Pos_dist: 15.1116, Neg_dist: 24.7717, Acc: 0.8967, PTFixPNLoss: 4.8332, NetFixLoss: 12.7548, ]
2022-11-06 07:43:14,727 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2871, Pos_dist: 15.1479, Neg_dist: 22.7222, Acc: 0.8767, PTFixPNLoss: 4.8329, NetFixLoss: 14.6212, ]
2022-11-06 07:43:14,990 INFO: fine-tune procedure is finished!
2022-11-06 07:44:04,661 INFO: [Test_acc of task 8 on test 3: 0.44573][acc of former classes: 0.75018][acc of former samples in all classes: 0.60259]
[acc of novel samples in all classes: 0.38387]
2022-11-06 07:44:05,023 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:44:05,063 WARNING: Current net - loaded net:
2022-11-06 07:44:05,063 WARNING: Loaded net - current net:
2022-11-06 07:44:05,063 WARNING:   func.classifier.bias
2022-11-06 07:44:05,063 WARNING:   func.classifier.weight
2022-11-06 07:44:05,075 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_8.pth.
2022-11-06 07:44:05,114 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:44:05,130 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:44:05,131 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:44:05,131 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:44:05,132 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:44:05,133 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:44:05,134 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:44:05,134 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:44:05,134 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:44:05,134 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:44:05,134 INFO: Model [FSLLModel] is created.
2022-11-06 07:44:05,139 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,143 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,147 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,151 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,155 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,159 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,164 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,168 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:44:05,172 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_8.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
2022-11-06 07:44:10,717 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1007, Pos_dist: 15.3055, Neg_dist: 23.4287, Acc: 0.8563, PTFixPNLoss: 4.9257, NetFixLoss: 0.0000, ]
2022-11-06 07:44:16,419 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3803, Pos_dist: 15.2940, Neg_dist: 22.0175, Acc: 0.8963, PTFixPNLoss: 4.9227, NetFixLoss: 0.6996, ]
2022-11-06 07:44:21,892 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0701, Pos_dist: 15.2659, Neg_dist: 24.9160, Acc: 0.8844, PTFixPNLoss: 4.9263, NetFixLoss: 2.0482, ]
2022-11-06 07:44:27,436 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3719, Pos_dist: 15.2057, Neg_dist: 22.0523, Acc: 0.8844, PTFixPNLoss: 4.9244, NetFixLoss: 3.4899, ]
2022-11-06 07:44:33,901 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1049, Pos_dist: 15.2102, Neg_dist: 25.6401, Acc: 0.8756, PTFixPNLoss: 4.9216, NetFixLoss: 5.0422, ]
2022-11-06 07:44:39,601 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1322, Pos_dist: 15.2720, Neg_dist: 24.0865, Acc: 0.8637, PTFixPNLoss: 4.9242, NetFixLoss: 6.6547, ]
2022-11-06 07:44:45,638 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3985, Pos_dist: 15.4040, Neg_dist: 21.9814, Acc: 0.8578, PTFixPNLoss: 4.9291, NetFixLoss: 8.2690, ]
2022-11-06 07:44:51,455 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3419, Pos_dist: 15.2037, Neg_dist: 22.1547, Acc: 0.8696, PTFixPNLoss: 4.9238, NetFixLoss: 9.9483, ]
2022-11-06 07:44:57,816 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3151, Pos_dist: 15.2693, Neg_dist: 22.2563, Acc: 0.8652, PTFixPNLoss: 4.9268, NetFixLoss: 11.7825, ]
2022-11-06 07:45:03,480 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2141, Pos_dist: 15.1806, Neg_dist: 23.2267, Acc: 0.8785, PTFixPNLoss: 4.9202, NetFixLoss: 13.7835, ]
2022-11-06 07:45:03,634 INFO: fine-tune procedure is finished!
2022-11-06 07:45:57,290 INFO: [Test_acc of task 9 on test 3: 0.43025][acc of former classes: 0.74658][acc of former samples in all classes: 0.59107]
[acc of novel samples in all classes: 0.37393]
2022-11-06 07:45:57,668 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:45:57,697 WARNING: Current net - loaded net:
2022-11-06 07:45:57,698 WARNING: Loaded net - current net:
2022-11-06 07:45:57,698 WARNING:   func.classifier.bias
2022-11-06 07:45:57,698 WARNING:   func.classifier.weight
2022-11-06 07:45:57,707 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_9.pth.
2022-11-06 07:45:57,737 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:45:57,752 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:45:57,752 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:45:57,752 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:45:57,752 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:45:57,752 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:45:57,753 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:45:57,754 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:45:57,755 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:45:57,755 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:45:57,755 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:45:57,755 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:45:57,755 INFO: Model [FSLLModel] is created.
2022-11-06 07:45:57,759 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,762 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,765 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,768 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,771 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,774 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,776 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,779 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,782 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:45:57,785 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_9.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-06 07:46:03,940 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2967, Pos_dist: 15.0645, Neg_dist: 21.9820, Acc: 0.8747, PTFixPNLoss: 5.0011, NetFixLoss: 0.0000, ]
2022-11-06 07:46:10,029 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1682, Pos_dist: 15.0709, Neg_dist: 22.6480, Acc: 0.8680, PTFixPNLoss: 5.0007, NetFixLoss: 1.0688, ]
2022-11-06 07:46:16,025 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1284, Pos_dist: 15.0721, Neg_dist: 22.9114, Acc: 0.8773, PTFixPNLoss: 4.9997, NetFixLoss: 2.3563, ]
2022-11-06 07:46:22,504 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1306, Pos_dist: 15.2085, Neg_dist: 24.1506, Acc: 0.8840, PTFixPNLoss: 5.0011, NetFixLoss: 3.7727, ]
2022-11-06 07:46:28,873 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1288, Pos_dist: 15.0383, Neg_dist: 24.3744, Acc: 0.8693, PTFixPNLoss: 4.9997, NetFixLoss: 5.2301, ]
2022-11-06 07:46:34,561 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1192, Pos_dist: 15.1464, Neg_dist: 23.5490, Acc: 0.8893, PTFixPNLoss: 5.0002, NetFixLoss: 6.7188, ]
2022-11-06 07:46:40,620 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0812, Pos_dist: 15.2298, Neg_dist: 24.9665, Acc: 0.8747, PTFixPNLoss: 5.0038, NetFixLoss: 8.2702, ]
2022-11-06 07:46:46,692 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2029, Pos_dist: 15.0227, Neg_dist: 22.6989, Acc: 0.8707, PTFixPNLoss: 4.9956, NetFixLoss: 9.7941, ]
2022-11-06 07:46:52,947 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1130, Pos_dist: 15.0306, Neg_dist: 24.0169, Acc: 0.8853, PTFixPNLoss: 5.0001, NetFixLoss: 11.3790, ]
2022-11-06 07:46:59,621 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2914, Pos_dist: 15.2603, Neg_dist: 22.8326, Acc: 0.8733, PTFixPNLoss: 5.0017, NetFixLoss: 12.9390, ]
2022-11-06 07:46:59,741 INFO: fine-tune procedure is finished!
2022-11-06 07:47:57,977 INFO: [Test_acc of task 10 on test 3: 0.43217][acc of former classes: 0.73938][acc of former samples in all classes: 0.58027]
[acc of novel samples in all classes: 0.38547]
2022-11-06 07:47:58,373 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:47:58,401 WARNING: Current net - loaded net:
2022-11-06 07:47:58,401 WARNING: Loaded net - current net:
2022-11-06 07:47:58,401 WARNING:   func.classifier.bias
2022-11-06 07:47:58,401 WARNING:   func.classifier.weight
2022-11-06 07:47:58,410 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth.
2022-11-06 07:47:58,439 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:47:58,451 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:47:58,452 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:47:58,452 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:47:58,453 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:47:58,454 INFO: Model [FSLLModel] is created.
2022-11-06 07:47:58,457 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test3_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-06 07:47:59,864 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 1.0050, Pos_dist: 16.0688, Neg_dist: 21.0436, Acc: 0.8933, PTFixPNLoss: 3.8855, NetFixLoss: 0.0000, ]
2022-11-06 07:48:01,110 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.5218, Pos_dist: 16.2752, Neg_dist: 22.5099, Acc: 0.9333, PTFixPNLoss: 3.8918, NetFixLoss: 3.0343, ]
2022-11-06 07:48:02,468 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3863, Pos_dist: 16.3334, Neg_dist: 23.0230, Acc: 0.8533, PTFixPNLoss: 3.8981, NetFixLoss: 6.3545, ]
2022-11-06 07:48:03,588 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3896, Pos_dist: 16.0989, Neg_dist: 23.3205, Acc: 0.9200, PTFixPNLoss: 3.8841, NetFixLoss: 9.9659, ]
2022-11-06 07:48:04,786 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1182, Pos_dist: 16.2682, Neg_dist: 25.9073, Acc: 0.8667, PTFixPNLoss: 3.8874, NetFixLoss: 14.2191, ]
2022-11-06 07:48:06,117 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4508, Pos_dist: 16.0006, Neg_dist: 22.1240, Acc: 0.9333, PTFixPNLoss: 3.8776, NetFixLoss: 18.3596, ]
2022-11-06 07:48:07,495 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.5910, Pos_dist: 15.8483, Neg_dist: 21.6833, Acc: 0.9200, PTFixPNLoss: 3.8827, NetFixLoss: 22.4922, ]
2022-11-06 07:48:09,083 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4367, Pos_dist: 15.4860, Neg_dist: 21.5465, Acc: 0.9600, PTFixPNLoss: 3.8728, NetFixLoss: 26.6902, ]
2022-11-06 07:48:10,360 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4784, Pos_dist: 15.2349, Neg_dist: 21.3279, Acc: 0.9467, PTFixPNLoss: 3.8736, NetFixLoss: 30.9118, ]
2022-11-06 07:48:11,559 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.5026, Pos_dist: 15.2107, Neg_dist: 21.1882, Acc: 0.9200, PTFixPNLoss: 3.8751, NetFixLoss: 35.0973, ]
2022-11-06 07:48:11,680 INFO: fine-tune procedure is finished!
2022-11-06 07:48:31,849 INFO: [Test_acc of task 1 on test 4: 0.66156][acc of former classes: 0.75234][acc of former samples in all classes: 0.71706]
[acc of novel samples in all classes: 0.48513]
2022-11-06 07:48:32,211 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:48:32,239 WARNING: Current net - loaded net:
2022-11-06 07:48:32,239 WARNING: Loaded net - current net:
2022-11-06 07:48:32,239 WARNING:   func.classifier.bias
2022-11-06 07:48:32,239 WARNING:   func.classifier.weight
2022-11-06 07:48:32,248 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_1.pth.
2022-11-06 07:48:32,278 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:48:32,290 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:48:32,290 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:48:32,290 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:48:32,290 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:48:32,291 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:48:32,291 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:48:32,291 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:48:32,291 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:48:32,291 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:48:32,291 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:48:32,291 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:48:32,291 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:48:32,292 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:48:32,293 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:48:32,293 INFO: Model [FSLLModel] is created.
2022-11-06 07:48:32,296 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:48:32,299 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_1.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 07:48:34,275 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.5845, Pos_dist: 15.6190, Neg_dist: 21.6275, Acc: 0.9333, PTFixPNLoss: 4.0828, NetFixLoss: 0.0000, ]
2022-11-06 07:48:36,020 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1220, Pos_dist: 16.0185, Neg_dist: 25.2003, Acc: 0.8600, PTFixPNLoss: 4.0909, NetFixLoss: 1.8082, ]
2022-11-06 07:48:38,137 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4361, Pos_dist: 15.7502, Neg_dist: 22.4890, Acc: 0.9133, PTFixPNLoss: 4.0875, NetFixLoss: 3.6836, ]
2022-11-06 07:48:39,820 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.5081, Pos_dist: 15.6335, Neg_dist: 21.5572, Acc: 0.9267, PTFixPNLoss: 4.0806, NetFixLoss: 6.0403, ]
2022-11-06 07:48:41,662 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2894, Pos_dist: 15.5580, Neg_dist: 23.1225, Acc: 0.9000, PTFixPNLoss: 4.0739, NetFixLoss: 9.0609, ]
2022-11-06 07:48:43,467 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1900, Pos_dist: 15.3331, Neg_dist: 23.5756, Acc: 0.9067, PTFixPNLoss: 4.0757, NetFixLoss: 12.3315, ]
2022-11-06 07:48:45,624 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1591, Pos_dist: 15.3818, Neg_dist: 24.0980, Acc: 0.8933, PTFixPNLoss: 4.0791, NetFixLoss: 15.5456, ]
2022-11-06 07:48:47,391 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.5190, Pos_dist: 15.5285, Neg_dist: 21.6832, Acc: 0.9133, PTFixPNLoss: 4.0792, NetFixLoss: 18.5997, ]
2022-11-06 07:48:49,234 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2191, Pos_dist: 15.5501, Neg_dist: 23.3766, Acc: 0.9400, PTFixPNLoss: 4.0765, NetFixLoss: 21.5434, ]
2022-11-06 07:48:51,085 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2810, Pos_dist: 14.9839, Neg_dist: 21.9397, Acc: 0.9333, PTFixPNLoss: 4.0689, NetFixLoss: 24.6188, ]
2022-11-06 07:48:51,212 INFO: fine-tune procedure is finished!
2022-11-06 07:49:15,104 INFO: [Test_acc of task 2 on test 4: 0.60299][acc of former classes: 0.74730][acc of former samples in all classes: 0.68323]
[acc of novel samples in all classes: 0.47678]
2022-11-06 07:49:15,466 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:49:15,496 WARNING: Current net - loaded net:
2022-11-06 07:49:15,496 WARNING: Loaded net - current net:
2022-11-06 07:49:15,496 WARNING:   func.classifier.bias
2022-11-06 07:49:15,496 WARNING:   func.classifier.weight
2022-11-06 07:49:15,506 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_2.pth.
2022-11-06 07:49:15,535 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:49:15,547 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:49:15,547 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:49:15,547 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:49:15,548 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:49:15,549 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:49:15,550 INFO: Model [FSLLModel] is created.
2022-11-06 07:49:15,553 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:49:15,555 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:49:15,558 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_2.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-06 07:49:17,645 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2067, Pos_dist: 15.4839, Neg_dist: 23.0649, Acc: 0.9111, PTFixPNLoss: 4.2482, NetFixLoss: 0.0000, ]
2022-11-06 07:49:19,994 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3131, Pos_dist: 15.5065, Neg_dist: 23.0137, Acc: 0.9156, PTFixPNLoss: 4.2561, NetFixLoss: 1.0571, ]
2022-11-06 07:49:22,580 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2166, Pos_dist: 15.3229, Neg_dist: 23.1314, Acc: 0.9111, PTFixPNLoss: 4.2513, NetFixLoss: 2.4858, ]
2022-11-06 07:49:25,163 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1482, Pos_dist: 15.2640, Neg_dist: 23.8502, Acc: 0.9289, PTFixPNLoss: 4.2483, NetFixLoss: 4.0925, ]
2022-11-06 07:49:27,759 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2824, Pos_dist: 15.3963, Neg_dist: 22.2894, Acc: 0.9067, PTFixPNLoss: 4.2486, NetFixLoss: 5.7840, ]
2022-11-06 07:49:30,406 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2220, Pos_dist: 15.5036, Neg_dist: 23.6265, Acc: 0.9289, PTFixPNLoss: 4.2559, NetFixLoss: 7.6021, ]
2022-11-06 07:49:33,140 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3856, Pos_dist: 15.3035, Neg_dist: 21.9084, Acc: 0.8978, PTFixPNLoss: 4.2510, NetFixLoss: 9.5426, ]
2022-11-06 07:49:35,538 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2192, Pos_dist: 15.2459, Neg_dist: 22.6039, Acc: 0.9378, PTFixPNLoss: 4.2453, NetFixLoss: 11.6560, ]
2022-11-06 07:49:38,196 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1554, Pos_dist: 15.3297, Neg_dist: 23.4280, Acc: 0.9333, PTFixPNLoss: 4.2452, NetFixLoss: 13.7978, ]
2022-11-06 07:49:40,576 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2117, Pos_dist: 15.4444, Neg_dist: 24.5945, Acc: 0.9289, PTFixPNLoss: 4.2444, NetFixLoss: 15.9967, ]
2022-11-06 07:49:40,710 INFO: fine-tune procedure is finished!
2022-11-06 07:50:08,585 INFO: [Test_acc of task 3 on test 4: 0.58158][acc of former classes: 0.73938][acc of former samples in all classes: 0.65155]
[acc of novel samples in all classes: 0.50830]
2022-11-06 07:50:09,030 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:50:09,069 WARNING: Current net - loaded net:
2022-11-06 07:50:09,069 WARNING: Loaded net - current net:
2022-11-06 07:50:09,069 WARNING:   func.classifier.bias
2022-11-06 07:50:09,069 WARNING:   func.classifier.weight
2022-11-06 07:50:09,078 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_3.pth.
2022-11-06 07:50:09,105 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:50:09,117 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:50:09,118 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:50:09,118 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:50:09,118 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:50:09,119 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:50:09,120 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:50:09,120 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:50:09,120 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:50:09,120 INFO: Model [FSLLModel] is created.
2022-11-06 07:50:09,123 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:50:09,125 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:50:09,128 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:50:09,130 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_3.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-06 07:50:11,804 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3476, Pos_dist: 15.2754, Neg_dist: 22.3404, Acc: 0.8833, PTFixPNLoss: 4.3928, NetFixLoss: 0.0000, ]
2022-11-06 07:50:14,663 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3145, Pos_dist: 15.3961, Neg_dist: 22.1405, Acc: 0.9067, PTFixPNLoss: 4.3938, NetFixLoss: 1.0755, ]
2022-11-06 07:50:17,535 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0547, Pos_dist: 15.2863, Neg_dist: 24.7963, Acc: 0.9067, PTFixPNLoss: 4.3896, NetFixLoss: 2.4857, ]
2022-11-06 07:50:20,461 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1861, Pos_dist: 15.0751, Neg_dist: 22.7149, Acc: 0.9200, PTFixPNLoss: 4.3873, NetFixLoss: 3.9259, ]
2022-11-06 07:50:23,387 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1707, Pos_dist: 15.1169, Neg_dist: 22.3281, Acc: 0.9100, PTFixPNLoss: 4.3916, NetFixLoss: 5.4195, ]
2022-11-06 07:50:26,379 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2844, Pos_dist: 15.5008, Neg_dist: 23.0058, Acc: 0.9067, PTFixPNLoss: 4.3951, NetFixLoss: 7.0004, ]
2022-11-06 07:50:29,334 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1552, Pos_dist: 15.1767, Neg_dist: 23.8721, Acc: 0.9133, PTFixPNLoss: 4.3898, NetFixLoss: 8.7945, ]
2022-11-06 07:50:32,301 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1930, Pos_dist: 15.2404, Neg_dist: 22.8228, Acc: 0.8933, PTFixPNLoss: 4.3894, NetFixLoss: 10.6745, ]
2022-11-06 07:50:35,109 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2736, Pos_dist: 15.3001, Neg_dist: 22.0905, Acc: 0.9100, PTFixPNLoss: 4.3923, NetFixLoss: 12.5765, ]
2022-11-06 07:50:38,134 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1641, Pos_dist: 15.1704, Neg_dist: 24.0119, Acc: 0.9033, PTFixPNLoss: 4.3909, NetFixLoss: 14.5233, ]
2022-11-06 07:50:38,259 INFO: fine-tune procedure is finished!
2022-11-06 07:51:10,223 INFO: [Test_acc of task 4 on test 4: 0.55711][acc of former classes: 0.74802][acc of former samples in all classes: 0.63283]
[acc of novel samples in all classes: 0.49715]
2022-11-06 07:51:10,539 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:51:10,568 WARNING: Current net - loaded net:
2022-11-06 07:51:10,568 WARNING: Loaded net - current net:
2022-11-06 07:51:10,568 WARNING:   func.classifier.bias
2022-11-06 07:51:10,569 WARNING:   func.classifier.weight
2022-11-06 07:51:10,578 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_4.pth.
2022-11-06 07:51:10,609 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:51:10,622 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:51:10,622 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:51:10,623 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:51:10,624 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:51:10,625 INFO: Model [FSLLModel] is created.
2022-11-06 07:51:10,628 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:51:10,630 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:51:10,633 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:51:10,635 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:51:10,638 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_4.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124]
2022-11-06 07:51:13,911 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2015, Pos_dist: 15.3920, Neg_dist: 23.1725, Acc: 0.9067, PTFixPNLoss: 4.5277, NetFixLoss: 0.0000, ]
2022-11-06 07:51:17,688 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2315, Pos_dist: 15.2827, Neg_dist: 23.9201, Acc: 0.8960, PTFixPNLoss: 4.5202, NetFixLoss: 1.0037, ]
2022-11-06 07:51:21,298 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2454, Pos_dist: 15.5387, Neg_dist: 22.9605, Acc: 0.8747, PTFixPNLoss: 4.5234, NetFixLoss: 2.2389, ]
2022-11-06 07:51:24,986 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1617, Pos_dist: 15.4680, Neg_dist: 23.8031, Acc: 0.8880, PTFixPNLoss: 4.5242, NetFixLoss: 3.7185, ]
2022-11-06 07:51:28,323 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1080, Pos_dist: 15.4356, Neg_dist: 23.8029, Acc: 0.9147, PTFixPNLoss: 4.5239, NetFixLoss: 5.3568, ]
2022-11-06 07:51:31,618 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1627, Pos_dist: 15.4635, Neg_dist: 23.4679, Acc: 0.9120, PTFixPNLoss: 4.5273, NetFixLoss: 7.0244, ]
2022-11-06 07:51:35,225 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1971, Pos_dist: 15.3911, Neg_dist: 24.0367, Acc: 0.8880, PTFixPNLoss: 4.5223, NetFixLoss: 8.7202, ]
2022-11-06 07:51:40,165 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1800, Pos_dist: 15.3036, Neg_dist: 22.9750, Acc: 0.8773, PTFixPNLoss: 4.5253, NetFixLoss: 10.4128, ]
2022-11-06 07:51:43,907 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1160, Pos_dist: 15.2976, Neg_dist: 25.1531, Acc: 0.9173, PTFixPNLoss: 4.5213, NetFixLoss: 12.1809, ]
2022-11-06 07:51:47,396 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1885, Pos_dist: 15.4357, Neg_dist: 23.0137, Acc: 0.9013, PTFixPNLoss: 4.5203, NetFixLoss: 13.9780, ]
2022-11-06 07:51:47,532 INFO: fine-tune procedure is finished!
2022-11-06 07:52:23,975 INFO: [Test_acc of task 5 on test 4: 0.51481][acc of former classes: 0.75090][acc of former samples in all classes: 0.63355]
[acc of novel samples in all classes: 0.43947]
2022-11-06 07:52:24,389 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:52:24,427 WARNING: Current net - loaded net:
2022-11-06 07:52:24,427 WARNING: Loaded net - current net:
2022-11-06 07:52:24,427 WARNING:   func.classifier.bias
2022-11-06 07:52:24,427 WARNING:   func.classifier.weight
2022-11-06 07:52:24,438 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_5.pth.
2022-11-06 07:52:24,472 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:52:24,485 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:52:24,485 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:52:24,485 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:52:24,485 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:52:24,485 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:52:24,485 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:52:24,486 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:52:24,486 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:52:24,486 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:52:24,486 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:52:24,486 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:52:24,486 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:52:24,487 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:52:24,488 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:52:24,488 INFO: Model [FSLLModel] is created.
2022-11-06 07:52:24,492 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:52:24,494 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:52:24,497 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:52:24,499 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:52:24,502 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:52:24,504 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_5.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-06 07:52:28,987 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2523, Pos_dist: 15.4861, Neg_dist: 22.3275, Acc: 0.8933, PTFixPNLoss: 4.6444, NetFixLoss: 0.0000, ]
2022-11-06 07:52:33,404 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4437, Pos_dist: 15.4436, Neg_dist: 21.8771, Acc: 0.8911, PTFixPNLoss: 4.6463, NetFixLoss: 1.2749, ]
2022-11-06 07:52:37,420 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1571, Pos_dist: 15.4766, Neg_dist: 23.4053, Acc: 0.8844, PTFixPNLoss: 4.6411, NetFixLoss: 3.0098, ]
2022-11-06 07:52:41,831 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3384, Pos_dist: 15.5001, Neg_dist: 22.4101, Acc: 0.8822, PTFixPNLoss: 4.6436, NetFixLoss: 5.1300, ]
2022-11-06 07:52:45,979 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3499, Pos_dist: 15.2818, Neg_dist: 22.8030, Acc: 0.8933, PTFixPNLoss: 4.6365, NetFixLoss: 7.3324, ]
2022-11-06 07:52:50,229 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1891, Pos_dist: 15.3465, Neg_dist: 23.4222, Acc: 0.8933, PTFixPNLoss: 4.6404, NetFixLoss: 9.6643, ]
2022-11-06 07:52:54,352 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2410, Pos_dist: 15.3590, Neg_dist: 23.1446, Acc: 0.8933, PTFixPNLoss: 4.6401, NetFixLoss: 12.0039, ]
2022-11-06 07:52:58,098 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0264, Pos_dist: 15.3379, Neg_dist: 29.4808, Acc: 0.8867, PTFixPNLoss: 4.6385, NetFixLoss: 14.3357, ]
2022-11-06 07:53:01,759 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3264, Pos_dist: 15.2179, Neg_dist: 21.7138, Acc: 0.9000, PTFixPNLoss: 4.6371, NetFixLoss: 16.6048, ]
2022-11-06 07:53:06,055 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4357, Pos_dist: 15.3093, Neg_dist: 22.0163, Acc: 0.8956, PTFixPNLoss: 4.6363, NetFixLoss: 18.7775, ]
2022-11-06 07:53:06,172 INFO: fine-tune procedure is finished!
2022-11-06 07:53:48,815 INFO: [Test_acc of task 6 on test 4: 0.48312][acc of former classes: 0.75954][acc of former samples in all classes: 0.61771]
[acc of novel samples in all classes: 0.41228]
2022-11-06 07:53:49,241 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:53:49,282 WARNING: Current net - loaded net:
2022-11-06 07:53:49,282 WARNING: Loaded net - current net:
2022-11-06 07:53:49,282 WARNING:   func.classifier.bias
2022-11-06 07:53:49,282 WARNING:   func.classifier.weight
2022-11-06 07:53:49,294 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_6.pth.
2022-11-06 07:53:49,333 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:53:49,352 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:53:49,353 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:53:49,353 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:53:49,354 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:53:49,355 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:53:49,356 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:53:49,356 INFO: Model [FSLLModel] is created.
2022-11-06 07:53:49,362 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:53:49,366 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:53:49,370 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:53:49,375 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:53:49,379 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:53:49,382 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:53:49,384 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_6.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154]
2022-11-06 07:53:53,985 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1298, Pos_dist: 15.2164, Neg_dist: 24.9608, Acc: 0.8590, PTFixPNLoss: 4.7415, NetFixLoss: 0.0000, ]
2022-11-06 07:53:58,768 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2553, Pos_dist: 15.3937, Neg_dist: 22.9922, Acc: 0.8629, PTFixPNLoss: 4.7445, NetFixLoss: 0.6886, ]
2022-11-06 07:54:03,783 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0971, Pos_dist: 15.2040, Neg_dist: 27.3617, Acc: 0.8667, PTFixPNLoss: 4.7423, NetFixLoss: 1.8743, ]
2022-11-06 07:54:08,924 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2772, Pos_dist: 15.3231, Neg_dist: 22.8995, Acc: 0.8762, PTFixPNLoss: 4.7434, NetFixLoss: 3.1611, ]
2022-11-06 07:54:13,946 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1886, Pos_dist: 15.0769, Neg_dist: 22.9757, Acc: 0.8705, PTFixPNLoss: 4.7391, NetFixLoss: 4.6304, ]
2022-11-06 07:54:18,502 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2015, Pos_dist: 15.1746, Neg_dist: 23.2468, Acc: 0.8800, PTFixPNLoss: 4.7391, NetFixLoss: 6.2497, ]
2022-11-06 07:54:23,807 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2553, Pos_dist: 15.3374, Neg_dist: 22.7592, Acc: 0.8610, PTFixPNLoss: 4.7423, NetFixLoss: 7.9624, ]
2022-11-06 07:54:28,433 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1031, Pos_dist: 15.2769, Neg_dist: 26.2843, Acc: 0.8533, PTFixPNLoss: 4.7391, NetFixLoss: 9.7515, ]
2022-11-06 07:54:33,398 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3374, Pos_dist: 15.2598, Neg_dist: 22.1771, Acc: 0.8743, PTFixPNLoss: 4.7427, NetFixLoss: 11.5022, ]
2022-11-06 07:54:38,516 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4228, Pos_dist: 15.2363, Neg_dist: 21.5300, Acc: 0.8667, PTFixPNLoss: 4.7404, NetFixLoss: 13.2348, ]
2022-11-06 07:54:38,701 INFO: fine-tune procedure is finished!
2022-11-06 07:55:27,743 INFO: [Test_acc of task 7 on test 4: 0.45925][acc of former classes: 0.74946][acc of former samples in all classes: 0.59899]
[acc of novel samples in all classes: 0.39617]
2022-11-06 07:55:28,261 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:55:28,297 WARNING: Current net - loaded net:
2022-11-06 07:55:28,298 WARNING: Loaded net - current net:
2022-11-06 07:55:28,298 WARNING:   func.classifier.bias
2022-11-06 07:55:28,298 WARNING:   func.classifier.weight
2022-11-06 07:55:28,309 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_7.pth.
2022-11-06 07:55:28,362 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:55:28,382 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:55:28,383 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:55:28,383 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:55:28,384 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:55:28,385 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:55:28,386 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:55:28,386 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:55:28,386 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:55:28,386 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:55:28,386 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:55:28,386 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:55:28,386 INFO: Model [FSLLModel] is created.
2022-11-06 07:55:28,391 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:55:28,395 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:55:28,400 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:55:28,404 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:55:28,408 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:55:28,412 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:55:28,416 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:55:28,420 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_7.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-06 07:55:33,715 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2170, Pos_dist: 15.2539, Neg_dist: 23.1357, Acc: 0.8350, PTFixPNLoss: 4.8372, NetFixLoss: 0.0000, ]
2022-11-06 07:55:39,610 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3913, Pos_dist: 15.2272, Neg_dist: 22.0252, Acc: 0.8633, PTFixPNLoss: 4.8376, NetFixLoss: 0.9973, ]
2022-11-06 07:55:45,411 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0985, Pos_dist: 15.0360, Neg_dist: 23.7435, Acc: 0.8667, PTFixPNLoss: 4.8323, NetFixLoss: 2.3867, ]
2022-11-06 07:55:50,841 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3052, Pos_dist: 15.1643, Neg_dist: 22.1016, Acc: 0.8583, PTFixPNLoss: 4.8330, NetFixLoss: 3.8962, ]
2022-11-06 07:55:56,072 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2321, Pos_dist: 15.1921, Neg_dist: 23.1861, Acc: 0.8800, PTFixPNLoss: 4.8332, NetFixLoss: 5.5168, ]
2022-11-06 07:56:00,932 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2650, Pos_dist: 15.1429, Neg_dist: 22.0568, Acc: 0.8733, PTFixPNLoss: 4.8304, NetFixLoss: 7.2582, ]
2022-11-06 07:56:06,695 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0613, Pos_dist: 15.0673, Neg_dist: 25.2561, Acc: 0.8783, PTFixPNLoss: 4.8301, NetFixLoss: 9.1017, ]
2022-11-06 07:56:12,739 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1213, Pos_dist: 15.1769, Neg_dist: 24.5463, Acc: 0.8750, PTFixPNLoss: 4.8346, NetFixLoss: 10.9450, ]
2022-11-06 07:56:18,159 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1653, Pos_dist: 15.1627, Neg_dist: 24.0371, Acc: 0.8700, PTFixPNLoss: 4.8355, NetFixLoss: 12.7433, ]
2022-11-06 07:56:23,149 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1344, Pos_dist: 15.0239, Neg_dist: 23.7133, Acc: 0.8800, PTFixPNLoss: 4.8294, NetFixLoss: 14.4684, ]
2022-11-06 07:56:23,328 INFO: fine-tune procedure is finished!
2022-11-06 07:57:13,302 INFO: [Test_acc of task 8 on test 4: 0.45225][acc of former classes: 0.74658][acc of former samples in all classes: 0.57955]
[acc of novel samples in all classes: 0.40204]
2022-11-06 07:57:13,703 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:57:13,741 WARNING: Current net - loaded net:
2022-11-06 07:57:13,741 WARNING: Loaded net - current net:
2022-11-06 07:57:13,741 WARNING:   func.classifier.bias
2022-11-06 07:57:13,741 WARNING:   func.classifier.weight
2022-11-06 07:57:13,752 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_8.pth.
2022-11-06 07:57:13,789 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:57:13,806 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:57:13,806 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:57:13,806 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:57:13,807 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:57:13,808 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:57:13,809 INFO: Model [FSLLModel] is created.
2022-11-06 07:57:13,812 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,815 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,817 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,820 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,823 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,825 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,828 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,830 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:57:13,833 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_8.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184]
2022-11-06 07:57:19,458 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1496, Pos_dist: 15.1190, Neg_dist: 23.1107, Acc: 0.8741, PTFixPNLoss: 4.9208, NetFixLoss: 0.0000, ]
2022-11-06 07:57:25,270 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1568, Pos_dist: 15.1944, Neg_dist: 23.0958, Acc: 0.8874, PTFixPNLoss: 4.9198, NetFixLoss: 0.8952, ]
2022-11-06 07:57:31,532 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1004, Pos_dist: 15.2199, Neg_dist: 26.6559, Acc: 0.8756, PTFixPNLoss: 4.9197, NetFixLoss: 2.0026, ]
2022-11-06 07:57:37,363 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2904, Pos_dist: 15.0378, Neg_dist: 22.0780, Acc: 0.8785, PTFixPNLoss: 4.9192, NetFixLoss: 3.1912, ]
2022-11-06 07:57:43,479 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4013, Pos_dist: 15.3440, Neg_dist: 22.2814, Acc: 0.8681, PTFixPNLoss: 4.9219, NetFixLoss: 4.4993, ]
2022-11-06 07:57:49,639 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1784, Pos_dist: 15.0115, Neg_dist: 24.3724, Acc: 0.8904, PTFixPNLoss: 4.9138, NetFixLoss: 6.0113, ]
2022-11-06 07:57:54,836 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1648, Pos_dist: 15.1575, Neg_dist: 23.4045, Acc: 0.8622, PTFixPNLoss: 4.9190, NetFixLoss: 7.6495, ]
2022-11-06 07:58:00,386 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1235, Pos_dist: 15.0395, Neg_dist: 24.0830, Acc: 0.8785, PTFixPNLoss: 4.9173, NetFixLoss: 9.3341, ]
2022-11-06 07:58:06,583 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4665, Pos_dist: 15.1151, Neg_dist: 20.9956, Acc: 0.8607, PTFixPNLoss: 4.9205, NetFixLoss: 11.0182, ]
2022-11-06 07:58:12,642 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3139, Pos_dist: 15.1912, Neg_dist: 22.2630, Acc: 0.8637, PTFixPNLoss: 4.9189, NetFixLoss: 12.7187, ]
2022-11-06 07:58:12,895 INFO: fine-tune procedure is finished!
2022-11-06 07:59:06,106 INFO: [Test_acc of task 9 on test 4: 0.42876][acc of former classes: 0.74010][acc of former samples in all classes: 0.55940]
[acc of novel samples in all classes: 0.38301]
2022-11-06 07:59:06,541 INFO: Loading Resnet18_softmax model from ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth.
2022-11-06 07:59:06,583 WARNING: Current net - loaded net:
2022-11-06 07:59:06,583 WARNING: Loaded net - current net:
2022-11-06 07:59:06,583 WARNING:   func.classifier.bias
2022-11-06 07:59:06,583 WARNING:   func.classifier.weight
2022-11-06 07:59:06,598 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_9.pth.
2022-11-06 07:59:06,658 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/prototypes/test0_session0.pt
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-06 07:59:06,680 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-06 07:59:06,680 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-06 07:59:06,680 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-06 07:59:06,680 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-06 07:59:06,680 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-06 07:59:06,680 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-06 07:59:06,681 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-06 07:59:06,682 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-06 07:59:06,682 INFO: Model [FSLLModel] is created.
2022-11-06 07:59:06,686 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,689 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,691 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,694 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,696 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,698 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,701 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,703 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,706 INFO: Dataset NormalDataset - cub is created.
2022-11-06 07:59:06,709 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases50/FSIL_BaselineModel_res18_CUB_baseline_50base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_9.pth
Trainset classes:
[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-06 07:59:12,587 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2031, Pos_dist: 14.9932, Neg_dist: 22.7301, Acc: 0.8627, PTFixPNLoss: 4.9932, NetFixLoss: 0.0000, ]
2022-11-06 07:59:18,610 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2619, Pos_dist: 15.1419, Neg_dist: 22.6294, Acc: 0.8573, PTFixPNLoss: 5.0014, NetFixLoss: 0.8323, ]
2022-11-06 07:59:24,669 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4179, Pos_dist: 15.1741, Neg_dist: 21.6146, Acc: 0.8413, PTFixPNLoss: 4.9994, NetFixLoss: 1.9708, ]
2022-11-06 07:59:31,061 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2240, Pos_dist: 15.0723, Neg_dist: 22.1305, Acc: 0.8680, PTFixPNLoss: 4.9996, NetFixLoss: 3.5142, ]
2022-11-06 07:59:37,277 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1504, Pos_dist: 14.9549, Neg_dist: 23.0712, Acc: 0.8867, PTFixPNLoss: 4.9944, NetFixLoss: 5.3042, ]
2022-11-06 07:59:43,372 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2215, Pos_dist: 15.1198, Neg_dist: 22.3590, Acc: 0.8600, PTFixPNLoss: 4.9987, NetFixLoss: 7.1378, ]
2022-11-06 07:59:49,350 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1679, Pos_dist: 15.0405, Neg_dist: 23.4360, Acc: 0.8720, PTFixPNLoss: 4.9948, NetFixLoss: 8.9971, ]
2022-11-06 07:59:55,700 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0479, Pos_dist: 15.0505, Neg_dist: 24.8772, Acc: 0.8547, PTFixPNLoss: 4.9962, NetFixLoss: 10.8916, ]
2022-11-06 08:00:01,833 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3558, Pos_dist: 14.9745, Neg_dist: 21.6693, Acc: 0.8813, PTFixPNLoss: 4.9953, NetFixLoss: 12.7256, ]
2022-11-06 08:00:07,626 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2217, Pos_dist: 15.0784, Neg_dist: 22.5893, Acc: 0.8587, PTFixPNLoss: 4.9965, NetFixLoss: 14.5625, ]
2022-11-06 08:00:07,864 INFO: fine-tune procedure is finished!
2022-11-06 08:01:05,224 INFO: [Test_acc of task 10 on test 4: 0.42423][acc of former classes: 0.74082][acc of former samples in all classes: 0.54644]
[acc of novel samples in all classes: 0.38570]
2022-11-06 08:01:05,359 INFO: --------------------------Final Avg Acc-------------------------
2022-11-06 08:01:05,359 INFO: Session 1: 77.61+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7761]
2022-11-06 08:01:05,360 INFO: Session 2: 65.96+-0.64[acc of former classes: 0.7495][acc of former samples in all classes: 0.7185]
[acc of novel samples in all classes: 0.4723]
2022-11-06 08:01:05,360 INFO: Session 3: 60.37+-0.62[acc of former classes: 0.7490][acc of former samples in all classes: 0.6910]
[acc of novel samples in all classes: 0.4664]
2022-11-06 08:01:05,360 INFO: Session 4: 58.59+-0.92[acc of former classes: 0.7453][acc of former samples in all classes: 0.6713]
[acc of novel samples in all classes: 0.4964]
2022-11-06 08:01:05,360 INFO: Session 5: 55.96+-0.17[acc of former classes: 0.7538][acc of former samples in all classes: 0.6582]
[acc of novel samples in all classes: 0.4815]
2022-11-06 08:01:05,360 INFO: Session 6: 51.75+-0.28[acc of former classes: 0.7610][acc of former samples in all classes: 0.6590]
[acc of novel samples in all classes: 0.4277]
2022-11-06 08:01:05,360 INFO: Session 7: 48.35+-0.20[acc of former classes: 0.7578][acc of former samples in all classes: 0.6327]
[acc of novel samples in all classes: 0.4049]
2022-11-06 08:01:05,360 INFO: Session 8: 45.84+-0.56[acc of former classes: 0.7502][acc of former samples in all classes: 0.6071]
[acc of novel samples in all classes: 0.3914]
2022-11-06 08:01:05,360 INFO: Session 9: 44.92+-0.41[acc of former classes: 0.7503][acc of former samples in all classes: 0.5948]
[acc of novel samples in all classes: 0.3918]
2022-11-06 08:01:05,360 INFO: Session 10: 42.80+-0.50[acc of former classes: 0.7467][acc of former samples in all classes: 0.5808]
[acc of novel samples in all classes: 0.3744]
2022-11-06 08:01:05,361 INFO: Session 11: 42.62+-0.27[acc of former classes: 0.7446][acc of former samples in all classes: 0.5656]
[acc of novel samples in all classes: 0.3822]
2022-11-06 08:01:05,361 INFO: random seed: 1997
save network to: /workspace/FLOWER/f2m/increment/cub_bases50/FSLLModel_res18_cub_baseline_5shots_50base_wandb_debug/models/test4_session_10.pth
finish!!
