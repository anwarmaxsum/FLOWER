Path already exists. Rename it to /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug_archived_20221105_045911
/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-05 04:59:11,149 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-05 04:59:11,150 INFO: 
  name: FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug
  model_type: FSLLModel
  gpu: 1
  manual_seed: 1997
  use_cosine: False
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  datasets:[
    train:[
      name: cub
      type: NormalDataset
      total_classes: 200
      dataroot: DataSet/CUB_200_2011/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: None
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    val:[
      name: cub
      type: NormalDataset
      total_classes: 200
      dataroot: DataSet/CUB_200_2011/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    test:[
      name: cub
      type: NormalDataset
      total_classes: 200
      dataroot: DataSet/CUB_200_2011/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 224)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 256)]), OrderedDict([('type', 'CenterCrop'), ('size', 224)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
  ]
  network_g:[
    type: Resnet18_softmax
    Embed_dim: 512
    pretrained: False
    norm: False
    num_classes: 100
    adopt_classifier: False
    addition_net: False
    flatten: True
    cut_at_pooling: False
  ]
  path:[
    pretrain_model_g: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
    base_model: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug
    training_states: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/training_states
    log: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug
    models: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.0005
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [160]
      gamma: 0.1
    ]
    fine_tune: True
    fine_tune_epoch: 10
    threshold: 0.15
    warmup_iter: -1
    bases: 100
    tasks: 11
    shots: 5
    novel_exemplars: 5
    num_test: 5
    metric_opt:[
      type: TripletLossNoHardMining
      margin: 0.0
      num_instances: 5
    ]
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
    regularization:[
      type: IncrementalNetworkFixLoss
      w: 5.0
    ]
  ]
  val:[
    val_freq: 2000
    test_type: NCM
    p_norm: None
  ]
  logger:[
    print_freq: 2
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cub-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-05 04:59:11,150 INFO: Random seed: 1997
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:181: UserWarning: nn.init.kaiming_normal is now deprecated in favor of nn.init.kaiming_normal_.
  init.kaiming_normal(m.weight, mode='fan_out')
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:188: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  init.normal(m.weight, std=0.001)
2022-11-05 04:59:13,528 INFO: Network: Resnet18_softmax, with parameters: 11,689,512
2022-11-05 04:59:13,528 INFO: Resnet18_softmax(
  (func): ResNet_pytorch(
    (base): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=1000, bias=True)
    )
  )
)
2022-11-05 04:59:13,528 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 04:59:13,572 WARNING: Current net - loaded net:
2022-11-05 04:59:13,572 WARNING: Loaded net - current net:
2022-11-05 04:59:13,572 WARNING:   func.classifier.bias
2022-11-05 04:59:13,572 WARNING:   func.classifier.weight
2022-11-05 04:59:13,581 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 04:59:13,613 WARNING: Current net - loaded net:
2022-11-05 04:59:13,613 WARNING: Loaded net - current net:
2022-11-05 04:59:13,613 WARNING:   func.classifier.bias
2022-11-05 04:59:13,613 WARNING:   func.classifier.weight
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 04:59:13,637 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 04:59:13,637 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 04:59:13,637 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 04:59:13,637 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 04:59:13,637 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 04:59:13,637 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 04:59:13,637 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 04:59:13,637 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 04:59:13,637 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 04:59:13,638 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 04:59:13,639 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 04:59:13,640 INFO: Model [FSLLModel] is created.
2022-11-05 04:59:50,133 INFO: [Test_acc of task 0 on test 0: 0.76920][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.76920]
2022-11-05 04:59:50,490 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 04:59:50,535 WARNING: Current net - loaded net:
2022-11-05 04:59:50,535 WARNING: Loaded net - current net:
2022-11-05 04:59:50,535 WARNING:   func.classifier.bias
2022-11-05 04:59:50,535 WARNING:   func.classifier.weight
2022-11-05 04:59:50,547 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth.
2022-11-05 04:59:50,590 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 04:59:50,611 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 04:59:50,612 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 04:59:50,612 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 04:59:50,612 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 04:59:50,612 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 04:59:50,612 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 04:59:50,613 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 04:59:50,614 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 04:59:50,615 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 04:59:50,616 INFO: Model [FSLLModel] is created.
2022-11-05 04:59:50,621 INFO: Dataset NormalDataset - cub is created.
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
/workspace/FLOWER/f2m/methods/losses/losses.py:736: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1005.)
  dist.addmm_(1, -2, inputs, inputs.t())
2022-11-05 04:59:53,048 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2778, Pos_dist: 16.0798, Neg_dist: 24.6095, Acc: 0.9200, PTFixPNLoss: 4.3731, NetFixLoss: 0.0000, ]
2022-11-05 04:59:53,913 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4106, Pos_dist: 16.2358, Neg_dist: 23.4776, Acc: 0.9000, PTFixPNLoss: 4.3833, NetFixLoss: 1.4125, ]
2022-11-05 04:59:54,781 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1634, Pos_dist: 15.9401, Neg_dist: 23.8609, Acc: 0.9600, PTFixPNLoss: 4.3797, NetFixLoss: 3.6346, ]
2022-11-05 04:59:55,636 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2087, Pos_dist: 15.9931, Neg_dist: 23.2286, Acc: 0.9000, PTFixPNLoss: 4.3734, NetFixLoss: 6.2465, ]
2022-11-05 04:59:56,645 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2420, Pos_dist: 15.9664, Neg_dist: 23.7219, Acc: 0.8800, PTFixPNLoss: 4.3802, NetFixLoss: 9.2441, ]
2022-11-05 04:59:57,829 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1964, Pos_dist: 16.1628, Neg_dist: 23.7109, Acc: 0.9000, PTFixPNLoss: 4.3689, NetFixLoss: 12.5647, ]
2022-11-05 04:59:58,825 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1788, Pos_dist: 16.0322, Neg_dist: 24.7112, Acc: 0.8800, PTFixPNLoss: 4.3667, NetFixLoss: 16.0013, ]
2022-11-05 04:59:59,806 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2986, Pos_dist: 15.5310, Neg_dist: 21.2053, Acc: 0.9400, PTFixPNLoss: 4.3638, NetFixLoss: 19.4945, ]
2022-11-05 05:00:00,926 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2560, Pos_dist: 15.5960, Neg_dist: 24.8607, Acc: 0.9000, PTFixPNLoss: 4.3637, NetFixLoss: 22.9709, ]
2022-11-05 05:00:02,215 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0991, Pos_dist: 15.4417, Neg_dist: 24.3813, Acc: 0.9200, PTFixPNLoss: 4.3598, NetFixLoss: 26.3383, ]
2022-11-05 05:00:02,374 INFO: fine-tune procedure is finished!
2022-11-05 05:00:42,558 INFO: [Test_acc of task 1 on test 0: 0.70251][acc of former classes: 0.73883][acc of former samples in all classes: 0.72591]
[acc of novel samples in all classes: 0.46237]
2022-11-05 05:00:42,846 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:00:42,874 WARNING: Current net - loaded net:
2022-11-05 05:00:42,875 WARNING: Loaded net - current net:
2022-11-05 05:00:42,875 WARNING:   func.classifier.bias
2022-11-05 05:00:42,875 WARNING:   func.classifier.weight
2022-11-05 05:00:42,888 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_1.pth.
2022-11-05 05:00:42,953 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:00:42,976 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:00:42,977 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:00:42,977 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:00:42,978 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:00:42,979 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:00:42,980 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:00:42,980 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:00:42,980 INFO: Model [FSLLModel] is created.
2022-11-05 05:00:42,984 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:00:42,988 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_1.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
2022-11-05 05:00:44,241 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0760, Pos_dist: 15.9878, Neg_dist: 25.3382, Acc: 0.9300, PTFixPNLoss: 4.4670, NetFixLoss: 0.0000, ]
2022-11-05 05:00:46,732 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4242, Pos_dist: 16.0081, Neg_dist: 22.0363, Acc: 0.8900, PTFixPNLoss: 4.4675, NetFixLoss: 0.6359, ]
2022-11-05 05:00:48,170 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2331, Pos_dist: 15.7716, Neg_dist: 23.2640, Acc: 0.9500, PTFixPNLoss: 4.4602, NetFixLoss: 2.4919, ]
2022-11-05 05:00:49,290 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2939, Pos_dist: 15.8373, Neg_dist: 23.6354, Acc: 0.9100, PTFixPNLoss: 4.4630, NetFixLoss: 4.8218, ]
2022-11-05 05:00:50,493 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1609, Pos_dist: 15.7928, Neg_dist: 23.8547, Acc: 0.9300, PTFixPNLoss: 4.4653, NetFixLoss: 7.4025, ]
2022-11-05 05:00:51,870 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1677, Pos_dist: 15.7166, Neg_dist: 23.1718, Acc: 0.9600, PTFixPNLoss: 4.4577, NetFixLoss: 10.1901, ]
2022-11-05 05:00:53,289 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2002, Pos_dist: 15.7548, Neg_dist: 24.4307, Acc: 0.9200, PTFixPNLoss: 4.4574, NetFixLoss: 12.9216, ]
2022-11-05 05:00:54,921 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.6109, Pos_dist: 15.5665, Neg_dist: 21.5732, Acc: 0.9500, PTFixPNLoss: 4.4549, NetFixLoss: 15.6286, ]
2022-11-05 05:00:56,336 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0726, Pos_dist: 15.7452, Neg_dist: 25.4638, Acc: 0.9400, PTFixPNLoss: 4.4584, NetFixLoss: 18.3308, ]
2022-11-05 05:00:57,673 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1456, Pos_dist: 15.5493, Neg_dist: 23.8719, Acc: 0.9200, PTFixPNLoss: 4.4518, NetFixLoss: 21.0434, ]
2022-11-05 05:00:57,796 INFO: fine-tune procedure is finished!
2022-11-05 05:01:42,040 INFO: [Test_acc of task 2 on test 0: 0.64781][acc of former classes: 0.71578][acc of former samples in all classes: 0.69658]
[acc of novel samples in all classes: 0.40106]
2022-11-05 05:01:42,388 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:01:42,419 WARNING: Current net - loaded net:
2022-11-05 05:01:42,419 WARNING: Loaded net - current net:
2022-11-05 05:01:42,419 WARNING:   func.classifier.bias
2022-11-05 05:01:42,419 WARNING:   func.classifier.weight
2022-11-05 05:01:42,430 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_2.pth.
2022-11-05 05:01:42,472 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:01:42,490 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:01:42,490 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:01:42,490 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:01:42,490 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:01:42,490 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:01:42,490 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:01:42,491 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:01:42,492 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:01:42,493 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:01:42,493 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:01:42,493 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:01:42,493 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:01:42,493 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:01:42,493 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:01:42,493 INFO: Model [FSLLModel] is created.
2022-11-05 05:01:42,496 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:01:42,499 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:01:42,501 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_2.pth
Trainset classes:
[128, 129, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129]
2022-11-05 05:01:43,970 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0239, Pos_dist: 15.8495, Neg_dist: 27.8537, Acc: 0.9333, PTFixPNLoss: 4.5639, NetFixLoss: 0.0000, ]
2022-11-05 05:01:45,814 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.7439, Pos_dist: 15.7769, Neg_dist: 20.9329, Acc: 0.9133, PTFixPNLoss: 4.5611, NetFixLoss: 0.2871, ]
2022-11-05 05:01:47,566 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.6584, Pos_dist: 15.8204, Neg_dist: 21.1864, Acc: 0.9333, PTFixPNLoss: 4.5575, NetFixLoss: 2.2618, ]
2022-11-05 05:01:49,302 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0864, Pos_dist: 15.7075, Neg_dist: 24.8487, Acc: 0.9200, PTFixPNLoss: 4.5578, NetFixLoss: 5.1305, ]
2022-11-05 05:01:50,996 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4850, Pos_dist: 15.9700, Neg_dist: 21.9696, Acc: 0.9200, PTFixPNLoss: 4.5653, NetFixLoss: 8.1048, ]
2022-11-05 05:01:52,719 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3932, Pos_dist: 15.9213, Neg_dist: 22.4129, Acc: 0.9400, PTFixPNLoss: 4.5646, NetFixLoss: 11.1075, ]
2022-11-05 05:01:55,663 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.4231, Pos_dist: 15.7561, Neg_dist: 22.8221, Acc: 0.9200, PTFixPNLoss: 4.5602, NetFixLoss: 14.2114, ]
2022-11-05 05:01:57,270 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1637, Pos_dist: 15.6293, Neg_dist: 23.1079, Acc: 0.9533, PTFixPNLoss: 4.5564, NetFixLoss: 17.4438, ]
2022-11-05 05:01:59,066 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3678, Pos_dist: 15.6303, Neg_dist: 21.9683, Acc: 0.9467, PTFixPNLoss: 4.5586, NetFixLoss: 20.6225, ]
2022-11-05 05:02:00,788 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2923, Pos_dist: 15.5832, Neg_dist: 22.8099, Acc: 0.9400, PTFixPNLoss: 4.5522, NetFixLoss: 23.6410, ]
2022-11-05 05:02:00,912 INFO: fine-tune procedure is finished!
2022-11-05 05:02:47,582 INFO: [Test_acc of task 3 on test 0: 0.58530][acc of former classes: 0.67528][acc of former samples in all classes: 0.64735]
[acc of novel samples in all classes: 0.37963]
2022-11-05 05:02:47,906 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:02:47,948 WARNING: Current net - loaded net:
2022-11-05 05:02:47,948 WARNING: Loaded net - current net:
2022-11-05 05:02:47,948 WARNING:   func.classifier.bias
2022-11-05 05:02:47,948 WARNING:   func.classifier.weight
2022-11-05 05:02:47,959 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_3.pth.
2022-11-05 05:02:47,996 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:02:48,017 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:02:48,017 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:02:48,017 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:02:48,018 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:02:48,018 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:02:48,018 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:02:48,018 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:02:48,018 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:02:48,018 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:02:48,018 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:02:48,018 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:02:48,018 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:02:48,018 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:02:48,018 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:02:48,018 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:02:48,019 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:02:48,020 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:02:48,021 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:02:48,021 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:02:48,021 INFO: Model [FSLLModel] is created.
2022-11-05 05:02:48,024 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:02:48,026 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:02:48,029 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:02:48,031 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_3.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-05 05:02:50,085 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3305, Pos_dist: 15.8735, Neg_dist: 22.4324, Acc: 0.9200, PTFixPNLoss: 4.6390, NetFixLoss: 0.0000, ]
2022-11-05 05:02:53,497 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3679, Pos_dist: 15.3645, Neg_dist: 21.9077, Acc: 0.9350, PTFixPNLoss: 4.6251, NetFixLoss: 1.5269, ]
2022-11-05 05:02:55,852 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3723, Pos_dist: 15.6302, Neg_dist: 22.8126, Acc: 0.9000, PTFixPNLoss: 4.6322, NetFixLoss: 3.3856, ]
2022-11-05 05:02:57,867 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.4133, Pos_dist: 15.7878, Neg_dist: 22.4657, Acc: 0.9300, PTFixPNLoss: 4.6314, NetFixLoss: 5.5551, ]
2022-11-05 05:02:59,794 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1876, Pos_dist: 15.4060, Neg_dist: 23.9906, Acc: 0.9500, PTFixPNLoss: 4.6261, NetFixLoss: 8.0760, ]
2022-11-05 05:03:01,953 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4259, Pos_dist: 15.3796, Neg_dist: 21.6574, Acc: 0.9500, PTFixPNLoss: 4.6253, NetFixLoss: 10.7208, ]
2022-11-05 05:03:03,894 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.6455, Pos_dist: 15.2871, Neg_dist: 20.3304, Acc: 0.9350, PTFixPNLoss: 4.6247, NetFixLoss: 13.4084, ]
2022-11-05 05:03:05,925 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3369, Pos_dist: 15.2386, Neg_dist: 22.1311, Acc: 0.9400, PTFixPNLoss: 4.6200, NetFixLoss: 16.2867, ]
2022-11-05 05:03:08,109 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4199, Pos_dist: 15.2743, Neg_dist: 21.4879, Acc: 0.9250, PTFixPNLoss: 4.6265, NetFixLoss: 19.2961, ]
2022-11-05 05:03:10,283 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4866, Pos_dist: 15.2170, Neg_dist: 21.0907, Acc: 0.9150, PTFixPNLoss: 4.6226, NetFixLoss: 22.3347, ]
2022-11-05 05:03:10,436 INFO: fine-tune procedure is finished!
2022-11-05 05:04:00,398 INFO: [Test_acc of task 4 on test 0: 0.56629][acc of former classes: 0.68017][acc of former samples in all classes: 0.64001]
[acc of novel samples in all classes: 0.38488]
2022-11-05 05:04:00,696 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:04:00,723 WARNING: Current net - loaded net:
2022-11-05 05:04:00,724 WARNING: Loaded net - current net:
2022-11-05 05:04:00,724 WARNING:   func.classifier.bias
2022-11-05 05:04:00,724 WARNING:   func.classifier.weight
2022-11-05 05:04:00,732 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_4.pth.
2022-11-05 05:04:00,760 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:04:00,776 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:04:00,776 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:04:00,777 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:04:00,778 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:04:00,779 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:04:00,779 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:04:00,779 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:04:00,779 INFO: Model [FSLLModel] is created.
2022-11-05 05:04:00,782 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:04:00,785 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:04:00,787 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:04:00,789 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:04:00,791 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_4.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149]
2022-11-05 05:04:03,022 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.4044, Pos_dist: 15.3190, Neg_dist: 21.4954, Acc: 0.8920, PTFixPNLoss: 4.6893, NetFixLoss: 0.0000, ]
2022-11-05 05:04:05,351 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1861, Pos_dist: 15.5686, Neg_dist: 24.4560, Acc: 0.9000, PTFixPNLoss: 4.6934, NetFixLoss: 1.4736, ]
2022-11-05 05:04:07,799 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2119, Pos_dist: 15.2030, Neg_dist: 22.9201, Acc: 0.9200, PTFixPNLoss: 4.6854, NetFixLoss: 3.1136, ]
2022-11-05 05:04:10,251 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2580, Pos_dist: 15.3388, Neg_dist: 22.6543, Acc: 0.8880, PTFixPNLoss: 4.6916, NetFixLoss: 5.0386, ]
2022-11-05 05:04:12,691 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3479, Pos_dist: 15.4952, Neg_dist: 22.1537, Acc: 0.9120, PTFixPNLoss: 4.6916, NetFixLoss: 7.1087, ]
2022-11-05 05:04:15,185 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4604, Pos_dist: 15.5267, Neg_dist: 21.9651, Acc: 0.9040, PTFixPNLoss: 4.6944, NetFixLoss: 9.3988, ]
2022-11-05 05:04:17,477 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1437, Pos_dist: 15.4999, Neg_dist: 23.1533, Acc: 0.9080, PTFixPNLoss: 4.6931, NetFixLoss: 11.9009, ]
2022-11-05 05:04:20,092 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2410, Pos_dist: 15.2102, Neg_dist: 22.3202, Acc: 0.9200, PTFixPNLoss: 4.6808, NetFixLoss: 14.4091, ]
2022-11-05 05:04:22,672 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0427, Pos_dist: 15.2476, Neg_dist: 25.8910, Acc: 0.9320, PTFixPNLoss: 4.6860, NetFixLoss: 16.9167, ]
2022-11-05 05:04:25,250 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2983, Pos_dist: 15.4220, Neg_dist: 22.4664, Acc: 0.9280, PTFixPNLoss: 4.6885, NetFixLoss: 19.3104, ]
2022-11-05 05:04:25,424 INFO: fine-tune procedure is finished!
2022-11-05 05:05:18,479 INFO: [Test_acc of task 5 on test 0: 0.54415][acc of former classes: 0.68017][acc of former samples in all classes: 0.63652]
[acc of novel samples in all classes: 0.36320]
2022-11-05 05:05:18,851 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:05:18,890 WARNING: Current net - loaded net:
2022-11-05 05:05:18,890 WARNING: Loaded net - current net:
2022-11-05 05:05:18,890 WARNING:   func.classifier.bias
2022-11-05 05:05:18,890 WARNING:   func.classifier.weight
2022-11-05 05:05:18,901 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_5.pth.
2022-11-05 05:05:18,939 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:05:18,963 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:05:18,964 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:05:18,964 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:05:18,965 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:05:18,966 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:05:18,967 INFO: Model [FSLLModel] is created.
2022-11-05 05:05:18,971 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:05:18,974 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:05:18,978 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:05:18,981 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:05:18,984 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:05:18,987 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_5.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
2022-11-05 05:05:21,909 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3094, Pos_dist: 15.3219, Neg_dist: 22.1383, Acc: 0.9233, PTFixPNLoss: 4.7545, NetFixLoss: 0.0000, ]
2022-11-05 05:05:24,562 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3851, Pos_dist: 15.3667, Neg_dist: 21.3574, Acc: 0.9100, PTFixPNLoss: 4.7551, NetFixLoss: 1.3097, ]
2022-11-05 05:05:27,448 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1817, Pos_dist: 15.2748, Neg_dist: 23.1447, Acc: 0.9200, PTFixPNLoss: 4.7524, NetFixLoss: 3.0649, ]
2022-11-05 05:05:30,344 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3752, Pos_dist: 15.3232, Neg_dist: 21.8028, Acc: 0.9067, PTFixPNLoss: 4.7545, NetFixLoss: 4.9830, ]
2022-11-05 05:05:33,140 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1353, Pos_dist: 15.1953, Neg_dist: 23.0056, Acc: 0.9100, PTFixPNLoss: 4.7500, NetFixLoss: 7.1418, ]
2022-11-05 05:05:36,072 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4396, Pos_dist: 15.5918, Neg_dist: 21.4858, Acc: 0.8733, PTFixPNLoss: 4.7621, NetFixLoss: 9.3832, ]
2022-11-05 05:05:38,965 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1103, Pos_dist: 15.1629, Neg_dist: 23.7767, Acc: 0.9067, PTFixPNLoss: 4.7486, NetFixLoss: 11.7052, ]
2022-11-05 05:05:41,647 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1344, Pos_dist: 15.5024, Neg_dist: 23.6145, Acc: 0.9133, PTFixPNLoss: 4.7588, NetFixLoss: 14.0869, ]
2022-11-05 05:05:44,820 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1738, Pos_dist: 15.3338, Neg_dist: 23.5719, Acc: 0.9167, PTFixPNLoss: 4.7524, NetFixLoss: 16.3843, ]
2022-11-05 05:05:47,680 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0544, Pos_dist: 15.4110, Neg_dist: 25.7136, Acc: 0.9233, PTFixPNLoss: 4.7515, NetFixLoss: 18.6022, ]
2022-11-05 05:05:47,815 INFO: fine-tune procedure is finished!
2022-11-05 05:06:42,359 INFO: [Test_acc of task 6 on test 0: 0.53078][acc of former classes: 0.68575][acc of former samples in all classes: 0.62954]
[acc of novel samples in all classes: 0.36914]
2022-11-05 05:06:42,706 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:06:42,744 WARNING: Current net - loaded net:
2022-11-05 05:06:42,745 WARNING: Loaded net - current net:
2022-11-05 05:06:42,745 WARNING:   func.classifier.bias
2022-11-05 05:06:42,745 WARNING:   func.classifier.weight
2022-11-05 05:06:42,756 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_6.pth.
2022-11-05 05:06:42,790 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:06:42,807 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:06:42,807 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:06:42,807 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:06:42,808 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:06:42,809 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:06:42,809 INFO: Model [FSLLModel] is created.
2022-11-05 05:06:42,815 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:06:42,818 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:06:42,820 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:06:42,822 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:06:42,824 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:06:42,826 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:06:42,828 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_6.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-05 05:06:45,738 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0637, Pos_dist: 15.3361, Neg_dist: 24.9340, Acc: 0.9029, PTFixPNLoss: 4.8171, NetFixLoss: 0.0000, ]
2022-11-05 05:06:49,276 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0205, Pos_dist: 15.1722, Neg_dist: 26.6439, Acc: 0.9200, PTFixPNLoss: 4.8124, NetFixLoss: 0.4316, ]
2022-11-05 05:06:52,545 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1597, Pos_dist: 15.2801, Neg_dist: 22.9131, Acc: 0.9171, PTFixPNLoss: 4.8199, NetFixLoss: 0.9133, ]
2022-11-05 05:06:55,693 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3718, Pos_dist: 15.2458, Neg_dist: 21.7082, Acc: 0.9057, PTFixPNLoss: 4.8162, NetFixLoss: 1.7902, ]
2022-11-05 05:06:58,725 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1992, Pos_dist: 15.2822, Neg_dist: 22.8225, Acc: 0.9171, PTFixPNLoss: 4.8150, NetFixLoss: 3.1178, ]
2022-11-05 05:07:02,004 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2043, Pos_dist: 15.2167, Neg_dist: 22.8404, Acc: 0.9200, PTFixPNLoss: 4.8134, NetFixLoss: 4.6676, ]
2022-11-05 05:07:05,265 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0900, Pos_dist: 15.4434, Neg_dist: 24.1142, Acc: 0.8829, PTFixPNLoss: 4.8192, NetFixLoss: 6.3536, ]
2022-11-05 05:07:08,355 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0949, Pos_dist: 15.2891, Neg_dist: 24.5067, Acc: 0.8886, PTFixPNLoss: 4.8123, NetFixLoss: 8.0814, ]
2022-11-05 05:07:12,216 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3227, Pos_dist: 15.0427, Neg_dist: 22.1831, Acc: 0.8657, PTFixPNLoss: 4.8137, NetFixLoss: 9.7901, ]
2022-11-05 05:07:15,729 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1581, Pos_dist: 15.1750, Neg_dist: 25.3438, Acc: 0.9086, PTFixPNLoss: 4.8144, NetFixLoss: 11.5137, ]
2022-11-05 05:07:16,029 INFO: fine-tune procedure is finished!
2022-11-05 05:08:13,079 INFO: [Test_acc of task 7 on test 0: 0.51863][acc of former classes: 0.68226][acc of former samples in all classes: 0.60754]
[acc of novel samples in all classes: 0.39424]
2022-11-05 05:08:13,395 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:08:13,430 WARNING: Current net - loaded net:
2022-11-05 05:08:13,430 WARNING: Loaded net - current net:
2022-11-05 05:08:13,430 WARNING:   func.classifier.bias
2022-11-05 05:08:13,430 WARNING:   func.classifier.weight
2022-11-05 05:08:13,439 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_7.pth.
2022-11-05 05:08:13,472 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:08:13,490 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:08:13,490 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:08:13,490 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:08:13,490 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:08:13,490 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:08:13,491 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:08:13,491 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:08:13,491 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:08:13,491 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:08:13,491 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:08:13,491 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:08:13,491 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:08:13,492 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:08:13,493 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:08:13,494 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:08:13,494 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:08:13,494 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:08:13,494 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:08:13,494 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:08:13,494 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:08:13,494 INFO: Model [FSLLModel] is created.
2022-11-05 05:08:13,497 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:08:13,500 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:08:13,503 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:08:13,505 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:08:13,508 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:08:13,510 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:08:13,513 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:08:13,516 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_7.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
2022-11-05 05:08:17,030 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0756, Pos_dist: 15.2331, Neg_dist: 24.2607, Acc: 0.9025, PTFixPNLoss: 4.8787, NetFixLoss: 0.0000, ]
2022-11-05 05:08:20,773 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2324, Pos_dist: 15.1875, Neg_dist: 22.7815, Acc: 0.8825, PTFixPNLoss: 4.8785, NetFixLoss: 0.5193, ]
2022-11-05 05:08:24,658 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0680, Pos_dist: 15.1381, Neg_dist: 25.3195, Acc: 0.8875, PTFixPNLoss: 4.8776, NetFixLoss: 1.5377, ]
2022-11-05 05:08:28,250 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3547, Pos_dist: 15.1704, Neg_dist: 21.5847, Acc: 0.9075, PTFixPNLoss: 4.8751, NetFixLoss: 2.6547, ]
2022-11-05 05:08:31,744 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1810, Pos_dist: 15.2230, Neg_dist: 22.5030, Acc: 0.9100, PTFixPNLoss: 4.8789, NetFixLoss: 3.9734, ]
2022-11-05 05:08:35,382 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2508, Pos_dist: 15.2522, Neg_dist: 22.5624, Acc: 0.9050, PTFixPNLoss: 4.8809, NetFixLoss: 5.5689, ]
2022-11-05 05:08:38,897 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2252, Pos_dist: 15.2161, Neg_dist: 22.2668, Acc: 0.9175, PTFixPNLoss: 4.8786, NetFixLoss: 7.3158, ]
2022-11-05 05:08:42,461 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2429, Pos_dist: 15.1495, Neg_dist: 22.8213, Acc: 0.8800, PTFixPNLoss: 4.8773, NetFixLoss: 9.2032, ]
2022-11-05 05:08:45,990 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0144, Pos_dist: 15.1817, Neg_dist: 26.5481, Acc: 0.9075, PTFixPNLoss: 4.8771, NetFixLoss: 11.1721, ]
2022-11-05 05:08:49,792 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1776, Pos_dist: 15.1986, Neg_dist: 23.1604, Acc: 0.8975, PTFixPNLoss: 4.8773, NetFixLoss: 13.0936, ]
2022-11-05 05:08:49,896 INFO: fine-tune procedure is finished!
2022-11-05 05:09:49,319 INFO: [Test_acc of task 8 on test 0: 0.49846][acc of former classes: 0.67668][acc of former samples in all classes: 0.59777]
[acc of novel samples in all classes: 0.37703]
2022-11-05 05:09:49,616 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:09:49,644 WARNING: Current net - loaded net:
2022-11-05 05:09:49,644 WARNING: Loaded net - current net:
2022-11-05 05:09:49,644 WARNING:   func.classifier.bias
2022-11-05 05:09:49,644 WARNING:   func.classifier.weight
2022-11-05 05:09:49,653 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_8.pth.
2022-11-05 05:09:49,684 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:09:49,766 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:09:49,766 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:09:49,766 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:09:49,766 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:09:49,766 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:09:49,766 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:09:49,767 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:09:49,767 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:09:49,767 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:09:49,767 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:09:49,767 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:09:49,767 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:09:49,767 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:09:49,767 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:09:49,767 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:09:49,767 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:09:49,767 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:09:49,768 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:09:49,769 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:09:49,770 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:09:49,771 INFO: Model [FSLLModel] is created.
2022-11-05 05:09:49,780 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,783 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,787 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,790 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,793 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,797 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,800 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,804 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:09:49,807 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_8.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
2022-11-05 05:09:53,453 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0412, Pos_dist: 15.2376, Neg_dist: 27.2868, Acc: 0.8778, PTFixPNLoss: 4.9347, NetFixLoss: 0.0000, ]
2022-11-05 05:09:57,495 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2645, Pos_dist: 15.1154, Neg_dist: 22.0190, Acc: 0.9044, PTFixPNLoss: 4.9308, NetFixLoss: 0.3125, ]
2022-11-05 05:10:01,817 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2095, Pos_dist: 15.0992, Neg_dist: 22.3961, Acc: 0.8911, PTFixPNLoss: 4.9315, NetFixLoss: 1.1946, ]
2022-11-05 05:10:05,885 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1310, Pos_dist: 15.0664, Neg_dist: 22.9963, Acc: 0.8867, PTFixPNLoss: 4.9336, NetFixLoss: 2.4544, ]
2022-11-05 05:10:09,761 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3623, Pos_dist: 15.1774, Neg_dist: 21.8059, Acc: 0.9133, PTFixPNLoss: 4.9332, NetFixLoss: 3.8841, ]
2022-11-05 05:10:13,762 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1369, Pos_dist: 15.1174, Neg_dist: 23.5374, Acc: 0.9111, PTFixPNLoss: 4.9325, NetFixLoss: 5.6326, ]
2022-11-05 05:10:17,633 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1543, Pos_dist: 15.1655, Neg_dist: 22.8678, Acc: 0.9089, PTFixPNLoss: 4.9335, NetFixLoss: 7.5471, ]
2022-11-05 05:10:21,257 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1710, Pos_dist: 15.2511, Neg_dist: 23.1437, Acc: 0.9000, PTFixPNLoss: 4.9353, NetFixLoss: 9.4766, ]
2022-11-05 05:10:25,167 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0757, Pos_dist: 14.9726, Neg_dist: 24.0062, Acc: 0.9044, PTFixPNLoss: 4.9293, NetFixLoss: 11.4336, ]
2022-11-05 05:10:29,112 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0660, Pos_dist: 15.2072, Neg_dist: 24.6762, Acc: 0.8978, PTFixPNLoss: 4.9314, NetFixLoss: 13.3296, ]
2022-11-05 05:10:29,319 INFO: fine-tune procedure is finished!
2022-11-05 05:11:31,850 INFO: [Test_acc of task 9 on test 0: 0.49909][acc of former classes: 0.67633][acc of former samples in all classes: 0.59253]
[acc of novel samples in all classes: 0.39734]
2022-11-05 05:11:32,153 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:11:32,183 WARNING: Current net - loaded net:
2022-11-05 05:11:32,183 WARNING: Loaded net - current net:
2022-11-05 05:11:32,183 WARNING:   func.classifier.bias
2022-11-05 05:11:32,183 WARNING:   func.classifier.weight
2022-11-05 05:11:32,192 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_9.pth.
2022-11-05 05:11:32,228 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:11:32,292 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:11:32,301 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:11:32,301 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:11:32,302 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:11:32,303 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:11:32,304 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:11:32,304 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:11:32,304 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:11:32,304 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:11:32,304 INFO: Model [FSLLModel] is created.
2022-11-05 05:11:32,315 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,319 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,323 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,326 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,329 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,333 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,336 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,339 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,343 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:11:32,346 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_9.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-05 05:11:36,276 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1939, Pos_dist: 15.0332, Neg_dist: 22.6321, Acc: 0.9060, PTFixPNLoss: 4.9833, NetFixLoss: 0.0000, ]
2022-11-05 05:11:40,561 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2220, Pos_dist: 15.1417, Neg_dist: 22.4990, Acc: 0.9120, PTFixPNLoss: 4.9846, NetFixLoss: 0.9370, ]
2022-11-05 05:11:45,012 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2755, Pos_dist: 15.1540, Neg_dist: 21.9483, Acc: 0.8900, PTFixPNLoss: 4.9849, NetFixLoss: 2.1410, ]
2022-11-05 05:11:49,625 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3061, Pos_dist: 15.0839, Neg_dist: 22.3358, Acc: 0.8880, PTFixPNLoss: 4.9837, NetFixLoss: 3.6803, ]
2022-11-05 05:11:54,011 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2611, Pos_dist: 15.1144, Neg_dist: 21.9224, Acc: 0.9000, PTFixPNLoss: 4.9827, NetFixLoss: 5.3784, ]
2022-11-05 05:11:58,276 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3391, Pos_dist: 15.1791, Neg_dist: 23.4157, Acc: 0.8920, PTFixPNLoss: 4.9854, NetFixLoss: 7.2341, ]
2022-11-05 05:12:02,952 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2327, Pos_dist: 15.1453, Neg_dist: 22.5234, Acc: 0.9100, PTFixPNLoss: 4.9840, NetFixLoss: 9.1579, ]
2022-11-05 05:12:06,872 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1399, Pos_dist: 14.9994, Neg_dist: 23.4557, Acc: 0.8940, PTFixPNLoss: 4.9836, NetFixLoss: 11.0884, ]
2022-11-05 05:12:11,395 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2591, Pos_dist: 15.1630, Neg_dist: 22.2166, Acc: 0.8960, PTFixPNLoss: 4.9869, NetFixLoss: 12.9888, ]
2022-11-05 05:12:15,614 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1579, Pos_dist: 15.1829, Neg_dist: 23.9182, Acc: 0.8880, PTFixPNLoss: 4.9874, NetFixLoss: 14.8472, ]
2022-11-05 05:12:15,787 INFO: fine-tune procedure is finished!
2022-11-05 05:13:20,196 INFO: [Test_acc of task 10 on test 0: 0.48792][acc of former classes: 0.67877][acc of former samples in all classes: 0.58520]
[acc of novel samples in all classes: 0.39283]
2022-11-05 05:13:20,614 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:13:20,652 WARNING: Current net - loaded net:
2022-11-05 05:13:20,652 WARNING: Loaded net - current net:
2022-11-05 05:13:20,652 WARNING:   func.classifier.bias
2022-11-05 05:13:20,652 WARNING:   func.classifier.weight
2022-11-05 05:13:20,661 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth.
2022-11-05 05:13:20,690 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:13:20,712 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:13:20,713 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:13:20,713 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:13:20,713 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:13:20,714 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:13:20,715 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:13:20,716 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:13:20,716 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:13:20,716 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:13:20,716 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:13:20,716 INFO: Model [FSLLModel] is created.
2022-11-05 05:13:20,720 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-05 05:13:21,470 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3642, Pos_dist: 16.4732, Neg_dist: 23.5033, Acc: 0.8600, PTFixPNLoss: 4.3914, NetFixLoss: 0.0000, ]
2022-11-05 05:13:22,460 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2498, Pos_dist: 15.9200, Neg_dist: 23.0404, Acc: 0.8800, PTFixPNLoss: 4.3781, NetFixLoss: 1.9104, ]
2022-11-05 05:13:23,442 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.8273, Pos_dist: 16.3770, Neg_dist: 21.7838, Acc: 0.8800, PTFixPNLoss: 4.3842, NetFixLoss: 4.2863, ]
2022-11-05 05:13:24,669 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2443, Pos_dist: 16.2627, Neg_dist: 22.9652, Acc: 0.9000, PTFixPNLoss: 4.3842, NetFixLoss: 7.3478, ]
2022-11-05 05:13:25,624 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2228, Pos_dist: 15.9590, Neg_dist: 22.5914, Acc: 0.8600, PTFixPNLoss: 4.3803, NetFixLoss: 10.7277, ]
2022-11-05 05:13:26,577 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1307, Pos_dist: 16.0057, Neg_dist: 23.7186, Acc: 0.9600, PTFixPNLoss: 4.3736, NetFixLoss: 14.1102, ]
2022-11-05 05:13:27,677 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2376, Pos_dist: 15.8142, Neg_dist: 23.1400, Acc: 0.9200, PTFixPNLoss: 4.3691, NetFixLoss: 17.5866, ]
2022-11-05 05:13:28,728 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1153, Pos_dist: 15.7090, Neg_dist: 24.2571, Acc: 0.9200, PTFixPNLoss: 4.3666, NetFixLoss: 20.9089, ]
2022-11-05 05:13:29,663 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2163, Pos_dist: 15.9416, Neg_dist: 23.8667, Acc: 0.8800, PTFixPNLoss: 4.3725, NetFixLoss: 24.1597, ]
2022-11-05 05:13:30,765 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4484, Pos_dist: 15.7857, Neg_dist: 22.3926, Acc: 0.9000, PTFixPNLoss: 4.3682, NetFixLoss: 27.2426, ]
2022-11-05 05:13:30,945 INFO: fine-tune procedure is finished!
2022-11-05 05:14:11,929 INFO: [Test_acc of task 1 on test 1: 0.71110][acc of former classes: 0.74197][acc of former samples in all classes: 0.73394]
[acc of novel samples in all classes: 0.47670]
2022-11-05 05:14:12,366 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:14:12,411 WARNING: Current net - loaded net:
2022-11-05 05:14:12,411 WARNING: Loaded net - current net:
2022-11-05 05:14:12,411 WARNING:   func.classifier.bias
2022-11-05 05:14:12,411 WARNING:   func.classifier.weight
2022-11-05 05:14:12,423 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_1.pth.
2022-11-05 05:14:12,456 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:14:12,473 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:14:12,474 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:14:12,474 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:14:12,474 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:14:12,474 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:14:12,474 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:14:12,474 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:14:12,474 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:14:12,474 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:14:12,474 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:14:12,475 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:14:12,476 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:14:12,476 INFO: Model [FSLLModel] is created.
2022-11-05 05:14:12,481 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:14:12,484 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_1.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
2022-11-05 05:14:13,637 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3750, Pos_dist: 15.6748, Neg_dist: 22.3404, Acc: 0.9500, PTFixPNLoss: 4.4739, NetFixLoss: 0.0000, ]
2022-11-05 05:14:14,728 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3283, Pos_dist: 15.9888, Neg_dist: 22.2371, Acc: 0.9200, PTFixPNLoss: 4.4744, NetFixLoss: 1.8066, ]
2022-11-05 05:14:16,007 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.8234, Pos_dist: 16.0966, Neg_dist: 22.4931, Acc: 0.8800, PTFixPNLoss: 4.4758, NetFixLoss: 4.0978, ]
2022-11-05 05:14:17,343 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2438, Pos_dist: 15.9479, Neg_dist: 23.1774, Acc: 0.9400, PTFixPNLoss: 4.4720, NetFixLoss: 6.8674, ]
2022-11-05 05:14:18,738 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1496, Pos_dist: 16.0163, Neg_dist: 24.6129, Acc: 0.8900, PTFixPNLoss: 4.4742, NetFixLoss: 9.8477, ]
2022-11-05 05:14:20,187 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2014, Pos_dist: 15.7095, Neg_dist: 24.0420, Acc: 0.9400, PTFixPNLoss: 4.4699, NetFixLoss: 12.7986, ]
2022-11-05 05:14:21,512 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1737, Pos_dist: 15.8563, Neg_dist: 24.1830, Acc: 0.9100, PTFixPNLoss: 4.4714, NetFixLoss: 15.6511, ]
2022-11-05 05:14:22,686 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4138, Pos_dist: 15.5233, Neg_dist: 21.2996, Acc: 0.9100, PTFixPNLoss: 4.4645, NetFixLoss: 18.4720, ]
2022-11-05 05:14:23,898 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.6232, Pos_dist: 16.1747, Neg_dist: 22.8748, Acc: 0.8800, PTFixPNLoss: 4.4760, NetFixLoss: 21.2115, ]
2022-11-05 05:14:25,301 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2717, Pos_dist: 15.8778, Neg_dist: 22.6380, Acc: 0.9400, PTFixPNLoss: 4.4710, NetFixLoss: 23.9684, ]
2022-11-05 05:14:25,404 INFO: fine-tune procedure is finished!
2022-11-05 05:15:07,644 INFO: [Test_acc of task 2 on test 1: 0.64898][acc of former classes: 0.71578][acc of former samples in all classes: 0.69832]
[acc of novel samples in all classes: 0.39929]
2022-11-05 05:15:07,998 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:15:08,028 WARNING: Current net - loaded net:
2022-11-05 05:15:08,028 WARNING: Loaded net - current net:
2022-11-05 05:15:08,028 WARNING:   func.classifier.bias
2022-11-05 05:15:08,028 WARNING:   func.classifier.weight
2022-11-05 05:15:08,037 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_2.pth.
2022-11-05 05:15:08,068 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:15:08,082 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:15:08,082 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:15:08,082 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:15:08,082 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:15:08,082 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:15:08,082 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:15:08,083 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:15:08,083 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:15:08,083 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:15:08,083 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:15:08,083 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:15:08,083 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:15:08,084 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:15:08,085 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:15:08,085 INFO: Model [FSLLModel] is created.
2022-11-05 05:15:08,088 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:15:08,090 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:15:08,092 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_2.pth
Trainset classes:
[128, 129, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129]
2022-11-05 05:15:09,772 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.5364, Pos_dist: 15.7707, Neg_dist: 21.5780, Acc: 0.9333, PTFixPNLoss: 4.5665, NetFixLoss: 0.0000, ]
2022-11-05 05:15:11,472 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4991, Pos_dist: 15.8575, Neg_dist: 22.3101, Acc: 0.8933, PTFixPNLoss: 4.5615, NetFixLoss: 2.0693, ]
2022-11-05 05:15:13,318 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2335, Pos_dist: 15.9371, Neg_dist: 23.8400, Acc: 0.9133, PTFixPNLoss: 4.5638, NetFixLoss: 4.4642, ]
2022-11-05 05:15:15,196 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.7062, Pos_dist: 15.8573, Neg_dist: 20.7752, Acc: 0.9267, PTFixPNLoss: 4.5646, NetFixLoss: 6.9707, ]
2022-11-05 05:15:17,548 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3324, Pos_dist: 15.8383, Neg_dist: 23.0194, Acc: 0.8867, PTFixPNLoss: 4.5627, NetFixLoss: 9.8126, ]
2022-11-05 05:15:19,136 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1203, Pos_dist: 15.7144, Neg_dist: 23.4495, Acc: 0.9467, PTFixPNLoss: 4.5597, NetFixLoss: 12.7624, ]
2022-11-05 05:15:21,068 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2417, Pos_dist: 16.1191, Neg_dist: 23.1663, Acc: 0.9467, PTFixPNLoss: 4.5611, NetFixLoss: 15.7031, ]
2022-11-05 05:15:22,883 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3300, Pos_dist: 15.7125, Neg_dist: 22.4394, Acc: 0.9400, PTFixPNLoss: 4.5566, NetFixLoss: 18.6210, ]
2022-11-05 05:15:24,345 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2194, Pos_dist: 15.6553, Neg_dist: 24.6170, Acc: 0.9067, PTFixPNLoss: 4.5541, NetFixLoss: 21.5652, ]
2022-11-05 05:15:25,978 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1107, Pos_dist: 15.9053, Neg_dist: 24.4189, Acc: 0.9533, PTFixPNLoss: 4.5622, NetFixLoss: 24.4481, ]
2022-11-05 05:15:26,127 INFO: fine-tune procedure is finished!
2022-11-05 05:16:11,374 INFO: [Test_acc of task 3 on test 1: 0.56921][acc of former classes: 0.67109][acc of former samples in all classes: 0.63582]
[acc of novel samples in all classes: 0.34838]
2022-11-05 05:16:11,672 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:16:11,703 WARNING: Current net - loaded net:
2022-11-05 05:16:11,703 WARNING: Loaded net - current net:
2022-11-05 05:16:11,703 WARNING:   func.classifier.bias
2022-11-05 05:16:11,703 WARNING:   func.classifier.weight
2022-11-05 05:16:11,712 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_3.pth.
2022-11-05 05:16:11,740 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:16:11,753 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:16:11,753 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:16:11,753 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:16:11,753 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:16:11,754 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:16:11,755 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:16:11,756 INFO: Model [FSLLModel] is created.
2022-11-05 05:16:11,758 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:16:11,760 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:16:11,763 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:16:11,765 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_3.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-05 05:16:13,514 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.7968, Pos_dist: 15.7781, Neg_dist: 20.5896, Acc: 0.9200, PTFixPNLoss: 4.6359, NetFixLoss: 0.0000, ]
2022-11-05 05:16:15,474 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3832, Pos_dist: 15.9551, Neg_dist: 22.1533, Acc: 0.9100, PTFixPNLoss: 4.6369, NetFixLoss: 2.2105, ]
2022-11-05 05:16:17,698 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3061, Pos_dist: 15.8072, Neg_dist: 22.9589, Acc: 0.8950, PTFixPNLoss: 4.6331, NetFixLoss: 4.6277, ]
2022-11-05 05:16:19,588 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2380, Pos_dist: 15.9316, Neg_dist: 23.2256, Acc: 0.8950, PTFixPNLoss: 4.6340, NetFixLoss: 7.1804, ]
2022-11-05 05:16:21,823 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1109, Pos_dist: 15.4894, Neg_dist: 24.5794, Acc: 0.9350, PTFixPNLoss: 4.6291, NetFixLoss: 9.7570, ]
2022-11-05 05:16:23,698 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1844, Pos_dist: 15.6983, Neg_dist: 25.4345, Acc: 0.9100, PTFixPNLoss: 4.6319, NetFixLoss: 12.2745, ]
2022-11-05 05:16:26,033 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.4950, Pos_dist: 15.6502, Neg_dist: 21.8731, Acc: 0.9300, PTFixPNLoss: 4.6295, NetFixLoss: 14.6920, ]
2022-11-05 05:16:28,412 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.6452, Pos_dist: 15.5012, Neg_dist: 20.8106, Acc: 0.9150, PTFixPNLoss: 4.6273, NetFixLoss: 17.1268, ]
2022-11-05 05:16:30,578 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0477, Pos_dist: 15.5190, Neg_dist: 25.1445, Acc: 0.9150, PTFixPNLoss: 4.6291, NetFixLoss: 19.6743, ]
2022-11-05 05:16:32,606 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4252, Pos_dist: 15.6724, Neg_dist: 22.1731, Acc: 0.9150, PTFixPNLoss: 4.6337, NetFixLoss: 22.2398, ]
2022-11-05 05:16:32,702 INFO: fine-tune procedure is finished!
2022-11-05 05:17:20,773 INFO: [Test_acc of task 4 on test 1: 0.55933][acc of former classes: 0.67318][acc of former samples in all classes: 0.62744]
[acc of novel samples in all classes: 0.39175]
2022-11-05 05:17:21,066 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:17:21,098 WARNING: Current net - loaded net:
2022-11-05 05:17:21,098 WARNING: Loaded net - current net:
2022-11-05 05:17:21,098 WARNING:   func.classifier.bias
2022-11-05 05:17:21,098 WARNING:   func.classifier.weight
2022-11-05 05:17:21,107 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_4.pth.
2022-11-05 05:17:21,135 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:17:21,148 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:17:21,148 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:17:21,148 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:17:21,149 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:17:21,150 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:17:21,150 INFO: Model [FSLLModel] is created.
2022-11-05 05:17:21,153 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:17:21,155 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:17:21,157 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:17:21,159 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:17:21,161 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_4.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149]
2022-11-05 05:17:23,309 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1837, Pos_dist: 15.4914, Neg_dist: 23.7833, Acc: 0.8760, PTFixPNLoss: 4.6968, NetFixLoss: 0.0000, ]
2022-11-05 05:17:25,768 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.5216, Pos_dist: 15.6239, Neg_dist: 21.5949, Acc: 0.8840, PTFixPNLoss: 4.6931, NetFixLoss: 0.9352, ]
2022-11-05 05:17:28,138 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3610, Pos_dist: 15.5372, Neg_dist: 22.2727, Acc: 0.8720, PTFixPNLoss: 4.6903, NetFixLoss: 2.6857, ]
2022-11-05 05:17:30,541 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2154, Pos_dist: 15.5329, Neg_dist: 23.1434, Acc: 0.9160, PTFixPNLoss: 4.6967, NetFixLoss: 4.8728, ]
2022-11-05 05:17:32,943 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1724, Pos_dist: 15.4402, Neg_dist: 23.9523, Acc: 0.9080, PTFixPNLoss: 4.6928, NetFixLoss: 7.3099, ]
2022-11-05 05:17:35,624 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1692, Pos_dist: 15.3736, Neg_dist: 23.5618, Acc: 0.9080, PTFixPNLoss: 4.6891, NetFixLoss: 9.8157, ]
2022-11-05 05:17:38,230 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2732, Pos_dist: 15.4977, Neg_dist: 22.4197, Acc: 0.9040, PTFixPNLoss: 4.6966, NetFixLoss: 12.2570, ]
2022-11-05 05:17:40,529 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3655, Pos_dist: 15.1737, Neg_dist: 22.5046, Acc: 0.8920, PTFixPNLoss: 4.6874, NetFixLoss: 14.6426, ]
2022-11-05 05:17:42,901 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3096, Pos_dist: 15.3994, Neg_dist: 22.2257, Acc: 0.9360, PTFixPNLoss: 4.6864, NetFixLoss: 17.0053, ]
2022-11-05 05:17:45,113 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1954, Pos_dist: 15.3323, Neg_dist: 24.1250, Acc: 0.8960, PTFixPNLoss: 4.6849, NetFixLoss: 19.3577, ]
2022-11-05 05:17:45,252 INFO: fine-tune procedure is finished!
2022-11-05 05:18:36,766 INFO: [Test_acc of task 5 on test 1: 0.54669][acc of former classes: 0.68645][acc of former samples in all classes: 0.63547]
[acc of novel samples in all classes: 0.37278]
2022-11-05 05:18:37,048 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:18:37,076 WARNING: Current net - loaded net:
2022-11-05 05:18:37,077 WARNING: Loaded net - current net:
2022-11-05 05:18:37,077 WARNING:   func.classifier.bias
2022-11-05 05:18:37,077 WARNING:   func.classifier.weight
2022-11-05 05:18:37,085 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_5.pth.
2022-11-05 05:18:37,113 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:18:37,127 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:18:37,127 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:18:37,127 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:18:37,127 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:18:37,128 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:18:37,128 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:18:37,128 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:18:37,128 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:18:37,128 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:18:37,128 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:18:37,128 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:18:37,128 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:18:37,129 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:18:37,130 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:18:37,130 INFO: Model [FSLLModel] is created.
2022-11-05 05:18:37,133 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:18:37,135 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:18:37,137 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:18:37,139 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:18:37,141 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:18:37,143 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_5.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
2022-11-05 05:18:39,882 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2695, Pos_dist: 15.1929, Neg_dist: 22.5464, Acc: 0.9033, PTFixPNLoss: 4.7536, NetFixLoss: 0.0000, ]
2022-11-05 05:18:42,836 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1694, Pos_dist: 15.0922, Neg_dist: 25.3893, Acc: 0.9033, PTFixPNLoss: 4.7486, NetFixLoss: 1.1502, ]
2022-11-05 05:18:45,682 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2368, Pos_dist: 15.2669, Neg_dist: 22.1696, Acc: 0.8967, PTFixPNLoss: 4.7547, NetFixLoss: 2.3241, ]
2022-11-05 05:18:48,200 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2883, Pos_dist: 15.0386, Neg_dist: 22.0164, Acc: 0.8900, PTFixPNLoss: 4.7477, NetFixLoss: 3.7514, ]
2022-11-05 05:18:50,916 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0568, Pos_dist: 15.1569, Neg_dist: 25.6966, Acc: 0.9067, PTFixPNLoss: 4.7485, NetFixLoss: 5.3682, ]
2022-11-05 05:18:53,343 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2136, Pos_dist: 15.6162, Neg_dist: 24.2949, Acc: 0.8800, PTFixPNLoss: 4.7564, NetFixLoss: 7.0277, ]
2022-11-05 05:18:56,204 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.4238, Pos_dist: 15.3103, Neg_dist: 21.7623, Acc: 0.8800, PTFixPNLoss: 4.7487, NetFixLoss: 8.6722, ]
2022-11-05 05:18:59,600 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3144, Pos_dist: 15.3000, Neg_dist: 21.8151, Acc: 0.9033, PTFixPNLoss: 4.7529, NetFixLoss: 10.3881, ]
2022-11-05 05:19:02,254 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3714, Pos_dist: 15.0459, Neg_dist: 21.4074, Acc: 0.9100, PTFixPNLoss: 4.7487, NetFixLoss: 12.2413, ]
2022-11-05 05:19:04,943 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3288, Pos_dist: 15.1789, Neg_dist: 22.2348, Acc: 0.8967, PTFixPNLoss: 4.7506, NetFixLoss: 14.2600, ]
2022-11-05 05:19:05,070 INFO: fine-tune procedure is finished!
2022-11-05 05:19:58,333 INFO: [Test_acc of task 6 on test 1: 0.54638][acc of former classes: 0.69693][acc of former samples in all classes: 0.63687]
[acc of novel samples in all classes: 0.39829]
2022-11-05 05:19:58,719 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:19:58,748 WARNING: Current net - loaded net:
2022-11-05 05:19:58,748 WARNING: Loaded net - current net:
2022-11-05 05:19:58,748 WARNING:   func.classifier.bias
2022-11-05 05:19:58,748 WARNING:   func.classifier.weight
2022-11-05 05:19:58,758 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_6.pth.
2022-11-05 05:19:58,797 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:19:58,815 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:19:58,816 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:19:58,816 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:19:58,817 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:19:58,818 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:19:58,818 INFO: Model [FSLLModel] is created.
2022-11-05 05:19:58,828 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:19:58,831 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:19:58,834 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:19:58,837 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:19:58,840 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:19:58,843 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:19:58,846 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_6.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-05 05:20:01,901 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2965, Pos_dist: 15.1479, Neg_dist: 21.6290, Acc: 0.8800, PTFixPNLoss: 4.8161, NetFixLoss: 0.0000, ]
2022-11-05 05:20:04,674 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2212, Pos_dist: 14.9972, Neg_dist: 21.8347, Acc: 0.9029, PTFixPNLoss: 4.8132, NetFixLoss: 1.2188, ]
2022-11-05 05:20:07,639 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0810, Pos_dist: 15.1175, Neg_dist: 24.5402, Acc: 0.9057, PTFixPNLoss: 4.8135, NetFixLoss: 2.6306, ]
2022-11-05 05:20:10,350 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2598, Pos_dist: 15.0020, Neg_dist: 22.1612, Acc: 0.8886, PTFixPNLoss: 4.8127, NetFixLoss: 4.0974, ]
2022-11-05 05:20:13,295 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4285, Pos_dist: 15.3288, Neg_dist: 21.7602, Acc: 0.9029, PTFixPNLoss: 4.8176, NetFixLoss: 5.6413, ]
2022-11-05 05:20:16,099 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0397, Pos_dist: 15.0327, Neg_dist: 24.6551, Acc: 0.9057, PTFixPNLoss: 4.8097, NetFixLoss: 7.4074, ]
2022-11-05 05:20:19,371 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1382, Pos_dist: 15.1864, Neg_dist: 23.2637, Acc: 0.8857, PTFixPNLoss: 4.8132, NetFixLoss: 9.2372, ]
2022-11-05 05:20:22,306 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3442, Pos_dist: 14.9356, Neg_dist: 22.0632, Acc: 0.9171, PTFixPNLoss: 4.8080, NetFixLoss: 11.0556, ]
2022-11-05 05:20:25,478 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2140, Pos_dist: 15.1199, Neg_dist: 22.6403, Acc: 0.9029, PTFixPNLoss: 4.8169, NetFixLoss: 12.8671, ]
2022-11-05 05:20:28,597 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2277, Pos_dist: 14.9500, Neg_dist: 22.6677, Acc: 0.9000, PTFixPNLoss: 4.8107, NetFixLoss: 14.6759, ]
2022-11-05 05:20:28,696 INFO: fine-tune procedure is finished!
2022-11-05 05:21:24,429 INFO: [Test_acc of task 7 on test 1: 0.53431][acc of former classes: 0.69309][acc of former samples in all classes: 0.62011]
[acc of novel samples in all classes: 0.41426]
2022-11-05 05:21:24,807 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:21:24,836 WARNING: Current net - loaded net:
2022-11-05 05:21:24,837 WARNING: Loaded net - current net:
2022-11-05 05:21:24,837 WARNING:   func.classifier.bias
2022-11-05 05:21:24,837 WARNING:   func.classifier.weight
2022-11-05 05:21:24,845 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_7.pth.
2022-11-05 05:21:24,874 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:21:24,892 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:21:24,892 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:21:24,892 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:21:24,892 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:21:24,892 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:21:24,892 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:21:24,892 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:21:24,893 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:21:24,893 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:21:24,893 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:21:24,893 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:21:24,893 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:21:24,894 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:21:24,895 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:21:24,895 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:21:24,895 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:21:24,895 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:21:24,895 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:21:24,895 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:21:24,895 INFO: Model [FSLLModel] is created.
2022-11-05 05:21:24,898 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:21:24,900 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:21:24,902 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:21:24,904 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:21:24,906 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:21:24,908 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:21:24,910 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:21:24,912 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_7.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
2022-11-05 05:21:28,217 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1952, Pos_dist: 15.1611, Neg_dist: 22.4579, Acc: 0.8900, PTFixPNLoss: 4.8753, NetFixLoss: 0.0000, ]
2022-11-05 05:21:31,612 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0701, Pos_dist: 14.9736, Neg_dist: 24.9261, Acc: 0.9025, PTFixPNLoss: 4.8711, NetFixLoss: 1.0441, ]
2022-11-05 05:21:35,107 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0262, Pos_dist: 15.0336, Neg_dist: 25.7853, Acc: 0.8875, PTFixPNLoss: 4.8734, NetFixLoss: 2.0665, ]
2022-11-05 05:21:38,638 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3403, Pos_dist: 15.0583, Neg_dist: 21.5991, Acc: 0.8875, PTFixPNLoss: 4.8734, NetFixLoss: 3.0454, ]
2022-11-05 05:21:42,362 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3139, Pos_dist: 15.2180, Neg_dist: 23.3605, Acc: 0.8650, PTFixPNLoss: 4.8727, NetFixLoss: 4.2242, ]
2022-11-05 05:21:46,103 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3424, Pos_dist: 15.2010, Neg_dist: 22.1762, Acc: 0.8825, PTFixPNLoss: 4.8775, NetFixLoss: 5.6414, ]
2022-11-05 05:21:49,609 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0885, Pos_dist: 15.0873, Neg_dist: 25.0584, Acc: 0.9125, PTFixPNLoss: 4.8743, NetFixLoss: 7.2718, ]
2022-11-05 05:21:53,075 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1065, Pos_dist: 15.1438, Neg_dist: 23.5637, Acc: 0.8925, PTFixPNLoss: 4.8777, NetFixLoss: 9.0329, ]
2022-11-05 05:21:56,568 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2524, Pos_dist: 15.0539, Neg_dist: 22.9407, Acc: 0.8800, PTFixPNLoss: 4.8740, NetFixLoss: 10.7872, ]
2022-11-05 05:21:59,940 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1574, Pos_dist: 14.9928, Neg_dist: 22.9655, Acc: 0.9075, PTFixPNLoss: 4.8722, NetFixLoss: 12.5573, ]
2022-11-05 05:22:00,072 INFO: fine-tune procedure is finished!
2022-11-05 05:22:59,451 INFO: [Test_acc of task 8 on test 1: 0.50595][acc of former classes: 0.68261][acc of former samples in all classes: 0.60091]
[acc of novel samples in all classes: 0.38984]
2022-11-05 05:22:59,746 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:22:59,780 WARNING: Current net - loaded net:
2022-11-05 05:22:59,780 WARNING: Loaded net - current net:
2022-11-05 05:22:59,780 WARNING:   func.classifier.bias
2022-11-05 05:22:59,780 WARNING:   func.classifier.weight
2022-11-05 05:22:59,789 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_8.pth.
2022-11-05 05:22:59,827 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:22:59,846 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:22:59,846 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:22:59,847 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:22:59,848 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:22:59,849 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:22:59,850 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:22:59,850 INFO: Model [FSLLModel] is created.
2022-11-05 05:22:59,854 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,858 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,861 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,864 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,870 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,874 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,877 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,880 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:22:59,884 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_8.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
2022-11-05 05:23:04,025 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1671, Pos_dist: 14.9991, Neg_dist: 23.2396, Acc: 0.9156, PTFixPNLoss: 4.9271, NetFixLoss: 0.0000, ]
2022-11-05 05:23:07,745 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0353, Pos_dist: 15.0667, Neg_dist: 26.8110, Acc: 0.9067, PTFixPNLoss: 4.9319, NetFixLoss: 0.7886, ]
2022-11-05 05:23:11,178 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1372, Pos_dist: 15.0522, Neg_dist: 23.1210, Acc: 0.8933, PTFixPNLoss: 4.9288, NetFixLoss: 1.5288, ]
2022-11-05 05:23:15,088 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2243, Pos_dist: 14.9157, Neg_dist: 22.3004, Acc: 0.8778, PTFixPNLoss: 4.9255, NetFixLoss: 2.3679, ]
2022-11-05 05:23:19,036 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0875, Pos_dist: 14.8336, Neg_dist: 24.3220, Acc: 0.9044, PTFixPNLoss: 4.9268, NetFixLoss: 3.4487, ]
2022-11-05 05:23:22,954 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3366, Pos_dist: 14.9705, Neg_dist: 21.5010, Acc: 0.9089, PTFixPNLoss: 4.9237, NetFixLoss: 4.6467, ]
2022-11-05 05:23:26,851 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1001, Pos_dist: 15.0003, Neg_dist: 23.5886, Acc: 0.8889, PTFixPNLoss: 4.9272, NetFixLoss: 6.0335, ]
2022-11-05 05:23:30,831 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2670, Pos_dist: 15.0104, Neg_dist: 22.1027, Acc: 0.8956, PTFixPNLoss: 4.9266, NetFixLoss: 7.5127, ]
2022-11-05 05:23:34,434 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2461, Pos_dist: 14.9089, Neg_dist: 21.9676, Acc: 0.8956, PTFixPNLoss: 4.9235, NetFixLoss: 9.0667, ]
2022-11-05 05:23:37,961 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1138, Pos_dist: 14.7929, Neg_dist: 24.9778, Acc: 0.8867, PTFixPNLoss: 4.9229, NetFixLoss: 10.7229, ]
2022-11-05 05:23:38,075 INFO: fine-tune procedure is finished!
2022-11-05 05:24:41,300 INFO: [Test_acc of task 9 on test 1: 0.49600][acc of former classes: 0.67912][acc of former samples in all classes: 0.58205]
[acc of novel samples in all classes: 0.40228]
2022-11-05 05:24:41,708 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:24:41,748 WARNING: Current net - loaded net:
2022-11-05 05:24:41,748 WARNING: Loaded net - current net:
2022-11-05 05:24:41,748 WARNING:   func.classifier.bias
2022-11-05 05:24:41,748 WARNING:   func.classifier.weight
2022-11-05 05:24:41,759 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_9.pth.
2022-11-05 05:24:41,795 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:24:41,810 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:24:41,810 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:24:41,810 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:24:41,810 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:24:41,811 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:24:41,811 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:24:41,811 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:24:41,811 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:24:41,811 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:24:41,811 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:24:41,811 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:24:41,811 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:24:41,812 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:24:41,813 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:24:41,813 INFO: Model [FSLLModel] is created.
2022-11-05 05:24:41,819 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,821 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,824 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,826 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,828 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,830 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,832 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,834 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,836 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:24:41,838 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_9.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-05 05:24:45,813 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0973, Pos_dist: 14.9563, Neg_dist: 23.9463, Acc: 0.8920, PTFixPNLoss: 4.9805, NetFixLoss: 0.0000, ]
2022-11-05 05:24:49,928 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2115, Pos_dist: 14.8471, Neg_dist: 23.4452, Acc: 0.9060, PTFixPNLoss: 4.9807, NetFixLoss: 0.5086, ]
2022-11-05 05:24:53,962 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2729, Pos_dist: 14.9751, Neg_dist: 21.8075, Acc: 0.8800, PTFixPNLoss: 4.9824, NetFixLoss: 1.2373, ]
2022-11-05 05:24:58,742 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1543, Pos_dist: 15.0520, Neg_dist: 23.4580, Acc: 0.8800, PTFixPNLoss: 4.9804, NetFixLoss: 2.4578, ]
2022-11-05 05:25:03,070 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4026, Pos_dist: 15.0146, Neg_dist: 21.2207, Acc: 0.9100, PTFixPNLoss: 4.9800, NetFixLoss: 4.0125, ]
2022-11-05 05:25:07,439 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2132, Pos_dist: 14.9737, Neg_dist: 22.4678, Acc: 0.8980, PTFixPNLoss: 4.9839, NetFixLoss: 5.7917, ]
2022-11-05 05:25:12,292 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0633, Pos_dist: 14.8793, Neg_dist: 24.3441, Acc: 0.9080, PTFixPNLoss: 4.9779, NetFixLoss: 7.6201, ]
2022-11-05 05:25:17,008 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0786, Pos_dist: 15.0065, Neg_dist: 24.6705, Acc: 0.8900, PTFixPNLoss: 4.9827, NetFixLoss: 9.4267, ]
2022-11-05 05:25:21,323 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1454, Pos_dist: 14.8061, Neg_dist: 22.7475, Acc: 0.9280, PTFixPNLoss: 4.9744, NetFixLoss: 11.1328, ]
2022-11-05 05:25:25,403 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2610, Pos_dist: 14.9092, Neg_dist: 21.6591, Acc: 0.8980, PTFixPNLoss: 4.9806, NetFixLoss: 12.7593, ]
2022-11-05 05:25:25,515 INFO: fine-tune procedure is finished!
2022-11-05 05:26:30,430 INFO: [Test_acc of task 10 on test 1: 0.49413][acc of former classes: 0.68017][acc of former samples in all classes: 0.58554]
[acc of novel samples in all classes: 0.40478]
2022-11-05 05:26:30,791 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:26:30,820 WARNING: Current net - loaded net:
2022-11-05 05:26:30,821 WARNING: Loaded net - current net:
2022-11-05 05:26:30,821 WARNING:   func.classifier.bias
2022-11-05 05:26:30,821 WARNING:   func.classifier.weight
2022-11-05 05:26:30,830 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth.
2022-11-05 05:26:30,859 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:26:30,874 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:26:30,875 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:26:30,875 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:26:30,876 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:26:30,877 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:26:30,877 INFO: Model [FSLLModel] is created.
2022-11-05 05:26:30,880 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test1_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-05 05:26:31,728 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.4190, Pos_dist: 16.0835, Neg_dist: 22.5965, Acc: 0.8800, PTFixPNLoss: 4.3872, NetFixLoss: 0.0000, ]
2022-11-05 05:26:32,784 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1242, Pos_dist: 16.0793, Neg_dist: 25.4097, Acc: 0.8800, PTFixPNLoss: 4.3822, NetFixLoss: 2.0833, ]
2022-11-05 05:26:33,904 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3660, Pos_dist: 16.0957, Neg_dist: 23.6112, Acc: 0.9000, PTFixPNLoss: 4.3904, NetFixLoss: 4.2114, ]
2022-11-05 05:26:35,007 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3626, Pos_dist: 16.3410, Neg_dist: 22.6734, Acc: 0.8400, PTFixPNLoss: 4.3853, NetFixLoss: 6.7707, ]
2022-11-05 05:26:36,131 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.6182, Pos_dist: 16.6782, Neg_dist: 22.4453, Acc: 0.8400, PTFixPNLoss: 4.3855, NetFixLoss: 9.6957, ]
2022-11-05 05:26:37,258 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1515, Pos_dist: 16.1299, Neg_dist: 24.6875, Acc: 0.8600, PTFixPNLoss: 4.3756, NetFixLoss: 13.2117, ]
2022-11-05 05:26:38,335 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.7646, Pos_dist: 16.1237, Neg_dist: 21.4664, Acc: 0.8600, PTFixPNLoss: 4.3811, NetFixLoss: 17.0174, ]
2022-11-05 05:26:39,378 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1571, Pos_dist: 15.8658, Neg_dist: 23.8572, Acc: 0.8800, PTFixPNLoss: 4.3743, NetFixLoss: 21.0024, ]
2022-11-05 05:26:40,357 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2537, Pos_dist: 15.7394, Neg_dist: 23.4306, Acc: 0.9000, PTFixPNLoss: 4.3697, NetFixLoss: 25.1387, ]
2022-11-05 05:26:42,789 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0858, Pos_dist: 15.5263, Neg_dist: 23.2645, Acc: 0.9400, PTFixPNLoss: 4.3640, NetFixLoss: 29.1384, ]
2022-11-05 05:26:42,892 INFO: fine-tune procedure is finished!
2022-11-05 05:27:23,231 INFO: [Test_acc of task 1 on test 2: 0.70060][acc of former classes: 0.73499][acc of former samples in all classes: 0.72172]
[acc of novel samples in all classes: 0.48387]
2022-11-05 05:27:23,632 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:27:23,673 WARNING: Current net - loaded net:
2022-11-05 05:27:23,674 WARNING: Loaded net - current net:
2022-11-05 05:27:23,674 WARNING:   func.classifier.bias
2022-11-05 05:27:23,674 WARNING:   func.classifier.weight
2022-11-05 05:27:23,685 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_1.pth.
2022-11-05 05:27:23,721 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:27:23,734 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:27:23,735 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:27:23,735 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:27:23,736 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:27:23,737 INFO: Model [FSLLModel] is created.
2022-11-05 05:27:23,739 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:27:23,742 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_1.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
2022-11-05 05:27:24,817 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.5633, Pos_dist: 15.9193, Neg_dist: 21.9096, Acc: 0.9500, PTFixPNLoss: 4.4667, NetFixLoss: 0.0000, ]
2022-11-05 05:27:26,251 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4484, Pos_dist: 15.8816, Neg_dist: 22.0129, Acc: 0.9200, PTFixPNLoss: 4.4661, NetFixLoss: 2.6283, ]
2022-11-05 05:27:28,783 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0139, Pos_dist: 15.8647, Neg_dist: 27.6506, Acc: 0.9100, PTFixPNLoss: 4.4648, NetFixLoss: 5.5318, ]
2022-11-05 05:27:30,179 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3359, Pos_dist: 15.6418, Neg_dist: 22.9378, Acc: 0.9100, PTFixPNLoss: 4.4658, NetFixLoss: 8.3843, ]
2022-11-05 05:27:31,672 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.6500, Pos_dist: 16.0675, Neg_dist: 21.8000, Acc: 0.9000, PTFixPNLoss: 4.4778, NetFixLoss: 11.1665, ]
2022-11-05 05:27:32,961 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4152, Pos_dist: 15.9790, Neg_dist: 22.1045, Acc: 0.9100, PTFixPNLoss: 4.4689, NetFixLoss: 14.0092, ]
2022-11-05 05:27:34,384 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2768, Pos_dist: 15.7790, Neg_dist: 23.2296, Acc: 0.9500, PTFixPNLoss: 4.4613, NetFixLoss: 17.0249, ]
2022-11-05 05:27:35,703 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4344, Pos_dist: 15.6328, Neg_dist: 21.8032, Acc: 0.9200, PTFixPNLoss: 4.4675, NetFixLoss: 20.0683, ]
2022-11-05 05:27:37,012 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.5150, Pos_dist: 15.4552, Neg_dist: 21.3815, Acc: 0.9300, PTFixPNLoss: 4.4641, NetFixLoss: 23.1541, ]
2022-11-05 05:27:38,540 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2325, Pos_dist: 15.6655, Neg_dist: 23.0646, Acc: 0.9400, PTFixPNLoss: 4.4606, NetFixLoss: 26.2169, ]
2022-11-05 05:27:38,652 INFO: fine-tune procedure is finished!
2022-11-05 05:28:23,113 INFO: [Test_acc of task 2 on test 2: 0.64344][acc of former classes: 0.71439][acc of former samples in all classes: 0.68890]
[acc of novel samples in all classes: 0.41343]
2022-11-05 05:28:23,464 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:28:23,496 WARNING: Current net - loaded net:
2022-11-05 05:28:23,497 WARNING: Loaded net - current net:
2022-11-05 05:28:23,497 WARNING:   func.classifier.bias
2022-11-05 05:28:23,497 WARNING:   func.classifier.weight
2022-11-05 05:28:23,505 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_2.pth.
2022-11-05 05:28:23,536 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:28:23,551 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:28:23,551 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:28:23,551 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:28:23,552 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:28:23,553 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:28:23,554 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:28:23,554 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:28:23,554 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:28:23,554 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:28:23,554 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:28:23,554 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:28:23,554 INFO: Model [FSLLModel] is created.
2022-11-05 05:28:23,557 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:28:23,560 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:28:23,562 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_2.pth
Trainset classes:
[128, 129, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129]
2022-11-05 05:28:25,153 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2748, Pos_dist: 15.7763, Neg_dist: 22.4650, Acc: 0.9533, PTFixPNLoss: 4.5551, NetFixLoss: 0.0000, ]
2022-11-05 05:28:28,007 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1103, Pos_dist: 15.9384, Neg_dist: 24.4942, Acc: 0.9133, PTFixPNLoss: 4.5618, NetFixLoss: 1.4286, ]
2022-11-05 05:28:29,594 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1500, Pos_dist: 15.9626, Neg_dist: 23.6300, Acc: 0.9333, PTFixPNLoss: 4.5628, NetFixLoss: 2.9346, ]
2022-11-05 05:28:31,290 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2337, Pos_dist: 15.7285, Neg_dist: 22.4016, Acc: 0.9133, PTFixPNLoss: 4.5611, NetFixLoss: 4.5941, ]
2022-11-05 05:28:33,036 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4050, Pos_dist: 15.8714, Neg_dist: 22.1570, Acc: 0.9200, PTFixPNLoss: 4.5572, NetFixLoss: 6.5045, ]
2022-11-05 05:28:34,999 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2946, Pos_dist: 15.9832, Neg_dist: 22.7777, Acc: 0.9200, PTFixPNLoss: 4.5586, NetFixLoss: 8.7892, ]
2022-11-05 05:28:36,968 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2350, Pos_dist: 15.9665, Neg_dist: 24.0244, Acc: 0.9267, PTFixPNLoss: 4.5609, NetFixLoss: 11.3655, ]
2022-11-05 05:28:39,868 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.5932, Pos_dist: 15.8145, Neg_dist: 21.2644, Acc: 0.9133, PTFixPNLoss: 4.5578, NetFixLoss: 14.0617, ]
2022-11-05 05:28:41,547 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3811, Pos_dist: 15.7883, Neg_dist: 22.2180, Acc: 0.9400, PTFixPNLoss: 4.5585, NetFixLoss: 16.8448, ]
2022-11-05 05:28:43,270 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.6036, Pos_dist: 15.8835, Neg_dist: 21.5664, Acc: 0.9067, PTFixPNLoss: 4.5587, NetFixLoss: 19.9387, ]
2022-11-05 05:28:43,414 INFO: fine-tune procedure is finished!
2022-11-05 05:29:29,414 INFO: [Test_acc of task 3 on test 2: 0.56357][acc of former classes: 0.66899][acc of former samples in all classes: 0.63373]
[acc of novel samples in all classes: 0.33102]
2022-11-05 05:29:29,701 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:29:29,731 WARNING: Current net - loaded net:
2022-11-05 05:29:29,731 WARNING: Loaded net - current net:
2022-11-05 05:29:29,732 WARNING:   func.classifier.bias
2022-11-05 05:29:29,732 WARNING:   func.classifier.weight
2022-11-05 05:29:29,740 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_3.pth.
2022-11-05 05:29:29,770 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:29:29,795 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:29:29,796 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:29:29,796 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:29:29,797 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:29:29,798 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:29:29,799 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:29:29,799 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:29:29,799 INFO: Model [FSLLModel] is created.
2022-11-05 05:29:29,805 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:29:29,809 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:29:29,812 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:29:29,815 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_3.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-05 05:29:32,187 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2526, Pos_dist: 15.8696, Neg_dist: 22.9777, Acc: 0.8700, PTFixPNLoss: 4.6325, NetFixLoss: 0.0000, ]
2022-11-05 05:29:34,642 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.7178, Pos_dist: 15.7194, Neg_dist: 21.5411, Acc: 0.8950, PTFixPNLoss: 4.6241, NetFixLoss: 1.4855, ]
2022-11-05 05:29:37,411 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2580, Pos_dist: 15.6432, Neg_dist: 22.6760, Acc: 0.9050, PTFixPNLoss: 4.6248, NetFixLoss: 3.6243, ]
2022-11-05 05:29:39,582 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2329, Pos_dist: 15.8227, Neg_dist: 23.4469, Acc: 0.9200, PTFixPNLoss: 4.6295, NetFixLoss: 6.0377, ]
2022-11-05 05:29:41,689 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4542, Pos_dist: 15.7076, Neg_dist: 22.1063, Acc: 0.9300, PTFixPNLoss: 4.6214, NetFixLoss: 8.5499, ]
2022-11-05 05:29:43,810 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0956, Pos_dist: 15.7059, Neg_dist: 23.7316, Acc: 0.9250, PTFixPNLoss: 4.6222, NetFixLoss: 11.3338, ]
2022-11-05 05:29:45,963 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1375, Pos_dist: 15.4115, Neg_dist: 23.0038, Acc: 0.9150, PTFixPNLoss: 4.6229, NetFixLoss: 14.1584, ]
2022-11-05 05:29:48,927 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1421, Pos_dist: 15.7103, Neg_dist: 23.8931, Acc: 0.9100, PTFixPNLoss: 4.6259, NetFixLoss: 16.9113, ]
2022-11-05 05:29:50,982 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.5629, Pos_dist: 15.5638, Neg_dist: 21.6048, Acc: 0.9150, PTFixPNLoss: 4.6216, NetFixLoss: 19.5495, ]
2022-11-05 05:29:52,884 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1524, Pos_dist: 15.6114, Neg_dist: 23.5912, Acc: 0.9100, PTFixPNLoss: 4.6283, NetFixLoss: 22.0557, ]
2022-11-05 05:29:52,984 INFO: fine-tune procedure is finished!
2022-11-05 05:30:47,134 INFO: [Test_acc of task 4 on test 2: 0.54568][acc of former classes: 0.67318][acc of former samples in all classes: 0.62081]
[acc of novel samples in all classes: 0.36082]
2022-11-05 05:30:47,477 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:30:47,504 WARNING: Current net - loaded net:
2022-11-05 05:30:47,505 WARNING: Loaded net - current net:
2022-11-05 05:30:47,505 WARNING:   func.classifier.bias
2022-11-05 05:30:47,505 WARNING:   func.classifier.weight
2022-11-05 05:30:47,514 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_4.pth.
2022-11-05 05:30:47,543 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:30:47,557 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:30:47,558 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:30:47,558 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:30:47,559 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:30:47,560 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:30:47,560 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:30:47,560 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:30:47,560 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:30:47,560 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:30:47,560 INFO: Model [FSLLModel] is created.
2022-11-05 05:30:47,563 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:30:47,566 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:30:47,568 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:30:47,570 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:30:47,573 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_4.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149]
2022-11-05 05:30:49,873 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2512, Pos_dist: 15.4708, Neg_dist: 23.2885, Acc: 0.9120, PTFixPNLoss: 4.6889, NetFixLoss: 0.0000, ]
2022-11-05 05:30:52,656 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3322, Pos_dist: 15.5259, Neg_dist: 22.2044, Acc: 0.9080, PTFixPNLoss: 4.6928, NetFixLoss: 1.1498, ]
2022-11-05 05:30:55,794 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4973, Pos_dist: 15.4739, Neg_dist: 21.6392, Acc: 0.8960, PTFixPNLoss: 4.6945, NetFixLoss: 2.7723, ]
2022-11-05 05:30:58,529 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1737, Pos_dist: 15.4139, Neg_dist: 24.3118, Acc: 0.9080, PTFixPNLoss: 4.6865, NetFixLoss: 4.9476, ]
2022-11-05 05:31:01,461 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3232, Pos_dist: 15.3621, Neg_dist: 22.2713, Acc: 0.9200, PTFixPNLoss: 4.6896, NetFixLoss: 7.3204, ]
2022-11-05 05:31:03,879 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3566, Pos_dist: 15.4043, Neg_dist: 22.2744, Acc: 0.9160, PTFixPNLoss: 4.6859, NetFixLoss: 9.6957, ]
2022-11-05 05:31:06,683 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2922, Pos_dist: 15.5154, Neg_dist: 23.1596, Acc: 0.8600, PTFixPNLoss: 4.6870, NetFixLoss: 12.1146, ]
2022-11-05 05:31:09,395 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1319, Pos_dist: 15.2629, Neg_dist: 24.3345, Acc: 0.9000, PTFixPNLoss: 4.6866, NetFixLoss: 14.6758, ]
2022-11-05 05:31:12,399 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1892, Pos_dist: 15.3137, Neg_dist: 23.1830, Acc: 0.9040, PTFixPNLoss: 4.6839, NetFixLoss: 17.1586, ]
2022-11-05 05:31:14,982 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1313, Pos_dist: 15.1650, Neg_dist: 22.9429, Acc: 0.9440, PTFixPNLoss: 4.6828, NetFixLoss: 19.5566, ]
2022-11-05 05:31:15,239 INFO: fine-tune procedure is finished!
2022-11-05 05:32:13,792 INFO: [Test_acc of task 5 on test 2: 0.54115][acc of former classes: 0.69413][acc of former samples in all classes: 0.63932]
[acc of novel samples in all classes: 0.34884]
2022-11-05 05:32:14,191 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:32:14,270 WARNING: Current net - loaded net:
2022-11-05 05:32:14,271 WARNING: Loaded net - current net:
2022-11-05 05:32:14,271 WARNING:   func.classifier.bias
2022-11-05 05:32:14,271 WARNING:   func.classifier.weight
2022-11-05 05:32:14,285 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_5.pth.
2022-11-05 05:32:14,325 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:32:14,341 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:32:14,342 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:32:14,342 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:32:14,343 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:32:14,344 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:32:14,344 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:32:14,344 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:32:14,344 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:32:14,344 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:32:14,344 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:32:14,344 INFO: Model [FSLLModel] is created.
2022-11-05 05:32:14,347 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:32:14,350 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:32:14,352 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:32:14,354 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:32:14,356 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:32:14,359 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_5.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
2022-11-05 05:32:17,347 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1369, Pos_dist: 15.3311, Neg_dist: 23.6236, Acc: 0.8900, PTFixPNLoss: 4.7510, NetFixLoss: 0.0000, ]
2022-11-05 05:32:20,632 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2310, Pos_dist: 15.3848, Neg_dist: 23.0750, Acc: 0.8967, PTFixPNLoss: 4.7525, NetFixLoss: 0.8182, ]
2022-11-05 05:32:24,069 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1231, Pos_dist: 15.3404, Neg_dist: 24.6493, Acc: 0.9200, PTFixPNLoss: 4.7494, NetFixLoss: 2.0624, ]
2022-11-05 05:32:27,315 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3269, Pos_dist: 15.1405, Neg_dist: 21.9021, Acc: 0.9133, PTFixPNLoss: 4.7478, NetFixLoss: 3.5574, ]
2022-11-05 05:32:30,677 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2836, Pos_dist: 15.4794, Neg_dist: 22.7824, Acc: 0.8867, PTFixPNLoss: 4.7540, NetFixLoss: 5.1850, ]
2022-11-05 05:32:33,489 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3398, Pos_dist: 15.2121, Neg_dist: 22.1462, Acc: 0.9233, PTFixPNLoss: 4.7479, NetFixLoss: 7.0541, ]
2022-11-05 05:32:36,453 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.5271, Pos_dist: 15.1123, Neg_dist: 20.8077, Acc: 0.8933, PTFixPNLoss: 4.7482, NetFixLoss: 9.1254, ]
2022-11-05 05:32:39,720 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1413, Pos_dist: 15.4835, Neg_dist: 24.0287, Acc: 0.8867, PTFixPNLoss: 4.7536, NetFixLoss: 11.5052, ]
2022-11-05 05:32:43,141 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2204, Pos_dist: 15.1440, Neg_dist: 24.1923, Acc: 0.8733, PTFixPNLoss: 4.7488, NetFixLoss: 13.9990, ]
2022-11-05 05:32:46,176 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2778, Pos_dist: 15.0827, Neg_dist: 22.0578, Acc: 0.9100, PTFixPNLoss: 4.7477, NetFixLoss: 16.4649, ]
2022-11-05 05:32:46,414 INFO: fine-tune procedure is finished!
2022-11-05 05:33:43,365 INFO: [Test_acc of task 6 on test 2: 0.53663][acc of former classes: 0.69553][acc of former samples in all classes: 0.63547]
[acc of novel samples in all classes: 0.37486]
2022-11-05 05:33:43,674 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:33:43,711 WARNING: Current net - loaded net:
2022-11-05 05:33:43,712 WARNING: Loaded net - current net:
2022-11-05 05:33:43,712 WARNING:   func.classifier.bias
2022-11-05 05:33:43,712 WARNING:   func.classifier.weight
2022-11-05 05:33:43,723 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_6.pth.
2022-11-05 05:33:43,759 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:33:43,777 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:33:43,778 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:33:43,778 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:33:43,778 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:33:43,778 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:33:43,778 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:33:43,778 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:33:43,779 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:33:43,780 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:33:43,781 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:33:43,782 INFO: Model [FSLLModel] is created.
2022-11-05 05:33:43,786 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:33:43,789 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:33:43,793 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:33:43,796 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:33:43,799 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:33:43,801 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:33:43,804 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_6.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-05 05:33:47,111 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2328, Pos_dist: 15.1437, Neg_dist: 23.4890, Acc: 0.9314, PTFixPNLoss: 4.8126, NetFixLoss: 0.0000, ]
2022-11-05 05:33:50,541 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2880, Pos_dist: 15.2076, Neg_dist: 22.6429, Acc: 0.8800, PTFixPNLoss: 4.8175, NetFixLoss: 0.7150, ]
2022-11-05 05:33:53,854 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1212, Pos_dist: 15.1488, Neg_dist: 23.7184, Acc: 0.9257, PTFixPNLoss: 4.8083, NetFixLoss: 1.9147, ]
2022-11-05 05:33:57,158 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.4762, Pos_dist: 14.9926, Neg_dist: 20.6317, Acc: 0.9257, PTFixPNLoss: 4.8099, NetFixLoss: 3.2972, ]
2022-11-05 05:34:00,590 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1705, Pos_dist: 14.9346, Neg_dist: 24.5582, Acc: 0.9286, PTFixPNLoss: 4.8095, NetFixLoss: 4.9927, ]
2022-11-05 05:34:04,026 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1880, Pos_dist: 15.1569, Neg_dist: 23.4101, Acc: 0.8943, PTFixPNLoss: 4.8115, NetFixLoss: 6.8295, ]
2022-11-05 05:34:07,372 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2298, Pos_dist: 14.7845, Neg_dist: 22.4122, Acc: 0.9114, PTFixPNLoss: 4.8030, NetFixLoss: 8.6606, ]
2022-11-05 05:34:10,944 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3029, Pos_dist: 15.0061, Neg_dist: 22.1533, Acc: 0.9200, PTFixPNLoss: 4.8099, NetFixLoss: 10.5240, ]
2022-11-05 05:34:14,132 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2295, Pos_dist: 14.9733, Neg_dist: 22.2492, Acc: 0.8943, PTFixPNLoss: 4.8054, NetFixLoss: 12.3877, ]
2022-11-05 05:34:17,475 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1682, Pos_dist: 14.9188, Neg_dist: 23.2978, Acc: 0.9029, PTFixPNLoss: 4.8061, NetFixLoss: 14.2492, ]
2022-11-05 05:34:17,616 INFO: fine-tune procedure is finished!
2022-11-05 05:35:15,672 INFO: [Test_acc of task 7 on test 2: 0.53859][acc of former classes: 0.70251][acc of former samples in all classes: 0.63757]
[acc of novel samples in all classes: 0.40010]
2022-11-05 05:35:16,101 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:35:16,133 WARNING: Current net - loaded net:
2022-11-05 05:35:16,133 WARNING: Loaded net - current net:
2022-11-05 05:35:16,133 WARNING:   func.classifier.bias
2022-11-05 05:35:16,133 WARNING:   func.classifier.weight
2022-11-05 05:35:16,143 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_7.pth.
2022-11-05 05:35:16,177 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:35:16,194 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:35:16,195 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:35:16,195 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:35:16,195 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:35:16,196 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:35:16,197 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:35:16,197 INFO: Model [FSLLModel] is created.
2022-11-05 05:35:16,200 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:35:16,202 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:35:16,205 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:35:16,207 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:35:16,209 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:35:16,211 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:35:16,213 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:35:16,215 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_7.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
2022-11-05 05:35:20,318 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2948, Pos_dist: 15.1730, Neg_dist: 22.1387, Acc: 0.8850, PTFixPNLoss: 4.8735, NetFixLoss: 0.0000, ]
2022-11-05 05:35:24,266 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1594, Pos_dist: 14.9819, Neg_dist: 24.4322, Acc: 0.9000, PTFixPNLoss: 4.8716, NetFixLoss: 1.1564, ]
2022-11-05 05:35:28,177 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0971, Pos_dist: 15.0327, Neg_dist: 23.9549, Acc: 0.8950, PTFixPNLoss: 4.8756, NetFixLoss: 2.3067, ]
2022-11-05 05:35:32,161 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.4113, Pos_dist: 15.2648, Neg_dist: 21.5281, Acc: 0.9000, PTFixPNLoss: 4.8768, NetFixLoss: 3.4733, ]
2022-11-05 05:35:35,475 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0625, Pos_dist: 15.1463, Neg_dist: 25.3864, Acc: 0.8725, PTFixPNLoss: 4.8786, NetFixLoss: 4.9912, ]
2022-11-05 05:35:39,688 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3400, Pos_dist: 14.9562, Neg_dist: 21.5202, Acc: 0.8950, PTFixPNLoss: 4.8692, NetFixLoss: 6.7058, ]
2022-11-05 05:35:43,657 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0452, Pos_dist: 14.8630, Neg_dist: 26.4705, Acc: 0.9100, PTFixPNLoss: 4.8667, NetFixLoss: 8.4927, ]
2022-11-05 05:35:47,358 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1578, Pos_dist: 15.1180, Neg_dist: 23.5213, Acc: 0.9000, PTFixPNLoss: 4.8695, NetFixLoss: 10.3067, ]
2022-11-05 05:35:51,374 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3274, Pos_dist: 15.0468, Neg_dist: 22.0441, Acc: 0.8900, PTFixPNLoss: 4.8709, NetFixLoss: 12.0877, ]
2022-11-05 05:35:55,236 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3151, Pos_dist: 15.0348, Neg_dist: 21.7965, Acc: 0.8950, PTFixPNLoss: 4.8727, NetFixLoss: 13.9050, ]
2022-11-05 05:35:55,437 INFO: fine-tune procedure is finished!
2022-11-05 05:36:59,884 INFO: [Test_acc of task 8 on test 2: 0.49942][acc of former classes: 0.68890][acc of former samples in all classes: 0.60929]
[acc of novel samples in all classes: 0.36507]
2022-11-05 05:37:00,183 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:37:00,211 WARNING: Current net - loaded net:
2022-11-05 05:37:00,212 WARNING: Loaded net - current net:
2022-11-05 05:37:00,212 WARNING:   func.classifier.bias
2022-11-05 05:37:00,212 WARNING:   func.classifier.weight
2022-11-05 05:37:00,221 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_8.pth.
2022-11-05 05:37:00,251 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:37:00,271 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:37:00,272 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:37:00,272 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:37:00,273 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:37:00,275 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:37:00,276 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:37:00,276 INFO: Model [FSLLModel] is created.
2022-11-05 05:37:00,284 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,286 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,289 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,291 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,293 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,295 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,298 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,300 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:37:00,303 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_8.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
2022-11-05 05:37:04,144 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1280, Pos_dist: 15.1593, Neg_dist: 23.1904, Acc: 0.8733, PTFixPNLoss: 4.9297, NetFixLoss: 0.0000, ]
2022-11-05 05:37:08,034 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2001, Pos_dist: 15.0632, Neg_dist: 22.8752, Acc: 0.8800, PTFixPNLoss: 4.9287, NetFixLoss: 0.6342, ]
2022-11-05 05:37:11,915 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1261, Pos_dist: 15.0008, Neg_dist: 26.8078, Acc: 0.8800, PTFixPNLoss: 4.9270, NetFixLoss: 1.6661, ]
2022-11-05 05:37:16,319 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2884, Pos_dist: 15.0050, Neg_dist: 22.2802, Acc: 0.9022, PTFixPNLoss: 4.9242, NetFixLoss: 2.8349, ]
2022-11-05 05:37:20,548 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1485, Pos_dist: 14.7655, Neg_dist: 22.7953, Acc: 0.9200, PTFixPNLoss: 4.9237, NetFixLoss: 4.1678, ]
2022-11-05 05:37:25,277 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2481, Pos_dist: 14.8822, Neg_dist: 24.4063, Acc: 0.9000, PTFixPNLoss: 4.9235, NetFixLoss: 5.6460, ]
2022-11-05 05:37:29,555 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0487, Pos_dist: 15.0068, Neg_dist: 25.9108, Acc: 0.9089, PTFixPNLoss: 4.9228, NetFixLoss: 7.1394, ]
2022-11-05 05:37:34,040 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1288, Pos_dist: 14.8152, Neg_dist: 23.0272, Acc: 0.9089, PTFixPNLoss: 4.9204, NetFixLoss: 8.5939, ]
2022-11-05 05:37:38,248 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1202, Pos_dist: 14.9844, Neg_dist: 25.4438, Acc: 0.8978, PTFixPNLoss: 4.9242, NetFixLoss: 9.9948, ]
2022-11-05 05:37:42,311 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2137, Pos_dist: 14.8449, Neg_dist: 22.1708, Acc: 0.8911, PTFixPNLoss: 4.9215, NetFixLoss: 11.3858, ]
2022-11-05 05:37:42,438 INFO: fine-tune procedure is finished!
2022-11-05 05:38:48,817 INFO: [Test_acc of task 9 on test 2: 0.50291][acc of former classes: 0.68820][acc of former samples in all classes: 0.60265]
[acc of novel samples in all classes: 0.39430]
2022-11-05 05:38:49,481 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:38:49,547 WARNING: Current net - loaded net:
2022-11-05 05:38:49,547 WARNING: Loaded net - current net:
2022-11-05 05:38:49,547 WARNING:   func.classifier.bias
2022-11-05 05:38:49,547 WARNING:   func.classifier.weight
2022-11-05 05:38:49,556 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_9.pth.
2022-11-05 05:38:49,697 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:38:49,720 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:38:49,720 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:38:49,720 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:38:49,720 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:38:49,721 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:38:49,721 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:38:49,721 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:38:49,721 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:38:49,721 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:38:49,721 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:38:49,721 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:38:49,721 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:38:49,721 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:38:49,721 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:38:49,721 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:38:49,722 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:38:49,723 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:38:49,724 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:38:49,725 INFO: Model [FSLLModel] is created.
2022-11-05 05:38:49,729 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,733 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,737 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,740 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,744 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,747 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,751 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,754 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,758 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:38:49,762 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_9.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-05 05:38:54,247 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1653, Pos_dist: 14.8134, Neg_dist: 22.7376, Acc: 0.8960, PTFixPNLoss: 4.9742, NetFixLoss: 0.0000, ]
2022-11-05 05:38:58,769 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0675, Pos_dist: 14.9806, Neg_dist: 24.7956, Acc: 0.8960, PTFixPNLoss: 4.9751, NetFixLoss: 0.9164, ]
2022-11-05 05:39:03,322 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2284, Pos_dist: 14.8261, Neg_dist: 22.4059, Acc: 0.9160, PTFixPNLoss: 4.9743, NetFixLoss: 1.8433, ]
2022-11-05 05:39:07,799 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1843, Pos_dist: 14.8778, Neg_dist: 23.3739, Acc: 0.8800, PTFixPNLoss: 4.9819, NetFixLoss: 2.9110, ]
2022-11-05 05:39:12,252 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0977, Pos_dist: 14.8196, Neg_dist: 24.1011, Acc: 0.9020, PTFixPNLoss: 4.9782, NetFixLoss: 4.1490, ]
2022-11-05 05:39:17,383 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1702, Pos_dist: 14.9016, Neg_dist: 22.7227, Acc: 0.8940, PTFixPNLoss: 4.9805, NetFixLoss: 5.4617, ]
2022-11-05 05:39:22,116 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0267, Pos_dist: 15.1826, Neg_dist: 27.4020, Acc: 0.8660, PTFixPNLoss: 4.9843, NetFixLoss: 6.8454, ]
2022-11-05 05:39:27,180 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0680, Pos_dist: 14.8799, Neg_dist: 24.5466, Acc: 0.8960, PTFixPNLoss: 4.9739, NetFixLoss: 8.2063, ]
2022-11-05 05:39:32,066 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1821, Pos_dist: 14.8097, Neg_dist: 22.8531, Acc: 0.9120, PTFixPNLoss: 4.9757, NetFixLoss: 9.5139, ]
2022-11-05 05:39:36,725 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2241, Pos_dist: 14.9136, Neg_dist: 23.2595, Acc: 0.8920, PTFixPNLoss: 4.9733, NetFixLoss: 10.7995, ]
2022-11-05 05:39:36,816 INFO: fine-tune procedure is finished!
2022-11-05 05:40:44,771 INFO: [Test_acc of task 10 on test 2: 0.49361][acc of former classes: 0.69274][acc of former samples in all classes: 0.59707]
[acc of novel samples in all classes: 0.39249]
2022-11-05 05:40:45,204 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:40:45,239 WARNING: Current net - loaded net:
2022-11-05 05:40:45,239 WARNING: Loaded net - current net:
2022-11-05 05:40:45,239 WARNING:   func.classifier.bias
2022-11-05 05:40:45,239 WARNING:   func.classifier.weight
2022-11-05 05:40:45,263 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth.
2022-11-05 05:40:45,307 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:40:45,323 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:40:45,324 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:40:45,324 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:40:45,324 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:40:45,325 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:40:45,326 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:40:45,327 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:40:45,327 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:40:45,327 INFO: Model [FSLLModel] is created.
2022-11-05 05:40:45,331 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test2_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-05 05:40:46,361 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2431, Pos_dist: 16.1359, Neg_dist: 22.9993, Acc: 0.8400, PTFixPNLoss: 4.3712, NetFixLoss: 0.0000, ]
2022-11-05 05:40:47,371 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1225, Pos_dist: 15.3212, Neg_dist: 23.7108, Acc: 0.8400, PTFixPNLoss: 4.3646, NetFixLoss: 1.7669, ]
2022-11-05 05:40:48,498 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0648, Pos_dist: 15.8736, Neg_dist: 24.5430, Acc: 0.9400, PTFixPNLoss: 4.3659, NetFixLoss: 3.5707, ]
2022-11-05 05:40:49,649 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2926, Pos_dist: 16.0119, Neg_dist: 23.4114, Acc: 0.8800, PTFixPNLoss: 4.3729, NetFixLoss: 5.4471, ]
2022-11-05 05:40:50,840 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0565, Pos_dist: 15.2236, Neg_dist: 25.9056, Acc: 0.9200, PTFixPNLoss: 4.3572, NetFixLoss: 7.7572, ]
2022-11-05 05:40:53,089 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1271, Pos_dist: 16.0491, Neg_dist: 23.9183, Acc: 0.9000, PTFixPNLoss: 4.3724, NetFixLoss: 10.1914, ]
2022-11-05 05:40:54,169 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0979, Pos_dist: 15.8720, Neg_dist: 24.0103, Acc: 0.8800, PTFixPNLoss: 4.3617, NetFixLoss: 12.7687, ]
2022-11-05 05:40:55,164 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3827, Pos_dist: 15.8648, Neg_dist: 22.8956, Acc: 0.8800, PTFixPNLoss: 4.3689, NetFixLoss: 15.3321, ]
2022-11-05 05:40:56,204 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1659, Pos_dist: 15.5467, Neg_dist: 23.8279, Acc: 0.9000, PTFixPNLoss: 4.3581, NetFixLoss: 17.9750, ]
2022-11-05 05:40:57,566 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2466, Pos_dist: 15.4546, Neg_dist: 21.8389, Acc: 0.9200, PTFixPNLoss: 4.3634, NetFixLoss: 20.5965, ]
2022-11-05 05:40:57,653 INFO: fine-tune procedure is finished!
2022-11-05 05:41:40,778 INFO: [Test_acc of task 1 on test 3: 0.71460][acc of former classes: 0.74511][acc of former samples in all classes: 0.73464]
[acc of novel samples in all classes: 0.50896]
2022-11-05 05:41:41,089 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:41:41,129 WARNING: Current net - loaded net:
2022-11-05 05:41:41,130 WARNING: Loaded net - current net:
2022-11-05 05:41:41,130 WARNING:   func.classifier.bias
2022-11-05 05:41:41,130 WARNING:   func.classifier.weight
2022-11-05 05:41:41,141 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_1.pth.
2022-11-05 05:41:41,178 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:41:41,199 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:41:41,200 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:41:41,200 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:41:41,201 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:41:41,202 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:41:41,203 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:41:41,203 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:41:41,203 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:41:41,203 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:41:41,203 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:41:41,203 INFO: Model [FSLLModel] is created.
2022-11-05 05:41:41,207 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:41:41,211 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_1.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
2022-11-05 05:41:42,599 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.0908, Pos_dist: 15.4611, Neg_dist: 24.1014, Acc: 0.9200, PTFixPNLoss: 4.4589, NetFixLoss: 0.0000, ]
2022-11-05 05:41:44,197 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0758, Pos_dist: 15.8133, Neg_dist: 27.4732, Acc: 0.9200, PTFixPNLoss: 4.4711, NetFixLoss: 0.8539, ]
2022-11-05 05:41:45,723 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0183, Pos_dist: 15.4182, Neg_dist: 27.4466, Acc: 0.9500, PTFixPNLoss: 4.4625, NetFixLoss: 1.7780, ]
2022-11-05 05:41:47,516 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1918, Pos_dist: 15.9707, Neg_dist: 24.5562, Acc: 0.9100, PTFixPNLoss: 4.4736, NetFixLoss: 2.7090, ]
2022-11-05 05:41:49,148 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.5477, Pos_dist: 15.5918, Neg_dist: 21.9074, Acc: 0.9100, PTFixPNLoss: 4.4646, NetFixLoss: 3.9166, ]
2022-11-05 05:41:50,374 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.6374, Pos_dist: 15.7648, Neg_dist: 21.0364, Acc: 0.9300, PTFixPNLoss: 4.4642, NetFixLoss: 5.8580, ]
2022-11-05 05:41:51,638 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2535, Pos_dist: 15.4722, Neg_dist: 23.0897, Acc: 0.9200, PTFixPNLoss: 4.4651, NetFixLoss: 8.5010, ]
2022-11-05 05:41:53,275 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2855, Pos_dist: 15.7223, Neg_dist: 23.1342, Acc: 0.9300, PTFixPNLoss: 4.4686, NetFixLoss: 11.3887, ]
2022-11-05 05:41:54,855 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.5316, Pos_dist: 15.5651, Neg_dist: 21.9860, Acc: 0.9300, PTFixPNLoss: 4.4646, NetFixLoss: 14.3547, ]
2022-11-05 05:41:56,462 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3829, Pos_dist: 15.3982, Neg_dist: 21.6241, Acc: 0.9300, PTFixPNLoss: 4.4564, NetFixLoss: 17.4436, ]
2022-11-05 05:41:56,558 INFO: fine-tune procedure is finished!
2022-11-05 05:42:43,305 INFO: [Test_acc of task 2 on test 3: 0.64898][acc of former classes: 0.71194][acc of former samples in all classes: 0.69309]
[acc of novel samples in all classes: 0.42580]
2022-11-05 05:42:43,743 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:42:43,778 WARNING: Current net - loaded net:
2022-11-05 05:42:43,778 WARNING: Loaded net - current net:
2022-11-05 05:42:43,778 WARNING:   func.classifier.bias
2022-11-05 05:42:43,778 WARNING:   func.classifier.weight
2022-11-05 05:42:43,787 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_2.pth.
2022-11-05 05:42:43,816 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:42:43,836 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:42:43,837 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:42:43,837 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:42:43,837 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:42:43,838 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:42:43,839 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:42:43,839 INFO: Model [FSLLModel] is created.
2022-11-05 05:42:43,843 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:42:43,845 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:42:43,848 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_2.pth
Trainset classes:
[128, 129, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129]
2022-11-05 05:42:45,357 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2879, Pos_dist: 15.5998, Neg_dist: 22.6343, Acc: 0.9200, PTFixPNLoss: 4.5566, NetFixLoss: 0.0000, ]
2022-11-05 05:42:47,284 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4171, Pos_dist: 15.9577, Neg_dist: 22.3305, Acc: 0.9000, PTFixPNLoss: 4.5644, NetFixLoss: 1.6223, ]
2022-11-05 05:42:49,169 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3797, Pos_dist: 15.8168, Neg_dist: 22.3984, Acc: 0.9400, PTFixPNLoss: 4.5610, NetFixLoss: 3.9146, ]
2022-11-05 05:42:51,019 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.6492, Pos_dist: 15.8094, Neg_dist: 21.2885, Acc: 0.9067, PTFixPNLoss: 4.5602, NetFixLoss: 6.5388, ]
2022-11-05 05:42:52,958 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.4497, Pos_dist: 16.0395, Neg_dist: 23.2825, Acc: 0.9000, PTFixPNLoss: 4.5596, NetFixLoss: 9.6323, ]
2022-11-05 05:42:54,910 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.5919, Pos_dist: 15.7437, Neg_dist: 21.0092, Acc: 0.8867, PTFixPNLoss: 4.5620, NetFixLoss: 12.8677, ]
2022-11-05 05:42:56,909 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3917, Pos_dist: 15.6116, Neg_dist: 22.0604, Acc: 0.9267, PTFixPNLoss: 4.5521, NetFixLoss: 16.1875, ]
2022-11-05 05:42:58,716 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1476, Pos_dist: 15.8554, Neg_dist: 24.4230, Acc: 0.9333, PTFixPNLoss: 4.5599, NetFixLoss: 19.5520, ]
2022-11-05 05:43:01,634 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2592, Pos_dist: 15.4456, Neg_dist: 22.1275, Acc: 0.9600, PTFixPNLoss: 4.5554, NetFixLoss: 22.8397, ]
2022-11-05 05:43:03,642 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.4325, Pos_dist: 15.6062, Neg_dist: 21.4168, Acc: 0.9133, PTFixPNLoss: 4.5556, NetFixLoss: 25.9525, ]
2022-11-05 05:43:03,772 INFO: fine-tune procedure is finished!
2022-11-05 05:43:55,799 INFO: [Test_acc of task 3 on test 3: 0.59388][acc of former classes: 0.68820][acc of former samples in all classes: 0.65922]
[acc of novel samples in all classes: 0.37731]
2022-11-05 05:43:56,274 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:43:56,305 WARNING: Current net - loaded net:
2022-11-05 05:43:56,305 WARNING: Loaded net - current net:
2022-11-05 05:43:56,305 WARNING:   func.classifier.bias
2022-11-05 05:43:56,305 WARNING:   func.classifier.weight
2022-11-05 05:43:56,313 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_3.pth.
2022-11-05 05:43:56,342 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:43:56,356 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:43:56,357 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:43:56,357 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:43:56,357 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:43:56,358 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:43:56,359 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:43:56,359 INFO: Model [FSLLModel] is created.
2022-11-05 05:43:56,362 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:43:56,364 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:43:56,367 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:43:56,369 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_3.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-05 05:43:58,677 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2597, Pos_dist: 15.5249, Neg_dist: 23.5484, Acc: 0.9100, PTFixPNLoss: 4.6272, NetFixLoss: 0.0000, ]
2022-11-05 05:44:01,020 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3174, Pos_dist: 15.3673, Neg_dist: 22.1498, Acc: 0.9200, PTFixPNLoss: 4.6233, NetFixLoss: 1.1149, ]
2022-11-05 05:44:03,440 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3228, Pos_dist: 15.5608, Neg_dist: 23.5935, Acc: 0.9250, PTFixPNLoss: 4.6289, NetFixLoss: 2.8781, ]
2022-11-05 05:44:05,710 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2169, Pos_dist: 15.3112, Neg_dist: 23.5006, Acc: 0.9300, PTFixPNLoss: 4.6244, NetFixLoss: 4.9376, ]
2022-11-05 05:44:07,754 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2738, Pos_dist: 15.5557, Neg_dist: 23.9208, Acc: 0.9300, PTFixPNLoss: 4.6263, NetFixLoss: 7.1317, ]
2022-11-05 05:44:10,338 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.4624, Pos_dist: 15.2510, Neg_dist: 21.4987, Acc: 0.9300, PTFixPNLoss: 4.6228, NetFixLoss: 9.4386, ]
2022-11-05 05:44:12,614 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1821, Pos_dist: 15.4514, Neg_dist: 23.4695, Acc: 0.9200, PTFixPNLoss: 4.6252, NetFixLoss: 11.8508, ]
2022-11-05 05:44:15,211 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.3151, Pos_dist: 15.4434, Neg_dist: 22.6773, Acc: 0.9250, PTFixPNLoss: 4.6263, NetFixLoss: 14.2679, ]
2022-11-05 05:44:17,536 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2988, Pos_dist: 15.5459, Neg_dist: 23.1600, Acc: 0.9050, PTFixPNLoss: 4.6257, NetFixLoss: 16.6766, ]
2022-11-05 05:44:19,961 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0920, Pos_dist: 15.2134, Neg_dist: 24.5570, Acc: 0.9350, PTFixPNLoss: 4.6197, NetFixLoss: 19.1420, ]
2022-11-05 05:44:20,108 INFO: fine-tune procedure is finished!
2022-11-05 05:45:17,000 INFO: [Test_acc of task 4 on test 3: 0.57249][acc of former classes: 0.68785][acc of former samples in all classes: 0.64106]
[acc of novel samples in all classes: 0.40378]
2022-11-05 05:45:17,474 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:45:17,514 WARNING: Current net - loaded net:
2022-11-05 05:45:17,514 WARNING: Loaded net - current net:
2022-11-05 05:45:17,514 WARNING:   func.classifier.bias
2022-11-05 05:45:17,514 WARNING:   func.classifier.weight
2022-11-05 05:45:17,526 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_4.pth.
2022-11-05 05:45:17,567 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:45:17,586 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:45:17,587 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:45:17,587 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:45:17,587 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:45:17,587 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:45:17,587 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:45:17,587 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:45:17,587 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:45:17,588 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:45:17,589 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:45:17,590 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:45:17,591 INFO: Model [FSLLModel] is created.
2022-11-05 05:45:17,600 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:45:17,604 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:45:17,608 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:45:17,611 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:45:17,615 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_4.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149]
2022-11-05 05:45:21,331 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.5866, Pos_dist: 15.1110, Neg_dist: 20.9648, Acc: 0.9200, PTFixPNLoss: 4.6837, NetFixLoss: 0.0000, ]
2022-11-05 05:45:24,180 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.5457, Pos_dist: 15.5100, Neg_dist: 21.2719, Acc: 0.9040, PTFixPNLoss: 4.6924, NetFixLoss: 1.6549, ]
2022-11-05 05:45:26,781 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1039, Pos_dist: 15.3812, Neg_dist: 24.1770, Acc: 0.8960, PTFixPNLoss: 4.6904, NetFixLoss: 4.0029, ]
2022-11-05 05:45:29,402 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0955, Pos_dist: 15.4474, Neg_dist: 25.4100, Acc: 0.8840, PTFixPNLoss: 4.6898, NetFixLoss: 6.5281, ]
2022-11-05 05:45:32,243 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1774, Pos_dist: 15.2694, Neg_dist: 23.4633, Acc: 0.8480, PTFixPNLoss: 4.6893, NetFixLoss: 8.9541, ]
2022-11-05 05:45:34,847 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1754, Pos_dist: 15.4641, Neg_dist: 25.9431, Acc: 0.9000, PTFixPNLoss: 4.6932, NetFixLoss: 11.2282, ]
2022-11-05 05:45:37,492 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.0943, Pos_dist: 15.4050, Neg_dist: 25.0043, Acc: 0.9000, PTFixPNLoss: 4.6908, NetFixLoss: 13.3731, ]
2022-11-05 05:45:40,307 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.4301, Pos_dist: 15.1747, Neg_dist: 21.6189, Acc: 0.9080, PTFixPNLoss: 4.6865, NetFixLoss: 15.3962, ]
2022-11-05 05:45:43,155 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0194, Pos_dist: 15.4436, Neg_dist: 28.3511, Acc: 0.9040, PTFixPNLoss: 4.6899, NetFixLoss: 17.3360, ]
2022-11-05 05:45:45,692 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0293, Pos_dist: 15.3725, Neg_dist: 27.7872, Acc: 0.8760, PTFixPNLoss: 4.6919, NetFixLoss: 19.2501, ]
2022-11-05 05:45:45,813 INFO: fine-tune procedure is finished!
2022-11-05 05:46:41,013 INFO: [Test_acc of task 5 on test 3: 0.54669][acc of former classes: 0.68785][acc of former samples in all classes: 0.63582]
[acc of novel samples in all classes: 0.37209]
2022-11-05 05:46:41,398 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:46:41,433 WARNING: Current net - loaded net:
2022-11-05 05:46:41,434 WARNING: Loaded net - current net:
2022-11-05 05:46:41,434 WARNING:   func.classifier.bias
2022-11-05 05:46:41,434 WARNING:   func.classifier.weight
2022-11-05 05:46:41,443 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_5.pth.
2022-11-05 05:46:41,479 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:46:41,499 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:46:41,499 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:46:41,499 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:46:41,499 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:46:41,499 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:46:41,499 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:46:41,499 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:46:41,500 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:46:41,500 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:46:41,500 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:46:41,500 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:46:41,500 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:46:41,500 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:46:41,500 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:46:41,500 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:46:41,500 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:46:41,500 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:46:41,500 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:46:41,501 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:46:41,502 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:46:41,503 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:46:41,504 INFO: Model [FSLLModel] is created.
2022-11-05 05:46:41,508 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:46:41,512 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:46:41,515 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:46:41,519 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:46:41,522 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:46:41,525 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_5.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
2022-11-05 05:46:44,499 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1130, Pos_dist: 15.0661, Neg_dist: 23.9017, Acc: 0.8967, PTFixPNLoss: 4.7571, NetFixLoss: 0.0000, ]
2022-11-05 05:46:47,627 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2612, Pos_dist: 15.1572, Neg_dist: 22.3048, Acc: 0.8800, PTFixPNLoss: 4.7559, NetFixLoss: 0.6333, ]
2022-11-05 05:46:50,997 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1955, Pos_dist: 15.2189, Neg_dist: 22.6985, Acc: 0.9000, PTFixPNLoss: 4.7612, NetFixLoss: 1.8874, ]
2022-11-05 05:46:54,325 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0250, Pos_dist: 15.2984, Neg_dist: 27.0494, Acc: 0.9000, PTFixPNLoss: 4.7587, NetFixLoss: 3.4665, ]
2022-11-05 05:46:57,834 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2278, Pos_dist: 15.1886, Neg_dist: 23.4635, Acc: 0.9000, PTFixPNLoss: 4.7515, NetFixLoss: 5.0527, ]
2022-11-05 05:47:01,024 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0765, Pos_dist: 15.1360, Neg_dist: 26.3348, Acc: 0.9300, PTFixPNLoss: 4.7521, NetFixLoss: 6.6716, ]
2022-11-05 05:47:04,288 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2984, Pos_dist: 15.5304, Neg_dist: 22.2205, Acc: 0.9033, PTFixPNLoss: 4.7611, NetFixLoss: 8.2903, ]
2022-11-05 05:47:07,418 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2174, Pos_dist: 15.1419, Neg_dist: 22.5279, Acc: 0.9167, PTFixPNLoss: 4.7538, NetFixLoss: 9.9803, ]
2022-11-05 05:47:10,313 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1644, Pos_dist: 15.1706, Neg_dist: 23.3429, Acc: 0.9000, PTFixPNLoss: 4.7523, NetFixLoss: 11.7852, ]
2022-11-05 05:47:12,830 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1329, Pos_dist: 15.1376, Neg_dist: 23.7645, Acc: 0.9067, PTFixPNLoss: 4.7540, NetFixLoss: 13.6500, ]
2022-11-05 05:47:12,933 INFO: fine-tune procedure is finished!
2022-11-05 05:48:09,388 INFO: [Test_acc of task 6 on test 3: 0.54053][acc of former classes: 0.69344][acc of former samples in all classes: 0.63059]
[acc of novel samples in all classes: 0.39314]
2022-11-05 05:48:09,888 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:48:09,921 WARNING: Current net - loaded net:
2022-11-05 05:48:09,921 WARNING: Loaded net - current net:
2022-11-05 05:48:09,922 WARNING:   func.classifier.bias
2022-11-05 05:48:09,922 WARNING:   func.classifier.weight
2022-11-05 05:48:09,933 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_6.pth.
2022-11-05 05:48:09,969 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:48:09,987 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:48:09,987 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:48:09,987 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:48:09,987 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:48:09,988 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:48:09,989 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:48:09,990 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:48:09,990 INFO: Model [FSLLModel] is created.
2022-11-05 05:48:09,995 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:48:09,998 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:48:10,001 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:48:10,004 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:48:10,007 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:48:10,009 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:48:10,012 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_6.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-05 05:48:13,298 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2159, Pos_dist: 15.0929, Neg_dist: 23.6047, Acc: 0.8943, PTFixPNLoss: 4.8125, NetFixLoss: 0.0000, ]
2022-11-05 05:48:17,270 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.4123, Pos_dist: 15.0511, Neg_dist: 21.2179, Acc: 0.9086, PTFixPNLoss: 4.8152, NetFixLoss: 0.7059, ]
2022-11-05 05:48:20,872 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1373, Pos_dist: 15.2075, Neg_dist: 23.9036, Acc: 0.8857, PTFixPNLoss: 4.8162, NetFixLoss: 2.2621, ]
2022-11-05 05:48:24,438 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.3499, Pos_dist: 15.1857, Neg_dist: 22.2475, Acc: 0.8886, PTFixPNLoss: 4.8150, NetFixLoss: 3.9857, ]
2022-11-05 05:48:28,209 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2587, Pos_dist: 15.3528, Neg_dist: 22.5305, Acc: 0.8971, PTFixPNLoss: 4.8155, NetFixLoss: 6.1561, ]
2022-11-05 05:48:32,225 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1184, Pos_dist: 15.4227, Neg_dist: 23.8434, Acc: 0.9029, PTFixPNLoss: 4.8175, NetFixLoss: 8.4084, ]
2022-11-05 05:48:35,685 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2299, Pos_dist: 15.1644, Neg_dist: 22.2948, Acc: 0.9314, PTFixPNLoss: 4.8137, NetFixLoss: 10.6310, ]
2022-11-05 05:48:38,888 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2232, Pos_dist: 15.3012, Neg_dist: 25.0023, Acc: 0.8800, PTFixPNLoss: 4.8160, NetFixLoss: 12.7853, ]
2022-11-05 05:48:42,571 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2197, Pos_dist: 14.9939, Neg_dist: 22.4488, Acc: 0.9029, PTFixPNLoss: 4.8137, NetFixLoss: 14.9435, ]
2022-11-05 05:48:45,923 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2683, Pos_dist: 15.1652, Neg_dist: 21.9231, Acc: 0.8943, PTFixPNLoss: 4.8133, NetFixLoss: 16.9990, ]
2022-11-05 05:48:46,025 INFO: fine-tune procedure is finished!
2022-11-05 05:49:48,706 INFO: [Test_acc of task 7 on test 3: 0.53574][acc of former classes: 0.69169][acc of former samples in all classes: 0.62395]
[acc of novel samples in all classes: 0.41231]
2022-11-05 05:49:49,233 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:49:49,263 WARNING: Current net - loaded net:
2022-11-05 05:49:49,264 WARNING: Loaded net - current net:
2022-11-05 05:49:49,264 WARNING:   func.classifier.bias
2022-11-05 05:49:49,264 WARNING:   func.classifier.weight
2022-11-05 05:49:49,273 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_7.pth.
2022-11-05 05:49:49,308 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:49:49,326 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:49:49,326 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:49:49,326 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:49:49,326 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:49:49,326 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:49:49,326 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:49:49,327 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:49:49,327 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:49:49,327 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:49:49,327 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:49:49,327 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:49:49,327 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:49:49,328 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:49:49,329 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:49:49,329 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:49:49,329 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:49:49,329 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:49:49,329 INFO: Model [FSLLModel] is created.
2022-11-05 05:49:49,332 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:49:49,334 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:49:49,336 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:49:49,338 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:49:49,340 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:49:49,342 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:49:49,344 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:49:49,346 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_7.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
2022-11-05 05:49:53,272 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2622, Pos_dist: 15.1473, Neg_dist: 23.4606, Acc: 0.8925, PTFixPNLoss: 4.8769, NetFixLoss: 0.0000, ]
2022-11-05 05:49:57,143 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1356, Pos_dist: 15.2170, Neg_dist: 23.2900, Acc: 0.9100, PTFixPNLoss: 4.8769, NetFixLoss: 0.7774, ]
2022-11-05 05:50:00,871 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1669, Pos_dist: 15.1970, Neg_dist: 24.0383, Acc: 0.9100, PTFixPNLoss: 4.8775, NetFixLoss: 1.8228, ]
2022-11-05 05:50:04,807 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2387, Pos_dist: 15.3162, Neg_dist: 23.2257, Acc: 0.9025, PTFixPNLoss: 4.8759, NetFixLoss: 3.0531, ]
2022-11-05 05:50:08,839 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1433, Pos_dist: 15.1757, Neg_dist: 23.6312, Acc: 0.9000, PTFixPNLoss: 4.8763, NetFixLoss: 4.4912, ]
2022-11-05 05:50:13,013 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.6013, Pos_dist: 15.0342, Neg_dist: 20.8704, Acc: 0.8950, PTFixPNLoss: 4.8751, NetFixLoss: 6.1977, ]
2022-11-05 05:50:16,953 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2958, Pos_dist: 15.2483, Neg_dist: 22.4487, Acc: 0.9000, PTFixPNLoss: 4.8780, NetFixLoss: 8.1246, ]
2022-11-05 05:50:20,756 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1491, Pos_dist: 15.0937, Neg_dist: 23.2601, Acc: 0.8650, PTFixPNLoss: 4.8749, NetFixLoss: 10.2149, ]
2022-11-05 05:50:24,454 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4118, Pos_dist: 15.1149, Neg_dist: 21.4084, Acc: 0.9100, PTFixPNLoss: 4.8770, NetFixLoss: 12.3146, ]
2022-11-05 05:50:28,306 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.3682, Pos_dist: 15.1891, Neg_dist: 22.1473, Acc: 0.8950, PTFixPNLoss: 4.8760, NetFixLoss: 14.4468, ]
2022-11-05 05:50:28,405 INFO: fine-tune procedure is finished!
2022-11-05 05:51:32,064 INFO: [Test_acc of task 8 on test 3: 0.51671][acc of former classes: 0.68715][acc of former samples in all classes: 0.61068]
[acc of novel samples in all classes: 0.40179]
2022-11-05 05:51:32,448 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:51:32,480 WARNING: Current net - loaded net:
2022-11-05 05:51:32,480 WARNING: Loaded net - current net:
2022-11-05 05:51:32,480 WARNING:   func.classifier.bias
2022-11-05 05:51:32,480 WARNING:   func.classifier.weight
2022-11-05 05:51:32,490 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_8.pth.
2022-11-05 05:51:32,519 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:51:32,532 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:51:32,532 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:51:32,532 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:51:32,532 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:51:32,532 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:51:32,532 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:51:32,532 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:51:32,532 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:51:32,533 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:51:32,534 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:51:32,534 INFO: Model [FSLLModel] is created.
2022-11-05 05:51:32,537 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,539 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,542 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,544 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,546 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,548 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,550 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,553 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:51:32,557 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_8.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
2022-11-05 05:51:36,264 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2758, Pos_dist: 15.0674, Neg_dist: 21.9094, Acc: 0.9067, PTFixPNLoss: 4.9324, NetFixLoss: 0.0000, ]
2022-11-05 05:51:40,530 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3390, Pos_dist: 15.1165, Neg_dist: 22.0860, Acc: 0.9067, PTFixPNLoss: 4.9316, NetFixLoss: 1.2970, ]
2022-11-05 05:51:44,556 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.4420, Pos_dist: 15.2213, Neg_dist: 21.2881, Acc: 0.8911, PTFixPNLoss: 4.9321, NetFixLoss: 2.9150, ]
2022-11-05 05:51:48,771 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1724, Pos_dist: 14.9200, Neg_dist: 22.8443, Acc: 0.9044, PTFixPNLoss: 4.9277, NetFixLoss: 4.8810, ]
2022-11-05 05:51:53,385 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3245, Pos_dist: 15.0454, Neg_dist: 21.5496, Acc: 0.8889, PTFixPNLoss: 4.9309, NetFixLoss: 6.9527, ]
2022-11-05 05:51:57,469 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2492, Pos_dist: 15.1300, Neg_dist: 22.4042, Acc: 0.8911, PTFixPNLoss: 4.9315, NetFixLoss: 9.0478, ]
2022-11-05 05:52:01,494 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2823, Pos_dist: 14.9778, Neg_dist: 21.9939, Acc: 0.8911, PTFixPNLoss: 4.9282, NetFixLoss: 11.1812, ]
2022-11-05 05:52:05,635 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2610, Pos_dist: 15.0011, Neg_dist: 22.2141, Acc: 0.8933, PTFixPNLoss: 4.9259, NetFixLoss: 13.3434, ]
2022-11-05 05:52:09,848 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2800, Pos_dist: 15.1858, Neg_dist: 22.3686, Acc: 0.8889, PTFixPNLoss: 4.9327, NetFixLoss: 15.5111, ]
2022-11-05 05:52:14,161 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1634, Pos_dist: 14.9348, Neg_dist: 24.5081, Acc: 0.9178, PTFixPNLoss: 4.9275, NetFixLoss: 17.6720, ]
2022-11-05 05:52:14,303 INFO: fine-tune procedure is finished!
2022-11-05 05:53:18,466 INFO: [Test_acc of task 9 on test 3: 0.51984][acc of former classes: 0.69064][acc of former samples in all classes: 0.60999]
[acc of novel samples in all classes: 0.42167]
2022-11-05 05:53:18,869 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:53:18,900 WARNING: Current net - loaded net:
2022-11-05 05:53:18,901 WARNING: Loaded net - current net:
2022-11-05 05:53:18,901 WARNING:   func.classifier.bias
2022-11-05 05:53:18,901 WARNING:   func.classifier.weight
2022-11-05 05:53:18,910 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_9.pth.
2022-11-05 05:53:18,939 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:53:18,953 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:53:18,954 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:53:18,954 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:53:18,955 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:53:18,956 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:53:18,956 INFO: Model [FSLLModel] is created.
2022-11-05 05:53:18,959 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,961 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,963 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,966 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,969 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,972 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,976 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,979 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,981 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:53:18,984 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_9.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-05 05:53:23,078 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1250, Pos_dist: 14.9614, Neg_dist: 22.9745, Acc: 0.9100, PTFixPNLoss: 4.9822, NetFixLoss: 0.0000, ]
2022-11-05 05:53:27,150 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1570, Pos_dist: 14.9970, Neg_dist: 25.0763, Acc: 0.9020, PTFixPNLoss: 4.9792, NetFixLoss: 0.6702, ]
2022-11-05 05:53:31,704 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3420, Pos_dist: 15.1634, Neg_dist: 21.6848, Acc: 0.8980, PTFixPNLoss: 4.9841, NetFixLoss: 1.4176, ]
2022-11-05 05:53:36,474 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1041, Pos_dist: 14.9190, Neg_dist: 23.9315, Acc: 0.9020, PTFixPNLoss: 4.9810, NetFixLoss: 2.6594, ]
2022-11-05 05:53:41,232 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0660, Pos_dist: 14.9496, Neg_dist: 25.4100, Acc: 0.9180, PTFixPNLoss: 4.9783, NetFixLoss: 4.0494, ]
2022-11-05 05:53:45,580 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0754, Pos_dist: 14.9876, Neg_dist: 24.2717, Acc: 0.9060, PTFixPNLoss: 4.9798, NetFixLoss: 5.4180, ]
2022-11-05 05:53:49,987 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2277, Pos_dist: 14.8133, Neg_dist: 22.1268, Acc: 0.8900, PTFixPNLoss: 4.9770, NetFixLoss: 6.7508, ]
2022-11-05 05:53:54,829 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0245, Pos_dist: 14.9405, Neg_dist: 26.2570, Acc: 0.8880, PTFixPNLoss: 4.9787, NetFixLoss: 8.1236, ]
2022-11-05 05:53:58,860 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1005, Pos_dist: 14.8423, Neg_dist: 23.9014, Acc: 0.8840, PTFixPNLoss: 4.9769, NetFixLoss: 9.5381, ]
2022-11-05 05:54:03,202 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2379, Pos_dist: 14.8696, Neg_dist: 22.6747, Acc: 0.9100, PTFixPNLoss: 4.9789, NetFixLoss: 10.9203, ]
2022-11-05 05:54:03,304 INFO: fine-tune procedure is finished!
2022-11-05 05:55:10,153 INFO: [Test_acc of task 10 on test 3: 0.50897][acc of former classes: 0.68925][acc of former samples in all classes: 0.60300]
[acc of novel samples in all classes: 0.41706]
2022-11-05 05:55:10,524 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:55:10,578 WARNING: Current net - loaded net:
2022-11-05 05:55:10,579 WARNING: Loaded net - current net:
2022-11-05 05:55:10,579 WARNING:   func.classifier.bias
2022-11-05 05:55:10,579 WARNING:   func.classifier.weight
2022-11-05 05:55:10,591 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth.
2022-11-05 05:55:10,645 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:55:10,665 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:55:10,665 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:55:10,666 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:55:10,667 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:55:10,668 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:55:10,669 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:55:10,669 INFO: Model [FSLLModel] is created.
2022-11-05 05:55:10,674 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test3_session_10.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test0_session_0.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109]
2022-11-05 05:55:11,571 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3272, Pos_dist: 15.9875, Neg_dist: 22.8893, Acc: 0.9200, PTFixPNLoss: 4.3754, NetFixLoss: 0.0000, ]
2022-11-05 05:55:12,756 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3490, Pos_dist: 16.4046, Neg_dist: 24.5502, Acc: 0.9000, PTFixPNLoss: 4.3804, NetFixLoss: 1.7552, ]
2022-11-05 05:55:13,855 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2050, Pos_dist: 15.9271, Neg_dist: 24.4563, Acc: 0.9200, PTFixPNLoss: 4.3752, NetFixLoss: 4.2323, ]
2022-11-05 05:55:14,820 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0828, Pos_dist: 15.9413, Neg_dist: 24.1504, Acc: 0.9000, PTFixPNLoss: 4.3784, NetFixLoss: 7.0146, ]
2022-11-05 05:55:15,870 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2386, Pos_dist: 15.6746, Neg_dist: 22.5806, Acc: 0.9400, PTFixPNLoss: 4.3663, NetFixLoss: 9.7871, ]
2022-11-05 05:55:17,092 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3773, Pos_dist: 15.8811, Neg_dist: 22.7379, Acc: 0.8800, PTFixPNLoss: 4.3767, NetFixLoss: 12.6399, ]
2022-11-05 05:55:18,199 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2856, Pos_dist: 15.9207, Neg_dist: 22.4540, Acc: 0.9600, PTFixPNLoss: 4.3735, NetFixLoss: 15.6224, ]
2022-11-05 05:55:19,221 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0824, Pos_dist: 15.6813, Neg_dist: 24.7259, Acc: 0.9800, PTFixPNLoss: 4.3603, NetFixLoss: 18.7257, ]
2022-11-05 05:55:20,411 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.0273, Pos_dist: 15.5163, Neg_dist: 25.4022, Acc: 0.9400, PTFixPNLoss: 4.3628, NetFixLoss: 21.9152, ]
2022-11-05 05:55:21,563 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1973, Pos_dist: 15.7617, Neg_dist: 23.8368, Acc: 0.9000, PTFixPNLoss: 4.3566, NetFixLoss: 25.0270, ]
2022-11-05 05:55:21,750 INFO: fine-tune procedure is finished!
2022-11-05 05:56:04,150 INFO: [Test_acc of task 1 on test 4: 0.70029][acc of former classes: 0.73673][acc of former samples in all classes: 0.72451]
[acc of novel samples in all classes: 0.45161]
2022-11-05 05:56:04,557 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:56:04,599 WARNING: Current net - loaded net:
2022-11-05 05:56:04,599 WARNING: Loaded net - current net:
2022-11-05 05:56:04,599 WARNING:   func.classifier.bias
2022-11-05 05:56:04,599 WARNING:   func.classifier.weight
2022-11-05 05:56:04,622 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_1.pth.
2022-11-05 05:56:04,695 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:56:04,709 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:56:04,709 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:56:04,710 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:56:04,710 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:56:04,710 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:56:04,711 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:56:04,712 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:56:04,712 INFO: Model [FSLLModel] is created.
2022-11-05 05:56:04,716 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:56:04,718 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_1.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
2022-11-05 05:56:05,850 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2975, Pos_dist: 15.9105, Neg_dist: 23.6614, Acc: 0.9600, PTFixPNLoss: 4.4668, NetFixLoss: 0.0000, ]
2022-11-05 05:56:07,164 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3902, Pos_dist: 15.8860, Neg_dist: 22.0093, Acc: 0.9300, PTFixPNLoss: 4.4664, NetFixLoss: 1.4772, ]
2022-11-05 05:56:08,636 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.3891, Pos_dist: 16.1945, Neg_dist: 22.7199, Acc: 0.9000, PTFixPNLoss: 4.4738, NetFixLoss: 3.6297, ]
2022-11-05 05:56:10,255 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1776, Pos_dist: 15.9687, Neg_dist: 23.8499, Acc: 0.9300, PTFixPNLoss: 4.4748, NetFixLoss: 6.2821, ]
2022-11-05 05:56:11,507 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.6173, Pos_dist: 15.6314, Neg_dist: 21.2775, Acc: 0.9300, PTFixPNLoss: 4.4619, NetFixLoss: 9.1632, ]
2022-11-05 05:56:12,864 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.3835, Pos_dist: 15.7027, Neg_dist: 22.6267, Acc: 0.9600, PTFixPNLoss: 4.4696, NetFixLoss: 12.2669, ]
2022-11-05 05:56:14,430 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.7138, Pos_dist: 15.6918, Neg_dist: 20.8598, Acc: 0.9600, PTFixPNLoss: 4.4688, NetFixLoss: 15.4684, ]
2022-11-05 05:56:15,924 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1453, Pos_dist: 15.8718, Neg_dist: 23.9067, Acc: 0.9300, PTFixPNLoss: 4.4647, NetFixLoss: 18.8344, ]
2022-11-05 05:56:17,281 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4287, Pos_dist: 15.5807, Neg_dist: 22.3504, Acc: 0.8900, PTFixPNLoss: 4.4619, NetFixLoss: 22.2981, ]
2022-11-05 05:56:18,734 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1453, Pos_dist: 15.4681, Neg_dist: 22.9771, Acc: 0.9600, PTFixPNLoss: 4.4540, NetFixLoss: 25.7246, ]
2022-11-05 05:56:18,906 INFO: fine-tune procedure is finished!
2022-11-05 05:57:03,390 INFO: [Test_acc of task 2 on test 4: 0.64723][acc of former classes: 0.71054][acc of former samples in all classes: 0.69134]
[acc of novel samples in all classes: 0.42403]
2022-11-05 05:57:03,795 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:57:03,825 WARNING: Current net - loaded net:
2022-11-05 05:57:03,825 WARNING: Loaded net - current net:
2022-11-05 05:57:03,826 WARNING:   func.classifier.bias
2022-11-05 05:57:03,826 WARNING:   func.classifier.weight
2022-11-05 05:57:03,835 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_2.pth.
2022-11-05 05:57:03,871 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:57:03,890 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:57:03,890 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:57:03,891 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:57:03,892 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:57:03,893 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:57:03,894 INFO: Model [FSLLModel] is created.
2022-11-05 05:57:03,898 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:57:03,901 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:57:03,904 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_2.pth
Trainset classes:
[128, 129, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129]
2022-11-05 05:57:05,504 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.5732, Pos_dist: 15.6731, Neg_dist: 21.7118, Acc: 0.9267, PTFixPNLoss: 4.5579, NetFixLoss: 0.0000, ]
2022-11-05 05:57:07,274 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.0463, Pos_dist: 15.5541, Neg_dist: 26.7739, Acc: 0.9133, PTFixPNLoss: 4.5560, NetFixLoss: 1.8676, ]
2022-11-05 05:57:09,114 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.5231, Pos_dist: 15.9052, Neg_dist: 21.5680, Acc: 0.9067, PTFixPNLoss: 4.5621, NetFixLoss: 3.5904, ]
2022-11-05 05:57:10,830 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2355, Pos_dist: 15.9585, Neg_dist: 23.5014, Acc: 0.9200, PTFixPNLoss: 4.5644, NetFixLoss: 5.6503, ]
2022-11-05 05:57:12,491 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0663, Pos_dist: 15.7409, Neg_dist: 26.2983, Acc: 0.9600, PTFixPNLoss: 4.5613, NetFixLoss: 8.0123, ]
2022-11-05 05:57:14,502 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.0976, Pos_dist: 15.6500, Neg_dist: 24.8180, Acc: 0.9267, PTFixPNLoss: 4.5572, NetFixLoss: 10.3733, ]
2022-11-05 05:57:16,245 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.4142, Pos_dist: 15.4656, Neg_dist: 21.0717, Acc: 0.9400, PTFixPNLoss: 4.5560, NetFixLoss: 12.6191, ]
2022-11-05 05:57:17,941 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0875, Pos_dist: 15.7852, Neg_dist: 26.2312, Acc: 0.9533, PTFixPNLoss: 4.5590, NetFixLoss: 14.8609, ]
2022-11-05 05:57:19,836 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4479, Pos_dist: 15.7949, Neg_dist: 21.5415, Acc: 0.9400, PTFixPNLoss: 4.5564, NetFixLoss: 17.1219, ]
2022-11-05 05:57:21,601 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2093, Pos_dist: 15.6941, Neg_dist: 23.3106, Acc: 0.9467, PTFixPNLoss: 4.5549, NetFixLoss: 19.4295, ]
2022-11-05 05:57:21,733 INFO: fine-tune procedure is finished!
2022-11-05 05:58:08,511 INFO: [Test_acc of task 3 on test 4: 0.57672][acc of former classes: 0.67144][acc of former samples in all classes: 0.64281]
[acc of novel samples in all classes: 0.35764]
2022-11-05 05:58:08,919 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:58:08,949 WARNING: Current net - loaded net:
2022-11-05 05:58:08,949 WARNING: Loaded net - current net:
2022-11-05 05:58:08,949 WARNING:   func.classifier.bias
2022-11-05 05:58:08,949 WARNING:   func.classifier.weight
2022-11-05 05:58:08,959 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_3.pth.
2022-11-05 05:58:08,988 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:58:09,001 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:58:09,001 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:58:09,001 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:58:09,001 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:58:09,002 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:58:09,002 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:58:09,002 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:58:09,002 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:58:09,002 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:58:09,002 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:58:09,002 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:58:09,002 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:58:09,002 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:58:09,002 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:58:09,002 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:58:09,003 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:58:09,004 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:58:09,005 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:58:09,005 INFO: Model [FSLLModel] is created.
2022-11-05 05:58:09,010 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:58:09,013 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:58:09,015 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:58:09,018 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_3.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
2022-11-05 05:58:11,015 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.4126, Pos_dist: 15.5687, Neg_dist: 22.2849, Acc: 0.9050, PTFixPNLoss: 4.6265, NetFixLoss: 0.0000, ]
2022-11-05 05:58:13,254 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1504, Pos_dist: 15.3355, Neg_dist: 23.6985, Acc: 0.9350, PTFixPNLoss: 4.6242, NetFixLoss: 1.6844, ]
2022-11-05 05:58:15,807 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0148, Pos_dist: 15.5551, Neg_dist: 26.3248, Acc: 0.9600, PTFixPNLoss: 4.6307, NetFixLoss: 3.4388, ]
2022-11-05 05:58:17,885 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2539, Pos_dist: 15.5009, Neg_dist: 22.4602, Acc: 0.9250, PTFixPNLoss: 4.6260, NetFixLoss: 5.1204, ]
2022-11-05 05:58:20,210 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.0687, Pos_dist: 15.5068, Neg_dist: 27.5663, Acc: 0.9400, PTFixPNLoss: 4.6303, NetFixLoss: 6.9117, ]
2022-11-05 05:58:22,572 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.5779, Pos_dist: 15.4631, Neg_dist: 20.9960, Acc: 0.9200, PTFixPNLoss: 4.6269, NetFixLoss: 8.7517, ]
2022-11-05 05:58:24,803 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1731, Pos_dist: 15.4082, Neg_dist: 24.5750, Acc: 0.9550, PTFixPNLoss: 4.6251, NetFixLoss: 10.8081, ]
2022-11-05 05:58:27,080 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0465, Pos_dist: 15.4972, Neg_dist: 25.4713, Acc: 0.9150, PTFixPNLoss: 4.6252, NetFixLoss: 12.9687, ]
2022-11-05 05:58:29,357 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.5240, Pos_dist: 15.6661, Neg_dist: 21.5680, Acc: 0.9550, PTFixPNLoss: 4.6306, NetFixLoss: 15.1157, ]
2022-11-05 05:58:31,533 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0929, Pos_dist: 15.5709, Neg_dist: 25.0031, Acc: 0.9400, PTFixPNLoss: 4.6281, NetFixLoss: 17.2614, ]
2022-11-05 05:58:31,673 INFO: fine-tune procedure is finished!
2022-11-05 05:59:21,237 INFO: [Test_acc of task 4 on test 4: 0.55437][acc of former classes: 0.66830][acc of former samples in all classes: 0.62360]
[acc of novel samples in all classes: 0.38402]
2022-11-05 05:59:21,526 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 05:59:21,557 WARNING: Current net - loaded net:
2022-11-05 05:59:21,557 WARNING: Loaded net - current net:
2022-11-05 05:59:21,557 WARNING:   func.classifier.bias
2022-11-05 05:59:21,557 WARNING:   func.classifier.weight
2022-11-05 05:59:21,567 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_4.pth.
2022-11-05 05:59:21,597 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 05:59:21,611 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 05:59:21,611 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 05:59:21,611 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 05:59:21,611 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 05:59:21,611 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 05:59:21,611 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 05:59:21,611 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 05:59:21,612 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 05:59:21,612 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 05:59:21,612 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 05:59:21,612 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 05:59:21,612 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 05:59:21,613 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 05:59:21,614 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 05:59:21,614 INFO: Model [FSLLModel] is created.
2022-11-05 05:59:21,617 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:59:21,619 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:59:21,622 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:59:21,624 INFO: Dataset NormalDataset - cub is created.
2022-11-05 05:59:21,626 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_4.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149]
2022-11-05 05:59:23,980 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1799, Pos_dist: 15.5769, Neg_dist: 23.7603, Acc: 0.9120, PTFixPNLoss: 4.6926, NetFixLoss: 0.0000, ]
2022-11-05 05:59:26,548 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1300, Pos_dist: 15.5903, Neg_dist: 24.8062, Acc: 0.9360, PTFixPNLoss: 4.6924, NetFixLoss: 0.9088, ]
2022-11-05 05:59:28,949 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.2989, Pos_dist: 15.5928, Neg_dist: 22.7786, Acc: 0.9040, PTFixPNLoss: 4.6932, NetFixLoss: 2.0009, ]
2022-11-05 05:59:31,451 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0654, Pos_dist: 15.4091, Neg_dist: 25.0432, Acc: 0.9240, PTFixPNLoss: 4.6923, NetFixLoss: 3.5679, ]
2022-11-05 05:59:33,914 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2293, Pos_dist: 15.4560, Neg_dist: 23.6438, Acc: 0.9280, PTFixPNLoss: 4.6907, NetFixLoss: 5.2749, ]
2022-11-05 05:59:36,396 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2832, Pos_dist: 15.4930, Neg_dist: 22.9208, Acc: 0.9120, PTFixPNLoss: 4.6948, NetFixLoss: 7.0393, ]
2022-11-05 05:59:38,780 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2468, Pos_dist: 15.4641, Neg_dist: 22.6186, Acc: 0.9160, PTFixPNLoss: 4.6915, NetFixLoss: 8.9567, ]
2022-11-05 05:59:41,508 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.5040, Pos_dist: 15.6788, Neg_dist: 21.8684, Acc: 0.8680, PTFixPNLoss: 4.6959, NetFixLoss: 11.0165, ]
2022-11-05 05:59:44,452 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.3385, Pos_dist: 15.4322, Neg_dist: 22.3482, Acc: 0.9400, PTFixPNLoss: 4.6931, NetFixLoss: 13.2226, ]
2022-11-05 05:59:46,998 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.1255, Pos_dist: 15.3695, Neg_dist: 23.5710, Acc: 0.8880, PTFixPNLoss: 4.6872, NetFixLoss: 15.6212, ]
2022-11-05 05:59:47,129 INFO: fine-tune procedure is finished!
2022-11-05 06:00:39,743 INFO: [Test_acc of task 5 on test 4: 0.53814][acc of former classes: 0.67737][acc of former samples in all classes: 0.62884]
[acc of novel samples in all classes: 0.36047]
2022-11-05 06:00:40,089 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 06:00:40,117 WARNING: Current net - loaded net:
2022-11-05 06:00:40,117 WARNING: Loaded net - current net:
2022-11-05 06:00:40,117 WARNING:   func.classifier.bias
2022-11-05 06:00:40,117 WARNING:   func.classifier.weight
2022-11-05 06:00:40,126 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_5.pth.
2022-11-05 06:00:40,154 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 06:00:40,168 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 06:00:40,169 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 06:00:40,169 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 06:00:40,169 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 06:00:40,170 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 06:00:40,171 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 06:00:40,171 INFO: Model [FSLLModel] is created.
2022-11-05 06:00:40,174 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:00:40,176 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:00:40,178 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:00:40,180 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:00:40,182 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:00:40,184 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_5.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
2022-11-05 06:00:42,933 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.3041, Pos_dist: 15.5142, Neg_dist: 22.4532, Acc: 0.8933, PTFixPNLoss: 4.7558, NetFixLoss: 0.0000, ]
2022-11-05 06:00:45,654 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1603, Pos_dist: 15.2036, Neg_dist: 24.3289, Acc: 0.9067, PTFixPNLoss: 4.7515, NetFixLoss: 1.1509, ]
2022-11-05 06:00:48,872 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1761, Pos_dist: 15.3226, Neg_dist: 22.8011, Acc: 0.9133, PTFixPNLoss: 4.7566, NetFixLoss: 2.4395, ]
2022-11-05 06:00:52,413 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2028, Pos_dist: 15.2172, Neg_dist: 23.0268, Acc: 0.8967, PTFixPNLoss: 4.7525, NetFixLoss: 3.9317, ]
2022-11-05 06:00:55,512 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3120, Pos_dist: 15.4023, Neg_dist: 22.6321, Acc: 0.9300, PTFixPNLoss: 4.7559, NetFixLoss: 5.5982, ]
2022-11-05 06:00:58,471 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2584, Pos_dist: 15.1903, Neg_dist: 22.7163, Acc: 0.9200, PTFixPNLoss: 4.7533, NetFixLoss: 7.4379, ]
2022-11-05 06:01:01,114 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1060, Pos_dist: 15.1569, Neg_dist: 22.9521, Acc: 0.9200, PTFixPNLoss: 4.7560, NetFixLoss: 9.4452, ]
2022-11-05 06:01:03,841 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.1705, Pos_dist: 15.3684, Neg_dist: 23.0463, Acc: 0.9133, PTFixPNLoss: 4.7552, NetFixLoss: 11.4600, ]
2022-11-05 06:01:06,799 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2784, Pos_dist: 15.2592, Neg_dist: 22.0291, Acc: 0.9300, PTFixPNLoss: 4.7544, NetFixLoss: 13.5375, ]
2022-11-05 06:01:09,675 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0967, Pos_dist: 15.4543, Neg_dist: 24.6090, Acc: 0.9200, PTFixPNLoss: 4.7552, NetFixLoss: 15.5560, ]
2022-11-05 06:01:09,834 INFO: fine-tune procedure is finished!
2022-11-05 06:02:03,866 INFO: [Test_acc of task 6 on test 4: 0.52687][acc of former classes: 0.67598][acc of former samples in all classes: 0.61872]
[acc of novel samples in all classes: 0.37657]
2022-11-05 06:02:04,224 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 06:02:04,253 WARNING: Current net - loaded net:
2022-11-05 06:02:04,254 WARNING: Loaded net - current net:
2022-11-05 06:02:04,254 WARNING:   func.classifier.bias
2022-11-05 06:02:04,254 WARNING:   func.classifier.weight
2022-11-05 06:02:04,263 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_6.pth.
2022-11-05 06:02:04,292 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 06:02:04,307 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 06:02:04,307 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 06:02:04,307 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 06:02:04,307 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 06:02:04,307 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 06:02:04,307 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 06:02:04,308 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 06:02:04,309 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 06:02:04,310 INFO: Model [FSLLModel] is created.
2022-11-05 06:02:04,312 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:02:04,314 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:02:04,316 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:02:04,318 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:02:04,320 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:02:04,323 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:02:04,325 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_6.pth
Trainset classes:
[128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169]
2022-11-05 06:02:07,367 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2089, Pos_dist: 15.2597, Neg_dist: 23.0269, Acc: 0.9257, PTFixPNLoss: 4.8157, NetFixLoss: 0.0000, ]
2022-11-05 06:02:10,507 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1221, Pos_dist: 15.2654, Neg_dist: 24.8184, Acc: 0.9314, PTFixPNLoss: 4.8180, NetFixLoss: 0.9208, ]
2022-11-05 06:02:13,712 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1149, Pos_dist: 15.1716, Neg_dist: 23.5493, Acc: 0.9143, PTFixPNLoss: 4.8148, NetFixLoss: 1.8909, ]
2022-11-05 06:02:16,903 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2824, Pos_dist: 15.3364, Neg_dist: 22.8370, Acc: 0.8886, PTFixPNLoss: 4.8195, NetFixLoss: 2.9653, ]
2022-11-05 06:02:20,158 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2800, Pos_dist: 15.1854, Neg_dist: 21.9669, Acc: 0.9114, PTFixPNLoss: 4.8144, NetFixLoss: 4.2911, ]
2022-11-05 06:02:23,698 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1940, Pos_dist: 15.2125, Neg_dist: 23.5361, Acc: 0.9000, PTFixPNLoss: 4.8159, NetFixLoss: 5.8917, ]
2022-11-05 06:02:27,775 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3980, Pos_dist: 15.3379, Neg_dist: 21.8505, Acc: 0.9314, PTFixPNLoss: 4.8197, NetFixLoss: 7.6777, ]
2022-11-05 06:02:31,738 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0516, Pos_dist: 15.1563, Neg_dist: 25.5460, Acc: 0.9343, PTFixPNLoss: 4.8144, NetFixLoss: 9.6255, ]
2022-11-05 06:02:35,235 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.4611, Pos_dist: 15.1812, Neg_dist: 20.8617, Acc: 0.9171, PTFixPNLoss: 4.8132, NetFixLoss: 11.6331, ]
2022-11-05 06:02:38,469 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2403, Pos_dist: 15.3432, Neg_dist: 23.3441, Acc: 0.8943, PTFixPNLoss: 4.8162, NetFixLoss: 13.7704, ]
2022-11-05 06:02:38,576 INFO: fine-tune procedure is finished!
2022-11-05 06:03:38,539 INFO: [Test_acc of task 7 on test 4: 0.52474][acc of former classes: 0.68645][acc of former samples in all classes: 0.61941]
[acc of novel samples in all classes: 0.39228]
2022-11-05 06:03:38,917 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 06:03:38,959 WARNING: Current net - loaded net:
2022-11-05 06:03:38,959 WARNING: Loaded net - current net:
2022-11-05 06:03:38,959 WARNING:   func.classifier.bias
2022-11-05 06:03:38,959 WARNING:   func.classifier.weight
2022-11-05 06:03:38,971 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_7.pth.
2022-11-05 06:03:39,009 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 06:03:39,029 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 06:03:39,030 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 06:03:39,030 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 06:03:39,031 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 06:03:39,032 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 06:03:39,033 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 06:03:39,033 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 06:03:39,033 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 06:03:39,033 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 06:03:39,033 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 06:03:39,033 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 06:03:39,033 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 06:03:39,033 INFO: Model [FSLLModel] is created.
2022-11-05 06:03:39,038 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:03:39,041 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:03:39,045 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:03:39,048 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:03:39,051 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:03:39,055 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:03:39,058 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:03:39,062 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_7.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
2022-11-05 06:03:43,323 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1061, Pos_dist: 15.0963, Neg_dist: 23.5805, Acc: 0.9250, PTFixPNLoss: 4.8723, NetFixLoss: 0.0000, ]
2022-11-05 06:03:47,120 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.1841, Pos_dist: 15.1425, Neg_dist: 23.6412, Acc: 0.9050, PTFixPNLoss: 4.8736, NetFixLoss: 0.6227, ]
2022-11-05 06:03:51,091 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.1772, Pos_dist: 15.0752, Neg_dist: 23.1043, Acc: 0.9125, PTFixPNLoss: 4.8725, NetFixLoss: 1.5346, ]
2022-11-05 06:03:55,421 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.1778, Pos_dist: 15.2156, Neg_dist: 22.8048, Acc: 0.9050, PTFixPNLoss: 4.8785, NetFixLoss: 2.7712, ]
2022-11-05 06:03:59,612 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.3587, Pos_dist: 14.9894, Neg_dist: 21.5583, Acc: 0.9225, PTFixPNLoss: 4.8733, NetFixLoss: 4.2415, ]
2022-11-05 06:04:03,701 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2159, Pos_dist: 15.0981, Neg_dist: 22.6007, Acc: 0.9250, PTFixPNLoss: 4.8748, NetFixLoss: 5.8845, ]
2022-11-05 06:04:07,668 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.1161, Pos_dist: 15.2944, Neg_dist: 24.3784, Acc: 0.8875, PTFixPNLoss: 4.8803, NetFixLoss: 7.6443, ]
2022-11-05 06:04:11,974 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.0641, Pos_dist: 14.9960, Neg_dist: 26.0684, Acc: 0.9325, PTFixPNLoss: 4.8738, NetFixLoss: 9.5246, ]
2022-11-05 06:04:15,791 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1034, Pos_dist: 15.0754, Neg_dist: 25.2146, Acc: 0.9100, PTFixPNLoss: 4.8740, NetFixLoss: 11.3236, ]
2022-11-05 06:04:19,593 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.0509, Pos_dist: 15.0381, Neg_dist: 24.5320, Acc: 0.9300, PTFixPNLoss: 4.8778, NetFixLoss: 13.0143, ]
2022-11-05 06:04:19,710 INFO: fine-tune procedure is finished!
2022-11-05 06:05:24,960 INFO: [Test_acc of task 8 on test 4: 0.50192][acc of former classes: 0.68017][acc of former samples in all classes: 0.60649]
[acc of novel samples in all classes: 0.37404]
2022-11-05 06:05:25,435 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 06:05:25,482 WARNING: Current net - loaded net:
2022-11-05 06:05:25,483 WARNING: Loaded net - current net:
2022-11-05 06:05:25,483 WARNING:   func.classifier.bias
2022-11-05 06:05:25,483 WARNING:   func.classifier.weight
2022-11-05 06:05:25,494 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_8.pth.
2022-11-05 06:05:25,531 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 06:05:25,548 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 06:05:25,548 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 06:05:25,548 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 06:05:25,548 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 06:05:25,548 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 06:05:25,548 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 06:05:25,548 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 06:05:25,548 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 06:05:25,548 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 06:05:25,549 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 06:05:25,550 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 06:05:25,551 INFO: Model [FSLLModel] is created.
2022-11-05 06:05:25,553 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,555 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,558 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,560 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,562 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,564 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,566 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,568 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:05:25,570 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_8.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_8.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]
2022-11-05 06:05:30,390 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.1221, Pos_dist: 15.1022, Neg_dist: 23.2829, Acc: 0.9178, PTFixPNLoss: 4.9291, NetFixLoss: 0.0000, ]
2022-11-05 06:05:34,525 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.2319, Pos_dist: 15.0181, Neg_dist: 22.1194, Acc: 0.9111, PTFixPNLoss: 4.9282, NetFixLoss: 0.7421, ]
2022-11-05 06:05:38,614 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0947, Pos_dist: 15.0655, Neg_dist: 23.4896, Acc: 0.9178, PTFixPNLoss: 4.9281, NetFixLoss: 1.9010, ]
2022-11-05 06:05:43,289 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.2688, Pos_dist: 15.2154, Neg_dist: 22.3519, Acc: 0.9244, PTFixPNLoss: 4.9321, NetFixLoss: 3.1821, ]
2022-11-05 06:05:47,860 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.1814, Pos_dist: 15.1576, Neg_dist: 23.2139, Acc: 0.9022, PTFixPNLoss: 4.9313, NetFixLoss: 4.6204, ]
2022-11-05 06:05:52,321 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.1324, Pos_dist: 15.1867, Neg_dist: 25.7522, Acc: 0.9089, PTFixPNLoss: 4.9328, NetFixLoss: 6.2372, ]
2022-11-05 06:05:56,243 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.2242, Pos_dist: 15.1291, Neg_dist: 22.2295, Acc: 0.8978, PTFixPNLoss: 4.9283, NetFixLoss: 7.8842, ]
2022-11-05 06:06:00,883 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2333, Pos_dist: 15.0169, Neg_dist: 22.0904, Acc: 0.9111, PTFixPNLoss: 4.9272, NetFixLoss: 9.6670, ]
2022-11-05 06:06:05,417 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.2472, Pos_dist: 14.9185, Neg_dist: 22.3594, Acc: 0.9133, PTFixPNLoss: 4.9256, NetFixLoss: 11.5996, ]
2022-11-05 06:06:09,560 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2807, Pos_dist: 14.9837, Neg_dist: 22.6021, Acc: 0.9311, PTFixPNLoss: 4.9261, NetFixLoss: 13.6119, ]
2022-11-05 06:06:09,719 INFO: fine-tune procedure is finished!
2022-11-05 06:07:18,063 INFO: [Test_acc of task 9 on test 4: 0.50000][acc of former classes: 0.68436][acc of former samples in all classes: 0.60161]
[acc of novel samples in all classes: 0.38935]
2022-11-05 06:07:18,435 INFO: Loading Resnet18_softmax model from ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth.
2022-11-05 06:07:18,471 WARNING: Current net - loaded net:
2022-11-05 06:07:18,471 WARNING: Loaded net - current net:
2022-11-05 06:07:18,471 WARNING:   func.classifier.bias
2022-11-05 06:07:18,471 WARNING:   func.classifier.weight
2022-11-05 06:07:18,482 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_9.pth.
2022-11-05 06:07:18,519 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/prototypes/test0_session0.pt
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer1.1.conv2.weight.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer2.0.bn2.bias.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer2.0.downsample.1.bias.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer3.0.downsample.1.weight.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-11-05 06:07:18,538 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-11-05 06:07:18,539 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-11-05 06:07:18,539 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-05 06:07:18,539 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-05 06:07:18,540 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-05 06:07:18,541 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-05 06:07:18,542 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-05 06:07:18,542 INFO: Model [FSLLModel] is created.
2022-11-05 06:07:18,547 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,550 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,553 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,557 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,559 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,562 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,564 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,566 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,568 INFO: Dataset NormalDataset - cub is created.
2022-11-05 06:07:18,570 INFO: Dataset NormalDataset - cub is created.
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_9.pth
Load NETWORK MODEL From: ./exp/cub_bases100/FSIL_BaselineModel_res18_CUB_baseline_100base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_9.pth
Trainset classes:
[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2022-11-05 06:07:23,133 INFO: [epoch:  0, iter:   1, lr:(5.000e-04)] [ TripletLoss: 0.2028, Pos_dist: 15.0563, Neg_dist: 23.1225, Acc: 0.9020, PTFixPNLoss: 4.9828, NetFixLoss: 0.0000, ]
2022-11-05 06:07:27,845 INFO: [epoch:  1, iter:   2, lr:(5.000e-04)] [ TripletLoss: 0.3923, Pos_dist: 15.1895, Neg_dist: 21.4738, Acc: 0.9000, PTFixPNLoss: 4.9827, NetFixLoss: 0.8369, ]
2022-11-05 06:07:32,552 INFO: [epoch:  2, iter:   3, lr:(5.000e-04)] [ TripletLoss: 0.0904, Pos_dist: 15.2053, Neg_dist: 24.3924, Acc: 0.8820, PTFixPNLoss: 4.9819, NetFixLoss: 2.1462, ]
2022-11-05 06:07:36,926 INFO: [epoch:  3, iter:   4, lr:(5.000e-04)] [ TripletLoss: 0.0407, Pos_dist: 14.9048, Neg_dist: 27.4755, Acc: 0.9160, PTFixPNLoss: 4.9776, NetFixLoss: 3.5391, ]
2022-11-05 06:07:41,822 INFO: [epoch:  4, iter:   5, lr:(5.000e-04)] [ TripletLoss: 0.2052, Pos_dist: 15.0386, Neg_dist: 22.5578, Acc: 0.9060, PTFixPNLoss: 4.9808, NetFixLoss: 4.8609, ]
2022-11-05 06:07:46,618 INFO: [epoch:  5, iter:   6, lr:(5.000e-04)] [ TripletLoss: 0.2983, Pos_dist: 14.9787, Neg_dist: 21.5801, Acc: 0.9020, PTFixPNLoss: 4.9802, NetFixLoss: 6.1797, ]
2022-11-05 06:07:51,439 INFO: [epoch:  6, iter:   7, lr:(5.000e-04)] [ TripletLoss: 0.3070, Pos_dist: 14.9869, Neg_dist: 21.6108, Acc: 0.9120, PTFixPNLoss: 4.9775, NetFixLoss: 7.6677, ]
2022-11-05 06:07:55,910 INFO: [epoch:  7, iter:   8, lr:(5.000e-04)] [ TripletLoss: 0.2392, Pos_dist: 15.1647, Neg_dist: 22.6977, Acc: 0.8960, PTFixPNLoss: 4.9808, NetFixLoss: 9.4086, ]
2022-11-05 06:08:00,619 INFO: [epoch:  8, iter:   9, lr:(5.000e-04)] [ TripletLoss: 0.1151, Pos_dist: 14.8602, Neg_dist: 23.8676, Acc: 0.9180, PTFixPNLoss: 4.9727, NetFixLoss: 11.3211, ]
2022-11-05 06:08:05,577 INFO: [epoch:  9, iter:  10, lr:(5.000e-04)] [ TripletLoss: 0.2933, Pos_dist: 15.0873, Neg_dist: 22.2608, Acc: 0.9200, PTFixPNLoss: 4.9765, NetFixLoss: 13.2942, ]
2022-11-05 06:08:05,785 INFO: fine-tune procedure is finished!
2022-11-05 06:09:18,208 INFO: [Test_acc of task 10 on test 4: 0.48913][acc of former classes: 0.68052][acc of former samples in all classes: 0.59218]
[acc of novel samples in all classes: 0.38840]
2022-11-05 06:09:18,335 INFO: --------------------------Final Avg Acc-------------------------
2022-11-05 06:09:18,335 INFO: Session 1: 76.92+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7692]
2022-11-05 06:09:18,335 INFO: Session 2: 70.58+-0.52[acc of former classes: 0.7395][acc of former samples in all classes: 0.7281]
[acc of novel samples in all classes: 0.4767]
2022-11-05 06:09:18,336 INFO: Session 3: 64.73+-0.18[acc of former classes: 0.7137][acc of former samples in all classes: 0.6936]
[acc of novel samples in all classes: 0.4127]
2022-11-05 06:09:18,336 INFO: Session 4: 57.77+-0.95[acc of former classes: 0.6750][acc of former samples in all classes: 0.6438]
[acc of novel samples in all classes: 0.3588]
2022-11-05 06:09:18,336 INFO: Session 5: 55.96+-0.81[acc of former classes: 0.6765][acc of former samples in all classes: 0.6306]
[acc of novel samples in all classes: 0.3851]
2022-11-05 06:09:18,336 INFO: Session 6: 54.34+-0.29[acc of former classes: 0.6852][acc of former samples in all classes: 0.6352]
[acc of novel samples in all classes: 0.3635]
2022-11-05 06:09:18,336 INFO: Session 7: 53.62+-0.61[acc of former classes: 0.6895][acc of former samples in all classes: 0.6302]
[acc of novel samples in all classes: 0.3824]
2022-11-05 06:09:18,336 INFO: Session 8: 53.04+-0.66[acc of former classes: 0.6912][acc of former samples in all classes: 0.6217]
[acc of novel samples in all classes: 0.4026]
2022-11-05 06:09:18,336 INFO: Session 9: 50.45+-0.58[acc of former classes: 0.6831][acc of former samples in all classes: 0.6050]
[acc of novel samples in all classes: 0.3816]
2022-11-05 06:09:18,336 INFO: Session 10: 50.36+-0.74[acc of former classes: 0.6837][acc of former samples in all classes: 0.5978]
[acc of novel samples in all classes: 0.4010]
2022-11-05 06:09:18,336 INFO: Session 11: 49.48+-0.66[acc of former classes: 0.6843][acc of former samples in all classes: 0.5926]
[acc of novel samples in all classes: 0.3991]
2022-11-05 06:09:18,336 INFO: random seed: 1997
save network to: /workspace/FLOWER/f2m/increment/cub_bases100/FSLLModel_res18_cub_baseline_5shots_100base_wandb_debug/models/test4_session_10.pth
finish!!
