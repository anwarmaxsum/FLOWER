/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-10 10:01:41,388 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-10 10:01:41,388 INFO: 
  name: 1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug
  model_type: MTNBModel
  gpu: 1
  manual_seed: 1997
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  datasets:[
    train:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/train
      aug: True
      num_worker_per_gpu: 8
      batch_size_base_classes: None
      pin_memory: True
      pre_load: False
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    val:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      num_worker_per_gpu: 8
      pin_memory: True
      pre_load: False
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    test:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      num_worker_per_gpu: 8
      pin_memory: True
      pre_load: False
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
  ]
  network_g:[
    type: Resnet18_softmax
    Embed_dim: 512
    pretrained: False
    norm: False
    num_classes: 60
    adopt_classifier: False
    addition_net: False
    flatten: True
    cut_at_pooling: False
  ]
  path:[
    pretrain_model_g: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
    pretrain_prototypes: None
    base_model: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug
    training_states: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/training_states
    log: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug
    models: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.02
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [10]
      gamma: 1e-06
    ]
    random_noise:[
      distribution:[
        type: DiscreteBeta
      ]
      type: suffix_conv_weight
      num_layers: 4
      low: 0.1
      high: 5.0
      reduction_factor: 4
      bound_value: 0.01
      random_times: 4
    ]
    max_steps: 1
    ratio: 1
    fine_tune: True
    incremental: True
    fine_tune_epoch: 6
    warmup_iter: -1
    bases: 60
    tasks: 9
    novel_exemplars: 1
    shots: 1
    num_test: 5
    test_id: 1
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 1
      use_cosine: True
    ]
  ]
  val:[
    val_freq: 100
    test_type: NCM
    use_all_bases: False
  ]
  logger:[
    print_freq: 1
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-miniImageNet-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-10 10:01:41,388 INFO: Random seed: 1997
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:181: UserWarning: nn.init.kaiming_normal is now deprecated in favor of nn.init.kaiming_normal_.
  init.kaiming_normal(m.weight, mode='fan_out')
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:188: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  init.normal(m.weight, std=0.001)
2022-11-10 10:01:43,309 INFO: Network: Resnet18_softmax, with parameters: 11,689,512
2022-11-10 10:01:43,309 INFO: Resnet18_softmax(
  (func): ResNet_pytorch(
    (base): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=1000, bias=True)
    )
  )
)
2022-11-10 10:01:43,309 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:01:43,357 WARNING: Current net - loaded net:
2022-11-10 10:01:43,358 WARNING: Loaded net - current net:
2022-11-10 10:01:43,358 WARNING:   func.classifier.bias
2022-11-10 10:01:43,358 WARNING:   func.classifier.weight
2022-11-10 10:01:43,400 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:01:43,434 WARNING: Current net - loaded net:
2022-11-10 10:01:43,434 WARNING: Loaded net - current net:
2022-11-10 10:01:43,434 WARNING:   func.classifier.bias
2022-11-10 10:01:43,434 WARNING:   func.classifier.weight
2022-11-10 10:01:43,473 INFO: Obtain parameters for train
2022-11-10 10:01:43,482 INFO: Model [MTNBModel] is created.
2022-11-10 10:02:29,002 INFO: [Test_acc of task 0 on test 0: 0.66067][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.66067]
2022-11-10 10:02:29,252 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:02:29,292 WARNING: Current net - loaded net:
2022-11-10 10:02:29,292 WARNING: Loaded net - current net:
2022-11-10 10:02:29,292 WARNING:   func.classifier.bias
2022-11-10 10:02:29,292 WARNING:   func.classifier.weight
2022-11-10 10:02:29,331 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth.
2022-11-10 10:02:29,402 INFO: Obtain parameters for train
2022-11-10 10:02:29,407 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:02:29,407 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:02:29,408 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:02:29,409 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:02:29,409 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:02:29,409 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:02:29,409 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:02:29,409 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:02:29,409 INFO: Model [MTNBModel] is created.
2022-11-10 10:02:29,416 INFO: Dataset NormalDataset - miniImageNet is created.
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
>>> Test >>>
Former classes: []
Novel classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 10:02:29,917 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.8657, Acc: 1.0000, ]
2022-11-10 10:02:30,334 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.8871, Acc: 1.0000, ]
2022-11-10 10:02:30,800 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.8613, Acc: 1.0000, ]
2022-11-10 10:02:31,395 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.8982, Acc: 1.0000, ]
2022-11-10 10:02:31,946 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.8890, Acc: 1.0000, ]
2022-11-10 10:02:32,500 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.8845, Acc: 1.0000, ]
2022-11-10 10:02:32,574 INFO: fine-tune procedure is finished!
2022-11-10 10:03:20,209 INFO: [Test_acc of task 1 on test 0: 0.61000][acc of former classes: 0.66067][acc of former samples in all classes: 0.65983]
[acc of novel samples in all classes: 0.01200]
2022-11-10 10:03:20,497 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:03:20,525 WARNING: Current net - loaded net:
2022-11-10 10:03:20,526 WARNING: Loaded net - current net:
2022-11-10 10:03:20,526 WARNING:   func.classifier.bias
2022-11-10 10:03:20,526 WARNING:   func.classifier.weight
2022-11-10 10:03:20,566 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_1.pth.
2022-11-10 10:03:20,639 INFO: Obtain parameters for train
2022-11-10 10:03:20,644 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:03:20,644 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:03:20,645 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:03:20,646 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:03:20,646 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:03:20,646 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:03:20,646 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:03:20,646 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:03:20,646 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:03:20,646 INFO: Model [MTNBModel] is created.
2022-11-10 10:03:20,652 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:03:20,658 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 10:03:21,015 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9100, Acc: 1.0000, ]
2022-11-10 10:03:21,484 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9266, Acc: 1.0000, ]
2022-11-10 10:03:22,035 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9445, Acc: 1.0000, ]
2022-11-10 10:03:22,480 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9287, Acc: 1.0000, ]
2022-11-10 10:03:22,937 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9180, Acc: 1.0000, ]
2022-11-10 10:03:23,416 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9168, Acc: 1.0000, ]
2022-11-10 10:03:23,495 INFO: fine-tune procedure is finished!
2022-11-10 10:04:13,859 INFO: [Test_acc of task 2 on test 0: 0.56557][acc of former classes: 0.66067][acc of former samples in all classes: 0.65800]
[acc of novel samples in all classes: 0.01100]
2022-11-10 10:04:14,145 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:04:14,174 WARNING: Current net - loaded net:
2022-11-10 10:04:14,174 WARNING: Loaded net - current net:
2022-11-10 10:04:14,174 WARNING:   func.classifier.bias
2022-11-10 10:04:14,174 WARNING:   func.classifier.weight
2022-11-10 10:04:14,202 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_2.pth.
2022-11-10 10:04:14,241 INFO: Obtain parameters for train
2022-11-10 10:04:14,243 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:04:14,244 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:04:14,245 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:04:14,246 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:04:14,246 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:04:14,246 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:04:14,246 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:04:14,246 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:04:14,246 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:04:14,246 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:04:14,246 INFO: Model [MTNBModel] is created.
2022-11-10 10:04:14,252 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:04:14,258 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:04:14,263 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 10:04:14,641 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0090, Acc: 1.0000, ]
2022-11-10 10:04:15,250 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0058, Acc: 1.0000, ]
2022-11-10 10:04:15,839 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9985, Acc: 1.0000, ]
2022-11-10 10:04:16,321 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9951, Acc: 1.0000, ]
2022-11-10 10:04:16,787 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0075, Acc: 1.0000, ]
2022-11-10 10:04:17,269 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0120, Acc: 1.0000, ]
2022-11-10 10:04:17,353 INFO: fine-tune procedure is finished!
2022-11-10 10:05:16,479 INFO: [Test_acc of task 3 on test 0: 0.52893][acc of former classes: 0.66067][acc of former samples in all classes: 0.65617]
[acc of novel samples in all classes: 0.02000]
2022-11-10 10:05:16,775 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:05:16,805 WARNING: Current net - loaded net:
2022-11-10 10:05:16,805 WARNING: Loaded net - current net:
2022-11-10 10:05:16,805 WARNING:   func.classifier.bias
2022-11-10 10:05:16,805 WARNING:   func.classifier.weight
2022-11-10 10:05:16,842 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_3.pth.
2022-11-10 10:05:16,900 INFO: Obtain parameters for train
2022-11-10 10:05:16,906 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:05:16,906 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:05:16,906 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:05:16,907 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:05:16,908 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:05:16,909 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:05:16,909 INFO: Model [MTNBModel] is created.
2022-11-10 10:05:16,915 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:05:16,921 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:05:16,926 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:05:16,932 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 10:05:17,348 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0640, Acc: 1.0000, ]
2022-11-10 10:05:18,005 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0497, Acc: 1.0000, ]
2022-11-10 10:05:18,539 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0662, Acc: 1.0000, ]
2022-11-10 10:05:19,038 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0605, Acc: 1.0000, ]
2022-11-10 10:05:19,518 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0637, Acc: 1.0000, ]
2022-11-10 10:05:20,044 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0617, Acc: 1.0000, ]
2022-11-10 10:05:20,115 INFO: fine-tune procedure is finished!
2022-11-10 10:06:16,112 INFO: [Test_acc of task 4 on test 0: 0.49712][acc of former classes: 0.66067][acc of former samples in all classes: 0.65483]
[acc of novel samples in all classes: 0.02400]
2022-11-10 10:06:16,398 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:06:16,427 WARNING: Current net - loaded net:
2022-11-10 10:06:16,428 WARNING: Loaded net - current net:
2022-11-10 10:06:16,428 WARNING:   func.classifier.bias
2022-11-10 10:06:16,428 WARNING:   func.classifier.weight
2022-11-10 10:06:16,463 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_4.pth.
2022-11-10 10:06:16,526 INFO: Obtain parameters for train
2022-11-10 10:06:16,530 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:06:16,530 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:06:16,531 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:06:16,532 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:06:16,532 INFO: Model [MTNBModel] is created.
2022-11-10 10:06:16,541 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:06:16,547 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:06:16,552 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:06:16,558 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:06:16,563 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 10:06:16,968 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1036, Acc: 1.0000, ]
2022-11-10 10:06:17,410 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1182, Acc: 1.0000, ]
2022-11-10 10:06:18,049 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1077, Acc: 1.0000, ]
2022-11-10 10:06:18,584 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1161, Acc: 1.0000, ]
2022-11-10 10:06:19,099 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1276, Acc: 1.0000, ]
2022-11-10 10:06:19,754 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1287, Acc: 1.0000, ]
2022-11-10 10:06:19,834 INFO: fine-tune procedure is finished!
2022-11-10 10:07:23,748 INFO: [Test_acc of task 5 on test 0: 0.46753][acc of former classes: 0.66067][acc of former samples in all classes: 0.65283]
[acc of novel samples in all classes: 0.02280]
2022-11-10 10:07:24,063 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:07:24,091 WARNING: Current net - loaded net:
2022-11-10 10:07:24,091 WARNING: Loaded net - current net:
2022-11-10 10:07:24,092 WARNING:   func.classifier.bias
2022-11-10 10:07:24,092 WARNING:   func.classifier.weight
2022-11-10 10:07:24,158 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_5.pth.
2022-11-10 10:07:24,251 INFO: Obtain parameters for train
2022-11-10 10:07:24,258 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:07:24,259 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:07:24,260 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:07:24,261 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:07:24,261 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:07:24,261 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:07:24,261 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:07:24,261 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:07:24,261 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:07:24,261 INFO: Model [MTNBModel] is created.
2022-11-10 10:07:24,267 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:07:24,273 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:07:24,278 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:07:24,283 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:07:24,289 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:07:24,294 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 10:07:24,680 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1683, Acc: 1.0000, ]
2022-11-10 10:07:25,118 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1707, Acc: 1.0000, ]
2022-11-10 10:07:25,596 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1792, Acc: 1.0000, ]
2022-11-10 10:07:26,227 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1867, Acc: 1.0000, ]
2022-11-10 10:07:26,898 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1829, Acc: 1.0000, ]
2022-11-10 10:07:27,525 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1635, Acc: 1.0000, ]
2022-11-10 10:07:27,633 INFO: fine-tune procedure is finished!
2022-11-10 10:08:38,362 INFO: [Test_acc of task 6 on test 0: 0.44233][acc of former classes: 0.66067][acc of former samples in all classes: 0.65217]
[acc of novel samples in all classes: 0.02267]
2022-11-10 10:08:38,681 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:08:38,802 WARNING: Current net - loaded net:
2022-11-10 10:08:38,802 WARNING: Loaded net - current net:
2022-11-10 10:08:38,802 WARNING:   func.classifier.bias
2022-11-10 10:08:38,803 WARNING:   func.classifier.weight
2022-11-10 10:08:38,874 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_6.pth.
2022-11-10 10:08:38,975 INFO: Obtain parameters for train
2022-11-10 10:08:38,986 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:08:38,986 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:08:38,987 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:08:38,988 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:08:38,988 INFO: Model [MTNBModel] is created.
2022-11-10 10:08:38,995 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:08:39,000 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:08:39,005 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:08:39,011 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:08:39,016 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:08:39,022 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:08:39,027 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 10:08:39,476 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2303, Acc: 1.0000, ]
2022-11-10 10:08:40,015 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2160, Acc: 1.0000, ]
2022-11-10 10:08:40,585 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2263, Acc: 1.0000, ]
2022-11-10 10:08:41,091 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2175, Acc: 1.0000, ]
2022-11-10 10:08:41,715 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2126, Acc: 1.0000, ]
2022-11-10 10:08:42,285 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2196, Acc: 1.0000, ]
2022-11-10 10:08:42,358 INFO: fine-tune procedure is finished!
2022-11-10 10:09:57,138 INFO: [Test_acc of task 7 on test 0: 0.41926][acc of former classes: 0.66067][acc of former samples in all classes: 0.65050]
[acc of novel samples in all classes: 0.02286]
2022-11-10 10:09:57,458 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:09:57,487 WARNING: Current net - loaded net:
2022-11-10 10:09:57,487 WARNING: Loaded net - current net:
2022-11-10 10:09:57,487 WARNING:   func.classifier.bias
2022-11-10 10:09:57,487 WARNING:   func.classifier.weight
2022-11-10 10:09:57,562 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_7.pth.
2022-11-10 10:09:57,668 INFO: Obtain parameters for train
2022-11-10 10:09:57,677 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:09:57,677 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:09:57,678 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:09:57,679 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:09:57,679 INFO: Model [MTNBModel] is created.
2022-11-10 10:09:57,686 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:09:57,691 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:09:57,697 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:09:57,702 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:09:57,708 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:09:57,713 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:09:57,719 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:09:57,724 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 10:09:58,126 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2734, Acc: 1.0000, ]
2022-11-10 10:09:58,685 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2659, Acc: 1.0000, ]
2022-11-10 10:09:59,218 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2823, Acc: 1.0000, ]
2022-11-10 10:09:59,723 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2557, Acc: 1.0000, ]
2022-11-10 10:10:00,221 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2723, Acc: 1.0000, ]
2022-11-10 10:10:00,845 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2817, Acc: 1.0000, ]
2022-11-10 10:10:00,988 INFO: fine-tune procedure is finished!
2022-11-10 10:11:19,976 INFO: [Test_acc of task 8 on test 0: 0.39950][acc of former classes: 0.66067][acc of former samples in all classes: 0.64983]
[acc of novel samples in all classes: 0.02400]
2022-11-10 10:11:20,297 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:11:20,325 WARNING: Current net - loaded net:
2022-11-10 10:11:20,326 WARNING: Loaded net - current net:
2022-11-10 10:11:20,326 WARNING:   func.classifier.bias
2022-11-10 10:11:20,326 WARNING:   func.classifier.weight
2022-11-10 10:11:20,398 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth.
2022-11-10 10:11:20,497 INFO: Obtain parameters for train
2022-11-10 10:11:20,506 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:11:20,506 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:11:20,506 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:11:20,506 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:11:20,506 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:11:20,506 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:11:20,506 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:11:20,506 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:11:20,507 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:11:20,508 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:11:20,509 INFO: Model [MTNBModel] is created.
2022-11-10 10:11:20,515 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 10:11:20,869 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.8851, Acc: 1.0000, ]
2022-11-10 10:11:21,301 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.8718, Acc: 1.0000, ]
2022-11-10 10:11:21,743 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.8745, Acc: 1.0000, ]
2022-11-10 10:11:22,167 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.8735, Acc: 1.0000, ]
2022-11-10 10:11:22,588 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.8871, Acc: 1.0000, ]
2022-11-10 10:11:23,024 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.8699, Acc: 1.0000, ]
2022-11-10 10:11:23,142 INFO: fine-tune procedure is finished!
2022-11-10 10:12:18,269 INFO: [Test_acc of task 1 on test 1: 0.60908][acc of former classes: 0.66067][acc of former samples in all classes: 0.65917]
[acc of novel samples in all classes: 0.00800]
2022-11-10 10:12:18,613 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:12:18,641 WARNING: Current net - loaded net:
2022-11-10 10:12:18,641 WARNING: Loaded net - current net:
2022-11-10 10:12:18,641 WARNING:   func.classifier.bias
2022-11-10 10:12:18,641 WARNING:   func.classifier.weight
2022-11-10 10:12:18,713 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_1.pth.
2022-11-10 10:12:18,820 INFO: Obtain parameters for train
2022-11-10 10:12:18,827 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:12:18,827 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:12:18,827 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:12:18,827 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:12:18,827 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:12:18,827 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:12:18,828 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:12:18,829 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:12:18,830 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:12:18,830 INFO: Model [MTNBModel] is created.
2022-11-10 10:12:18,836 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:12:18,842 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 10:12:19,302 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9290, Acc: 1.0000, ]
2022-11-10 10:12:19,913 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9467, Acc: 1.0000, ]
2022-11-10 10:12:20,496 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9337, Acc: 1.0000, ]
2022-11-10 10:12:21,002 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9452, Acc: 1.0000, ]
2022-11-10 10:12:21,655 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9433, Acc: 1.0000, ]
2022-11-10 10:12:22,184 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9393, Acc: 1.0000, ]
2022-11-10 10:12:22,264 INFO: fine-tune procedure is finished!
2022-11-10 10:13:21,347 INFO: [Test_acc of task 2 on test 1: 0.56486][acc of former classes: 0.66067][acc of former samples in all classes: 0.65783]
[acc of novel samples in all classes: 0.00700]
2022-11-10 10:13:21,677 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:13:21,707 WARNING: Current net - loaded net:
2022-11-10 10:13:21,707 WARNING: Loaded net - current net:
2022-11-10 10:13:21,707 WARNING:   func.classifier.bias
2022-11-10 10:13:21,707 WARNING:   func.classifier.weight
2022-11-10 10:13:21,780 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_2.pth.
2022-11-10 10:13:21,881 INFO: Obtain parameters for train
2022-11-10 10:13:21,896 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:13:21,896 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:13:21,897 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:13:21,898 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:13:21,898 INFO: Model [MTNBModel] is created.
2022-11-10 10:13:21,904 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:13:21,910 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:13:21,915 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 10:13:22,283 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9909, Acc: 1.0000, ]
2022-11-10 10:13:22,726 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0056, Acc: 1.0000, ]
2022-11-10 10:13:23,333 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0062, Acc: 1.0000, ]
2022-11-10 10:13:23,936 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0069, Acc: 1.0000, ]
2022-11-10 10:13:24,465 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9812, Acc: 1.0000, ]
2022-11-10 10:13:24,921 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9952, Acc: 1.0000, ]
2022-11-10 10:13:24,995 INFO: fine-tune procedure is finished!
2022-11-10 10:14:28,928 INFO: [Test_acc of task 3 on test 1: 0.52840][acc of former classes: 0.66067][acc of former samples in all classes: 0.65667]
[acc of novel samples in all classes: 0.01533]
2022-11-10 10:14:29,267 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:14:29,303 WARNING: Current net - loaded net:
2022-11-10 10:14:29,303 WARNING: Loaded net - current net:
2022-11-10 10:14:29,303 WARNING:   func.classifier.bias
2022-11-10 10:14:29,303 WARNING:   func.classifier.weight
2022-11-10 10:14:29,372 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_3.pth.
2022-11-10 10:14:29,479 INFO: Obtain parameters for train
2022-11-10 10:14:29,491 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:14:29,491 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:14:29,491 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:14:29,491 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:14:29,491 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:14:29,492 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:14:29,493 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:14:29,494 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:14:29,494 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:14:29,494 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:14:29,494 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:14:29,494 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:14:29,494 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:14:29,494 INFO: Model [MTNBModel] is created.
2022-11-10 10:14:29,502 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:14:29,509 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:14:29,515 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:14:29,522 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 10:14:29,995 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0606, Acc: 1.0000, ]
2022-11-10 10:14:30,667 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0484, Acc: 1.0000, ]
2022-11-10 10:14:31,207 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0627, Acc: 1.0000, ]
2022-11-10 10:14:31,940 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0530, Acc: 1.0000, ]
2022-11-10 10:14:32,610 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0619, Acc: 1.0000, ]
2022-11-10 10:14:33,240 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0735, Acc: 1.0000, ]
2022-11-10 10:14:33,346 INFO: fine-tune procedure is finished!
2022-11-10 10:15:40,789 INFO: [Test_acc of task 4 on test 1: 0.49562][acc of former classes: 0.66067][acc of former samples in all classes: 0.65567]
[acc of novel samples in all classes: 0.01550]
2022-11-10 10:15:41,148 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:15:41,180 WARNING: Current net - loaded net:
2022-11-10 10:15:41,180 WARNING: Loaded net - current net:
2022-11-10 10:15:41,180 WARNING:   func.classifier.bias
2022-11-10 10:15:41,180 WARNING:   func.classifier.weight
2022-11-10 10:15:41,247 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_4.pth.
2022-11-10 10:15:41,342 INFO: Obtain parameters for train
2022-11-10 10:15:41,351 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:15:41,351 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:15:41,351 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:15:41,352 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:15:41,353 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:15:41,354 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:15:41,355 INFO: Model [MTNBModel] is created.
2022-11-10 10:15:41,364 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:15:41,370 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:15:41,376 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:15:41,382 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:15:41,388 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 10:15:41,892 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1000, Acc: 1.0000, ]
2022-11-10 10:15:42,483 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1115, Acc: 1.0000, ]
2022-11-10 10:15:43,071 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1095, Acc: 1.0000, ]
2022-11-10 10:15:43,811 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1264, Acc: 1.0000, ]
2022-11-10 10:15:44,602 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1054, Acc: 1.0000, ]
2022-11-10 10:15:45,455 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1154, Acc: 1.0000, ]
2022-11-10 10:15:45,591 INFO: fine-tune procedure is finished!
2022-11-10 10:16:56,390 INFO: [Test_acc of task 5 on test 1: 0.46576][acc of former classes: 0.66067][acc of former samples in all classes: 0.65283]
[acc of novel samples in all classes: 0.01680]
2022-11-10 10:16:56,732 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:16:56,760 WARNING: Current net - loaded net:
2022-11-10 10:16:56,760 WARNING: Loaded net - current net:
2022-11-10 10:16:56,760 WARNING:   func.classifier.bias
2022-11-10 10:16:56,760 WARNING:   func.classifier.weight
2022-11-10 10:16:56,832 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_5.pth.
2022-11-10 10:16:56,931 INFO: Obtain parameters for train
2022-11-10 10:16:56,938 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:16:56,938 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:16:56,939 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:16:56,940 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:16:56,941 INFO: Model [MTNBModel] is created.
2022-11-10 10:16:56,947 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:16:56,952 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:16:56,958 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:16:56,963 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:16:56,969 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:16:56,974 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 10:16:57,389 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1804, Acc: 1.0000, ]
2022-11-10 10:16:58,034 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1822, Acc: 1.0000, ]
2022-11-10 10:16:58,667 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1874, Acc: 1.0000, ]
2022-11-10 10:16:59,341 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1814, Acc: 1.0000, ]
2022-11-10 10:16:59,987 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1777, Acc: 1.0000, ]
2022-11-10 10:17:00,696 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1747, Acc: 1.0000, ]
2022-11-10 10:17:00,824 INFO: fine-tune procedure is finished!
2022-11-10 10:18:14,166 INFO: [Test_acc of task 6 on test 1: 0.43967][acc of former classes: 0.66067][acc of former samples in all classes: 0.65233]
[acc of novel samples in all classes: 0.01433]
2022-11-10 10:18:14,526 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:18:14,560 WARNING: Current net - loaded net:
2022-11-10 10:18:14,560 WARNING: Loaded net - current net:
2022-11-10 10:18:14,560 WARNING:   func.classifier.bias
2022-11-10 10:18:14,560 WARNING:   func.classifier.weight
2022-11-10 10:18:14,629 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_6.pth.
2022-11-10 10:18:14,730 INFO: Obtain parameters for train
2022-11-10 10:18:14,737 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:18:14,737 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:18:14,738 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:18:14,739 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:18:14,740 INFO: Model [MTNBModel] is created.
2022-11-10 10:18:14,747 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:18:14,753 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:18:14,760 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:18:14,766 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:18:14,771 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:18:14,777 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:18:14,782 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 10:18:15,205 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2343, Acc: 1.0000, ]
2022-11-10 10:18:15,906 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2355, Acc: 1.0000, ]
2022-11-10 10:18:16,484 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2290, Acc: 1.0000, ]
2022-11-10 10:18:17,217 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2217, Acc: 1.0000, ]
2022-11-10 10:18:17,865 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2285, Acc: 1.0000, ]
2022-11-10 10:18:18,554 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2289, Acc: 1.0000, ]
2022-11-10 10:18:18,675 INFO: fine-tune procedure is finished!
2022-11-10 10:19:35,575 INFO: [Test_acc of task 7 on test 1: 0.41874][acc of former classes: 0.66067][acc of former samples in all classes: 0.65133]
[acc of novel samples in all classes: 0.02000]
2022-11-10 10:19:35,914 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:19:35,944 WARNING: Current net - loaded net:
2022-11-10 10:19:35,944 WARNING: Loaded net - current net:
2022-11-10 10:19:35,944 WARNING:   func.classifier.bias
2022-11-10 10:19:35,944 WARNING:   func.classifier.weight
2022-11-10 10:19:35,982 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_7.pth.
2022-11-10 10:19:36,056 INFO: Obtain parameters for train
2022-11-10 10:19:36,061 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:19:36,061 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:19:36,062 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:19:36,063 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:19:36,064 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:19:36,064 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:19:36,064 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:19:36,064 INFO: Model [MTNBModel] is created.
2022-11-10 10:19:36,071 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:19:36,078 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:19:36,084 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:19:36,090 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:19:36,096 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:19:36,103 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:19:36,109 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:19:36,115 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 10:19:36,679 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2735, Acc: 1.0000, ]
2022-11-10 10:19:37,355 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2749, Acc: 1.0000, ]
2022-11-10 10:19:38,154 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2710, Acc: 1.0000, ]
2022-11-10 10:19:38,846 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2624, Acc: 1.0000, ]
2022-11-10 10:19:39,582 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2726, Acc: 1.0000, ]
2022-11-10 10:19:40,326 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2651, Acc: 1.0000, ]
2022-11-10 10:19:40,449 INFO: fine-tune procedure is finished!
2022-11-10 10:21:00,691 INFO: [Test_acc of task 8 on test 1: 0.40150][acc of former classes: 0.66067][acc of former samples in all classes: 0.65083]
[acc of novel samples in all classes: 0.02750]
2022-11-10 10:21:01,040 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:21:01,075 WARNING: Current net - loaded net:
2022-11-10 10:21:01,075 WARNING: Loaded net - current net:
2022-11-10 10:21:01,075 WARNING:   func.classifier.bias
2022-11-10 10:21:01,075 WARNING:   func.classifier.weight
2022-11-10 10:21:01,151 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth.
2022-11-10 10:21:01,260 INFO: Obtain parameters for train
2022-11-10 10:21:01,267 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:21:01,267 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:21:01,268 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:21:01,269 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:21:01,269 INFO: Model [MTNBModel] is created.
2022-11-10 10:21:01,276 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 10:21:01,938 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.8586, Acc: 1.0000, ]
2022-11-10 10:21:02,564 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.8876, Acc: 1.0000, ]
2022-11-10 10:21:03,233 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.8666, Acc: 1.0000, ]
2022-11-10 10:21:03,763 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.8767, Acc: 1.0000, ]
2022-11-10 10:21:04,277 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.8688, Acc: 1.0000, ]
2022-11-10 10:21:04,941 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.8700, Acc: 1.0000, ]
2022-11-10 10:21:05,095 INFO: fine-tune procedure is finished!
2022-11-10 10:22:02,097 INFO: [Test_acc of task 1 on test 2: 0.60923][acc of former classes: 0.66067][acc of former samples in all classes: 0.65917]
[acc of novel samples in all classes: 0.01000]
2022-11-10 10:22:02,423 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:22:02,452 WARNING: Current net - loaded net:
2022-11-10 10:22:02,452 WARNING: Loaded net - current net:
2022-11-10 10:22:02,452 WARNING:   func.classifier.bias
2022-11-10 10:22:02,452 WARNING:   func.classifier.weight
2022-11-10 10:22:02,492 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_1.pth.
2022-11-10 10:22:02,578 INFO: Obtain parameters for train
2022-11-10 10:22:02,584 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:22:02,584 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:22:02,585 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:22:02,586 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:22:02,586 INFO: Model [MTNBModel] is created.
2022-11-10 10:22:02,595 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:22:02,600 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 10:22:03,113 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9203, Acc: 1.0000, ]
2022-11-10 10:22:03,719 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9291, Acc: 1.0000, ]
2022-11-10 10:22:04,376 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9118, Acc: 1.0000, ]
2022-11-10 10:22:05,002 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9380, Acc: 1.0000, ]
2022-11-10 10:22:05,631 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9353, Acc: 1.0000, ]
2022-11-10 10:22:06,349 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9257, Acc: 1.0000, ]
2022-11-10 10:22:06,472 INFO: fine-tune procedure is finished!
2022-11-10 10:23:07,588 INFO: [Test_acc of task 2 on test 2: 0.56586][acc of former classes: 0.66067][acc of former samples in all classes: 0.65833]
[acc of novel samples in all classes: 0.01100]
2022-11-10 10:23:07,948 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:23:07,983 WARNING: Current net - loaded net:
2022-11-10 10:23:07,983 WARNING: Loaded net - current net:
2022-11-10 10:23:07,983 WARNING:   func.classifier.bias
2022-11-10 10:23:07,983 WARNING:   func.classifier.weight
2022-11-10 10:23:08,048 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_2.pth.
2022-11-10 10:23:08,152 INFO: Obtain parameters for train
2022-11-10 10:23:08,158 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:23:08,158 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:23:08,158 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:23:08,158 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:23:08,158 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:23:08,158 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:23:08,159 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:23:08,160 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:23:08,161 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:23:08,161 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:23:08,161 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:23:08,161 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:23:08,161 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:23:08,161 INFO: Model [MTNBModel] is created.
2022-11-10 10:23:08,167 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:23:08,173 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:23:08,178 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 10:23:08,644 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9935, Acc: 1.0000, ]
2022-11-10 10:23:09,309 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0006, Acc: 1.0000, ]
2022-11-10 10:23:10,788 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0099, Acc: 1.0000, ]
2022-11-10 10:23:11,498 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0141, Acc: 1.0000, ]
2022-11-10 10:23:12,118 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0222, Acc: 1.0000, ]
2022-11-10 10:23:12,785 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0024, Acc: 1.0000, ]
2022-11-10 10:23:12,926 INFO: fine-tune procedure is finished!
2022-11-10 10:24:16,566 INFO: [Test_acc of task 3 on test 2: 0.52760][acc of former classes: 0.66067][acc of former samples in all classes: 0.65600]
[acc of novel samples in all classes: 0.01400]
2022-11-10 10:24:16,919 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:24:16,948 WARNING: Current net - loaded net:
2022-11-10 10:24:16,948 WARNING: Loaded net - current net:
2022-11-10 10:24:16,948 WARNING:   func.classifier.bias
2022-11-10 10:24:16,948 WARNING:   func.classifier.weight
2022-11-10 10:24:17,019 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_3.pth.
2022-11-10 10:24:17,125 INFO: Obtain parameters for train
2022-11-10 10:24:17,133 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:24:17,133 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:24:17,134 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:24:17,135 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:24:17,135 INFO: Model [MTNBModel] is created.
2022-11-10 10:24:17,142 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:24:17,147 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:24:17,153 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:24:17,159 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 10:24:17,618 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0638, Acc: 1.0000, ]
2022-11-10 10:24:18,304 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0732, Acc: 1.0000, ]
2022-11-10 10:24:18,973 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0689, Acc: 1.0000, ]
2022-11-10 10:24:19,619 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0795, Acc: 1.0000, ]
2022-11-10 10:24:20,236 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0741, Acc: 1.0000, ]
2022-11-10 10:24:20,840 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0707, Acc: 1.0000, ]
2022-11-10 10:24:20,929 INFO: fine-tune procedure is finished!
2022-11-10 10:25:27,609 INFO: [Test_acc of task 4 on test 2: 0.49488][acc of former classes: 0.66067][acc of former samples in all classes: 0.65467]
[acc of novel samples in all classes: 0.01550]
2022-11-10 10:25:27,952 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:25:27,980 WARNING: Current net - loaded net:
2022-11-10 10:25:27,980 WARNING: Loaded net - current net:
2022-11-10 10:25:27,980 WARNING:   func.classifier.bias
2022-11-10 10:25:27,980 WARNING:   func.classifier.weight
2022-11-10 10:25:28,057 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_4.pth.
2022-11-10 10:25:28,163 INFO: Obtain parameters for train
2022-11-10 10:25:28,170 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:25:28,170 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:25:28,171 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:25:28,172 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:25:28,172 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:25:28,172 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:25:28,172 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:25:28,172 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:25:28,172 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:25:28,172 INFO: Model [MTNBModel] is created.
2022-11-10 10:25:28,178 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:25:28,183 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:25:28,189 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:25:28,194 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:25:28,200 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 10:25:28,607 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1369, Acc: 1.0000, ]
2022-11-10 10:25:29,223 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1324, Acc: 1.0000, ]
2022-11-10 10:25:29,872 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1254, Acc: 1.0000, ]
2022-11-10 10:25:30,463 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1304, Acc: 1.0000, ]
2022-11-10 10:25:31,059 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1250, Acc: 1.0000, ]
2022-11-10 10:25:31,646 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1147, Acc: 1.0000, ]
2022-11-10 10:25:31,799 INFO: fine-tune procedure is finished!
2022-11-10 10:26:42,248 INFO: [Test_acc of task 5 on test 2: 0.46671][acc of former classes: 0.66067][acc of former samples in all classes: 0.65300]
[acc of novel samples in all classes: 0.01960]
2022-11-10 10:26:42,601 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:26:42,632 WARNING: Current net - loaded net:
2022-11-10 10:26:42,632 WARNING: Loaded net - current net:
2022-11-10 10:26:42,632 WARNING:   func.classifier.bias
2022-11-10 10:26:42,632 WARNING:   func.classifier.weight
2022-11-10 10:26:42,701 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_5.pth.
2022-11-10 10:26:42,807 INFO: Obtain parameters for train
2022-11-10 10:26:42,814 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:26:42,815 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:26:42,816 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:26:42,817 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:26:42,817 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:26:42,817 INFO: Model [MTNBModel] is created.
2022-11-10 10:26:42,823 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:26:42,829 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:26:42,834 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:26:42,840 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:26:42,846 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:26:42,853 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 10:26:43,354 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1789, Acc: 1.0000, ]
2022-11-10 10:26:44,023 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1776, Acc: 1.0000, ]
2022-11-10 10:26:44,626 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1745, Acc: 1.0000, ]
2022-11-10 10:26:45,246 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1838, Acc: 1.0000, ]
2022-11-10 10:26:45,915 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1793, Acc: 1.0000, ]
2022-11-10 10:26:46,578 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1888, Acc: 1.0000, ]
2022-11-10 10:26:46,819 INFO: fine-tune procedure is finished!
2022-11-10 10:28:00,434 INFO: [Test_acc of task 6 on test 2: 0.44078][acc of former classes: 0.66067][acc of former samples in all classes: 0.65267]
[acc of novel samples in all classes: 0.01700]
2022-11-10 10:28:00,765 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:28:00,794 WARNING: Current net - loaded net:
2022-11-10 10:28:00,795 WARNING: Loaded net - current net:
2022-11-10 10:28:00,795 WARNING:   func.classifier.bias
2022-11-10 10:28:00,795 WARNING:   func.classifier.weight
2022-11-10 10:28:00,861 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_6.pth.
2022-11-10 10:28:00,963 INFO: Obtain parameters for train
2022-11-10 10:28:00,971 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:28:00,971 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:28:00,971 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:28:00,971 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:28:00,971 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:28:00,971 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:28:00,972 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:28:00,973 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:28:00,974 INFO: Model [MTNBModel] is created.
2022-11-10 10:28:00,980 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:28:00,985 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:28:00,991 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:28:00,996 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:28:01,002 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:28:01,007 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:28:01,013 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 10:28:01,496 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2318, Acc: 1.0000, ]
2022-11-10 10:28:02,168 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2287, Acc: 1.0000, ]
2022-11-10 10:28:02,709 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2295, Acc: 1.0000, ]
2022-11-10 10:28:03,345 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2277, Acc: 1.0000, ]
2022-11-10 10:28:03,997 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2305, Acc: 1.0000, ]
2022-11-10 10:28:04,635 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2369, Acc: 1.0000, ]
2022-11-10 10:28:04,749 INFO: fine-tune procedure is finished!
2022-11-10 10:29:22,698 INFO: [Test_acc of task 7 on test 2: 0.41842][acc of former classes: 0.66067][acc of former samples in all classes: 0.65183]
[acc of novel samples in all classes: 0.01829]
2022-11-10 10:29:23,035 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:29:23,064 WARNING: Current net - loaded net:
2022-11-10 10:29:23,064 WARNING: Loaded net - current net:
2022-11-10 10:29:23,064 WARNING:   func.classifier.bias
2022-11-10 10:29:23,064 WARNING:   func.classifier.weight
2022-11-10 10:29:23,136 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_7.pth.
2022-11-10 10:29:23,241 INFO: Obtain parameters for train
2022-11-10 10:29:23,248 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:29:23,248 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:29:23,249 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:29:23,250 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:29:23,250 INFO: Model [MTNBModel] is created.
2022-11-10 10:29:23,257 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:29:23,262 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:29:23,268 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:29:23,273 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:29:23,279 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:29:23,284 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:29:23,290 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:29:23,295 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 10:29:23,735 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2765, Acc: 1.0000, ]
2022-11-10 10:29:24,434 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2796, Acc: 1.0000, ]
2022-11-10 10:29:24,941 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2820, Acc: 1.0000, ]
2022-11-10 10:29:25,460 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2635, Acc: 1.0000, ]
2022-11-10 10:29:25,920 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2839, Acc: 1.0000, ]
2022-11-10 10:29:26,601 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2710, Acc: 1.0000, ]
2022-11-10 10:29:26,726 INFO: fine-tune procedure is finished!
2022-11-10 10:30:46,385 INFO: [Test_acc of task 8 on test 2: 0.39700][acc of former classes: 0.66067][acc of former samples in all classes: 0.65067]
[acc of novel samples in all classes: 0.01650]
2022-11-10 10:30:46,724 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:30:46,755 WARNING: Current net - loaded net:
2022-11-10 10:30:46,755 WARNING: Loaded net - current net:
2022-11-10 10:30:46,755 WARNING:   func.classifier.bias
2022-11-10 10:30:46,755 WARNING:   func.classifier.weight
2022-11-10 10:30:46,818 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth.
2022-11-10 10:30:46,918 INFO: Obtain parameters for train
2022-11-10 10:30:46,925 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:30:46,925 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:30:46,926 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:30:46,927 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:30:46,927 INFO: Model [MTNBModel] is created.
2022-11-10 10:30:46,935 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 10:30:48,412 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.8819, Acc: 1.0000, ]
2022-11-10 10:30:49,082 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.8943, Acc: 1.0000, ]
2022-11-10 10:30:49,686 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.8746, Acc: 1.0000, ]
2022-11-10 10:30:50,159 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.8891, Acc: 1.0000, ]
2022-11-10 10:30:50,724 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.8448, Acc: 1.0000, ]
2022-11-10 10:30:51,207 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.8474, Acc: 1.0000, ]
2022-11-10 10:30:51,291 INFO: fine-tune procedure is finished!
2022-11-10 10:31:48,070 INFO: [Test_acc of task 1 on test 3: 0.60831][acc of former classes: 0.66067][acc of former samples in all classes: 0.65783]
[acc of novel samples in all classes: 0.01400]
2022-11-10 10:31:48,423 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:31:48,451 WARNING: Current net - loaded net:
2022-11-10 10:31:48,451 WARNING: Loaded net - current net:
2022-11-10 10:31:48,451 WARNING:   func.classifier.bias
2022-11-10 10:31:48,451 WARNING:   func.classifier.weight
2022-11-10 10:31:48,520 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_1.pth.
2022-11-10 10:31:48,627 INFO: Obtain parameters for train
2022-11-10 10:31:48,635 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:31:48,635 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:31:48,635 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:31:48,636 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:31:48,637 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:31:48,638 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:31:48,638 INFO: Model [MTNBModel] is created.
2022-11-10 10:31:48,646 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:31:48,653 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 10:31:49,074 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9392, Acc: 1.0000, ]
2022-11-10 10:31:49,846 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9540, Acc: 1.0000, ]
2022-11-10 10:31:50,529 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9402, Acc: 1.0000, ]
2022-11-10 10:31:51,066 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9433, Acc: 1.0000, ]
2022-11-10 10:31:51,768 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9286, Acc: 1.0000, ]
2022-11-10 10:31:52,414 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9381, Acc: 1.0000, ]
2022-11-10 10:31:52,523 INFO: fine-tune procedure is finished!
2022-11-10 10:32:52,622 INFO: [Test_acc of task 2 on test 3: 0.56414][acc of former classes: 0.66067][acc of former samples in all classes: 0.65550]
[acc of novel samples in all classes: 0.01600]
2022-11-10 10:32:52,959 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:32:52,988 WARNING: Current net - loaded net:
2022-11-10 10:32:52,989 WARNING: Loaded net - current net:
2022-11-10 10:32:52,989 WARNING:   func.classifier.bias
2022-11-10 10:32:52,989 WARNING:   func.classifier.weight
2022-11-10 10:32:53,059 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_2.pth.
2022-11-10 10:32:53,132 INFO: Obtain parameters for train
2022-11-10 10:32:53,136 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:32:53,136 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:32:53,137 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:32:53,138 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:32:53,138 INFO: Model [MTNBModel] is created.
2022-11-10 10:32:53,144 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:32:53,150 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:32:53,156 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 10:32:53,531 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0077, Acc: 1.0000, ]
2022-11-10 10:32:54,041 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0011, Acc: 1.0000, ]
2022-11-10 10:32:54,543 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0175, Acc: 1.0000, ]
2022-11-10 10:32:55,215 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9969, Acc: 1.0000, ]
2022-11-10 10:32:55,978 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0173, Acc: 1.0000, ]
2022-11-10 10:32:56,921 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0134, Acc: 1.0000, ]
2022-11-10 10:32:57,013 INFO: fine-tune procedure is finished!
2022-11-10 10:34:00,234 INFO: [Test_acc of task 3 on test 3: 0.52733][acc of former classes: 0.66067][acc of former samples in all classes: 0.65350]
[acc of novel samples in all classes: 0.02267]
2022-11-10 10:34:00,563 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:34:00,593 WARNING: Current net - loaded net:
2022-11-10 10:34:00,593 WARNING: Loaded net - current net:
2022-11-10 10:34:00,593 WARNING:   func.classifier.bias
2022-11-10 10:34:00,593 WARNING:   func.classifier.weight
2022-11-10 10:34:00,667 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_3.pth.
2022-11-10 10:34:00,770 INFO: Obtain parameters for train
2022-11-10 10:34:00,779 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:34:00,779 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:34:00,780 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:34:00,781 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:34:00,781 INFO: Model [MTNBModel] is created.
2022-11-10 10:34:00,787 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:34:00,793 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:34:00,798 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:34:00,804 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 10:34:01,197 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0789, Acc: 1.0000, ]
2022-11-10 10:34:01,771 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0710, Acc: 1.0000, ]
2022-11-10 10:34:02,241 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0794, Acc: 1.0000, ]
2022-11-10 10:34:02,797 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0760, Acc: 1.0000, ]
2022-11-10 10:34:03,336 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0687, Acc: 1.0000, ]
2022-11-10 10:34:03,966 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0541, Acc: 1.0000, ]
2022-11-10 10:34:04,053 INFO: fine-tune procedure is finished!
2022-11-10 10:35:09,677 INFO: [Test_acc of task 4 on test 3: 0.49438][acc of former classes: 0.66067][acc of former samples in all classes: 0.65133]
[acc of novel samples in all classes: 0.02350]
2022-11-10 10:35:10,007 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:35:10,035 WARNING: Current net - loaded net:
2022-11-10 10:35:10,035 WARNING: Loaded net - current net:
2022-11-10 10:35:10,035 WARNING:   func.classifier.bias
2022-11-10 10:35:10,035 WARNING:   func.classifier.weight
2022-11-10 10:35:10,107 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_4.pth.
2022-11-10 10:35:10,215 INFO: Obtain parameters for train
2022-11-10 10:35:10,221 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:35:10,221 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:35:10,222 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:35:10,223 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:35:10,223 INFO: Model [MTNBModel] is created.
2022-11-10 10:35:10,229 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:35:10,235 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:35:10,241 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:35:10,246 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:35:10,251 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 10:35:10,746 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1384, Acc: 1.0000, ]
2022-11-10 10:35:11,313 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1354, Acc: 1.0000, ]
2022-11-10 10:35:11,882 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1220, Acc: 1.0000, ]
2022-11-10 10:35:12,575 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1317, Acc: 1.0000, ]
2022-11-10 10:35:13,291 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1397, Acc: 1.0000, ]
2022-11-10 10:35:13,772 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1454, Acc: 1.0000, ]
2022-11-10 10:35:13,880 INFO: fine-tune procedure is finished!
2022-11-10 10:36:21,977 INFO: [Test_acc of task 5 on test 3: 0.46612][acc of former classes: 0.66067][acc of former samples in all classes: 0.65000]
[acc of novel samples in all classes: 0.02480]
2022-11-10 10:36:22,282 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:36:22,312 WARNING: Current net - loaded net:
2022-11-10 10:36:22,312 WARNING: Loaded net - current net:
2022-11-10 10:36:22,312 WARNING:   func.classifier.bias
2022-11-10 10:36:22,312 WARNING:   func.classifier.weight
2022-11-10 10:36:22,355 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_5.pth.
2022-11-10 10:36:22,436 INFO: Obtain parameters for train
2022-11-10 10:36:22,444 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:36:22,444 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:36:22,445 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:36:22,446 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:36:22,447 INFO: Model [MTNBModel] is created.
2022-11-10 10:36:22,455 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:36:22,461 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:36:22,466 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:36:22,472 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:36:22,478 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:36:22,485 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 10:36:22,960 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1878, Acc: 1.0000, ]
2022-11-10 10:36:23,523 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1670, Acc: 1.0000, ]
2022-11-10 10:36:24,065 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1892, Acc: 1.0000, ]
2022-11-10 10:36:24,603 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1648, Acc: 1.0000, ]
2022-11-10 10:36:25,207 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1747, Acc: 1.0000, ]
2022-11-10 10:36:25,863 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1789, Acc: 1.0000, ]
2022-11-10 10:36:25,950 INFO: fine-tune procedure is finished!
2022-11-10 10:37:26,783 INFO: [Test_acc of task 6 on test 3: 0.43989][acc of former classes: 0.66067][acc of former samples in all classes: 0.64867]
[acc of novel samples in all classes: 0.02233]
2022-11-10 10:37:27,081 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:37:27,110 WARNING: Current net - loaded net:
2022-11-10 10:37:27,111 WARNING: Loaded net - current net:
2022-11-10 10:37:27,111 WARNING:   func.classifier.bias
2022-11-10 10:37:27,111 WARNING:   func.classifier.weight
2022-11-10 10:37:27,218 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_6.pth.
2022-11-10 10:37:27,298 INFO: Obtain parameters for train
2022-11-10 10:37:27,306 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:37:27,306 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:37:27,307 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:37:27,308 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:37:27,308 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:37:27,308 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:37:27,308 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:37:27,308 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:37:27,308 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:37:27,308 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:37:27,308 INFO: Model [MTNBModel] is created.
2022-11-10 10:37:27,314 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:37:27,320 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:37:27,325 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:37:27,331 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:37:27,336 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:37:27,341 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:37:27,347 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 10:37:27,737 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2395, Acc: 1.0000, ]
2022-11-10 10:37:28,188 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2305, Acc: 1.0000, ]
2022-11-10 10:37:28,644 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2196, Acc: 1.0000, ]
2022-11-10 10:37:29,161 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2272, Acc: 1.0000, ]
2022-11-10 10:37:29,606 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2375, Acc: 1.0000, ]
2022-11-10 10:37:30,069 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2181, Acc: 1.0000, ]
2022-11-10 10:37:30,181 INFO: fine-tune procedure is finished!
2022-11-10 10:38:34,695 INFO: [Test_acc of task 7 on test 3: 0.41737][acc of former classes: 0.66067][acc of former samples in all classes: 0.64750]
[acc of novel samples in all classes: 0.02286]
2022-11-10 10:38:35,008 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:38:35,037 WARNING: Current net - loaded net:
2022-11-10 10:38:35,037 WARNING: Loaded net - current net:
2022-11-10 10:38:35,037 WARNING:   func.classifier.bias
2022-11-10 10:38:35,037 WARNING:   func.classifier.weight
2022-11-10 10:38:35,079 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_7.pth.
2022-11-10 10:38:35,153 INFO: Obtain parameters for train
2022-11-10 10:38:35,159 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:38:35,159 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:38:35,160 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:38:35,161 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:38:35,161 INFO: Model [MTNBModel] is created.
2022-11-10 10:38:35,168 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:38:35,175 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:38:35,181 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:38:35,187 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:38:35,192 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:38:35,198 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:38:35,203 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:38:35,209 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 10:38:35,669 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2825, Acc: 1.0000, ]
2022-11-10 10:38:36,193 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2641, Acc: 1.0000, ]
2022-11-10 10:38:36,764 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2772, Acc: 1.0000, ]
2022-11-10 10:38:37,441 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2933, Acc: 1.0000, ]
2022-11-10 10:38:38,014 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2745, Acc: 1.0000, ]
2022-11-10 10:38:38,609 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2806, Acc: 1.0000, ]
2022-11-10 10:38:38,697 INFO: fine-tune procedure is finished!
2022-11-10 10:39:46,606 INFO: [Test_acc of task 8 on test 3: 0.39670][acc of former classes: 0.66067][acc of former samples in all classes: 0.64567]
[acc of novel samples in all classes: 0.02325]
2022-11-10 10:39:46,920 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:39:46,948 WARNING: Current net - loaded net:
2022-11-10 10:39:46,948 WARNING: Loaded net - current net:
2022-11-10 10:39:46,948 WARNING:   func.classifier.bias
2022-11-10 10:39:46,949 WARNING:   func.classifier.weight
2022-11-10 10:39:46,991 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth.
2022-11-10 10:39:47,064 INFO: Obtain parameters for train
2022-11-10 10:39:47,070 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:39:47,070 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:39:47,071 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:39:47,072 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:39:47,072 INFO: Model [MTNBModel] is created.
2022-11-10 10:39:47,078 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 10:39:47,447 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.8627, Acc: 1.0000, ]
2022-11-10 10:39:47,992 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.8847, Acc: 1.0000, ]
2022-11-10 10:39:48,457 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.8486, Acc: 1.0000, ]
2022-11-10 10:39:48,945 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.8807, Acc: 1.0000, ]
2022-11-10 10:39:49,541 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.8635, Acc: 1.0000, ]
2022-11-10 10:39:50,208 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.8537, Acc: 1.0000, ]
2022-11-10 10:39:50,305 INFO: fine-tune procedure is finished!
2022-11-10 10:40:39,195 INFO: [Test_acc of task 1 on test 4: 0.60954][acc of former classes: 0.66067][acc of former samples in all classes: 0.65817]
[acc of novel samples in all classes: 0.02600]
2022-11-10 10:40:39,513 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:40:39,541 WARNING: Current net - loaded net:
2022-11-10 10:40:39,541 WARNING: Loaded net - current net:
2022-11-10 10:40:39,541 WARNING:   func.classifier.bias
2022-11-10 10:40:39,541 WARNING:   func.classifier.weight
2022-11-10 10:40:39,582 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_1.pth.
2022-11-10 10:40:39,656 INFO: Obtain parameters for train
2022-11-10 10:40:39,663 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:40:39,663 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:40:39,664 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:40:39,665 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:40:39,665 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:40:39,665 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:40:39,665 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:40:39,665 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:40:39,665 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:40:39,665 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:40:39,665 INFO: Model [MTNBModel] is created.
2022-11-10 10:40:39,671 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:40:39,677 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 10:40:40,068 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9324, Acc: 1.0000, ]
2022-11-10 10:40:40,518 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9676, Acc: 1.0000, ]
2022-11-10 10:40:41,160 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9401, Acc: 1.0000, ]
2022-11-10 10:40:41,690 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9447, Acc: 1.0000, ]
2022-11-10 10:40:42,280 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9530, Acc: 1.0000, ]
2022-11-10 10:40:42,967 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9597, Acc: 1.0000, ]
2022-11-10 10:40:43,064 INFO: fine-tune procedure is finished!
2022-11-10 10:41:34,266 INFO: [Test_acc of task 2 on test 4: 0.56486][acc of former classes: 0.66067][acc of former samples in all classes: 0.65583]
[acc of novel samples in all classes: 0.01900]
2022-11-10 10:41:34,566 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:41:34,595 WARNING: Current net - loaded net:
2022-11-10 10:41:34,595 WARNING: Loaded net - current net:
2022-11-10 10:41:34,595 WARNING:   func.classifier.bias
2022-11-10 10:41:34,595 WARNING:   func.classifier.weight
2022-11-10 10:41:34,635 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_2.pth.
2022-11-10 10:41:34,705 INFO: Obtain parameters for train
2022-11-10 10:41:34,711 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:41:34,711 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:41:34,712 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:41:34,713 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:41:34,713 INFO: Model [MTNBModel] is created.
2022-11-10 10:41:34,719 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:41:34,725 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:41:34,730 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 10:41:35,093 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9968, Acc: 1.0000, ]
2022-11-10 10:41:35,588 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0107, Acc: 1.0000, ]
2022-11-10 10:41:36,055 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9929, Acc: 1.0000, ]
2022-11-10 10:41:36,647 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0038, Acc: 1.0000, ]
2022-11-10 10:41:37,148 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9972, Acc: 1.0000, ]
2022-11-10 10:41:37,744 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9891, Acc: 1.0000, ]
2022-11-10 10:41:37,828 INFO: fine-tune procedure is finished!
2022-11-10 10:42:31,427 INFO: [Test_acc of task 3 on test 4: 0.52667][acc of former classes: 0.66067][acc of former samples in all classes: 0.65367]
[acc of novel samples in all classes: 0.01867]
2022-11-10 10:42:31,728 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:42:31,760 WARNING: Current net - loaded net:
2022-11-10 10:42:31,760 WARNING: Loaded net - current net:
2022-11-10 10:42:31,760 WARNING:   func.classifier.bias
2022-11-10 10:42:31,760 WARNING:   func.classifier.weight
2022-11-10 10:42:31,802 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_3.pth.
2022-11-10 10:42:31,876 INFO: Obtain parameters for train
2022-11-10 10:42:31,881 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:42:31,881 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:42:31,882 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:42:31,883 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:42:31,883 INFO: Model [MTNBModel] is created.
2022-11-10 10:42:31,891 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:42:31,898 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:42:31,904 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:42:31,911 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 10:42:32,328 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0581, Acc: 1.0000, ]
2022-11-10 10:42:32,971 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0446, Acc: 1.0000, ]
2022-11-10 10:42:33,505 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0520, Acc: 1.0000, ]
2022-11-10 10:42:34,007 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0649, Acc: 1.0000, ]
2022-11-10 10:42:34,670 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0698, Acc: 1.0000, ]
2022-11-10 10:42:35,243 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0687, Acc: 1.0000, ]
2022-11-10 10:42:35,364 INFO: fine-tune procedure is finished!
2022-11-10 10:43:32,007 INFO: [Test_acc of task 4 on test 4: 0.49388][acc of former classes: 0.66067][acc of former samples in all classes: 0.65183]
[acc of novel samples in all classes: 0.02000]
2022-11-10 10:43:32,282 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:43:32,311 WARNING: Current net - loaded net:
2022-11-10 10:43:32,311 WARNING: Loaded net - current net:
2022-11-10 10:43:32,311 WARNING:   func.classifier.bias
2022-11-10 10:43:32,311 WARNING:   func.classifier.weight
2022-11-10 10:43:32,330 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_4.pth.
2022-11-10 10:43:32,382 INFO: Obtain parameters for train
2022-11-10 10:43:32,384 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:43:32,384 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:43:32,384 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:43:32,384 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:43:32,384 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:43:32,384 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:43:32,385 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:43:32,386 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:43:32,387 INFO: Model [MTNBModel] is created.
2022-11-10 10:43:32,393 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:43:32,398 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:43:32,404 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:43:32,409 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:43:32,415 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 10:43:32,801 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1427, Acc: 1.0000, ]
2022-11-10 10:43:33,303 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1352, Acc: 1.0000, ]
2022-11-10 10:43:33,875 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1402, Acc: 1.0000, ]
2022-11-10 10:43:34,398 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1310, Acc: 1.0000, ]
2022-11-10 10:43:34,908 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1394, Acc: 1.0000, ]
2022-11-10 10:43:35,491 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1370, Acc: 1.0000, ]
2022-11-10 10:43:35,588 INFO: fine-tune procedure is finished!
2022-11-10 10:44:34,384 INFO: [Test_acc of task 5 on test 4: 0.46435][acc of former classes: 0.66067][acc of former samples in all classes: 0.64983]
[acc of novel samples in all classes: 0.01920]
2022-11-10 10:44:34,674 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:44:34,702 WARNING: Current net - loaded net:
2022-11-10 10:44:34,702 WARNING: Loaded net - current net:
2022-11-10 10:44:34,702 WARNING:   func.classifier.bias
2022-11-10 10:44:34,702 WARNING:   func.classifier.weight
2022-11-10 10:44:34,739 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_5.pth.
2022-11-10 10:44:34,809 INFO: Obtain parameters for train
2022-11-10 10:44:34,812 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:44:34,812 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:44:34,812 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:44:34,812 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:44:34,813 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:44:34,814 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:44:34,815 INFO: Model [MTNBModel] is created.
2022-11-10 10:44:34,821 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:44:34,826 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:44:34,832 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:44:34,837 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:44:34,843 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:44:34,848 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 10:44:35,214 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1806, Acc: 1.0000, ]
2022-11-10 10:44:35,691 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1702, Acc: 1.0000, ]
2022-11-10 10:44:36,263 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1882, Acc: 1.0000, ]
2022-11-10 10:44:36,930 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1740, Acc: 1.0000, ]
2022-11-10 10:44:37,557 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1839, Acc: 1.0000, ]
2022-11-10 10:44:38,024 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1770, Acc: 1.0000, ]
2022-11-10 10:44:38,111 INFO: fine-tune procedure is finished!
2022-11-10 10:45:39,013 INFO: [Test_acc of task 6 on test 4: 0.43878][acc of former classes: 0.66067][acc of former samples in all classes: 0.64867]
[acc of novel samples in all classes: 0.01900]
2022-11-10 10:45:39,305 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:45:39,334 WARNING: Current net - loaded net:
2022-11-10 10:45:39,334 WARNING: Loaded net - current net:
2022-11-10 10:45:39,334 WARNING:   func.classifier.bias
2022-11-10 10:45:39,334 WARNING:   func.classifier.weight
2022-11-10 10:45:39,372 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_6.pth.
2022-11-10 10:45:39,440 INFO: Obtain parameters for train
2022-11-10 10:45:39,444 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:45:39,444 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:45:39,444 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:45:39,444 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:45:39,444 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:45:39,445 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:45:39,446 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:45:39,447 INFO: Model [MTNBModel] is created.
2022-11-10 10:45:39,453 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:45:39,458 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:45:39,464 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:45:39,469 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:45:39,475 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:45:39,480 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:45:39,485 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 10:45:39,915 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2211, Acc: 1.0000, ]
2022-11-10 10:45:40,530 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2319, Acc: 1.0000, ]
2022-11-10 10:45:41,024 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2208, Acc: 1.0000, ]
2022-11-10 10:45:41,542 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2525, Acc: 1.0000, ]
2022-11-10 10:45:42,009 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2235, Acc: 1.0000, ]
2022-11-10 10:45:42,457 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2317, Acc: 1.0000, ]
2022-11-10 10:45:42,566 INFO: fine-tune procedure is finished!
2022-11-10 10:46:46,637 INFO: [Test_acc of task 7 on test 4: 0.41663][acc of former classes: 0.66067][acc of former samples in all classes: 0.64783]
[acc of novel samples in all classes: 0.02029]
2022-11-10 10:46:46,934 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 10:46:46,963 WARNING: Current net - loaded net:
2022-11-10 10:46:46,963 WARNING: Loaded net - current net:
2022-11-10 10:46:46,963 WARNING:   func.classifier.bias
2022-11-10 10:46:46,963 WARNING:   func.classifier.weight
2022-11-10 10:46:47,001 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_7.pth.
2022-11-10 10:46:47,070 INFO: Obtain parameters for train
2022-11-10 10:46:47,073 WARNING: Params func.base.conv1.weight will not be optimized.
2022-11-10 10:46:47,073 WARNING: Params func.base.bn1.weight will not be optimized.
2022-11-10 10:46:47,073 WARNING: Params func.base.bn1.bias will not be optimized.
2022-11-10 10:46:47,073 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-11-10 10:46:47,073 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-11-10 10:46:47,073 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-11-10 10:46:47,073 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-11-10 10:46:47,074 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.fc.weight will not be optimized.
2022-11-10 10:46:47,075 WARNING: Params func.base.fc.bias will not be optimized.
2022-11-10 10:46:47,076 INFO: Model [MTNBModel] is created.
2022-11-10 10:46:47,082 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:46:47,087 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:46:47,093 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:46:47,098 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:46:47,104 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:46:47,109 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:46:47,115 INFO: Dataset NormalDataset - miniImageNet is created.
2022-11-10 10:46:47,120 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 10:46:47,506 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2803, Acc: 1.0000, ]
2022-11-10 10:46:48,003 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2765, Acc: 1.0000, ]
2022-11-10 10:46:48,451 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2693, Acc: 1.0000, ]
2022-11-10 10:46:49,052 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2746, Acc: 1.0000, ]
2022-11-10 10:46:49,554 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2712, Acc: 1.0000, ]
2022-11-10 10:46:50,145 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2628, Acc: 1.0000, ]
2022-11-10 10:46:50,234 INFO: fine-tune procedure is finished!
2022-11-10 10:47:56,188 INFO: [Test_acc of task 8 on test 4: 0.39840][acc of former classes: 0.66067][acc of former samples in all classes: 0.64550]
[acc of novel samples in all classes: 0.02775]
2022-11-10 10:47:56,287 INFO: --------------------------Final Avg Acc-------------------------
2022-11-10 10:47:56,287 INFO: Session 1: 66.07+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.6607]
2022-11-10 10:47:56,287 INFO: Session 2: 60.92+-0.05[acc of former classes: 0.6607][acc of former samples in all classes: 0.6588]
[acc of novel samples in all classes: 0.0140]
2022-11-10 10:47:56,287 INFO: Session 3: 56.51+-0.05[acc of former classes: 0.6607][acc of former samples in all classes: 0.6571]
[acc of novel samples in all classes: 0.0128]
2022-11-10 10:47:56,287 INFO: Session 4: 52.78+-0.07[acc of former classes: 0.6607][acc of former samples in all classes: 0.6552]
[acc of novel samples in all classes: 0.0181]
2022-11-10 10:47:56,288 INFO: Session 5: 49.52+-0.10[acc of former classes: 0.6607][acc of former samples in all classes: 0.6537]
[acc of novel samples in all classes: 0.0197]
2022-11-10 10:47:56,288 INFO: Session 6: 46.61+-0.09[acc of former classes: 0.6607][acc of former samples in all classes: 0.6517]
[acc of novel samples in all classes: 0.0206]
2022-11-10 10:47:56,288 INFO: Session 7: 44.03+-0.11[acc of former classes: 0.6607][acc of former samples in all classes: 0.6509]
[acc of novel samples in all classes: 0.0191]
2022-11-10 10:47:56,288 INFO: Session 8: 41.81+-0.08[acc of former classes: 0.6607][acc of former samples in all classes: 0.6498]
[acc of novel samples in all classes: 0.0209]
2022-11-10 10:47:56,288 INFO: Session 9: 39.86+-0.15[acc of former classes: 0.6607][acc of former samples in all classes: 0.6485]
[acc of novel samples in all classes: 0.0238]
2022-11-10 10:47:56,288 INFO: random seed: 1997
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/1S_MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_1shot_debug/models/test4_session_8.pth
finish!!
