Path already exists. Rename it to /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02_archived_20221110_133135
/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-10 13:31:35,465 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-10 13:31:35,465 INFO: 
  name: 1S_F2M_res18_cifar_1shot_debug_02
  model_type: MTNBModel
  gpu: 1
  manual_seed: 1997
  use_cosine: False
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  datasets:[
    train:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: None
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    val:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    test:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
  ]
  network_g:[
    type: Resnet20_cifar_small
    num_classes: 60
    adopt_classifier: False
    flatten: True
  ]
  path:[
    pretrain_model_g: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
    base_model: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02
    training_states: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/training_states
    log: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02
    models: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models
    prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.02
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [1000]
      gamma: 1e-05
    ]
    fine_tune: True
    random_noise:[
      distribution:[
        type: DiscreteBeta
      ]
      type: suffix_conv_weight
      num_layers: 4
      low: 0.1
      high: 5.0
      reduction_factor: 4
      bound_value: 0.01
      random_times: 0
    ]
    clamping: True
    rounding: True
    fine_tune_epoch: 6
    max_steps: 1
    ratio: 1
    novel_exemplars: 1
    warmup_iter: -1
    bases: 60
    tasks: 9
    shots: 1
    num_test: 5
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 1
      use_cosine: False
    ]
  ]
  val:[
    val_freq: 10
    test_type: NCM
  ]
  logger:[
    print_freq: 1
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental-Results
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-10 13:31:35,466 INFO: Random seed: 1997
2022-11-10 13:31:37,104 INFO: Network: Resnet20_cifar_small, with parameters: 271,824
2022-11-10 13:31:37,104 INFO: Resnet20_cifar_small(
  (func): ResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (avg_pool): AdaptiveAvgPool2d(output_size=(1, 1))
  )
)
2022-11-10 13:31:37,104 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:31:37,111 WARNING: Current net - loaded net:
2022-11-10 13:31:37,111 WARNING: Loaded net - current net:
2022-11-10 13:31:37,111 WARNING:   func.fc.bias
2022-11-10 13:31:37,111 WARNING:   func.fc.weight
2022-11-10 13:31:37,124 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:31:37,130 WARNING: Current net - loaded net:
2022-11-10 13:31:37,130 WARNING: Loaded net - current net:
2022-11-10 13:31:37,130 WARNING:   func.fc.bias
2022-11-10 13:31:37,130 WARNING:   func.fc.weight
2022-11-10 13:31:37,141 INFO: Obtain parameters for train
2022-11-10 13:31:37,148 INFO: Model [MTNBModel] is created.
2022-11-10 13:32:08,495 INFO: [Test_acc of task 0 on test 0: 0.71400][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.71400]
2022-11-10 13:32:08,514 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:32:08,519 WARNING: Current net - loaded net:
2022-11-10 13:32:08,519 WARNING: Loaded net - current net:
2022-11-10 13:32:08,519 WARNING:   func.fc.bias
2022-11-10 13:32:08,519 WARNING:   func.fc.weight
2022-11-10 13:32:08,533 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth.
2022-11-10 13:32:08,551 INFO: Obtain parameters for train
2022-11-10 13:32:08,552 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:32:08,552 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:32:08,553 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:32:08,554 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:32:08,554 INFO: Model [MTNBModel] is created.
2022-11-10 13:32:08,561 INFO: Dataset NormalDataset - cifar-100 is created.
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
>>> Test >>>
Former classes: []
Novel classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 13:32:09,034 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:09,446 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:09,831 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:10,232 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:10,664 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:11,046 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:11,128 INFO: fine-tune procedure is finished!
2022-11-10 13:32:52,360 INFO: [Test_acc of task 1 on test 0: 0.66246][acc of former classes: 0.71400][acc of former samples in all classes: 0.71183]
[acc of novel samples in all classes: 0.07000]
2022-11-10 13:32:52,401 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:32:52,407 WARNING: Current net - loaded net:
2022-11-10 13:32:52,407 WARNING: Loaded net - current net:
2022-11-10 13:32:52,407 WARNING:   func.fc.bias
2022-11-10 13:32:52,407 WARNING:   func.fc.weight
2022-11-10 13:32:52,442 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_1.pth.
2022-11-10 13:32:52,484 INFO: Obtain parameters for train
2022-11-10 13:32:52,489 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:32:52,489 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:32:52,490 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:32:52,491 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:32:52,492 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:32:52,492 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:32:52,492 INFO: Model [MTNBModel] is created.
2022-11-10 13:32:52,498 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:32:52,503 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 13:32:52,834 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:53,305 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:53,922 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:54,499 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:54,999 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:55,463 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:32:55,567 INFO: fine-tune procedure is finished!
2022-11-10 13:33:45,313 INFO: [Test_acc of task 2 on test 0: 0.61714][acc of former classes: 0.71400][acc of former samples in all classes: 0.70850]
[acc of novel samples in all classes: 0.06900]
2022-11-10 13:33:45,355 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:33:45,362 WARNING: Current net - loaded net:
2022-11-10 13:33:45,362 WARNING: Loaded net - current net:
2022-11-10 13:33:45,362 WARNING:   func.fc.bias
2022-11-10 13:33:45,362 WARNING:   func.fc.weight
2022-11-10 13:33:45,398 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_2.pth.
2022-11-10 13:33:45,441 INFO: Obtain parameters for train
2022-11-10 13:33:45,444 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:33:45,444 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:33:45,445 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:33:45,447 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:33:45,448 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:33:45,448 INFO: Model [MTNBModel] is created.
2022-11-10 13:33:45,455 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:33:45,460 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:33:45,465 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 13:33:45,832 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:33:46,254 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:33:46,670 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:33:47,076 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:33:47,579 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:33:48,181 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:33:48,301 INFO: fine-tune procedure is finished!
2022-11-10 13:34:40,999 INFO: [Test_acc of task 3 on test 0: 0.57747][acc of former classes: 0.71417][acc of former samples in all classes: 0.70633]
[acc of novel samples in all classes: 0.06200]
2022-11-10 13:34:41,042 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:34:41,047 WARNING: Current net - loaded net:
2022-11-10 13:34:41,047 WARNING: Loaded net - current net:
2022-11-10 13:34:41,048 WARNING:   func.fc.bias
2022-11-10 13:34:41,048 WARNING:   func.fc.weight
2022-11-10 13:34:41,084 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_3.pth.
2022-11-10 13:34:41,126 INFO: Obtain parameters for train
2022-11-10 13:34:41,129 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:34:41,129 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:34:41,130 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:34:41,131 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:34:41,131 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:34:41,131 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:34:41,131 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:34:41,131 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:34:41,131 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:34:41,131 INFO: Model [MTNBModel] is created.
2022-11-10 13:34:41,137 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:34:41,142 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:34:41,147 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:34:41,153 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 13:34:41,514 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:34:42,064 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:34:42,581 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:34:43,094 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:34:43,680 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:34:44,216 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:34:44,302 INFO: fine-tune procedure is finished!
2022-11-10 13:35:39,383 INFO: [Test_acc of task 4 on test 0: 0.54475][acc of former classes: 0.71417][acc of former samples in all classes: 0.70583]
[acc of novel samples in all classes: 0.06150]
2022-11-10 13:35:39,426 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:35:39,432 WARNING: Current net - loaded net:
2022-11-10 13:35:39,432 WARNING: Loaded net - current net:
2022-11-10 13:35:39,432 WARNING:   func.fc.bias
2022-11-10 13:35:39,433 WARNING:   func.fc.weight
2022-11-10 13:35:39,466 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_4.pth.
2022-11-10 13:35:39,509 INFO: Obtain parameters for train
2022-11-10 13:35:39,513 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:35:39,513 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:35:39,514 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:35:39,515 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:35:39,515 INFO: Model [MTNBModel] is created.
2022-11-10 13:35:39,521 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:35:39,527 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:35:39,532 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:35:39,537 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:35:39,542 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 13:35:39,901 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:35:40,302 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:35:40,714 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:35:41,133 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:35:41,720 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:35:42,143 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:35:42,215 INFO: fine-tune procedure is finished!
2022-11-10 13:36:40,055 INFO: [Test_acc of task 5 on test 0: 0.51388][acc of former classes: 0.71417][acc of former samples in all classes: 0.70350]
[acc of novel samples in all classes: 0.05880]
2022-11-10 13:36:40,097 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:36:40,103 WARNING: Current net - loaded net:
2022-11-10 13:36:40,103 WARNING: Loaded net - current net:
2022-11-10 13:36:40,103 WARNING:   func.fc.bias
2022-11-10 13:36:40,103 WARNING:   func.fc.weight
2022-11-10 13:36:40,139 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_5.pth.
2022-11-10 13:36:40,180 INFO: Obtain parameters for train
2022-11-10 13:36:40,184 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:36:40,184 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:36:40,185 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:36:40,186 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:36:40,186 INFO: Model [MTNBModel] is created.
2022-11-10 13:36:40,192 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:36:40,197 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:36:40,202 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:36:40,208 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:36:40,213 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:36:40,218 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 13:36:40,610 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:36:41,047 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:36:41,626 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:36:42,297 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:36:42,915 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:36:43,468 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:36:43,594 INFO: fine-tune procedure is finished!
2022-11-10 13:37:43,683 INFO: [Test_acc of task 6 on test 0: 0.49033][acc of former classes: 0.71450][acc of former samples in all classes: 0.70217]
[acc of novel samples in all classes: 0.06667]
2022-11-10 13:37:43,725 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:37:43,731 WARNING: Current net - loaded net:
2022-11-10 13:37:43,731 WARNING: Loaded net - current net:
2022-11-10 13:37:43,731 WARNING:   func.fc.bias
2022-11-10 13:37:43,731 WARNING:   func.fc.weight
2022-11-10 13:37:43,835 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_6.pth.
2022-11-10 13:37:43,879 INFO: Obtain parameters for train
2022-11-10 13:37:43,882 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:37:43,882 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:37:43,882 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:37:43,883 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:37:43,884 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:37:43,885 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:37:43,885 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:37:43,885 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:37:43,885 INFO: Model [MTNBModel] is created.
2022-11-10 13:37:43,891 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:37:43,896 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:37:43,901 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:37:43,906 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:37:43,911 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:37:43,917 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:37:43,922 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 13:37:44,287 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:37:45,001 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:37:45,594 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:37:46,089 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:37:46,537 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:37:46,997 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:37:47,114 INFO: fine-tune procedure is finished!
2022-11-10 13:38:50,405 INFO: [Test_acc of task 7 on test 0: 0.46947][acc of former classes: 0.71450][acc of former samples in all classes: 0.70100]
[acc of novel samples in all classes: 0.07257]
2022-11-10 13:38:50,447 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:38:50,452 WARNING: Current net - loaded net:
2022-11-10 13:38:50,453 WARNING: Loaded net - current net:
2022-11-10 13:38:50,453 WARNING:   func.fc.bias
2022-11-10 13:38:50,453 WARNING:   func.fc.weight
2022-11-10 13:38:50,489 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_7.pth.
2022-11-10 13:38:50,529 INFO: Obtain parameters for train
2022-11-10 13:38:50,532 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:38:50,533 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:38:50,534 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:38:50,535 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:38:50,535 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:38:50,535 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:38:50,535 INFO: Model [MTNBModel] is created.
2022-11-10 13:38:50,541 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:38:50,546 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:38:50,551 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:38:50,556 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:38:50,561 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:38:50,567 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:38:50,572 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:38:50,577 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 13:38:50,934 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:38:51,356 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:38:51,813 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:38:52,438 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:38:53,075 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:38:53,656 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:38:53,739 INFO: fine-tune procedure is finished!
2022-11-10 13:39:59,230 INFO: [Test_acc of task 8 on test 0: 0.44670][acc of former classes: 0.71450][acc of former samples in all classes: 0.69850]
[acc of novel samples in all classes: 0.06900]
2022-11-10 13:39:59,277 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:39:59,283 WARNING: Current net - loaded net:
2022-11-10 13:39:59,283 WARNING: Loaded net - current net:
2022-11-10 13:39:59,283 WARNING:   func.fc.bias
2022-11-10 13:39:59,283 WARNING:   func.fc.weight
2022-11-10 13:39:59,319 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth.
2022-11-10 13:39:59,364 INFO: Obtain parameters for train
2022-11-10 13:39:59,367 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:39:59,367 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:39:59,368 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:39:59,369 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:39:59,369 INFO: Model [MTNBModel] is created.
2022-11-10 13:39:59,375 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 13:39:59,704 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:00,150 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:00,724 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:01,353 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:01,967 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:02,440 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:02,512 INFO: fine-tune procedure is finished!
2022-11-10 13:40:49,904 INFO: [Test_acc of task 1 on test 1: 0.66692][acc of former classes: 0.71400][acc of former samples in all classes: 0.71033]
[acc of novel samples in all classes: 0.14600]
2022-11-10 13:40:49,946 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:40:49,952 WARNING: Current net - loaded net:
2022-11-10 13:40:49,952 WARNING: Loaded net - current net:
2022-11-10 13:40:49,952 WARNING:   func.fc.bias
2022-11-10 13:40:49,952 WARNING:   func.fc.weight
2022-11-10 13:40:49,988 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_1.pth.
2022-11-10 13:40:50,030 INFO: Obtain parameters for train
2022-11-10 13:40:50,033 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:40:50,033 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:40:50,034 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:40:50,035 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:40:50,035 INFO: Model [MTNBModel] is created.
2022-11-10 13:40:50,041 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:40:50,047 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 13:40:50,416 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:50,954 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:51,417 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:51,874 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:52,282 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:52,729 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:40:52,807 INFO: fine-tune procedure is finished!
2022-11-10 13:41:42,772 INFO: [Test_acc of task 2 on test 1: 0.62200][acc of former classes: 0.71400][acc of former samples in all classes: 0.70800]
[acc of novel samples in all classes: 0.10600]
2022-11-10 13:41:42,814 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:41:42,819 WARNING: Current net - loaded net:
2022-11-10 13:41:42,820 WARNING: Loaded net - current net:
2022-11-10 13:41:42,820 WARNING:   func.fc.bias
2022-11-10 13:41:42,820 WARNING:   func.fc.weight
2022-11-10 13:41:42,856 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_2.pth.
2022-11-10 13:41:42,896 INFO: Obtain parameters for train
2022-11-10 13:41:42,899 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:41:42,899 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:41:42,900 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:41:42,901 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:41:42,902 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:41:42,902 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:41:42,902 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:41:42,902 INFO: Model [MTNBModel] is created.
2022-11-10 13:41:42,908 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:41:42,913 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:41:42,918 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 13:41:43,269 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:41:43,712 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:41:44,273 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:41:44,686 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:41:45,243 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:41:45,688 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:41:45,766 INFO: fine-tune procedure is finished!
2022-11-10 13:42:38,540 INFO: [Test_acc of task 3 on test 1: 0.58227][acc of former classes: 0.71417][acc of former samples in all classes: 0.70650]
[acc of novel samples in all classes: 0.08533]
2022-11-10 13:42:38,582 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:42:38,587 WARNING: Current net - loaded net:
2022-11-10 13:42:38,587 WARNING: Loaded net - current net:
2022-11-10 13:42:38,587 WARNING:   func.fc.bias
2022-11-10 13:42:38,587 WARNING:   func.fc.weight
2022-11-10 13:42:38,623 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_3.pth.
2022-11-10 13:42:38,665 INFO: Obtain parameters for train
2022-11-10 13:42:38,668 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:42:38,668 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:42:38,669 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:42:38,670 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:42:38,670 INFO: Model [MTNBModel] is created.
2022-11-10 13:42:38,677 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:42:38,682 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:42:38,687 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:42:38,692 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 13:42:39,028 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:42:39,468 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:42:39,896 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:42:40,314 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:42:40,759 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:42:41,196 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:42:41,270 INFO: fine-tune procedure is finished!
2022-11-10 13:43:36,438 INFO: [Test_acc of task 4 on test 1: 0.54625][acc of former classes: 0.71417][acc of former samples in all classes: 0.70550]
[acc of novel samples in all classes: 0.06850]
2022-11-10 13:43:36,482 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:43:36,487 WARNING: Current net - loaded net:
2022-11-10 13:43:36,487 WARNING: Loaded net - current net:
2022-11-10 13:43:36,488 WARNING:   func.fc.bias
2022-11-10 13:43:36,488 WARNING:   func.fc.weight
2022-11-10 13:43:36,529 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_4.pth.
2022-11-10 13:43:36,570 INFO: Obtain parameters for train
2022-11-10 13:43:36,574 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:43:36,574 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:43:36,575 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:43:36,576 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:43:36,576 INFO: Model [MTNBModel] is created.
2022-11-10 13:43:36,582 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:36,588 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:36,593 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:36,598 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:36,603 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 13:43:36,944 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:43:37,542 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:43:38,108 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:43:38,673 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:43:39,241 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:43:39,687 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:43:39,808 INFO: fine-tune procedure is finished!
2022-11-10 13:44:37,577 INFO: [Test_acc of task 5 on test 1: 0.51400][acc of former classes: 0.71417][acc of former samples in all classes: 0.70217]
[acc of novel samples in all classes: 0.06240]
2022-11-10 13:44:37,620 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:44:37,625 WARNING: Current net - loaded net:
2022-11-10 13:44:37,625 WARNING: Loaded net - current net:
2022-11-10 13:44:37,625 WARNING:   func.fc.bias
2022-11-10 13:44:37,625 WARNING:   func.fc.weight
2022-11-10 13:44:37,663 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_5.pth.
2022-11-10 13:44:37,702 INFO: Obtain parameters for train
2022-11-10 13:44:37,705 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:44:37,705 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:44:37,706 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:44:37,707 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:44:37,707 INFO: Model [MTNBModel] is created.
2022-11-10 13:44:37,713 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:37,718 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:37,724 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:37,729 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:37,734 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:37,739 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 13:44:38,083 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:44:38,505 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:44:38,903 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:44:39,395 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:44:39,892 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:44:40,338 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:44:40,454 INFO: fine-tune procedure is finished!
2022-11-10 13:45:40,723 INFO: [Test_acc of task 6 on test 1: 0.48711][acc of former classes: 0.71450][acc of former samples in all classes: 0.69983]
[acc of novel samples in all classes: 0.06167]
2022-11-10 13:45:40,766 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:45:40,773 WARNING: Current net - loaded net:
2022-11-10 13:45:40,773 WARNING: Loaded net - current net:
2022-11-10 13:45:40,773 WARNING:   func.fc.bias
2022-11-10 13:45:40,773 WARNING:   func.fc.weight
2022-11-10 13:45:40,808 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_6.pth.
2022-11-10 13:45:40,850 INFO: Obtain parameters for train
2022-11-10 13:45:40,853 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:45:40,853 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:45:40,854 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:45:40,855 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:45:40,855 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:45:40,855 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:45:40,855 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:45:40,855 INFO: Model [MTNBModel] is created.
2022-11-10 13:45:40,861 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:40,866 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:40,871 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:40,876 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:40,882 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:40,887 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:40,892 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 13:45:41,247 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:45:41,693 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:45:42,107 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:45:42,513 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:45:42,957 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:45:43,533 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:45:43,613 INFO: fine-tune procedure is finished!
2022-11-10 13:46:46,189 INFO: [Test_acc of task 7 on test 1: 0.46253][acc of former classes: 0.71450][acc of former samples in all classes: 0.69617]
[acc of novel samples in all classes: 0.06200]
2022-11-10 13:46:46,246 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:46:46,253 WARNING: Current net - loaded net:
2022-11-10 13:46:46,253 WARNING: Loaded net - current net:
2022-11-10 13:46:46,253 WARNING:   func.fc.bias
2022-11-10 13:46:46,253 WARNING:   func.fc.weight
2022-11-10 13:46:46,297 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_7.pth.
2022-11-10 13:46:46,359 INFO: Obtain parameters for train
2022-11-10 13:46:46,362 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:46:46,362 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:46:46,363 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:46:46,364 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:46:46,365 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:46:46,365 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:46:46,365 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:46:46,365 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:46:46,365 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:46:46,365 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:46:46,365 INFO: Model [MTNBModel] is created.
2022-11-10 13:46:46,371 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:46,377 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:46,383 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:46,404 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:46,410 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:46,416 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:46,422 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:46,443 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 13:46:46,865 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:46:47,420 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:46:48,059 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:46:48,591 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:46:49,132 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:46:49,608 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:46:49,693 INFO: fine-tune procedure is finished!
2022-11-10 13:47:55,029 INFO: [Test_acc of task 8 on test 1: 0.44130][acc of former classes: 0.71450][acc of former samples in all classes: 0.69500]
[acc of novel samples in all classes: 0.06075]
2022-11-10 13:47:55,071 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:47:55,077 WARNING: Current net - loaded net:
2022-11-10 13:47:55,077 WARNING: Loaded net - current net:
2022-11-10 13:47:55,077 WARNING:   func.fc.bias
2022-11-10 13:47:55,077 WARNING:   func.fc.weight
2022-11-10 13:47:55,112 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth.
2022-11-10 13:47:55,153 INFO: Obtain parameters for train
2022-11-10 13:47:55,157 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:47:55,157 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:47:55,158 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:47:55,159 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:47:55,159 INFO: Model [MTNBModel] is created.
2022-11-10 13:47:55,165 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 13:47:55,494 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:47:55,938 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:47:56,379 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:47:56,915 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:47:57,356 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:47:57,961 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:47:58,047 INFO: fine-tune procedure is finished!
2022-11-10 13:48:45,692 INFO: [Test_acc of task 1 on test 2: 0.66723][acc of former classes: 0.71400][acc of former samples in all classes: 0.71000]
[acc of novel samples in all classes: 0.15400]
2022-11-10 13:48:45,733 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:48:45,739 WARNING: Current net - loaded net:
2022-11-10 13:48:45,739 WARNING: Loaded net - current net:
2022-11-10 13:48:45,739 WARNING:   func.fc.bias
2022-11-10 13:48:45,739 WARNING:   func.fc.weight
2022-11-10 13:48:45,775 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_1.pth.
2022-11-10 13:48:45,817 INFO: Obtain parameters for train
2022-11-10 13:48:45,820 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:48:45,820 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:48:45,820 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:48:45,820 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:48:45,820 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:48:45,820 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:48:45,820 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:48:45,820 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:48:45,821 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:48:45,822 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:48:45,823 INFO: Model [MTNBModel] is created.
2022-11-10 13:48:45,829 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:48:45,834 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 13:48:46,161 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:48:46,567 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:48:46,984 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:48:47,397 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:48:47,807 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:48:48,203 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:48:48,275 INFO: fine-tune procedure is finished!
2022-11-10 13:49:38,366 INFO: [Test_acc of task 2 on test 2: 0.62086][acc of former classes: 0.71400][acc of former samples in all classes: 0.70583]
[acc of novel samples in all classes: 0.11100]
2022-11-10 13:49:38,409 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:49:38,415 WARNING: Current net - loaded net:
2022-11-10 13:49:38,415 WARNING: Loaded net - current net:
2022-11-10 13:49:38,415 WARNING:   func.fc.bias
2022-11-10 13:49:38,415 WARNING:   func.fc.weight
2022-11-10 13:49:38,453 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_2.pth.
2022-11-10 13:49:38,495 INFO: Obtain parameters for train
2022-11-10 13:49:38,501 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:49:38,501 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:49:38,501 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:49:38,501 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:49:38,501 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:49:38,501 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:49:38,501 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:49:38,501 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:49:38,502 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:49:38,503 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:49:38,504 INFO: Model [MTNBModel] is created.
2022-11-10 13:49:38,510 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:49:38,515 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:49:38,520 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 13:49:38,869 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:49:39,324 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:49:39,766 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:49:40,198 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:49:40,660 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:49:41,114 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:49:41,184 INFO: fine-tune procedure is finished!
2022-11-10 13:50:34,334 INFO: [Test_acc of task 3 on test 2: 0.58013][acc of former classes: 0.71417][acc of former samples in all classes: 0.70283]
[acc of novel samples in all classes: 0.08933]
2022-11-10 13:50:34,376 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:50:34,382 WARNING: Current net - loaded net:
2022-11-10 13:50:34,382 WARNING: Loaded net - current net:
2022-11-10 13:50:34,383 WARNING:   func.fc.bias
2022-11-10 13:50:34,383 WARNING:   func.fc.weight
2022-11-10 13:50:34,421 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_3.pth.
2022-11-10 13:50:34,465 INFO: Obtain parameters for train
2022-11-10 13:50:34,468 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:50:34,468 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:50:34,468 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:50:34,468 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:50:34,468 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:50:34,468 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:50:34,469 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:50:34,470 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:50:34,471 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:50:34,471 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:50:34,471 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:50:34,471 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:50:34,471 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:50:34,471 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:50:34,471 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:50:34,471 INFO: Model [MTNBModel] is created.
2022-11-10 13:50:34,478 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:50:34,483 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:50:34,489 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:50:34,494 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 13:50:34,902 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:50:35,469 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:50:36,009 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:50:36,504 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:50:37,085 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:50:37,669 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:50:37,743 INFO: fine-tune procedure is finished!
2022-11-10 13:51:32,677 INFO: [Test_acc of task 4 on test 2: 0.54775][acc of former classes: 0.71417][acc of former samples in all classes: 0.70183]
[acc of novel samples in all classes: 0.08550]
2022-11-10 13:51:32,720 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:51:32,726 WARNING: Current net - loaded net:
2022-11-10 13:51:32,726 WARNING: Loaded net - current net:
2022-11-10 13:51:32,726 WARNING:   func.fc.bias
2022-11-10 13:51:32,726 WARNING:   func.fc.weight
2022-11-10 13:51:32,756 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_4.pth.
2022-11-10 13:51:32,800 INFO: Obtain parameters for train
2022-11-10 13:51:32,803 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:51:32,803 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:51:32,804 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:51:32,805 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:51:32,805 INFO: Model [MTNBModel] is created.
2022-11-10 13:51:32,811 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:32,817 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:32,822 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:32,827 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:32,832 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 13:51:33,200 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:51:33,710 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:51:34,146 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:51:34,601 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:51:35,023 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:51:35,434 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:51:35,537 INFO: fine-tune procedure is finished!
2022-11-10 13:52:34,603 INFO: [Test_acc of task 5 on test 2: 0.51788][acc of former classes: 0.71417][acc of former samples in all classes: 0.70050]
[acc of novel samples in all classes: 0.07960]
2022-11-10 13:52:34,647 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:52:34,653 WARNING: Current net - loaded net:
2022-11-10 13:52:34,653 WARNING: Loaded net - current net:
2022-11-10 13:52:34,653 WARNING:   func.fc.bias
2022-11-10 13:52:34,653 WARNING:   func.fc.weight
2022-11-10 13:52:34,689 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_5.pth.
2022-11-10 13:52:34,732 INFO: Obtain parameters for train
2022-11-10 13:52:34,735 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:52:34,735 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:52:34,735 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:52:34,735 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:52:34,735 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:52:34,736 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:52:34,737 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:52:34,738 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:52:34,738 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:52:34,738 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:52:34,738 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:52:34,738 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:52:34,738 INFO: Model [MTNBModel] is created.
2022-11-10 13:52:34,744 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:34,749 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:34,755 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:34,761 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:34,767 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:34,773 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 13:52:35,203 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:52:35,957 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:52:36,482 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:52:37,204 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:52:37,778 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:52:38,382 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:52:38,491 INFO: fine-tune procedure is finished!
2022-11-10 13:53:40,106 INFO: [Test_acc of task 6 on test 2: 0.49167][acc of former classes: 0.71450][acc of former samples in all classes: 0.69767]
[acc of novel samples in all classes: 0.07967]
2022-11-10 13:53:40,148 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:53:40,154 WARNING: Current net - loaded net:
2022-11-10 13:53:40,154 WARNING: Loaded net - current net:
2022-11-10 13:53:40,154 WARNING:   func.fc.bias
2022-11-10 13:53:40,154 WARNING:   func.fc.weight
2022-11-10 13:53:40,189 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_6.pth.
2022-11-10 13:53:40,231 INFO: Obtain parameters for train
2022-11-10 13:53:40,234 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:53:40,234 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:53:40,235 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:53:40,236 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:53:40,236 INFO: Model [MTNBModel] is created.
2022-11-10 13:53:40,242 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:40,247 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:40,253 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:40,258 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:40,263 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:40,268 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:40,273 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 13:53:40,731 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:53:41,226 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:53:41,810 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:53:42,368 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:53:42,863 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:53:43,410 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:53:43,484 INFO: fine-tune procedure is finished!
2022-11-10 13:54:47,454 INFO: [Test_acc of task 7 on test 2: 0.47263][acc of former classes: 0.71450][acc of former samples in all classes: 0.69533]
[acc of novel samples in all classes: 0.09086]
2022-11-10 13:54:47,497 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:54:47,503 WARNING: Current net - loaded net:
2022-11-10 13:54:47,503 WARNING: Loaded net - current net:
2022-11-10 13:54:47,503 WARNING:   func.fc.bias
2022-11-10 13:54:47,503 WARNING:   func.fc.weight
2022-11-10 13:54:47,540 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_7.pth.
2022-11-10 13:54:47,582 INFO: Obtain parameters for train
2022-11-10 13:54:47,584 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:54:47,585 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:54:47,586 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:54:47,587 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:54:47,587 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:54:47,587 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:54:47,587 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:54:47,587 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:54:47,587 INFO: Model [MTNBModel] is created.
2022-11-10 13:54:47,594 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:54:47,600 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:54:47,606 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:54:47,611 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:54:47,617 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:54:47,622 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:54:47,628 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:54:47,633 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 13:54:48,113 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:54:48,722 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:54:49,300 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:54:49,841 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:54:50,345 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:54:50,946 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:54:51,026 INFO: fine-tune procedure is finished!
2022-11-10 13:55:58,275 INFO: [Test_acc of task 8 on test 2: 0.44950][acc of former classes: 0.71450][acc of former samples in all classes: 0.69250]
[acc of novel samples in all classes: 0.08500]
2022-11-10 13:55:58,314 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:55:58,320 WARNING: Current net - loaded net:
2022-11-10 13:55:58,320 WARNING: Loaded net - current net:
2022-11-10 13:55:58,320 WARNING:   func.fc.bias
2022-11-10 13:55:58,320 WARNING:   func.fc.weight
2022-11-10 13:55:58,358 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth.
2022-11-10 13:55:58,399 INFO: Obtain parameters for train
2022-11-10 13:55:58,401 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:55:58,402 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:55:58,403 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:55:58,404 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:55:58,404 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:55:58,404 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:55:58,404 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:55:58,404 INFO: Model [MTNBModel] is created.
2022-11-10 13:55:58,410 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 13:55:58,799 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:55:59,457 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:00,145 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:00,738 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:01,249 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:01,834 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:01,910 INFO: fine-tune procedure is finished!
2022-11-10 13:56:50,860 INFO: [Test_acc of task 1 on test 3: 0.66415][acc of former classes: 0.71400][acc of former samples in all classes: 0.71117]
[acc of novel samples in all classes: 0.10000]
2022-11-10 13:56:50,901 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:56:50,907 WARNING: Current net - loaded net:
2022-11-10 13:56:50,907 WARNING: Loaded net - current net:
2022-11-10 13:56:50,907 WARNING:   func.fc.bias
2022-11-10 13:56:50,907 WARNING:   func.fc.weight
2022-11-10 13:56:50,945 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_1.pth.
2022-11-10 13:56:50,987 INFO: Obtain parameters for train
2022-11-10 13:56:50,991 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:56:50,991 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:56:50,992 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:56:50,993 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:56:50,993 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:56:50,993 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:56:50,993 INFO: Model [MTNBModel] is created.
2022-11-10 13:56:50,999 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:56:51,004 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 13:56:51,357 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:51,886 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:52,349 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:52,802 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:53,516 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:54,193 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:56:54,306 INFO: fine-tune procedure is finished!
2022-11-10 13:57:46,308 INFO: [Test_acc of task 2 on test 3: 0.62229][acc of former classes: 0.71400][acc of former samples in all classes: 0.70767]
[acc of novel samples in all classes: 0.11000]
2022-11-10 13:57:46,350 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:57:46,355 WARNING: Current net - loaded net:
2022-11-10 13:57:46,356 WARNING: Loaded net - current net:
2022-11-10 13:57:46,356 WARNING:   func.fc.bias
2022-11-10 13:57:46,356 WARNING:   func.fc.weight
2022-11-10 13:57:46,380 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_2.pth.
2022-11-10 13:57:46,422 INFO: Obtain parameters for train
2022-11-10 13:57:46,425 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:57:46,425 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:57:46,426 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:57:46,427 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:57:46,427 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:57:46,427 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:57:46,427 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:57:46,427 INFO: Model [MTNBModel] is created.
2022-11-10 13:57:46,433 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:57:46,438 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:57:46,444 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 13:57:46,906 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:57:47,437 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:57:48,188 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:57:48,690 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:57:49,551 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:57:50,062 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:57:50,152 INFO: fine-tune procedure is finished!
2022-11-10 13:58:44,481 INFO: [Test_acc of task 3 on test 3: 0.58267][acc of former classes: 0.71417][acc of former samples in all classes: 0.70467]
[acc of novel samples in all classes: 0.09467]
2022-11-10 13:58:44,523 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:58:44,530 WARNING: Current net - loaded net:
2022-11-10 13:58:44,530 WARNING: Loaded net - current net:
2022-11-10 13:58:44,530 WARNING:   func.fc.bias
2022-11-10 13:58:44,530 WARNING:   func.fc.weight
2022-11-10 13:58:44,577 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_3.pth.
2022-11-10 13:58:44,620 INFO: Obtain parameters for train
2022-11-10 13:58:44,623 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:58:44,623 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:58:44,623 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:58:44,624 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:58:44,625 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:58:44,626 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:58:44,626 INFO: Model [MTNBModel] is created.
2022-11-10 13:58:44,633 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:58:44,639 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:58:44,645 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:58:44,650 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 13:58:45,029 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:58:45,605 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:58:46,274 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:58:46,823 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:58:47,450 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:58:48,019 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:58:48,105 INFO: fine-tune procedure is finished!
2022-11-10 13:59:45,565 INFO: [Test_acc of task 4 on test 3: 0.54750][acc of former classes: 0.71417][acc of former samples in all classes: 0.70317]
[acc of novel samples in all classes: 0.08050]
2022-11-10 13:59:45,608 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 13:59:45,616 WARNING: Current net - loaded net:
2022-11-10 13:59:45,616 WARNING: Loaded net - current net:
2022-11-10 13:59:45,616 WARNING:   func.fc.bias
2022-11-10 13:59:45,616 WARNING:   func.fc.weight
2022-11-10 13:59:45,653 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_4.pth.
2022-11-10 13:59:45,697 INFO: Obtain parameters for train
2022-11-10 13:59:45,700 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:59:45,700 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:59:45,701 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:59:45,702 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 13:59:45,702 INFO: Model [MTNBModel] is created.
2022-11-10 13:59:45,708 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:59:45,714 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:59:45,719 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:59:45,724 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:59:45,730 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 13:59:46,101 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:59:46,521 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:59:46,931 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:59:47,574 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:59:48,179 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:59:48,847 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 13:59:48,976 INFO: fine-tune procedure is finished!
2022-11-10 14:00:49,300 INFO: [Test_acc of task 5 on test 3: 0.51718][acc of former classes: 0.71417][acc of former samples in all classes: 0.70017]
[acc of novel samples in all classes: 0.07800]
2022-11-10 14:00:49,344 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:00:49,351 WARNING: Current net - loaded net:
2022-11-10 14:00:49,351 WARNING: Loaded net - current net:
2022-11-10 14:00:49,351 WARNING:   func.fc.bias
2022-11-10 14:00:49,351 WARNING:   func.fc.weight
2022-11-10 14:00:49,389 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_5.pth.
2022-11-10 14:00:49,431 INFO: Obtain parameters for train
2022-11-10 14:00:49,435 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:00:49,435 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:00:49,436 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:00:49,437 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:00:49,437 INFO: Model [MTNBModel] is created.
2022-11-10 14:00:49,443 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:49,448 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:49,454 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:49,459 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:49,464 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:49,470 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 14:00:49,896 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:00:50,598 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:00:51,192 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:00:51,738 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:00:52,224 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:00:52,707 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:00:52,791 INFO: fine-tune procedure is finished!
2022-11-10 14:01:54,958 INFO: [Test_acc of task 6 on test 3: 0.48989][acc of former classes: 0.71450][acc of former samples in all classes: 0.69900]
[acc of novel samples in all classes: 0.07167]
2022-11-10 14:01:54,997 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:01:55,002 WARNING: Current net - loaded net:
2022-11-10 14:01:55,002 WARNING: Loaded net - current net:
2022-11-10 14:01:55,002 WARNING:   func.fc.bias
2022-11-10 14:01:55,002 WARNING:   func.fc.weight
2022-11-10 14:01:55,039 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_6.pth.
2022-11-10 14:01:55,147 INFO: Obtain parameters for train
2022-11-10 14:01:55,150 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:01:55,150 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:01:55,151 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:01:55,152 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:01:55,153 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:01:55,153 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:01:55,153 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:01:55,153 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:01:55,153 INFO: Model [MTNBModel] is created.
2022-11-10 14:01:55,159 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:55,164 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:55,169 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:55,175 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:55,180 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:55,185 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:55,190 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 14:01:55,567 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:01:56,045 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:01:56,801 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:01:57,483 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:01:57,969 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:01:58,456 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:01:58,532 INFO: fine-tune procedure is finished!
2022-11-10 14:02:52,241 INFO: [Test_acc of task 7 on test 3: 0.46684][acc of former classes: 0.71450][acc of former samples in all classes: 0.69767]
[acc of novel samples in all classes: 0.07114]
2022-11-10 14:02:52,263 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:02:52,269 WARNING: Current net - loaded net:
2022-11-10 14:02:52,269 WARNING: Loaded net - current net:
2022-11-10 14:02:52,269 WARNING:   func.fc.bias
2022-11-10 14:02:52,269 WARNING:   func.fc.weight
2022-11-10 14:02:52,283 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_7.pth.
2022-11-10 14:02:52,302 INFO: Obtain parameters for train
2022-11-10 14:02:52,304 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:02:52,304 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:02:52,305 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:02:52,306 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:02:52,306 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:02:52,306 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:02:52,306 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:02:52,306 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:02:52,306 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:02:52,306 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:02:52,306 INFO: Model [MTNBModel] is created.
2022-11-10 14:02:52,312 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:02:52,318 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:02:52,323 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:02:52,328 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:02:52,333 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:02:52,339 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:02:52,344 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:02:52,349 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 14:02:52,777 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:02:53,481 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:02:54,227 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:02:54,739 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:02:55,403 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:02:55,987 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:02:56,116 INFO: fine-tune procedure is finished!
2022-11-10 14:03:50,338 INFO: [Test_acc of task 8 on test 3: 0.44540][acc of former classes: 0.71450][acc of former samples in all classes: 0.69617]
[acc of novel samples in all classes: 0.06925]
2022-11-10 14:03:50,358 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:03:50,364 WARNING: Current net - loaded net:
2022-11-10 14:03:50,364 WARNING: Loaded net - current net:
2022-11-10 14:03:50,364 WARNING:   func.fc.bias
2022-11-10 14:03:50,364 WARNING:   func.fc.weight
2022-11-10 14:03:50,377 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth.
2022-11-10 14:03:50,394 INFO: Obtain parameters for train
2022-11-10 14:03:50,396 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:03:50,396 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:03:50,397 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:03:50,398 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:03:50,398 INFO: Model [MTNBModel] is created.
2022-11-10 14:03:50,404 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 14:03:50,758 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:03:51,215 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:03:51,807 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:03:52,303 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:03:52,875 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:03:53,319 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:03:53,420 INFO: fine-tune procedure is finished!
2022-11-10 14:04:33,453 INFO: [Test_acc of task 1 on test 4: 0.66446][acc of former classes: 0.71400][acc of former samples in all classes: 0.71117]
[acc of novel samples in all classes: 0.10400]
2022-11-10 14:04:33,474 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:04:33,480 WARNING: Current net - loaded net:
2022-11-10 14:04:33,480 WARNING: Loaded net - current net:
2022-11-10 14:04:33,480 WARNING:   func.fc.bias
2022-11-10 14:04:33,480 WARNING:   func.fc.weight
2022-11-10 14:04:33,493 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_1.pth.
2022-11-10 14:04:33,510 INFO: Obtain parameters for train
2022-11-10 14:04:33,512 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:04:33,512 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:04:33,513 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:04:33,514 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:04:33,514 INFO: Model [MTNBModel] is created.
2022-11-10 14:04:33,521 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:33,527 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 14:04:33,908 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:04:34,569 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:04:35,057 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:04:35,748 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:04:36,388 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:04:37,091 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:04:37,312 INFO: fine-tune procedure is finished!
2022-11-10 14:05:19,485 INFO: [Test_acc of task 2 on test 4: 0.61886][acc of former classes: 0.71400][acc of former samples in all classes: 0.70750]
[acc of novel samples in all classes: 0.08700]
2022-11-10 14:05:19,509 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:05:19,515 WARNING: Current net - loaded net:
2022-11-10 14:05:19,515 WARNING: Loaded net - current net:
2022-11-10 14:05:19,515 WARNING:   func.fc.bias
2022-11-10 14:05:19,515 WARNING:   func.fc.weight
2022-11-10 14:05:19,527 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_2.pth.
2022-11-10 14:05:19,545 INFO: Obtain parameters for train
2022-11-10 14:05:19,547 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:05:19,547 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:05:19,548 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:05:19,549 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:05:19,550 INFO: Model [MTNBModel] is created.
2022-11-10 14:05:19,556 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:05:19,562 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:05:19,568 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 14:05:20,006 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:05:20,542 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:05:21,034 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:05:21,716 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:05:22,340 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:05:22,874 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:05:22,951 INFO: fine-tune procedure is finished!
2022-11-10 14:06:07,222 INFO: [Test_acc of task 3 on test 4: 0.58240][acc of former classes: 0.71417][acc of former samples in all classes: 0.70317]
[acc of novel samples in all classes: 0.09933]
2022-11-10 14:06:07,254 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:06:07,283 WARNING: Current net - loaded net:
2022-11-10 14:06:07,283 WARNING: Loaded net - current net:
2022-11-10 14:06:07,283 WARNING:   func.fc.bias
2022-11-10 14:06:07,283 WARNING:   func.fc.weight
2022-11-10 14:06:07,297 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_3.pth.
2022-11-10 14:06:07,319 INFO: Obtain parameters for train
2022-11-10 14:06:07,321 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:06:07,321 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:06:07,322 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:06:07,323 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:06:07,324 INFO: Model [MTNBModel] is created.
2022-11-10 14:06:07,331 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:07,338 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:07,344 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:07,355 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 14:06:07,798 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:08,380 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:08,879 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:09,453 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:10,034 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:10,561 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:10,648 INFO: fine-tune procedure is finished!
2022-11-10 14:06:56,197 INFO: [Test_acc of task 4 on test 4: 0.54888][acc of former classes: 0.71417][acc of former samples in all classes: 0.70200]
[acc of novel samples in all classes: 0.08950]
2022-11-10 14:06:56,217 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:06:56,223 WARNING: Current net - loaded net:
2022-11-10 14:06:56,223 WARNING: Loaded net - current net:
2022-11-10 14:06:56,223 WARNING:   func.fc.bias
2022-11-10 14:06:56,223 WARNING:   func.fc.weight
2022-11-10 14:06:56,236 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_4.pth.
2022-11-10 14:06:56,253 INFO: Obtain parameters for train
2022-11-10 14:06:56,255 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:06:56,255 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:06:56,256 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:06:56,257 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:06:56,257 INFO: Model [MTNBModel] is created.
2022-11-10 14:06:56,263 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:56,268 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:56,274 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:56,279 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:56,284 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 14:06:56,706 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:57,272 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:57,899 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:58,732 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:59,235 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:59,715 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:06:59,791 INFO: fine-tune procedure is finished!
2022-11-10 14:07:47,786 INFO: [Test_acc of task 5 on test 4: 0.51706][acc of former classes: 0.71417][acc of former samples in all classes: 0.70033]
[acc of novel samples in all classes: 0.07720]
2022-11-10 14:07:47,809 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:07:47,815 WARNING: Current net - loaded net:
2022-11-10 14:07:47,815 WARNING: Loaded net - current net:
2022-11-10 14:07:47,815 WARNING:   func.fc.bias
2022-11-10 14:07:47,816 WARNING:   func.fc.weight
2022-11-10 14:07:47,828 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_5.pth.
2022-11-10 14:07:47,846 INFO: Obtain parameters for train
2022-11-10 14:07:47,848 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:07:47,848 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:07:47,849 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:07:47,850 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:07:47,850 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:07:47,850 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:07:47,850 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:07:47,850 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:07:47,850 INFO: Model [MTNBModel] is created.
2022-11-10 14:07:47,856 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:07:47,861 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:07:47,866 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:07:47,871 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:07:47,877 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:07:47,882 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 14:07:48,310 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:07:48,762 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:07:49,238 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:07:49,696 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:07:50,208 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:07:50,941 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:07:51,078 INFO: fine-tune procedure is finished!
2022-11-10 14:08:41,324 INFO: [Test_acc of task 6 on test 4: 0.48822][acc of former classes: 0.71450][acc of former samples in all classes: 0.69867]
[acc of novel samples in all classes: 0.06733]
2022-11-10 14:08:41,348 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:08:41,354 WARNING: Current net - loaded net:
2022-11-10 14:08:41,354 WARNING: Loaded net - current net:
2022-11-10 14:08:41,354 WARNING:   func.fc.bias
2022-11-10 14:08:41,354 WARNING:   func.fc.weight
2022-11-10 14:08:41,369 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_6.pth.
2022-11-10 14:08:41,389 INFO: Obtain parameters for train
2022-11-10 14:08:41,391 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:08:41,391 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:08:41,392 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:08:41,393 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:08:41,393 INFO: Model [MTNBModel] is created.
2022-11-10 14:08:41,400 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:41,405 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:41,410 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:41,415 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:41,421 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:41,426 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:41,431 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 14:08:41,890 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:08:42,562 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:08:43,198 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:08:43,689 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:08:44,365 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:08:45,043 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:08:45,177 INFO: fine-tune procedure is finished!
2022-11-10 14:09:37,540 INFO: [Test_acc of task 7 on test 4: 0.46916][acc of former classes: 0.71450][acc of former samples in all classes: 0.69750]
[acc of novel samples in all classes: 0.07771]
2022-11-10 14:09:37,563 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-10 14:09:37,569 WARNING: Current net - loaded net:
2022-11-10 14:09:37,569 WARNING: Loaded net - current net:
2022-11-10 14:09:37,569 WARNING:   func.fc.bias
2022-11-10 14:09:37,569 WARNING:   func.fc.weight
2022-11-10 14:09:37,581 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_7.pth.
2022-11-10 14:09:37,600 INFO: Obtain parameters for train
2022-11-10 14:09:37,602 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:09:37,602 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:09:37,603 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:09:37,604 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-10 14:09:37,604 INFO: Model [MTNBModel] is created.
2022-11-10 14:09:37,610 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:37,615 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:37,623 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:37,628 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:37,633 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:37,639 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:37,644 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:37,649 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 14:09:38,026 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:09:38,511 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:09:39,120 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:09:39,581 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:09:40,079 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:09:40,779 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-10 14:09:40,877 INFO: fine-tune procedure is finished!
2022-11-10 14:10:35,122 INFO: [Test_acc of task 8 on test 4: 0.44570][acc of former classes: 0.71450][acc of former samples in all classes: 0.69417]
[acc of novel samples in all classes: 0.07300]
2022-11-10 14:10:35,132 INFO: --------------------------Final Avg Acc-------------------------
2022-11-10 14:10:35,132 INFO: Session 1: 71.40+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7140]
2022-11-10 14:10:35,132 INFO: Session 2: 66.50+-0.16[acc of former classes: 0.7140][acc of former samples in all classes: 0.7109]
[acc of novel samples in all classes: 0.1148]
2022-11-10 14:10:35,132 INFO: Session 3: 62.02+-0.17[acc of former classes: 0.7140][acc of former samples in all classes: 0.7075]
[acc of novel samples in all classes: 0.0966]
2022-11-10 14:10:35,132 INFO: Session 4: 58.10+-0.17[acc of former classes: 0.7142][acc of former samples in all classes: 0.7047]
[acc of novel samples in all classes: 0.0861]
2022-11-10 14:10:35,132 INFO: Session 5: 54.70+-0.12[acc of former classes: 0.7142][acc of former samples in all classes: 0.7037]
[acc of novel samples in all classes: 0.0771]
2022-11-10 14:10:35,132 INFO: Session 6: 51.60+-0.15[acc of former classes: 0.7142][acc of former samples in all classes: 0.7013]
[acc of novel samples in all classes: 0.0712]
2022-11-10 14:10:35,133 INFO: Session 7: 48.94+-0.14[acc of former classes: 0.7145][acc of former samples in all classes: 0.6995]
[acc of novel samples in all classes: 0.0694]
2022-11-10 14:10:35,133 INFO: Session 8: 46.81+-0.29[acc of former classes: 0.7145][acc of former samples in all classes: 0.6975]
[acc of novel samples in all classes: 0.0749]
2022-11-10 14:10:35,133 INFO: Session 9: 44.57+-0.23[acc of former classes: 0.7145][acc of former samples in all classes: 0.6953]
[acc of novel samples in all classes: 0.0714]
2022-11-10 14:10:35,133 INFO: random seed: 1997
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_F2M_res18_cifar_1shot_debug_02/models/test4_session_8.pth
finish!!
