/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-10 13:39:07,577 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-10 13:39:07,578 INFO: 
  name: 1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug
  model_type: FSLLModel
  gpu: 1
  manual_seed: 1997
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  datasets:[
    train:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: 25
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    val:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    test:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: True
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
  ]
  network_g:[
    type: Resnet20_cifar_small
    num_classes: 60
    adopt_classifier: False
    flatten: True
  ]
  path:[
    pretrain_model_g: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
    base_model: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug
    training_states: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/training_states
    log: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug
    models: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.001
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [160]
      gamma: 0.1
    ]
    fine_tune: True
    fine_tune_epoch: 15
    threshold: 0.4
    warmup_iter: -1
    bases: 60
    tasks: 9
    shots: 1
    novel_exemplars: 1
    num_test: 5
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 1
      use_cosine: True
    ]
    regularization:[
      type: IncrementalNetworkFixLoss
      w: 5.0
    ]
  ]
  val:[
    val_freq: 1000
    test_type: NCM
    p_norm: None
  ]
  logger:[
    print_freq: 2
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-10 13:39:07,578 INFO: Random seed: 1997
2022-11-10 13:39:09,392 INFO: Network: Resnet20_cifar_small, with parameters: 271,824
2022-11-10 13:39:09,392 INFO: Resnet20_cifar_small(
  (func): ResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (avg_pool): AdaptiveAvgPool2d(output_size=(1, 1))
  )
)
2022-11-10 13:39:09,392 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:39:09,399 WARNING: Current net - loaded net:
2022-11-10 13:39:09,399 WARNING: Loaded net - current net:
2022-11-10 13:39:09,399 WARNING:   func.fc.bias
2022-11-10 13:39:09,399 WARNING:   func.fc.weight
2022-11-10 13:39:09,403 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:39:09,408 WARNING: Current net - loaded net:
2022-11-10 13:39:09,408 WARNING: Loaded net - current net:
2022-11-10 13:39:09,408 WARNING:   func.fc.bias
2022-11-10 13:39:09,408 WARNING:   func.fc.weight
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:39:09,425 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:39:09,426 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:39:09,426 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:39:09,427 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:39:09,428 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:39:09,428 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:39:09,428 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:39:09,428 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:39:09,428 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:39:09,428 INFO: Model [FSLLModel] is created.
2022-11-10 13:39:41,362 INFO: [Test_acc of task 0 on test 0: 0.72517][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.72517]
2022-11-10 13:39:41,382 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:39:41,388 WARNING: Current net - loaded net:
2022-11-10 13:39:41,388 WARNING: Loaded net - current net:
2022-11-10 13:39:41,388 WARNING:   func.fc.bias
2022-11-10 13:39:41,388 WARNING:   func.fc.weight
2022-11-10 13:39:41,392 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth.
2022-11-10 13:39:41,401 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:39:41,412 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:39:41,413 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:39:41,413 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:39:41,414 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:39:41,415 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:39:41,415 INFO: Model [FSLLModel] is created.
2022-11-10 13:39:41,421 INFO: Dataset NormalDataset - cifar-100 is created.
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 13:39:42,039 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8133, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:39:42,507 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.8155, Acc: 1.0000, NetFixLoss: 0.0033, ]
2022-11-10 13:39:43,003 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8115, Acc: 1.0000, NetFixLoss: 0.0083, ]
2022-11-10 13:39:43,621 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8151, Acc: 1.0000, NetFixLoss: 0.0150, ]
2022-11-10 13:39:44,252 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.8186, Acc: 1.0000, NetFixLoss: 0.0233, ]
2022-11-10 13:39:44,746 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.8172, Acc: 1.0000, NetFixLoss: 0.0328, ]
2022-11-10 13:39:45,263 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8176, Acc: 1.0000, NetFixLoss: 0.0439, ]
2022-11-10 13:39:45,792 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.8065, Acc: 1.0000, NetFixLoss: 0.0561, ]
2022-11-10 13:39:46,281 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.8176, Acc: 1.0000, NetFixLoss: 0.0690, ]
2022-11-10 13:39:46,800 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.8022, Acc: 1.0000, NetFixLoss: 0.0828, ]
2022-11-10 13:39:47,318 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8082, Acc: 1.0000, NetFixLoss: 0.0974, ]
2022-11-10 13:39:47,914 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.8025, Acc: 1.0000, NetFixLoss: 0.1127, ]
2022-11-10 13:39:48,417 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.8200, Acc: 1.0000, NetFixLoss: 0.1287, ]
2022-11-10 13:39:49,037 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8149, Acc: 1.0000, NetFixLoss: 0.1454, ]
2022-11-10 13:39:49,656 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.8155, Acc: 1.0000, NetFixLoss: 0.1629, ]
2022-11-10 13:39:49,754 INFO: fine-tune procedure is finished!
2022-11-10 13:40:29,483 INFO: [Test_acc of task 1 on test 0: 0.56862][acc of former classes: 0.61317][acc of former samples in all classes: 0.61200]
[acc of novel samples in all classes: 0.04800]
2022-11-10 13:40:29,504 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:40:29,509 WARNING: Current net - loaded net:
2022-11-10 13:40:29,509 WARNING: Loaded net - current net:
2022-11-10 13:40:29,509 WARNING:   func.fc.bias
2022-11-10 13:40:29,509 WARNING:   func.fc.weight
2022-11-10 13:40:29,514 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_1.pth.
2022-11-10 13:40:29,523 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:40:29,534 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:40:29,535 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:40:29,535 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:40:29,536 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:40:29,537 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:40:29,537 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:40:29,537 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:40:29,537 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:40:29,537 INFO: Model [FSLLModel] is created.
2022-11-10 13:40:29,543 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:40:29,548 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 13:40:29,949 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8605, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:40:30,464 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.8484, Acc: 1.0000, NetFixLoss: 0.0026, ]
2022-11-10 13:40:30,946 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8639, Acc: 1.0000, NetFixLoss: 0.0067, ]
2022-11-10 13:40:31,562 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8508, Acc: 1.0000, NetFixLoss: 0.0121, ]
2022-11-10 13:40:32,132 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.8642, Acc: 1.0000, NetFixLoss: 0.0186, ]
2022-11-10 13:40:32,660 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.8638, Acc: 1.0000, NetFixLoss: 0.0263, ]
2022-11-10 13:40:33,241 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8648, Acc: 1.0000, NetFixLoss: 0.0349, ]
2022-11-10 13:40:33,807 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.8552, Acc: 1.0000, NetFixLoss: 0.0445, ]
2022-11-10 13:40:34,338 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.8670, Acc: 1.0000, NetFixLoss: 0.0548, ]
2022-11-10 13:40:34,829 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.8643, Acc: 1.0000, NetFixLoss: 0.0657, ]
2022-11-10 13:40:35,321 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8636, Acc: 1.0000, NetFixLoss: 0.0773, ]
2022-11-10 13:40:35,873 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.8634, Acc: 1.0000, NetFixLoss: 0.0895, ]
2022-11-10 13:40:36,356 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.8663, Acc: 1.0000, NetFixLoss: 0.1023, ]
2022-11-10 13:40:36,917 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8639, Acc: 1.0000, NetFixLoss: 0.1156, ]
2022-11-10 13:40:38,479 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.8664, Acc: 1.0000, NetFixLoss: 0.1294, ]
2022-11-10 13:40:38,570 INFO: fine-tune procedure is finished!
2022-11-10 13:41:19,807 INFO: [Test_acc of task 2 on test 0: 0.54357][acc of former classes: 0.63167][acc of former samples in all classes: 0.62650]
[acc of novel samples in all classes: 0.04600]
2022-11-10 13:41:19,827 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:41:19,832 WARNING: Current net - loaded net:
2022-11-10 13:41:19,832 WARNING: Loaded net - current net:
2022-11-10 13:41:19,832 WARNING:   func.fc.bias
2022-11-10 13:41:19,832 WARNING:   func.fc.weight
2022-11-10 13:41:19,837 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_2.pth.
2022-11-10 13:41:19,846 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:41:19,857 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:41:19,858 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:41:19,858 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:41:19,859 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:41:19,860 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:41:19,860 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:41:19,860 INFO: Model [FSLLModel] is created.
2022-11-10 13:41:19,866 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:41:19,871 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:41:19,876 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 13:41:20,292 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9127, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:41:20,798 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9159, Acc: 1.0000, NetFixLoss: 0.0025, ]
2022-11-10 13:41:21,299 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9234, Acc: 1.0000, NetFixLoss: 0.0064, ]
2022-11-10 13:41:21,864 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9216, Acc: 1.0000, NetFixLoss: 0.0116, ]
2022-11-10 13:41:22,395 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9131, Acc: 1.0000, NetFixLoss: 0.0181, ]
2022-11-10 13:41:22,911 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9105, Acc: 1.0000, NetFixLoss: 0.0256, ]
2022-11-10 13:41:23,425 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9162, Acc: 1.0000, NetFixLoss: 0.0341, ]
2022-11-10 13:41:23,971 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9160, Acc: 1.0000, NetFixLoss: 0.0434, ]
2022-11-10 13:41:24,469 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9242, Acc: 1.0000, NetFixLoss: 0.0534, ]
2022-11-10 13:41:25,015 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9138, Acc: 1.0000, NetFixLoss: 0.0641, ]
2022-11-10 13:41:25,631 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9135, Acc: 1.0000, NetFixLoss: 0.0754, ]
2022-11-10 13:41:26,171 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9164, Acc: 1.0000, NetFixLoss: 0.0873, ]
2022-11-10 13:41:26,730 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9169, Acc: 1.0000, NetFixLoss: 0.0998, ]
2022-11-10 13:41:27,324 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9160, Acc: 1.0000, NetFixLoss: 0.1126, ]
2022-11-10 13:41:27,901 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9097, Acc: 1.0000, NetFixLoss: 0.1259, ]
2022-11-10 13:41:27,986 INFO: fine-tune procedure is finished!
2022-11-10 13:42:11,315 INFO: [Test_acc of task 3 on test 0: 0.50493][acc of former classes: 0.62883][acc of former samples in all classes: 0.62067]
[acc of novel samples in all classes: 0.04200]
2022-11-10 13:42:11,335 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:42:11,340 WARNING: Current net - loaded net:
2022-11-10 13:42:11,340 WARNING: Loaded net - current net:
2022-11-10 13:42:11,340 WARNING:   func.fc.bias
2022-11-10 13:42:11,340 WARNING:   func.fc.weight
2022-11-10 13:42:11,344 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_3.pth.
2022-11-10 13:42:11,353 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:42:11,365 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:42:11,366 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:42:11,366 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:42:11,366 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:42:11,367 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:42:11,368 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:42:11,368 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:42:11,368 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:42:11,368 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:42:11,368 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:42:11,368 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:42:11,368 INFO: Model [FSLLModel] is created.
2022-11-10 13:42:11,374 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:42:11,379 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:42:11,384 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:42:11,389 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 13:42:11,825 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9704, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:42:12,429 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9711, Acc: 1.0000, NetFixLoss: 0.0022, ]
2022-11-10 13:42:12,967 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9728, Acc: 1.0000, NetFixLoss: 0.0057, ]
2022-11-10 13:42:13,464 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9726, Acc: 1.0000, NetFixLoss: 0.0105, ]
2022-11-10 13:42:13,990 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9660, Acc: 1.0000, NetFixLoss: 0.0165, ]
2022-11-10 13:42:14,514 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9646, Acc: 1.0000, NetFixLoss: 0.0235, ]
2022-11-10 13:42:15,128 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9638, Acc: 1.0000, NetFixLoss: 0.0315, ]
2022-11-10 13:42:15,729 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9644, Acc: 1.0000, NetFixLoss: 0.0403, ]
2022-11-10 13:42:16,267 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9701, Acc: 1.0000, NetFixLoss: 0.0500, ]
2022-11-10 13:42:16,828 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9681, Acc: 1.0000, NetFixLoss: 0.0603, ]
2022-11-10 13:42:17,462 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9705, Acc: 1.0000, NetFixLoss: 0.0711, ]
2022-11-10 13:42:18,043 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9686, Acc: 1.0000, NetFixLoss: 0.0825, ]
2022-11-10 13:42:18,567 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9728, Acc: 1.0000, NetFixLoss: 0.0945, ]
2022-11-10 13:42:19,083 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9730, Acc: 1.0000, NetFixLoss: 0.1070, ]
2022-11-10 13:42:19,725 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9660, Acc: 1.0000, NetFixLoss: 0.1198, ]
2022-11-10 13:42:19,843 INFO: fine-tune procedure is finished!
2022-11-10 13:43:05,795 INFO: [Test_acc of task 4 on test 0: 0.48300][acc of former classes: 0.64067][acc of former samples in all classes: 0.63183]
[acc of novel samples in all classes: 0.03650]
2022-11-10 13:43:05,816 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:43:05,821 WARNING: Current net - loaded net:
2022-11-10 13:43:05,821 WARNING: Loaded net - current net:
2022-11-10 13:43:05,821 WARNING:   func.fc.bias
2022-11-10 13:43:05,821 WARNING:   func.fc.weight
2022-11-10 13:43:05,826 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_4.pth.
2022-11-10 13:43:05,835 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:43:05,847 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:43:05,847 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:43:05,847 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:43:05,847 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:43:05,847 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:43:05,847 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:43:05,848 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:43:05,849 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:43:05,849 INFO: Model [FSLLModel] is created.
2022-11-10 13:43:05,855 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:05,860 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:05,866 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:05,871 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:43:05,876 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 13:43:06,322 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0186, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:43:06,851 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0193, Acc: 1.0000, NetFixLoss: 0.0019, ]
2022-11-10 13:43:07,384 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0151, Acc: 1.0000, NetFixLoss: 0.0052, ]
2022-11-10 13:43:07,962 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0202, Acc: 1.0000, NetFixLoss: 0.0096, ]
2022-11-10 13:43:08,481 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0254, Acc: 1.0000, NetFixLoss: 0.0152, ]
2022-11-10 13:43:09,003 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0199, Acc: 1.0000, NetFixLoss: 0.0218, ]
2022-11-10 13:43:09,513 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0180, Acc: 1.0000, NetFixLoss: 0.0293, ]
2022-11-10 13:43:10,129 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0167, Acc: 1.0000, NetFixLoss: 0.0377, ]
2022-11-10 13:43:10,678 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0244, Acc: 1.0000, NetFixLoss: 0.0466, ]
2022-11-10 13:43:11,246 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0207, Acc: 1.0000, NetFixLoss: 0.0562, ]
2022-11-10 13:43:11,787 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0251, Acc: 1.0000, NetFixLoss: 0.0662, ]
2022-11-10 13:43:12,395 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0195, Acc: 1.0000, NetFixLoss: 0.0768, ]
2022-11-10 13:43:12,931 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0234, Acc: 1.0000, NetFixLoss: 0.0878, ]
2022-11-10 13:43:13,431 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0177, Acc: 1.0000, NetFixLoss: 0.0993, ]
2022-11-10 13:43:13,930 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0240, Acc: 1.0000, NetFixLoss: 0.1110, ]
2022-11-10 13:43:14,034 INFO: fine-tune procedure is finished!
2022-11-10 13:44:11,138 INFO: [Test_acc of task 5 on test 0: 0.47447][acc of former classes: 0.66883][acc of former samples in all classes: 0.65583]
[acc of novel samples in all classes: 0.03920]
2022-11-10 13:44:11,191 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:44:11,196 WARNING: Current net - loaded net:
2022-11-10 13:44:11,196 WARNING: Loaded net - current net:
2022-11-10 13:44:11,196 WARNING:   func.fc.bias
2022-11-10 13:44:11,196 WARNING:   func.fc.weight
2022-11-10 13:44:11,232 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_5.pth.
2022-11-10 13:44:11,274 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:44:11,301 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:44:11,302 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:44:11,302 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:44:11,303 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:44:11,304 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:44:11,304 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:44:11,304 INFO: Model [FSLLModel] is created.
2022-11-10 13:44:11,310 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:11,315 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:11,320 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:11,325 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:11,330 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:44:11,335 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 13:44:11,791 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0798, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:44:12,317 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0716, Acc: 1.0000, NetFixLoss: 0.0019, ]
2022-11-10 13:44:12,829 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0742, Acc: 1.0000, NetFixLoss: 0.0048, ]
2022-11-10 13:44:13,372 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0763, Acc: 1.0000, NetFixLoss: 0.0089, ]
2022-11-10 13:44:13,894 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0714, Acc: 1.0000, NetFixLoss: 0.0141, ]
2022-11-10 13:44:14,424 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0748, Acc: 1.0000, NetFixLoss: 0.0202, ]
2022-11-10 13:44:14,976 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0688, Acc: 1.0000, NetFixLoss: 0.0271, ]
2022-11-10 13:44:15,488 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0756, Acc: 1.0000, NetFixLoss: 0.0348, ]
2022-11-10 13:44:16,046 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0770, Acc: 1.0000, NetFixLoss: 0.0431, ]
2022-11-10 13:44:16,554 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0705, Acc: 1.0000, NetFixLoss: 0.0520, ]
2022-11-10 13:44:17,198 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0699, Acc: 1.0000, NetFixLoss: 0.0613, ]
2022-11-10 13:44:17,830 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0740, Acc: 1.0000, NetFixLoss: 0.0712, ]
2022-11-10 13:44:18,381 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0726, Acc: 1.0000, NetFixLoss: 0.0814, ]
2022-11-10 13:44:18,955 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0676, Acc: 1.0000, NetFixLoss: 0.0921, ]
2022-11-10 13:44:19,567 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0737, Acc: 1.0000, NetFixLoss: 0.1031, ]
2022-11-10 13:44:19,649 INFO: fine-tune procedure is finished!
2022-11-10 13:45:18,669 INFO: [Test_acc of task 6 on test 0: 0.46578][acc of former classes: 0.68650][acc of former samples in all classes: 0.67150]
[acc of novel samples in all classes: 0.05433]
2022-11-10 13:45:18,722 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:45:18,727 WARNING: Current net - loaded net:
2022-11-10 13:45:18,727 WARNING: Loaded net - current net:
2022-11-10 13:45:18,727 WARNING:   func.fc.bias
2022-11-10 13:45:18,727 WARNING:   func.fc.weight
2022-11-10 13:45:18,764 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_6.pth.
2022-11-10 13:45:18,806 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:45:18,834 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:45:18,834 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:45:18,834 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:45:18,834 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:45:18,835 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:45:18,835 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:45:18,835 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:45:18,835 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:45:18,835 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:45:18,835 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:45:18,835 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:45:18,835 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:45:18,835 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:45:18,836 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:45:18,837 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:45:18,837 INFO: Model [FSLLModel] is created.
2022-11-10 13:45:18,843 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:18,848 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:18,853 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:18,858 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:18,863 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:18,868 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:45:18,874 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 13:45:19,349 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1342, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:45:19,887 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1299, Acc: 1.0000, NetFixLoss: 0.0019, ]
2022-11-10 13:45:20,499 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1267, Acc: 1.0000, NetFixLoss: 0.0049, ]
2022-11-10 13:45:21,016 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1258, Acc: 1.0000, NetFixLoss: 0.0090, ]
2022-11-10 13:45:21,583 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1256, Acc: 1.0000, NetFixLoss: 0.0141, ]
2022-11-10 13:45:22,101 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1230, Acc: 1.0000, NetFixLoss: 0.0201, ]
2022-11-10 13:45:22,639 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1274, Acc: 1.0000, NetFixLoss: 0.0270, ]
2022-11-10 13:45:23,348 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1343, Acc: 1.0000, NetFixLoss: 0.0345, ]
2022-11-10 13:45:23,892 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1258, Acc: 1.0000, NetFixLoss: 0.0428, ]
2022-11-10 13:45:24,446 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1280, Acc: 1.0000, NetFixLoss: 0.0518, ]
2022-11-10 13:45:24,943 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1262, Acc: 1.0000, NetFixLoss: 0.0613, ]
2022-11-10 13:45:25,595 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1272, Acc: 1.0000, NetFixLoss: 0.0712, ]
2022-11-10 13:45:26,103 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1276, Acc: 1.0000, NetFixLoss: 0.0815, ]
2022-11-10 13:45:26,600 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1305, Acc: 1.0000, NetFixLoss: 0.0922, ]
2022-11-10 13:45:27,190 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1264, Acc: 1.0000, NetFixLoss: 0.1032, ]
2022-11-10 13:45:27,332 INFO: fine-tune procedure is finished!
2022-11-10 13:46:25,977 INFO: [Test_acc of task 7 on test 0: 0.44726][acc of former classes: 0.68833][acc of former samples in all classes: 0.67150]
[acc of novel samples in all classes: 0.06286]
2022-11-10 13:46:25,997 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:46:26,002 WARNING: Current net - loaded net:
2022-11-10 13:46:26,002 WARNING: Loaded net - current net:
2022-11-10 13:46:26,003 WARNING:   func.fc.bias
2022-11-10 13:46:26,003 WARNING:   func.fc.weight
2022-11-10 13:46:26,007 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_7.pth.
2022-11-10 13:46:26,016 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:46:26,027 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:46:26,027 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:46:26,027 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:46:26,027 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:46:26,027 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:46:26,027 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:46:26,027 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:46:26,028 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:46:26,028 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:46:26,028 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:46:26,028 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:46:26,028 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:46:26,028 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:46:26,029 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:46:26,030 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:46:26,030 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:46:26,030 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:46:26,030 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:46:26,030 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:46:26,030 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:46:26,030 INFO: Model [FSLLModel] is created.
2022-11-10 13:46:26,036 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:26,041 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:26,046 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:26,052 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:26,057 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:26,062 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:26,067 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:46:26,072 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 13:46:26,505 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1698, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:46:27,091 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1807, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 13:46:27,688 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1705, Acc: 1.0000, NetFixLoss: 0.0047, ]
2022-11-10 13:46:28,283 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1713, Acc: 1.0000, NetFixLoss: 0.0087, ]
2022-11-10 13:46:28,788 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1685, Acc: 1.0000, NetFixLoss: 0.0137, ]
2022-11-10 13:46:29,350 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1707, Acc: 1.0000, NetFixLoss: 0.0196, ]
2022-11-10 13:46:29,980 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1721, Acc: 1.0000, NetFixLoss: 0.0263, ]
2022-11-10 13:46:30,511 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1685, Acc: 1.0000, NetFixLoss: 0.0338, ]
2022-11-10 13:46:31,117 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1720, Acc: 1.0000, NetFixLoss: 0.0419, ]
2022-11-10 13:46:31,695 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1796, Acc: 1.0000, NetFixLoss: 0.0506, ]
2022-11-10 13:46:32,257 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1693, Acc: 1.0000, NetFixLoss: 0.0599, ]
2022-11-10 13:46:32,888 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1744, Acc: 1.0000, NetFixLoss: 0.0696, ]
2022-11-10 13:46:33,479 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1722, Acc: 1.0000, NetFixLoss: 0.0797, ]
2022-11-10 13:46:34,028 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1722, Acc: 1.0000, NetFixLoss: 0.0902, ]
2022-11-10 13:46:34,619 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1721, Acc: 1.0000, NetFixLoss: 0.1010, ]
2022-11-10 13:46:34,713 INFO: fine-tune procedure is finished!
2022-11-10 13:47:35,519 INFO: [Test_acc of task 8 on test 0: 0.43110][acc of former classes: 0.69633][acc of former samples in all classes: 0.67950]
[acc of novel samples in all classes: 0.05850]
2022-11-10 13:47:35,572 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:47:35,577 WARNING: Current net - loaded net:
2022-11-10 13:47:35,577 WARNING: Loaded net - current net:
2022-11-10 13:47:35,577 WARNING:   func.fc.bias
2022-11-10 13:47:35,577 WARNING:   func.fc.weight
2022-11-10 13:47:35,614 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth.
2022-11-10 13:47:35,653 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:47:35,681 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:47:35,682 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:47:35,682 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:47:35,682 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:47:35,683 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:47:35,684 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:47:35,684 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:47:35,684 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:47:35,684 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:47:35,684 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:47:35,684 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:47:35,684 INFO: Model [FSLLModel] is created.
2022-11-10 13:47:35,690 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 13:47:36,120 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.7972, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:47:36,720 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.7915, Acc: 1.0000, NetFixLoss: 0.0030, ]
2022-11-10 13:47:37,341 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8019, Acc: 1.0000, NetFixLoss: 0.0076, ]
2022-11-10 13:47:38,024 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.7954, Acc: 1.0000, NetFixLoss: 0.0139, ]
2022-11-10 13:47:38,561 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.7959, Acc: 1.0000, NetFixLoss: 0.0217, ]
2022-11-10 13:47:39,084 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.7957, Acc: 1.0000, NetFixLoss: 0.0307, ]
2022-11-10 13:47:39,633 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.7877, Acc: 1.0000, NetFixLoss: 0.0411, ]
2022-11-10 13:47:40,190 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.7960, Acc: 1.0000, NetFixLoss: 0.0529, ]
2022-11-10 13:47:40,750 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.7920, Acc: 1.0000, NetFixLoss: 0.0658, ]
2022-11-10 13:47:41,268 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.7949, Acc: 1.0000, NetFixLoss: 0.0796, ]
2022-11-10 13:47:41,809 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8030, Acc: 1.0000, NetFixLoss: 0.0943, ]
2022-11-10 13:47:42,308 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.7978, Acc: 1.0000, NetFixLoss: 0.1100, ]
2022-11-10 13:47:42,804 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.7977, Acc: 1.0000, NetFixLoss: 0.1265, ]
2022-11-10 13:47:43,401 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8015, Acc: 1.0000, NetFixLoss: 0.1438, ]
2022-11-10 13:47:43,967 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.7920, Acc: 1.0000, NetFixLoss: 0.1612, ]
2022-11-10 13:47:44,063 INFO: fine-tune procedure is finished!
2022-11-10 13:48:30,748 INFO: [Test_acc of task 1 on test 1: 0.58846][acc of former classes: 0.63450][acc of former samples in all classes: 0.63183]
[acc of novel samples in all classes: 0.06800]
2022-11-10 13:48:30,900 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:48:30,906 WARNING: Current net - loaded net:
2022-11-10 13:48:30,906 WARNING: Loaded net - current net:
2022-11-10 13:48:30,906 WARNING:   func.fc.bias
2022-11-10 13:48:30,906 WARNING:   func.fc.weight
2022-11-10 13:48:30,942 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_1.pth.
2022-11-10 13:48:30,984 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:48:31,012 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:48:31,012 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:48:31,012 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:48:31,013 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:48:31,014 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:48:31,014 INFO: Model [FSLLModel] is created.
2022-11-10 13:48:31,020 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:48:31,025 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 13:48:31,423 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8440, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:48:31,949 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.8520, Acc: 1.0000, NetFixLoss: 0.0025, ]
2022-11-10 13:48:32,439 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8470, Acc: 1.0000, NetFixLoss: 0.0063, ]
2022-11-10 13:48:32,937 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8488, Acc: 1.0000, NetFixLoss: 0.0118, ]
2022-11-10 13:48:33,421 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.8405, Acc: 1.0000, NetFixLoss: 0.0186, ]
2022-11-10 13:48:33,923 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.8396, Acc: 1.0000, NetFixLoss: 0.0264, ]
2022-11-10 13:48:34,469 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8362, Acc: 1.0000, NetFixLoss: 0.0351, ]
2022-11-10 13:48:34,977 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.8509, Acc: 1.0000, NetFixLoss: 0.0447, ]
2022-11-10 13:48:35,564 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.8419, Acc: 1.0000, NetFixLoss: 0.0552, ]
2022-11-10 13:48:36,070 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.8409, Acc: 1.0000, NetFixLoss: 0.0667, ]
2022-11-10 13:48:36,602 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8475, Acc: 1.0000, NetFixLoss: 0.0788, ]
2022-11-10 13:48:37,122 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.8380, Acc: 1.0000, NetFixLoss: 0.0915, ]
2022-11-10 13:48:37,708 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.8384, Acc: 1.0000, NetFixLoss: 0.1045, ]
2022-11-10 13:48:38,213 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8476, Acc: 1.0000, NetFixLoss: 0.1182, ]
2022-11-10 13:48:38,734 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.8444, Acc: 1.0000, NetFixLoss: 0.1323, ]
2022-11-10 13:48:38,834 INFO: fine-tune procedure is finished!
2022-11-10 13:49:29,673 INFO: [Test_acc of task 2 on test 1: 0.55529][acc of former classes: 0.64333][acc of former samples in all classes: 0.63767]
[acc of novel samples in all classes: 0.06100]
2022-11-10 13:49:29,718 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:49:29,723 WARNING: Current net - loaded net:
2022-11-10 13:49:29,723 WARNING: Loaded net - current net:
2022-11-10 13:49:29,723 WARNING:   func.fc.bias
2022-11-10 13:49:29,723 WARNING:   func.fc.weight
2022-11-10 13:49:29,755 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_2.pth.
2022-11-10 13:49:29,791 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:49:29,819 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:49:29,820 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:49:29,820 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:49:29,821 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:49:29,822 INFO: Model [FSLLModel] is created.
2022-11-10 13:49:29,827 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:49:29,833 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:49:29,838 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 13:49:30,242 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9104, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:49:30,745 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9064, Acc: 1.0000, NetFixLoss: 0.0024, ]
2022-11-10 13:49:31,242 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9006, Acc: 1.0000, NetFixLoss: 0.0062, ]
2022-11-10 13:49:31,793 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9092, Acc: 1.0000, NetFixLoss: 0.0113, ]
2022-11-10 13:49:32,267 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9075, Acc: 1.0000, NetFixLoss: 0.0178, ]
2022-11-10 13:49:32,754 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9026, Acc: 1.0000, NetFixLoss: 0.0254, ]
2022-11-10 13:49:33,277 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9085, Acc: 1.0000, NetFixLoss: 0.0341, ]
2022-11-10 13:49:33,804 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9078, Acc: 1.0000, NetFixLoss: 0.0435, ]
2022-11-10 13:49:34,331 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9062, Acc: 1.0000, NetFixLoss: 0.0536, ]
2022-11-10 13:49:34,837 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9066, Acc: 1.0000, NetFixLoss: 0.0645, ]
2022-11-10 13:49:35,455 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8985, Acc: 1.0000, NetFixLoss: 0.0761, ]
2022-11-10 13:49:36,054 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9055, Acc: 1.0000, NetFixLoss: 0.0883, ]
2022-11-10 13:49:36,601 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9053, Acc: 1.0000, NetFixLoss: 0.1010, ]
2022-11-10 13:49:37,153 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9081, Acc: 1.0000, NetFixLoss: 0.1142, ]
2022-11-10 13:49:37,678 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9192, Acc: 1.0000, NetFixLoss: 0.1278, ]
2022-11-10 13:49:37,770 INFO: fine-tune procedure is finished!
2022-11-10 13:50:32,720 INFO: [Test_acc of task 3 on test 1: 0.52533][acc of former classes: 0.64933][acc of former samples in all classes: 0.63900]
[acc of novel samples in all classes: 0.07067]
2022-11-10 13:50:32,774 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:50:32,779 WARNING: Current net - loaded net:
2022-11-10 13:50:32,779 WARNING: Loaded net - current net:
2022-11-10 13:50:32,779 WARNING:   func.fc.bias
2022-11-10 13:50:32,779 WARNING:   func.fc.weight
2022-11-10 13:50:32,816 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_3.pth.
2022-11-10 13:50:32,854 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:50:32,881 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:50:32,881 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:50:32,881 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:50:32,881 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:50:32,881 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:50:32,881 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:50:32,882 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:50:32,882 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:50:32,882 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:50:32,882 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:50:32,882 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:50:32,882 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:50:32,882 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:50:32,883 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:50:32,884 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:50:32,884 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:50:32,884 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:50:32,884 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:50:32,884 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:50:32,884 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:50:32,884 INFO: Model [FSLLModel] is created.
2022-11-10 13:50:32,890 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:50:32,895 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:50:32,900 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:50:32,905 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 13:50:33,440 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9724, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:50:34,055 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9723, Acc: 1.0000, NetFixLoss: 0.0022, ]
2022-11-10 13:50:34,771 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9719, Acc: 1.0000, NetFixLoss: 0.0058, ]
2022-11-10 13:50:35,366 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9741, Acc: 1.0000, NetFixLoss: 0.0107, ]
2022-11-10 13:50:36,001 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9736, Acc: 1.0000, NetFixLoss: 0.0167, ]
2022-11-10 13:50:36,781 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9736, Acc: 1.0000, NetFixLoss: 0.0238, ]
2022-11-10 13:50:37,473 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9738, Acc: 1.0000, NetFixLoss: 0.0319, ]
2022-11-10 13:50:38,131 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9739, Acc: 1.0000, NetFixLoss: 0.0407, ]
2022-11-10 13:50:38,793 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9691, Acc: 1.0000, NetFixLoss: 0.0503, ]
2022-11-10 13:50:39,406 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9701, Acc: 1.0000, NetFixLoss: 0.0606, ]
2022-11-10 13:50:40,092 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9733, Acc: 1.0000, NetFixLoss: 0.0713, ]
2022-11-10 13:50:40,751 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9704, Acc: 1.0000, NetFixLoss: 0.0826, ]
2022-11-10 13:50:41,322 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9765, Acc: 1.0000, NetFixLoss: 0.0944, ]
2022-11-10 13:50:41,959 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9725, Acc: 1.0000, NetFixLoss: 0.1067, ]
2022-11-10 13:50:42,593 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9715, Acc: 1.0000, NetFixLoss: 0.1193, ]
2022-11-10 13:50:42,716 INFO: fine-tune procedure is finished!
2022-11-10 13:51:37,775 INFO: [Test_acc of task 4 on test 1: 0.50625][acc of former classes: 0.66667][acc of former samples in all classes: 0.65567]
[acc of novel samples in all classes: 0.05800]
2022-11-10 13:51:37,821 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:51:37,826 WARNING: Current net - loaded net:
2022-11-10 13:51:37,826 WARNING: Loaded net - current net:
2022-11-10 13:51:37,826 WARNING:   func.fc.bias
2022-11-10 13:51:37,826 WARNING:   func.fc.weight
2022-11-10 13:51:37,858 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_4.pth.
2022-11-10 13:51:37,897 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:51:37,925 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:51:37,925 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:51:37,926 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:51:37,927 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:51:37,928 INFO: Model [FSLLModel] is created.
2022-11-10 13:51:37,934 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:37,939 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:37,944 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:37,949 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:51:37,954 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 13:51:38,377 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0213, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:51:38,899 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0222, Acc: 1.0000, NetFixLoss: 0.0020, ]
2022-11-10 13:51:39,464 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0275, Acc: 1.0000, NetFixLoss: 0.0051, ]
2022-11-10 13:51:39,996 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0266, Acc: 1.0000, NetFixLoss: 0.0095, ]
2022-11-10 13:51:40,575 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0334, Acc: 1.0000, NetFixLoss: 0.0151, ]
2022-11-10 13:51:41,089 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0266, Acc: 1.0000, NetFixLoss: 0.0217, ]
2022-11-10 13:51:41,630 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0255, Acc: 1.0000, NetFixLoss: 0.0291, ]
2022-11-10 13:51:42,164 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0294, Acc: 1.0000, NetFixLoss: 0.0373, ]
2022-11-10 13:51:42,657 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0253, Acc: 1.0000, NetFixLoss: 0.0461, ]
2022-11-10 13:51:43,185 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0259, Acc: 1.0000, NetFixLoss: 0.0555, ]
2022-11-10 13:51:43,687 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0294, Acc: 1.0000, NetFixLoss: 0.0655, ]
2022-11-10 13:51:44,225 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0262, Acc: 1.0000, NetFixLoss: 0.0760, ]
2022-11-10 13:51:44,804 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0259, Acc: 1.0000, NetFixLoss: 0.0870, ]
2022-11-10 13:51:45,355 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0224, Acc: 1.0000, NetFixLoss: 0.0984, ]
2022-11-10 13:51:45,944 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0240, Acc: 1.0000, NetFixLoss: 0.1102, ]
2022-11-10 13:51:46,034 INFO: fine-tune procedure is finished!
2022-11-10 13:52:44,361 INFO: [Test_acc of task 5 on test 1: 0.49318][acc of former classes: 0.68617][acc of former samples in all classes: 0.67183]
[acc of novel samples in all classes: 0.06440]
2022-11-10 13:52:44,417 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:52:44,423 WARNING: Current net - loaded net:
2022-11-10 13:52:44,423 WARNING: Loaded net - current net:
2022-11-10 13:52:44,423 WARNING:   func.fc.bias
2022-11-10 13:52:44,423 WARNING:   func.fc.weight
2022-11-10 13:52:44,460 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_5.pth.
2022-11-10 13:52:44,502 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:52:44,530 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:52:44,531 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:52:44,531 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:52:44,531 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:52:44,532 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:52:44,533 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:52:44,533 INFO: Model [FSLLModel] is created.
2022-11-10 13:52:44,540 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:44,546 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:44,551 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:44,556 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:44,562 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:52:44,567 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 13:52:45,012 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0757, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:52:45,650 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0732, Acc: 1.0000, NetFixLoss: 0.0019, ]
2022-11-10 13:52:46,195 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0734, Acc: 1.0000, NetFixLoss: 0.0049, ]
2022-11-10 13:52:46,857 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0771, Acc: 1.0000, NetFixLoss: 0.0091, ]
2022-11-10 13:52:47,552 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0755, Acc: 1.0000, NetFixLoss: 0.0143, ]
2022-11-10 13:52:48,204 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0727, Acc: 1.0000, NetFixLoss: 0.0205, ]
2022-11-10 13:52:48,824 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0701, Acc: 1.0000, NetFixLoss: 0.0274, ]
2022-11-10 13:52:49,423 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0739, Acc: 1.0000, NetFixLoss: 0.0351, ]
2022-11-10 13:52:49,968 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0712, Acc: 1.0000, NetFixLoss: 0.0434, ]
2022-11-10 13:52:50,576 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0755, Acc: 1.0000, NetFixLoss: 0.0523, ]
2022-11-10 13:52:51,128 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0745, Acc: 1.0000, NetFixLoss: 0.0618, ]
2022-11-10 13:52:51,805 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0749, Acc: 1.0000, NetFixLoss: 0.0717, ]
2022-11-10 13:52:52,393 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0721, Acc: 1.0000, NetFixLoss: 0.0820, ]
2022-11-10 13:52:53,004 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0763, Acc: 1.0000, NetFixLoss: 0.0928, ]
2022-11-10 13:52:53,718 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0751, Acc: 1.0000, NetFixLoss: 0.1039, ]
2022-11-10 13:52:53,806 INFO: fine-tune procedure is finished!
2022-11-10 13:53:54,097 INFO: [Test_acc of task 6 on test 1: 0.47822][acc of former classes: 0.70183][acc of former samples in all classes: 0.68533]
[acc of novel samples in all classes: 0.06400]
2022-11-10 13:53:54,151 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:53:54,157 WARNING: Current net - loaded net:
2022-11-10 13:53:54,157 WARNING: Loaded net - current net:
2022-11-10 13:53:54,157 WARNING:   func.fc.bias
2022-11-10 13:53:54,157 WARNING:   func.fc.weight
2022-11-10 13:53:54,194 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_6.pth.
2022-11-10 13:53:54,220 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:53:54,253 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:53:54,253 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:53:54,253 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:53:54,253 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:53:54,253 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:53:54,254 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:53:54,254 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:53:54,254 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:53:54,254 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:53:54,254 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:53:54,254 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:53:54,254 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:53:54,254 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:53:54,255 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:53:54,256 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:53:54,256 INFO: Model [FSLLModel] is created.
2022-11-10 13:53:54,262 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:54,268 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:54,273 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:54,279 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:54,286 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:54,294 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:53:54,301 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 13:53:54,830 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1225, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:53:55,780 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1275, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 13:53:56,377 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1281, Acc: 1.0000, NetFixLoss: 0.0048, ]
2022-11-10 13:53:57,058 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1248, Acc: 1.0000, NetFixLoss: 0.0089, ]
2022-11-10 13:53:57,715 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1289, Acc: 1.0000, NetFixLoss: 0.0141, ]
2022-11-10 13:53:58,281 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1258, Acc: 1.0000, NetFixLoss: 0.0200, ]
2022-11-10 13:53:58,931 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1262, Acc: 1.0000, NetFixLoss: 0.0266, ]
2022-11-10 13:53:59,477 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1280, Acc: 1.0000, NetFixLoss: 0.0340, ]
2022-11-10 13:54:00,046 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1326, Acc: 1.0000, NetFixLoss: 0.0420, ]
2022-11-10 13:54:00,581 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1236, Acc: 1.0000, NetFixLoss: 0.0506, ]
2022-11-10 13:54:01,075 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1243, Acc: 1.0000, NetFixLoss: 0.0597, ]
2022-11-10 13:54:01,691 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1222, Acc: 1.0000, NetFixLoss: 0.0693, ]
2022-11-10 13:54:02,229 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1277, Acc: 1.0000, NetFixLoss: 0.0793, ]
2022-11-10 13:54:02,776 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1260, Acc: 1.0000, NetFixLoss: 0.0898, ]
2022-11-10 13:54:03,455 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1203, Acc: 1.0000, NetFixLoss: 0.1005, ]
2022-11-10 13:54:03,551 INFO: fine-tune procedure is finished!
2022-11-10 13:55:08,168 INFO: [Test_acc of task 7 on test 1: 0.45684][acc of former classes: 0.70383][acc of former samples in all classes: 0.68783]
[acc of novel samples in all classes: 0.06086]
2022-11-10 13:55:08,221 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:55:08,227 WARNING: Current net - loaded net:
2022-11-10 13:55:08,227 WARNING: Loaded net - current net:
2022-11-10 13:55:08,227 WARNING:   func.fc.bias
2022-11-10 13:55:08,227 WARNING:   func.fc.weight
2022-11-10 13:55:08,255 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_7.pth.
2022-11-10 13:55:08,297 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:55:08,325 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:55:08,325 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:55:08,325 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:55:08,326 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:55:08,327 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:55:08,328 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:55:08,328 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:55:08,328 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:55:08,328 INFO: Model [FSLLModel] is created.
2022-11-10 13:55:08,335 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:55:08,341 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:55:08,346 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:55:08,351 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:55:08,356 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:55:08,361 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:55:08,367 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:55:08,373 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 13:55:08,831 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1708, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:55:09,421 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1644, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 13:55:10,036 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1651, Acc: 1.0000, NetFixLoss: 0.0047, ]
2022-11-10 13:55:10,752 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1680, Acc: 1.0000, NetFixLoss: 0.0087, ]
2022-11-10 13:55:11,399 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1709, Acc: 1.0000, NetFixLoss: 0.0136, ]
2022-11-10 13:55:12,039 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1681, Acc: 1.0000, NetFixLoss: 0.0195, ]
2022-11-10 13:55:12,727 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1689, Acc: 1.0000, NetFixLoss: 0.0261, ]
2022-11-10 13:55:13,489 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1628, Acc: 1.0000, NetFixLoss: 0.0336, ]
2022-11-10 13:55:14,293 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1650, Acc: 1.0000, NetFixLoss: 0.0416, ]
2022-11-10 13:55:14,937 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1690, Acc: 1.0000, NetFixLoss: 0.0502, ]
2022-11-10 13:55:15,583 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1714, Acc: 1.0000, NetFixLoss: 0.0593, ]
2022-11-10 13:55:16,273 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1656, Acc: 1.0000, NetFixLoss: 0.0689, ]
2022-11-10 13:55:17,151 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1703, Acc: 1.0000, NetFixLoss: 0.0788, ]
2022-11-10 13:55:17,919 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1681, Acc: 1.0000, NetFixLoss: 0.0892, ]
2022-11-10 13:55:18,603 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1724, Acc: 1.0000, NetFixLoss: 0.0999, ]
2022-11-10 13:55:18,725 INFO: fine-tune procedure is finished!
2022-11-10 13:56:25,604 INFO: [Test_acc of task 8 on test 1: 0.43520][acc of former classes: 0.70750][acc of former samples in all classes: 0.68600]
[acc of novel samples in all classes: 0.05900]
2022-11-10 13:56:25,658 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:56:25,663 WARNING: Current net - loaded net:
2022-11-10 13:56:25,663 WARNING: Loaded net - current net:
2022-11-10 13:56:25,664 WARNING:   func.fc.bias
2022-11-10 13:56:25,664 WARNING:   func.fc.weight
2022-11-10 13:56:25,702 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth.
2022-11-10 13:56:25,724 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:56:25,736 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:56:25,737 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:56:25,737 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:56:25,737 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:56:25,738 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:56:25,739 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:56:25,739 INFO: Model [FSLLModel] is created.
2022-11-10 13:56:25,746 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 13:56:26,170 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.7853, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:56:26,867 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.7875, Acc: 1.0000, NetFixLoss: 0.0035, ]
2022-11-10 13:56:27,437 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.7807, Acc: 1.0000, NetFixLoss: 0.0096, ]
2022-11-10 13:56:28,011 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.7801, Acc: 1.0000, NetFixLoss: 0.0174, ]
2022-11-10 13:56:28,532 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.7878, Acc: 1.0000, NetFixLoss: 0.0265, ]
2022-11-10 13:56:29,229 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.7879, Acc: 1.0000, NetFixLoss: 0.0373, ]
2022-11-10 13:56:29,833 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.7831, Acc: 1.0000, NetFixLoss: 0.0493, ]
2022-11-10 13:56:30,467 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.7826, Acc: 1.0000, NetFixLoss: 0.0627, ]
2022-11-10 13:56:31,045 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.7943, Acc: 1.0000, NetFixLoss: 0.0774, ]
2022-11-10 13:56:31,588 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.7951, Acc: 1.0000, NetFixLoss: 0.0931, ]
2022-11-10 13:56:32,154 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.7918, Acc: 1.0000, NetFixLoss: 0.1095, ]
2022-11-10 13:56:32,733 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.7872, Acc: 1.0000, NetFixLoss: 0.1271, ]
2022-11-10 13:56:33,391 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.7848, Acc: 1.0000, NetFixLoss: 0.1453, ]
2022-11-10 13:56:33,947 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.7793, Acc: 1.0000, NetFixLoss: 0.1641, ]
2022-11-10 13:56:34,560 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.7906, Acc: 1.0000, NetFixLoss: 0.1833, ]
2022-11-10 13:56:34,677 INFO: fine-tune procedure is finished!
2022-11-10 13:57:24,239 INFO: [Test_acc of task 1 on test 2: 0.61169][acc of former classes: 0.65733][acc of former samples in all classes: 0.65400]
[acc of novel samples in all classes: 0.10400]
2022-11-10 13:57:24,280 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:57:24,286 WARNING: Current net - loaded net:
2022-11-10 13:57:24,286 WARNING: Loaded net - current net:
2022-11-10 13:57:24,286 WARNING:   func.fc.bias
2022-11-10 13:57:24,286 WARNING:   func.fc.weight
2022-11-10 13:57:24,318 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_1.pth.
2022-11-10 13:57:24,356 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:57:24,385 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:57:24,385 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:57:24,386 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:57:24,387 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:57:24,388 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:57:24,388 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:57:24,388 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:57:24,388 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:57:24,388 INFO: Model [FSLLModel] is created.
2022-11-10 13:57:24,395 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:57:24,405 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 13:57:24,899 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8613, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:57:25,573 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.8491, Acc: 1.0000, NetFixLoss: 0.0028, ]
2022-11-10 13:57:26,283 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8590, Acc: 1.0000, NetFixLoss: 0.0072, ]
2022-11-10 13:57:26,960 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8598, Acc: 1.0000, NetFixLoss: 0.0131, ]
2022-11-10 13:57:27,635 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.8519, Acc: 1.0000, NetFixLoss: 0.0204, ]
2022-11-10 13:57:28,250 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.8525, Acc: 1.0000, NetFixLoss: 0.0289, ]
2022-11-10 13:57:28,785 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8550, Acc: 1.0000, NetFixLoss: 0.0386, ]
2022-11-10 13:57:29,477 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.8564, Acc: 1.0000, NetFixLoss: 0.0491, ]
2022-11-10 13:57:30,008 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.8556, Acc: 1.0000, NetFixLoss: 0.0604, ]
2022-11-10 13:57:30,609 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.8596, Acc: 1.0000, NetFixLoss: 0.0724, ]
2022-11-10 13:57:31,167 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8605, Acc: 1.0000, NetFixLoss: 0.0853, ]
2022-11-10 13:57:31,830 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.8544, Acc: 1.0000, NetFixLoss: 0.0989, ]
2022-11-10 13:57:32,439 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.8587, Acc: 1.0000, NetFixLoss: 0.1131, ]
2022-11-10 13:57:33,073 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8570, Acc: 1.0000, NetFixLoss: 0.1279, ]
2022-11-10 13:57:33,681 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.8541, Acc: 1.0000, NetFixLoss: 0.1432, ]
2022-11-10 13:57:33,803 INFO: fine-tune procedure is finished!
2022-11-10 13:58:25,534 INFO: [Test_acc of task 2 on test 2: 0.57386][acc of former classes: 0.66150][acc of former samples in all classes: 0.65433]
[acc of novel samples in all classes: 0.09100]
2022-11-10 13:58:25,590 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:58:25,597 WARNING: Current net - loaded net:
2022-11-10 13:58:25,597 WARNING: Loaded net - current net:
2022-11-10 13:58:25,597 WARNING:   func.fc.bias
2022-11-10 13:58:25,597 WARNING:   func.fc.weight
2022-11-10 13:58:25,632 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_2.pth.
2022-11-10 13:58:25,674 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:58:25,702 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:58:25,702 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:58:25,702 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:58:25,702 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:58:25,702 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:58:25,702 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:58:25,702 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:58:25,703 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:58:25,704 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:58:25,705 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:58:25,705 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:58:25,705 INFO: Model [FSLLModel] is created.
2022-11-10 13:58:25,712 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:58:25,718 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:58:25,724 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 13:58:26,206 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9082, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:58:26,845 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9239, Acc: 1.0000, NetFixLoss: 0.0024, ]
2022-11-10 13:58:27,538 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9210, Acc: 1.0000, NetFixLoss: 0.0060, ]
2022-11-10 13:58:28,288 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9231, Acc: 1.0000, NetFixLoss: 0.0110, ]
2022-11-10 13:58:28,878 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9169, Acc: 1.0000, NetFixLoss: 0.0174, ]
2022-11-10 13:58:29,644 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9162, Acc: 1.0000, NetFixLoss: 0.0248, ]
2022-11-10 13:58:30,380 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9151, Acc: 1.0000, NetFixLoss: 0.0333, ]
2022-11-10 13:58:31,023 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9180, Acc: 1.0000, NetFixLoss: 0.0428, ]
2022-11-10 13:58:31,706 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9216, Acc: 1.0000, NetFixLoss: 0.0529, ]
2022-11-10 13:58:32,319 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9175, Acc: 1.0000, NetFixLoss: 0.0637, ]
2022-11-10 13:58:32,912 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9138, Acc: 1.0000, NetFixLoss: 0.0751, ]
2022-11-10 13:58:33,562 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9156, Acc: 1.0000, NetFixLoss: 0.0871, ]
2022-11-10 13:58:34,222 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9174, Acc: 1.0000, NetFixLoss: 0.0996, ]
2022-11-10 13:58:34,894 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9221, Acc: 1.0000, NetFixLoss: 0.1126, ]
2022-11-10 13:58:35,528 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9219, Acc: 1.0000, NetFixLoss: 0.1261, ]
2022-11-10 13:58:35,703 INFO: fine-tune procedure is finished!
2022-11-10 13:59:29,865 INFO: [Test_acc of task 3 on test 2: 0.53107][acc of former classes: 0.65200][acc of former samples in all classes: 0.64067]
[acc of novel samples in all classes: 0.09267]
2022-11-10 13:59:29,922 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 13:59:29,927 WARNING: Current net - loaded net:
2022-11-10 13:59:29,927 WARNING: Loaded net - current net:
2022-11-10 13:59:29,927 WARNING:   func.fc.bias
2022-11-10 13:59:29,927 WARNING:   func.fc.weight
2022-11-10 13:59:29,953 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_3.pth.
2022-11-10 13:59:29,996 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 13:59:30,023 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 13:59:30,024 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 13:59:30,024 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 13:59:30,024 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 13:59:30,025 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 13:59:30,026 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 13:59:30,026 INFO: Model [FSLLModel] is created.
2022-11-10 13:59:30,033 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:59:30,038 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:59:30,043 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 13:59:30,049 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 13:59:30,600 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9810, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 13:59:31,378 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9818, Acc: 1.0000, NetFixLoss: 0.0021, ]
2022-11-10 13:59:32,032 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9850, Acc: 1.0000, NetFixLoss: 0.0053, ]
2022-11-10 13:59:32,678 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9846, Acc: 1.0000, NetFixLoss: 0.0098, ]
2022-11-10 13:59:33,375 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9799, Acc: 1.0000, NetFixLoss: 0.0154, ]
2022-11-10 13:59:34,204 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9860, Acc: 1.0000, NetFixLoss: 0.0219, ]
2022-11-10 13:59:34,844 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9793, Acc: 1.0000, NetFixLoss: 0.0292, ]
2022-11-10 13:59:35,534 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9900, Acc: 1.0000, NetFixLoss: 0.0373, ]
2022-11-10 13:59:36,180 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9852, Acc: 1.0000, NetFixLoss: 0.0462, ]
2022-11-10 13:59:36,921 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9789, Acc: 1.0000, NetFixLoss: 0.0558, ]
2022-11-10 13:59:37,509 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9823, Acc: 1.0000, NetFixLoss: 0.0659, ]
2022-11-10 13:59:38,177 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9908, Acc: 1.0000, NetFixLoss: 0.0766, ]
2022-11-10 13:59:38,763 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9819, Acc: 1.0000, NetFixLoss: 0.0877, ]
2022-11-10 13:59:39,473 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9795, Acc: 1.0000, NetFixLoss: 0.0992, ]
2022-11-10 13:59:40,169 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9850, Acc: 1.0000, NetFixLoss: 0.1112, ]
2022-11-10 13:59:40,283 INFO: fine-tune procedure is finished!
2022-11-10 14:00:39,029 INFO: [Test_acc of task 4 on test 2: 0.51150][acc of former classes: 0.66150][acc of former samples in all classes: 0.64917]
[acc of novel samples in all classes: 0.09850]
2022-11-10 14:00:39,075 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:00:39,081 WARNING: Current net - loaded net:
2022-11-10 14:00:39,081 WARNING: Loaded net - current net:
2022-11-10 14:00:39,081 WARNING:   func.fc.bias
2022-11-10 14:00:39,081 WARNING:   func.fc.weight
2022-11-10 14:00:39,109 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_4.pth.
2022-11-10 14:00:39,142 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:00:39,168 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:00:39,168 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:00:39,168 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:00:39,168 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:00:39,168 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:00:39,168 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:00:39,168 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:00:39,168 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:00:39,169 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:00:39,170 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:00:39,170 INFO: Model [FSLLModel] is created.
2022-11-10 14:00:39,176 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:39,181 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:39,187 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:39,192 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:00:39,197 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 14:00:39,701 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0307, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:00:40,414 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0292, Acc: 1.0000, NetFixLoss: 0.0021, ]
2022-11-10 14:00:41,141 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0328, Acc: 1.0000, NetFixLoss: 0.0052, ]
2022-11-10 14:00:41,789 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0276, Acc: 1.0000, NetFixLoss: 0.0095, ]
2022-11-10 14:00:42,397 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0319, Acc: 1.0000, NetFixLoss: 0.0149, ]
2022-11-10 14:00:43,120 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0282, Acc: 1.0000, NetFixLoss: 0.0213, ]
2022-11-10 14:00:43,841 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0278, Acc: 1.0000, NetFixLoss: 0.0284, ]
2022-11-10 14:00:44,557 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0318, Acc: 1.0000, NetFixLoss: 0.0363, ]
2022-11-10 14:00:45,146 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0333, Acc: 1.0000, NetFixLoss: 0.0448, ]
2022-11-10 14:00:45,724 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0267, Acc: 1.0000, NetFixLoss: 0.0540, ]
2022-11-10 14:00:46,374 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0282, Acc: 1.0000, NetFixLoss: 0.0637, ]
2022-11-10 14:00:47,047 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0329, Acc: 1.0000, NetFixLoss: 0.0740, ]
2022-11-10 14:00:47,698 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0245, Acc: 1.0000, NetFixLoss: 0.0848, ]
2022-11-10 14:00:48,419 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0244, Acc: 1.0000, NetFixLoss: 0.0959, ]
2022-11-10 14:00:49,019 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0269, Acc: 1.0000, NetFixLoss: 0.1074, ]
2022-11-10 14:00:49,145 INFO: fine-tune procedure is finished!
2022-11-10 14:01:48,383 INFO: [Test_acc of task 5 on test 2: 0.49753][acc of former classes: 0.67967][acc of former samples in all classes: 0.66317]
[acc of novel samples in all classes: 0.10000]
2022-11-10 14:01:48,440 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:01:48,446 WARNING: Current net - loaded net:
2022-11-10 14:01:48,446 WARNING: Loaded net - current net:
2022-11-10 14:01:48,446 WARNING:   func.fc.bias
2022-11-10 14:01:48,446 WARNING:   func.fc.weight
2022-11-10 14:01:48,483 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_5.pth.
2022-11-10 14:01:48,526 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:01:48,554 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:01:48,555 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:01:48,555 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:01:48,555 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:01:48,556 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:01:48,557 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:01:48,557 INFO: Model [FSLLModel] is created.
2022-11-10 14:01:48,564 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:48,579 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:48,638 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:48,643 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:48,649 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:01:48,654 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 14:01:49,111 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0687, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:01:49,807 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0628, Acc: 1.0000, NetFixLoss: 0.0019, ]
2022-11-10 14:01:50,535 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0752, Acc: 1.0000, NetFixLoss: 0.0050, ]
2022-11-10 14:01:51,099 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0759, Acc: 1.0000, NetFixLoss: 0.0093, ]
2022-11-10 14:01:51,784 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0757, Acc: 1.0000, NetFixLoss: 0.0146, ]
2022-11-10 14:01:52,439 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0698, Acc: 1.0000, NetFixLoss: 0.0208, ]
2022-11-10 14:01:53,150 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0731, Acc: 1.0000, NetFixLoss: 0.0277, ]
2022-11-10 14:01:53,822 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0710, Acc: 1.0000, NetFixLoss: 0.0354, ]
2022-11-10 14:01:54,436 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0692, Acc: 1.0000, NetFixLoss: 0.0438, ]
2022-11-10 14:01:55,112 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0687, Acc: 1.0000, NetFixLoss: 0.0527, ]
2022-11-10 14:01:55,842 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0702, Acc: 1.0000, NetFixLoss: 0.0621, ]
2022-11-10 14:01:56,501 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0712, Acc: 1.0000, NetFixLoss: 0.0720, ]
2022-11-10 14:01:57,158 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0786, Acc: 1.0000, NetFixLoss: 0.0823, ]
2022-11-10 14:01:57,866 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0695, Acc: 1.0000, NetFixLoss: 0.0929, ]
2022-11-10 14:01:58,509 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0751, Acc: 1.0000, NetFixLoss: 0.1039, ]
2022-11-10 14:01:58,620 INFO: fine-tune procedure is finished!
2022-11-10 14:03:00,664 INFO: [Test_acc of task 6 on test 2: 0.48944][acc of former classes: 0.70033][acc of former samples in all classes: 0.68333]
[acc of novel samples in all classes: 0.10167]
2022-11-10 14:03:00,722 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:03:00,728 WARNING: Current net - loaded net:
2022-11-10 14:03:00,729 WARNING: Loaded net - current net:
2022-11-10 14:03:00,729 WARNING:   func.fc.bias
2022-11-10 14:03:00,729 WARNING:   func.fc.weight
2022-11-10 14:03:00,766 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_6.pth.
2022-11-10 14:03:00,809 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:03:00,838 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:03:00,838 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:03:00,838 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:03:00,838 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:03:00,839 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:03:00,840 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:03:00,841 INFO: Model [FSLLModel] is created.
2022-11-10 14:03:00,847 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:03:00,854 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:03:00,860 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:03:00,866 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:03:00,874 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:03:00,880 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:03:00,886 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 14:03:01,463 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1271, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:03:02,238 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1189, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 14:03:02,855 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1293, Acc: 1.0000, NetFixLoss: 0.0048, ]
2022-11-10 14:03:03,602 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1274, Acc: 1.0000, NetFixLoss: 0.0089, ]
2022-11-10 14:03:04,282 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1246, Acc: 1.0000, NetFixLoss: 0.0140, ]
2022-11-10 14:03:04,937 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1263, Acc: 1.0000, NetFixLoss: 0.0200, ]
2022-11-10 14:03:05,800 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1245, Acc: 1.0000, NetFixLoss: 0.0268, ]
2022-11-10 14:03:06,422 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1268, Acc: 1.0000, NetFixLoss: 0.0344, ]
2022-11-10 14:03:07,143 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1263, Acc: 1.0000, NetFixLoss: 0.0426, ]
2022-11-10 14:03:07,782 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1255, Acc: 1.0000, NetFixLoss: 0.0515, ]
2022-11-10 14:03:08,457 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1206, Acc: 1.0000, NetFixLoss: 0.0608, ]
2022-11-10 14:03:09,200 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1264, Acc: 1.0000, NetFixLoss: 0.0705, ]
2022-11-10 14:03:09,928 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1278, Acc: 1.0000, NetFixLoss: 0.0806, ]
2022-11-10 14:03:10,656 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1243, Acc: 1.0000, NetFixLoss: 0.0912, ]
2022-11-10 14:03:11,357 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1293, Acc: 1.0000, NetFixLoss: 0.1020, ]
2022-11-10 14:03:11,466 INFO: fine-tune procedure is finished!
2022-11-10 14:04:18,336 INFO: [Test_acc of task 7 on test 2: 0.46937][acc of former classes: 0.70100][acc of former samples in all classes: 0.68067]
[acc of novel samples in all classes: 0.10714]
2022-11-10 14:04:18,390 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:04:18,395 WARNING: Current net - loaded net:
2022-11-10 14:04:18,395 WARNING: Loaded net - current net:
2022-11-10 14:04:18,395 WARNING:   func.fc.bias
2022-11-10 14:04:18,395 WARNING:   func.fc.weight
2022-11-10 14:04:18,433 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_7.pth.
2022-11-10 14:04:18,475 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:04:18,503 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:04:18,503 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:04:18,503 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:04:18,503 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:04:18,503 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:04:18,503 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:04:18,503 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:04:18,504 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:04:18,504 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:04:18,504 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:04:18,504 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:04:18,504 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:04:18,504 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:04:18,505 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:04:18,506 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:04:18,506 INFO: Model [FSLLModel] is created.
2022-11-10 14:04:18,512 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:18,517 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:18,522 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:18,528 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:18,534 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:18,540 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:18,546 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:04:18,552 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 14:04:19,073 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1687, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:04:19,868 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1728, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 14:04:20,593 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1769, Acc: 1.0000, NetFixLoss: 0.0047, ]
2022-11-10 14:04:21,312 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1729, Acc: 1.0000, NetFixLoss: 0.0086, ]
2022-11-10 14:04:21,958 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1692, Acc: 1.0000, NetFixLoss: 0.0136, ]
2022-11-10 14:04:22,570 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1747, Acc: 1.0000, NetFixLoss: 0.0195, ]
2022-11-10 14:04:23,295 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1721, Acc: 1.0000, NetFixLoss: 0.0262, ]
2022-11-10 14:04:24,085 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1707, Acc: 1.0000, NetFixLoss: 0.0337, ]
2022-11-10 14:04:24,719 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1697, Acc: 1.0000, NetFixLoss: 0.0417, ]
2022-11-10 14:04:25,457 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1721, Acc: 1.0000, NetFixLoss: 0.0503, ]
2022-11-10 14:04:26,116 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1708, Acc: 1.0000, NetFixLoss: 0.0594, ]
2022-11-10 14:04:26,885 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1684, Acc: 1.0000, NetFixLoss: 0.0689, ]
2022-11-10 14:04:27,516 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1684, Acc: 1.0000, NetFixLoss: 0.0788, ]
2022-11-10 14:04:29,308 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1700, Acc: 1.0000, NetFixLoss: 0.0891, ]
2022-11-10 14:04:29,991 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1710, Acc: 1.0000, NetFixLoss: 0.0998, ]
2022-11-10 14:04:30,103 INFO: fine-tune procedure is finished!
2022-11-10 14:05:37,606 INFO: [Test_acc of task 8 on test 2: 0.44690][acc of former classes: 0.70333][acc of former samples in all classes: 0.67833]
[acc of novel samples in all classes: 0.09975]
2022-11-10 14:05:37,661 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:05:37,667 WARNING: Current net - loaded net:
2022-11-10 14:05:37,667 WARNING: Loaded net - current net:
2022-11-10 14:05:37,667 WARNING:   func.fc.bias
2022-11-10 14:05:37,667 WARNING:   func.fc.weight
2022-11-10 14:05:37,705 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth.
2022-11-10 14:05:37,748 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:05:37,776 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:05:37,776 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:05:37,776 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:05:37,776 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:05:37,776 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:05:37,776 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:05:37,777 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:05:37,777 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:05:37,777 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:05:37,777 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:05:37,777 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:05:37,777 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:05:37,777 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:05:37,778 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:05:37,779 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:05:37,779 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:05:37,779 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:05:37,779 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:05:37,779 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:05:37,779 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:05:37,779 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:05:37,779 INFO: Model [FSLLModel] is created.
2022-11-10 14:05:37,785 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 14:05:38,230 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.7678, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:05:38,793 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.7651, Acc: 1.0000, NetFixLoss: 0.0027, ]
2022-11-10 14:05:39,443 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.7729, Acc: 1.0000, NetFixLoss: 0.0069, ]
2022-11-10 14:05:40,067 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.7646, Acc: 1.0000, NetFixLoss: 0.0127, ]
2022-11-10 14:05:40,762 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.7601, Acc: 1.0000, NetFixLoss: 0.0198, ]
2022-11-10 14:05:41,353 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.7634, Acc: 1.0000, NetFixLoss: 0.0279, ]
2022-11-10 14:05:42,030 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.7615, Acc: 1.0000, NetFixLoss: 0.0371, ]
2022-11-10 14:05:42,685 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.7685, Acc: 1.0000, NetFixLoss: 0.0472, ]
2022-11-10 14:05:43,348 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.7616, Acc: 1.0000, NetFixLoss: 0.0585, ]
2022-11-10 14:05:43,981 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.7612, Acc: 1.0000, NetFixLoss: 0.0704, ]
2022-11-10 14:05:44,673 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.7711, Acc: 1.0000, NetFixLoss: 0.0832, ]
2022-11-10 14:05:45,271 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.7641, Acc: 1.0000, NetFixLoss: 0.0967, ]
2022-11-10 14:05:45,986 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.7655, Acc: 1.0000, NetFixLoss: 0.1108, ]
2022-11-10 14:05:46,596 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.7675, Acc: 1.0000, NetFixLoss: 0.1255, ]
2022-11-10 14:05:47,333 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.7609, Acc: 1.0000, NetFixLoss: 0.1407, ]
2022-11-10 14:05:47,461 INFO: fine-tune procedure is finished!
2022-11-10 14:06:36,503 INFO: [Test_acc of task 1 on test 3: 0.59831][acc of former classes: 0.64083][acc of former samples in all classes: 0.63933]
[acc of novel samples in all classes: 0.10600]
2022-11-10 14:06:36,559 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:06:36,566 WARNING: Current net - loaded net:
2022-11-10 14:06:36,566 WARNING: Loaded net - current net:
2022-11-10 14:06:36,566 WARNING:   func.fc.bias
2022-11-10 14:06:36,566 WARNING:   func.fc.weight
2022-11-10 14:06:36,603 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_1.pth.
2022-11-10 14:06:36,646 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:06:36,674 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:06:36,674 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:06:36,674 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:06:36,675 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:06:36,676 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:06:36,677 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:06:36,677 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:06:36,677 INFO: Model [FSLLModel] is created.
2022-11-10 14:06:36,684 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:06:36,690 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 14:06:37,294 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8318, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:06:37,986 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.8395, Acc: 1.0000, NetFixLoss: 0.0025, ]
2022-11-10 14:06:38,662 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8350, Acc: 1.0000, NetFixLoss: 0.0064, ]
2022-11-10 14:06:39,415 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8358, Acc: 1.0000, NetFixLoss: 0.0119, ]
2022-11-10 14:06:40,096 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.8381, Acc: 1.0000, NetFixLoss: 0.0188, ]
2022-11-10 14:06:40,729 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.8358, Acc: 1.0000, NetFixLoss: 0.0271, ]
2022-11-10 14:06:41,492 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8384, Acc: 1.0000, NetFixLoss: 0.0367, ]
2022-11-10 14:06:42,127 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.8342, Acc: 1.0000, NetFixLoss: 0.0473, ]
2022-11-10 14:06:42,770 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.8374, Acc: 1.0000, NetFixLoss: 0.0587, ]
2022-11-10 14:06:43,457 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.8343, Acc: 1.0000, NetFixLoss: 0.0709, ]
2022-11-10 14:06:44,091 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8371, Acc: 1.0000, NetFixLoss: 0.0838, ]
2022-11-10 14:06:44,614 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.8351, Acc: 1.0000, NetFixLoss: 0.0973, ]
2022-11-10 14:06:45,140 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.8426, Acc: 1.0000, NetFixLoss: 0.1112, ]
2022-11-10 14:06:45,734 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8341, Acc: 1.0000, NetFixLoss: 0.1256, ]
2022-11-10 14:06:46,265 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.8347, Acc: 1.0000, NetFixLoss: 0.1404, ]
2022-11-10 14:06:46,350 INFO: fine-tune procedure is finished!
2022-11-10 14:07:39,346 INFO: [Test_acc of task 2 on test 3: 0.56229][acc of former classes: 0.64950][acc of former samples in all classes: 0.64367]
[acc of novel samples in all classes: 0.07400]
2022-11-10 14:07:39,388 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:07:39,395 WARNING: Current net - loaded net:
2022-11-10 14:07:39,395 WARNING: Loaded net - current net:
2022-11-10 14:07:39,395 WARNING:   func.fc.bias
2022-11-10 14:07:39,395 WARNING:   func.fc.weight
2022-11-10 14:07:39,423 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_2.pth.
2022-11-10 14:07:39,457 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:07:39,486 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:07:39,486 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:07:39,486 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:07:39,486 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:07:39,486 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:07:39,486 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:07:39,486 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:07:39,486 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:07:39,486 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:07:39,487 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:07:39,488 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:07:39,489 INFO: Model [FSLLModel] is created.
2022-11-10 14:07:39,495 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:07:39,501 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:07:39,507 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 14:07:40,062 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8952, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:07:40,777 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.8981, Acc: 1.0000, NetFixLoss: 0.0022, ]
2022-11-10 14:07:41,564 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9012, Acc: 1.0000, NetFixLoss: 0.0058, ]
2022-11-10 14:07:42,165 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8987, Acc: 1.0000, NetFixLoss: 0.0108, ]
2022-11-10 14:07:42,796 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.8950, Acc: 1.0000, NetFixLoss: 0.0172, ]
2022-11-10 14:07:43,470 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.8879, Acc: 1.0000, NetFixLoss: 0.0248, ]
2022-11-10 14:07:44,202 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8933, Acc: 1.0000, NetFixLoss: 0.0332, ]
2022-11-10 14:07:44,877 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.8994, Acc: 1.0000, NetFixLoss: 0.0425, ]
2022-11-10 14:07:45,628 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.8960, Acc: 1.0000, NetFixLoss: 0.0525, ]
2022-11-10 14:07:46,304 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.8942, Acc: 1.0000, NetFixLoss: 0.0633, ]
2022-11-10 14:07:46,916 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8921, Acc: 1.0000, NetFixLoss: 0.0748, ]
2022-11-10 14:07:47,534 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.8899, Acc: 1.0000, NetFixLoss: 0.0869, ]
2022-11-10 14:07:48,288 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9026, Acc: 1.0000, NetFixLoss: 0.0994, ]
2022-11-10 14:07:48,925 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8957, Acc: 1.0000, NetFixLoss: 0.1125, ]
2022-11-10 14:07:49,710 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.8906, Acc: 1.0000, NetFixLoss: 0.1261, ]
2022-11-10 14:07:49,825 INFO: fine-tune procedure is finished!
2022-11-10 14:08:44,265 INFO: [Test_acc of task 3 on test 3: 0.53147][acc of former classes: 0.65700][acc of former samples in all classes: 0.64583]
[acc of novel samples in all classes: 0.07400]
2022-11-10 14:08:44,319 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:08:44,325 WARNING: Current net - loaded net:
2022-11-10 14:08:44,325 WARNING: Loaded net - current net:
2022-11-10 14:08:44,325 WARNING:   func.fc.bias
2022-11-10 14:08:44,325 WARNING:   func.fc.weight
2022-11-10 14:08:44,363 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_3.pth.
2022-11-10 14:08:44,384 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:08:44,413 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:08:44,413 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:08:44,413 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:08:44,414 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:08:44,414 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:08:44,414 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:08:44,415 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:08:44,416 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:08:44,416 INFO: Model [FSLLModel] is created.
2022-11-10 14:08:44,423 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:44,429 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:44,435 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:08:44,441 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 14:08:44,943 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9541, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:08:45,729 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9618, Acc: 1.0000, NetFixLoss: 0.0022, ]
2022-11-10 14:08:46,357 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9630, Acc: 1.0000, NetFixLoss: 0.0058, ]
2022-11-10 14:08:47,083 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9628, Acc: 1.0000, NetFixLoss: 0.0106, ]
2022-11-10 14:08:47,888 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9657, Acc: 1.0000, NetFixLoss: 0.0167, ]
2022-11-10 14:08:48,674 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9661, Acc: 1.0000, NetFixLoss: 0.0237, ]
2022-11-10 14:08:49,312 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9617, Acc: 1.0000, NetFixLoss: 0.0316, ]
2022-11-10 14:08:49,930 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9641, Acc: 1.0000, NetFixLoss: 0.0404, ]
2022-11-10 14:08:50,639 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9654, Acc: 1.0000, NetFixLoss: 0.0500, ]
2022-11-10 14:08:51,338 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9587, Acc: 1.0000, NetFixLoss: 0.0603, ]
2022-11-10 14:08:52,044 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9628, Acc: 1.0000, NetFixLoss: 0.0713, ]
2022-11-10 14:08:52,727 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9652, Acc: 1.0000, NetFixLoss: 0.0829, ]
2022-11-10 14:08:53,356 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9664, Acc: 1.0000, NetFixLoss: 0.0947, ]
2022-11-10 14:08:54,034 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9632, Acc: 1.0000, NetFixLoss: 0.1069, ]
2022-11-10 14:08:54,717 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9584, Acc: 1.0000, NetFixLoss: 0.1195, ]
2022-11-10 14:08:54,820 INFO: fine-tune procedure is finished!
2022-11-10 14:09:51,828 INFO: [Test_acc of task 4 on test 3: 0.50150][acc of former classes: 0.66017][acc of former samples in all classes: 0.64650]
[acc of novel samples in all classes: 0.06650]
2022-11-10 14:09:51,885 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:09:51,892 WARNING: Current net - loaded net:
2022-11-10 14:09:51,892 WARNING: Loaded net - current net:
2022-11-10 14:09:51,892 WARNING:   func.fc.bias
2022-11-10 14:09:51,892 WARNING:   func.fc.weight
2022-11-10 14:09:51,929 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_4.pth.
2022-11-10 14:09:51,974 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:09:52,002 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:09:52,002 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:09:52,002 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:09:52,003 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:09:52,004 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:09:52,005 INFO: Model [FSLLModel] is created.
2022-11-10 14:09:52,011 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:52,017 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:52,022 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:52,027 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:09:52,033 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 14:09:52,525 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0141, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:09:53,251 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0140, Acc: 1.0000, NetFixLoss: 0.0020, ]
2022-11-10 14:09:54,002 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0135, Acc: 1.0000, NetFixLoss: 0.0052, ]
2022-11-10 14:09:54,678 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0147, Acc: 1.0000, NetFixLoss: 0.0098, ]
2022-11-10 14:09:55,315 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0133, Acc: 1.0000, NetFixLoss: 0.0155, ]
2022-11-10 14:09:56,041 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0191, Acc: 1.0000, NetFixLoss: 0.0223, ]
2022-11-10 14:09:56,702 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0126, Acc: 1.0000, NetFixLoss: 0.0300, ]
2022-11-10 14:09:57,413 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0117, Acc: 1.0000, NetFixLoss: 0.0385, ]
2022-11-10 14:09:58,213 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0116, Acc: 1.0000, NetFixLoss: 0.0477, ]
2022-11-10 14:09:58,831 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0147, Acc: 1.0000, NetFixLoss: 0.0576, ]
2022-11-10 14:09:59,491 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0103, Acc: 1.0000, NetFixLoss: 0.0680, ]
2022-11-10 14:10:00,150 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0097, Acc: 1.0000, NetFixLoss: 0.0790, ]
2022-11-10 14:10:00,891 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0134, Acc: 1.0000, NetFixLoss: 0.0905, ]
2022-11-10 14:10:01,603 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0136, Acc: 1.0000, NetFixLoss: 0.1024, ]
2022-11-10 14:10:02,235 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0103, Acc: 1.0000, NetFixLoss: 0.1148, ]
2022-11-10 14:10:02,356 INFO: fine-tune procedure is finished!
2022-11-10 14:11:04,426 INFO: [Test_acc of task 5 on test 3: 0.48047][acc of former classes: 0.67183][acc of former samples in all classes: 0.65417]
[acc of novel samples in all classes: 0.06360]
2022-11-10 14:11:04,461 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:11:04,466 WARNING: Current net - loaded net:
2022-11-10 14:11:04,466 WARNING: Loaded net - current net:
2022-11-10 14:11:04,466 WARNING:   func.fc.bias
2022-11-10 14:11:04,466 WARNING:   func.fc.weight
2022-11-10 14:11:04,493 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_5.pth.
2022-11-10 14:11:04,524 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:11:04,550 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:11:04,551 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:11:04,551 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:11:04,552 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:11:04,553 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:11:04,553 INFO: Model [FSLLModel] is created.
2022-11-10 14:11:04,560 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:11:04,566 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:11:04,572 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:11:04,578 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:11:04,584 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:11:04,589 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 14:11:05,041 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0670, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:11:05,728 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0664, Acc: 1.0000, NetFixLoss: 0.0020, ]
2022-11-10 14:11:06,508 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0703, Acc: 1.0000, NetFixLoss: 0.0052, ]
2022-11-10 14:11:07,336 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0673, Acc: 1.0000, NetFixLoss: 0.0095, ]
2022-11-10 14:11:08,074 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0641, Acc: 1.0000, NetFixLoss: 0.0149, ]
2022-11-10 14:11:08,770 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0668, Acc: 1.0000, NetFixLoss: 0.0213, ]
2022-11-10 14:11:09,529 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0695, Acc: 1.0000, NetFixLoss: 0.0286, ]
2022-11-10 14:11:10,217 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0664, Acc: 1.0000, NetFixLoss: 0.0367, ]
2022-11-10 14:11:10,908 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0671, Acc: 1.0000, NetFixLoss: 0.0455, ]
2022-11-10 14:11:11,606 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0722, Acc: 1.0000, NetFixLoss: 0.0549, ]
2022-11-10 14:11:12,599 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0704, Acc: 1.0000, NetFixLoss: 0.0649, ]
2022-11-10 14:11:13,294 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0666, Acc: 1.0000, NetFixLoss: 0.0753, ]
2022-11-10 14:11:13,955 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0619, Acc: 1.0000, NetFixLoss: 0.0862, ]
2022-11-10 14:11:14,601 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0680, Acc: 1.0000, NetFixLoss: 0.0975, ]
2022-11-10 14:11:15,257 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0684, Acc: 1.0000, NetFixLoss: 0.1091, ]
2022-11-10 14:11:15,395 INFO: fine-tune procedure is finished!
2022-11-10 14:12:16,797 INFO: [Test_acc of task 6 on test 3: 0.46767][acc of former classes: 0.68583][acc of former samples in all classes: 0.66917]
[acc of novel samples in all classes: 0.06467]
2022-11-10 14:12:16,850 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:12:16,856 WARNING: Current net - loaded net:
2022-11-10 14:12:16,856 WARNING: Loaded net - current net:
2022-11-10 14:12:16,856 WARNING:   func.fc.bias
2022-11-10 14:12:16,856 WARNING:   func.fc.weight
2022-11-10 14:12:16,882 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_6.pth.
2022-11-10 14:12:16,924 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:12:16,953 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:12:16,953 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:12:16,954 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:12:16,955 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:12:16,956 INFO: Model [FSLLModel] is created.
2022-11-10 14:12:16,963 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:12:16,969 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:12:16,976 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:12:16,984 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:12:16,991 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:12:16,996 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:12:17,001 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 14:12:17,538 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1221, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:12:18,220 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1186, Acc: 1.0000, NetFixLoss: 0.0019, ]
2022-11-10 14:12:18,832 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1184, Acc: 1.0000, NetFixLoss: 0.0050, ]
2022-11-10 14:12:19,458 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1222, Acc: 1.0000, NetFixLoss: 0.0092, ]
2022-11-10 14:12:20,068 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1237, Acc: 1.0000, NetFixLoss: 0.0145, ]
2022-11-10 14:12:20,742 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1206, Acc: 1.0000, NetFixLoss: 0.0207, ]
2022-11-10 14:12:21,362 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1231, Acc: 1.0000, NetFixLoss: 0.0277, ]
2022-11-10 14:12:22,079 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1193, Acc: 1.0000, NetFixLoss: 0.0355, ]
2022-11-10 14:12:22,651 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1213, Acc: 1.0000, NetFixLoss: 0.0440, ]
2022-11-10 14:12:23,334 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1187, Acc: 1.0000, NetFixLoss: 0.0530, ]
2022-11-10 14:12:23,973 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1222, Acc: 1.0000, NetFixLoss: 0.0627, ]
2022-11-10 14:12:24,592 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1226, Acc: 1.0000, NetFixLoss: 0.0728, ]
2022-11-10 14:12:25,166 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1181, Acc: 1.0000, NetFixLoss: 0.0834, ]
2022-11-10 14:12:25,872 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1192, Acc: 1.0000, NetFixLoss: 0.0943, ]
2022-11-10 14:12:26,518 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1165, Acc: 1.0000, NetFixLoss: 0.1056, ]
2022-11-10 14:12:26,627 INFO: fine-tune procedure is finished!
2022-11-10 14:13:32,355 INFO: [Test_acc of task 7 on test 3: 0.45242][acc of former classes: 0.69317][acc of former samples in all classes: 0.67667]
[acc of novel samples in all classes: 0.06800]
2022-11-10 14:13:32,403 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:13:32,409 WARNING: Current net - loaded net:
2022-11-10 14:13:32,409 WARNING: Loaded net - current net:
2022-11-10 14:13:32,409 WARNING:   func.fc.bias
2022-11-10 14:13:32,409 WARNING:   func.fc.weight
2022-11-10 14:13:32,443 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_7.pth.
2022-11-10 14:13:32,481 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:13:32,511 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:13:32,512 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:13:32,512 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:13:32,513 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:13:32,514 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:13:32,514 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:13:32,514 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:13:32,514 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:13:32,514 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:13:32,514 INFO: Model [FSLLModel] is created.
2022-11-10 14:13:32,521 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:13:32,527 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:13:32,533 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:13:32,539 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:13:32,544 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:13:32,549 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:13:32,554 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:13:32,559 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 14:13:33,109 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1662, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:13:33,879 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1662, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 14:13:34,567 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1716, Acc: 1.0000, NetFixLoss: 0.0048, ]
2022-11-10 14:13:35,197 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1660, Acc: 1.0000, NetFixLoss: 0.0088, ]
2022-11-10 14:13:35,968 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1692, Acc: 1.0000, NetFixLoss: 0.0139, ]
2022-11-10 14:13:36,794 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1657, Acc: 1.0000, NetFixLoss: 0.0199, ]
2022-11-10 14:13:37,589 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1728, Acc: 1.0000, NetFixLoss: 0.0267, ]
2022-11-10 14:13:38,285 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1698, Acc: 1.0000, NetFixLoss: 0.0342, ]
2022-11-10 14:13:38,881 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1714, Acc: 1.0000, NetFixLoss: 0.0424, ]
2022-11-10 14:13:39,565 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1686, Acc: 1.0000, NetFixLoss: 0.0512, ]
2022-11-10 14:13:40,353 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1696, Acc: 1.0000, NetFixLoss: 0.0604, ]
2022-11-10 14:13:41,009 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1698, Acc: 1.0000, NetFixLoss: 0.0702, ]
2022-11-10 14:13:41,709 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1691, Acc: 1.0000, NetFixLoss: 0.0804, ]
2022-11-10 14:13:42,445 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1671, Acc: 1.0000, NetFixLoss: 0.0911, ]
2022-11-10 14:13:43,154 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1690, Acc: 1.0000, NetFixLoss: 0.1020, ]
2022-11-10 14:13:43,238 INFO: fine-tune procedure is finished!
2022-11-10 14:14:51,317 INFO: [Test_acc of task 8 on test 3: 0.43280][acc of former classes: 0.69833][acc of former samples in all classes: 0.67950]
[acc of novel samples in all classes: 0.06275]
2022-11-10 14:14:51,374 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:14:51,380 WARNING: Current net - loaded net:
2022-11-10 14:14:51,380 WARNING: Loaded net - current net:
2022-11-10 14:14:51,380 WARNING:   func.fc.bias
2022-11-10 14:14:51,380 WARNING:   func.fc.weight
2022-11-10 14:14:51,417 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth.
2022-11-10 14:14:51,454 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:14:51,483 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:14:51,483 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:14:51,483 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:14:51,483 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:14:51,483 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:14:51,483 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:14:51,483 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:14:51,483 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:14:51,483 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:14:51,484 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:14:51,485 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:14:51,486 INFO: Model [FSLLModel] is created.
2022-11-10 14:14:51,492 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-10 14:14:51,936 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8020, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:14:52,589 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.7945, Acc: 1.0000, NetFixLoss: 0.0035, ]
2022-11-10 14:14:53,300 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8043, Acc: 1.0000, NetFixLoss: 0.0089, ]
2022-11-10 14:14:53,854 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8030, Acc: 1.0000, NetFixLoss: 0.0160, ]
2022-11-10 14:14:54,548 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.7997, Acc: 1.0000, NetFixLoss: 0.0245, ]
2022-11-10 14:14:55,130 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.7842, Acc: 1.0000, NetFixLoss: 0.0345, ]
2022-11-10 14:14:55,689 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8000, Acc: 1.0000, NetFixLoss: 0.0455, ]
2022-11-10 14:14:56,213 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.7969, Acc: 1.0000, NetFixLoss: 0.0575, ]
2022-11-10 14:14:56,848 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.7936, Acc: 1.0000, NetFixLoss: 0.0706, ]
2022-11-10 14:14:57,497 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.7897, Acc: 1.0000, NetFixLoss: 0.0847, ]
2022-11-10 14:14:58,071 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8048, Acc: 1.0000, NetFixLoss: 0.0996, ]
2022-11-10 14:14:58,636 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.7927, Acc: 1.0000, NetFixLoss: 0.1151, ]
2022-11-10 14:14:59,253 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.7984, Acc: 1.0000, NetFixLoss: 0.1311, ]
2022-11-10 14:14:59,774 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8002, Acc: 1.0000, NetFixLoss: 0.1475, ]
2022-11-10 14:15:00,278 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.7964, Acc: 1.0000, NetFixLoss: 0.1646, ]
2022-11-10 14:15:00,378 INFO: fine-tune procedure is finished!
2022-11-10 14:15:49,346 INFO: [Test_acc of task 1 on test 4: 0.59415][acc of former classes: 0.63883][acc of former samples in all classes: 0.63667]
[acc of novel samples in all classes: 0.08400]
2022-11-10 14:15:49,392 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:15:49,398 WARNING: Current net - loaded net:
2022-11-10 14:15:49,398 WARNING: Loaded net - current net:
2022-11-10 14:15:49,398 WARNING:   func.fc.bias
2022-11-10 14:15:49,398 WARNING:   func.fc.weight
2022-11-10 14:15:49,429 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_1.pth.
2022-11-10 14:15:49,468 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:15:49,497 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:15:49,497 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:15:49,497 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:15:49,498 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:15:49,499 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:15:49,499 INFO: Model [FSLLModel] is created.
2022-11-10 14:15:49,505 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:15:49,510 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-10 14:15:49,957 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.8647, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:15:50,668 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.8704, Acc: 1.0000, NetFixLoss: 0.0028, ]
2022-11-10 14:15:51,332 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.8648, Acc: 1.0000, NetFixLoss: 0.0071, ]
2022-11-10 14:15:51,993 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.8700, Acc: 1.0000, NetFixLoss: 0.0125, ]
2022-11-10 14:15:52,545 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.8583, Acc: 1.0000, NetFixLoss: 0.0192, ]
2022-11-10 14:15:53,186 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.8632, Acc: 1.0000, NetFixLoss: 0.0269, ]
2022-11-10 14:15:53,850 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.8682, Acc: 1.0000, NetFixLoss: 0.0358, ]
2022-11-10 14:15:54,511 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.8616, Acc: 1.0000, NetFixLoss: 0.0456, ]
2022-11-10 14:15:55,181 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.8678, Acc: 1.0000, NetFixLoss: 0.0564, ]
2022-11-10 14:15:55,834 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.8664, Acc: 1.0000, NetFixLoss: 0.0681, ]
2022-11-10 14:15:56,441 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.8629, Acc: 1.0000, NetFixLoss: 0.0804, ]
2022-11-10 14:15:57,212 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.8672, Acc: 1.0000, NetFixLoss: 0.0933, ]
2022-11-10 14:15:57,879 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.8660, Acc: 1.0000, NetFixLoss: 0.1068, ]
2022-11-10 14:15:58,513 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.8658, Acc: 1.0000, NetFixLoss: 0.1208, ]
2022-11-10 14:15:59,253 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.8607, Acc: 1.0000, NetFixLoss: 0.1354, ]
2022-11-10 14:15:59,386 INFO: fine-tune procedure is finished!
2022-11-10 14:16:50,581 INFO: [Test_acc of task 2 on test 4: 0.55714][acc of former classes: 0.64083][acc of former samples in all classes: 0.63583]
[acc of novel samples in all classes: 0.08500]
2022-11-10 14:16:50,635 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:16:50,640 WARNING: Current net - loaded net:
2022-11-10 14:16:50,641 WARNING: Loaded net - current net:
2022-11-10 14:16:50,641 WARNING:   func.fc.bias
2022-11-10 14:16:50,641 WARNING:   func.fc.weight
2022-11-10 14:16:50,678 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_2.pth.
2022-11-10 14:16:50,720 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:16:50,749 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:16:50,750 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:16:50,750 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:16:50,751 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:16:50,752 INFO: Model [FSLLModel] is created.
2022-11-10 14:16:50,757 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:16:50,763 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:16:50,768 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-10 14:16:51,239 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9133, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:16:51,913 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9083, Acc: 1.0000, NetFixLoss: 0.0024, ]
2022-11-10 14:16:52,571 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9073, Acc: 1.0000, NetFixLoss: 0.0063, ]
2022-11-10 14:16:53,279 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9160, Acc: 1.0000, NetFixLoss: 0.0114, ]
2022-11-10 14:16:53,972 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9056, Acc: 1.0000, NetFixLoss: 0.0178, ]
2022-11-10 14:16:54,620 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9092, Acc: 1.0000, NetFixLoss: 0.0252, ]
2022-11-10 14:16:55,171 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9057, Acc: 1.0000, NetFixLoss: 0.0336, ]
2022-11-10 14:16:55,770 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9050, Acc: 1.0000, NetFixLoss: 0.0428, ]
2022-11-10 14:16:56,519 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9103, Acc: 1.0000, NetFixLoss: 0.0529, ]
2022-11-10 14:16:57,247 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9095, Acc: 1.0000, NetFixLoss: 0.0637, ]
2022-11-10 14:16:57,875 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9106, Acc: 1.0000, NetFixLoss: 0.0751, ]
2022-11-10 14:16:58,506 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9098, Acc: 1.0000, NetFixLoss: 0.0871, ]
2022-11-10 14:16:59,187 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9060, Acc: 1.0000, NetFixLoss: 0.0997, ]
2022-11-10 14:16:59,843 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9100, Acc: 1.0000, NetFixLoss: 0.1128, ]
2022-11-10 14:17:00,651 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9101, Acc: 1.0000, NetFixLoss: 0.1263, ]
2022-11-10 14:17:00,769 INFO: fine-tune procedure is finished!
2022-11-10 14:17:53,255 INFO: [Test_acc of task 3 on test 4: 0.53467][acc of former classes: 0.65917][acc of former samples in all classes: 0.65000]
[acc of novel samples in all classes: 0.07333]
2022-11-10 14:17:53,308 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:17:53,314 WARNING: Current net - loaded net:
2022-11-10 14:17:53,314 WARNING: Loaded net - current net:
2022-11-10 14:17:53,314 WARNING:   func.fc.bias
2022-11-10 14:17:53,314 WARNING:   func.fc.weight
2022-11-10 14:17:53,350 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_3.pth.
2022-11-10 14:17:53,392 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:17:53,420 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:17:53,421 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:17:53,421 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:17:53,421 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:17:53,421 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:17:53,421 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:17:53,422 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:17:53,423 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:17:53,423 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:17:53,423 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:17:53,423 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:17:53,423 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:17:53,423 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:17:53,423 INFO: Model [FSLLModel] is created.
2022-11-10 14:17:53,429 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:17:53,434 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:17:53,439 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:17:53,445 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-10 14:17:53,858 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 3.9723, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:17:54,368 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 3.9775, Acc: 1.0000, NetFixLoss: 0.0022, ]
2022-11-10 14:17:54,875 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 3.9730, Acc: 1.0000, NetFixLoss: 0.0057, ]
2022-11-10 14:17:55,387 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 3.9703, Acc: 1.0000, NetFixLoss: 0.0103, ]
2022-11-10 14:17:55,927 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 3.9721, Acc: 1.0000, NetFixLoss: 0.0162, ]
2022-11-10 14:17:56,516 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 3.9761, Acc: 1.0000, NetFixLoss: 0.0230, ]
2022-11-10 14:17:57,146 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 3.9714, Acc: 1.0000, NetFixLoss: 0.0307, ]
2022-11-10 14:17:57,741 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 3.9724, Acc: 1.0000, NetFixLoss: 0.0393, ]
2022-11-10 14:17:58,291 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 3.9742, Acc: 1.0000, NetFixLoss: 0.0486, ]
2022-11-10 14:17:58,837 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 3.9714, Acc: 1.0000, NetFixLoss: 0.0586, ]
2022-11-10 14:17:59,391 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 3.9739, Acc: 1.0000, NetFixLoss: 0.0691, ]
2022-11-10 14:17:59,949 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 3.9782, Acc: 1.0000, NetFixLoss: 0.0803, ]
2022-11-10 14:18:00,560 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 3.9755, Acc: 1.0000, NetFixLoss: 0.0921, ]
2022-11-10 14:18:01,071 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 3.9722, Acc: 1.0000, NetFixLoss: 0.1043, ]
2022-11-10 14:18:01,589 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 3.9738, Acc: 1.0000, NetFixLoss: 0.1169, ]
2022-11-10 14:18:01,686 INFO: fine-tune procedure is finished!
2022-11-10 14:18:57,047 INFO: [Test_acc of task 4 on test 4: 0.51013][acc of former classes: 0.66833][acc of former samples in all classes: 0.65900]
[acc of novel samples in all classes: 0.06350]
2022-11-10 14:18:57,102 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:18:57,107 WARNING: Current net - loaded net:
2022-11-10 14:18:57,107 WARNING: Loaded net - current net:
2022-11-10 14:18:57,107 WARNING:   func.fc.bias
2022-11-10 14:18:57,107 WARNING:   func.fc.weight
2022-11-10 14:18:57,144 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_4.pth.
2022-11-10 14:18:57,186 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:18:57,214 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:18:57,214 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:18:57,214 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:18:57,216 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:18:57,216 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:18:57,216 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:18:57,216 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:18:57,218 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:18:57,218 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:18:57,218 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:18:57,219 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:18:57,220 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:18:57,220 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:18:57,221 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:18:57,221 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:18:57,221 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:18:57,222 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:18:57,223 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:18:57,224 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:18:57,224 INFO: Model [FSLLModel] is created.
2022-11-10 14:18:57,246 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:18:57,252 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:18:57,257 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:18:57,263 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:18:57,272 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-10 14:18:57,843 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0242, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:18:58,399 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0200, Acc: 1.0000, NetFixLoss: 0.0020, ]
2022-11-10 14:18:58,922 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0287, Acc: 1.0000, NetFixLoss: 0.0052, ]
2022-11-10 14:18:59,460 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0307, Acc: 1.0000, NetFixLoss: 0.0097, ]
2022-11-10 14:19:01,098 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0200, Acc: 1.0000, NetFixLoss: 0.0151, ]
2022-11-10 14:19:01,613 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0214, Acc: 1.0000, NetFixLoss: 0.0215, ]
2022-11-10 14:19:02,273 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0233, Acc: 1.0000, NetFixLoss: 0.0289, ]
2022-11-10 14:19:02,843 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0218, Acc: 1.0000, NetFixLoss: 0.0371, ]
2022-11-10 14:19:03,418 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0219, Acc: 1.0000, NetFixLoss: 0.0459, ]
2022-11-10 14:19:03,994 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0223, Acc: 1.0000, NetFixLoss: 0.0554, ]
2022-11-10 14:19:04,622 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0208, Acc: 1.0000, NetFixLoss: 0.0654, ]
2022-11-10 14:19:05,225 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0222, Acc: 1.0000, NetFixLoss: 0.0759, ]
2022-11-10 14:19:05,788 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0225, Acc: 1.0000, NetFixLoss: 0.0868, ]
2022-11-10 14:19:06,310 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0292, Acc: 1.0000, NetFixLoss: 0.0981, ]
2022-11-10 14:19:06,902 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0230, Acc: 1.0000, NetFixLoss: 0.1098, ]
2022-11-10 14:19:06,984 INFO: fine-tune procedure is finished!
2022-11-10 14:20:03,576 INFO: [Test_acc of task 5 on test 4: 0.49341][acc of former classes: 0.68950][acc of former samples in all classes: 0.67700]
[acc of novel samples in all classes: 0.05280]
2022-11-10 14:20:03,596 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:20:03,601 WARNING: Current net - loaded net:
2022-11-10 14:20:03,601 WARNING: Loaded net - current net:
2022-11-10 14:20:03,601 WARNING:   func.fc.bias
2022-11-10 14:20:03,601 WARNING:   func.fc.weight
2022-11-10 14:20:03,606 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_5.pth.
2022-11-10 14:20:03,615 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:20:03,626 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:20:03,626 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:20:03,626 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:20:03,626 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:20:03,626 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:20:03,627 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:20:03,627 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:20:03,627 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:20:03,627 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:20:03,627 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:20:03,627 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:20:03,627 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:20:03,627 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:20:03,628 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:20:03,629 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:20:03,629 INFO: Model [FSLLModel] is created.
2022-11-10 14:20:03,635 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:20:03,640 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:20:03,645 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:20:03,651 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:20:03,656 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:20:03,661 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-10 14:20:04,125 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.0758, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:20:04,685 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.0759, Acc: 1.0000, NetFixLoss: 0.0020, ]
2022-11-10 14:20:05,277 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.0756, Acc: 1.0000, NetFixLoss: 0.0052, ]
2022-11-10 14:20:05,845 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.0801, Acc: 1.0000, NetFixLoss: 0.0096, ]
2022-11-10 14:20:06,399 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.0764, Acc: 1.0000, NetFixLoss: 0.0149, ]
2022-11-10 14:20:06,961 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.0755, Acc: 1.0000, NetFixLoss: 0.0212, ]
2022-11-10 14:20:07,600 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.0751, Acc: 1.0000, NetFixLoss: 0.0283, ]
2022-11-10 14:20:08,200 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.0733, Acc: 1.0000, NetFixLoss: 0.0362, ]
2022-11-10 14:20:08,751 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.0768, Acc: 1.0000, NetFixLoss: 0.0448, ]
2022-11-10 14:20:09,337 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.0719, Acc: 1.0000, NetFixLoss: 0.0540, ]
2022-11-10 14:20:09,927 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.0736, Acc: 1.0000, NetFixLoss: 0.0638, ]
2022-11-10 14:20:10,533 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.0737, Acc: 1.0000, NetFixLoss: 0.0742, ]
2022-11-10 14:20:11,101 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.0712, Acc: 1.0000, NetFixLoss: 0.0849, ]
2022-11-10 14:20:11,689 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.0767, Acc: 1.0000, NetFixLoss: 0.0961, ]
2022-11-10 14:20:12,221 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.0759, Acc: 1.0000, NetFixLoss: 0.1075, ]
2022-11-10 14:20:12,320 INFO: fine-tune procedure is finished!
2022-11-10 14:21:12,612 INFO: [Test_acc of task 6 on test 4: 0.47678][acc of former classes: 0.70317][acc of former samples in all classes: 0.69033]
[acc of novel samples in all classes: 0.04967]
2022-11-10 14:21:12,658 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:21:12,664 WARNING: Current net - loaded net:
2022-11-10 14:21:12,664 WARNING: Loaded net - current net:
2022-11-10 14:21:12,664 WARNING:   func.fc.bias
2022-11-10 14:21:12,664 WARNING:   func.fc.weight
2022-11-10 14:21:12,696 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_6.pth.
2022-11-10 14:21:12,733 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:21:12,762 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:21:12,763 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:21:12,763 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:21:12,764 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:21:12,765 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:21:12,765 INFO: Model [FSLLModel] is created.
2022-11-10 14:21:12,771 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:21:12,776 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:21:12,781 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:21:12,786 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:21:12,791 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:21:12,796 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:21:12,801 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-10 14:21:13,280 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1184, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:21:13,882 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1205, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 14:21:14,456 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1254, Acc: 1.0000, NetFixLoss: 0.0048, ]
2022-11-10 14:21:14,960 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1231, Acc: 1.0000, NetFixLoss: 0.0090, ]
2022-11-10 14:21:15,476 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1222, Acc: 1.0000, NetFixLoss: 0.0142, ]
2022-11-10 14:21:16,063 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1251, Acc: 1.0000, NetFixLoss: 0.0203, ]
2022-11-10 14:21:16,617 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1252, Acc: 1.0000, NetFixLoss: 0.0272, ]
2022-11-10 14:21:17,181 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1217, Acc: 1.0000, NetFixLoss: 0.0349, ]
2022-11-10 14:21:17,706 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1186, Acc: 1.0000, NetFixLoss: 0.0432, ]
2022-11-10 14:21:18,304 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1242, Acc: 1.0000, NetFixLoss: 0.0522, ]
2022-11-10 14:21:18,873 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1200, Acc: 1.0000, NetFixLoss: 0.0617, ]
2022-11-10 14:21:19,504 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1237, Acc: 1.0000, NetFixLoss: 0.0718, ]
2022-11-10 14:21:20,036 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1280, Acc: 1.0000, NetFixLoss: 0.0823, ]
2022-11-10 14:21:20,580 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1249, Acc: 1.0000, NetFixLoss: 0.0932, ]
2022-11-10 14:21:21,109 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1221, Acc: 1.0000, NetFixLoss: 0.1044, ]
2022-11-10 14:21:21,191 INFO: fine-tune procedure is finished!
2022-11-10 14:22:23,553 INFO: [Test_acc of task 7 on test 4: 0.45653][acc of former classes: 0.70400][acc of former samples in all classes: 0.69017]
[acc of novel samples in all classes: 0.05600]
2022-11-10 14:22:23,605 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-10 14:22:23,611 WARNING: Current net - loaded net:
2022-11-10 14:22:23,611 WARNING: Loaded net - current net:
2022-11-10 14:22:23,611 WARNING:   func.fc.bias
2022-11-10 14:22:23,611 WARNING:   func.fc.weight
2022-11-10 14:22:23,648 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_7.pth.
2022-11-10 14:22:23,690 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/prototypes/test0_session0.pt
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-10 14:22:23,718 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-10 14:22:23,718 WARNING: Params func.conv1.weight will not be optimized.
2022-11-10 14:22:23,718 WARNING: Params func.bn1.weight will not be optimized.
2022-11-10 14:22:23,718 WARNING: Params func.bn1.bias will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-10 14:22:23,719 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-10 14:22:23,720 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-10 14:22:23,721 INFO: Model [FSLLModel] is created.
2022-11-10 14:22:23,726 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:22:23,732 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:22:23,737 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:22:23,742 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:22:23,747 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:22:23,752 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:22:23,757 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-10 14:22:23,763 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-10 14:22:24,251 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ PTFixPNLoss: 4.1741, Acc: 1.0000, NetFixLoss: 0.0000, ]
2022-11-10 14:22:24,782 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ PTFixPNLoss: 4.1723, Acc: 1.0000, NetFixLoss: 0.0018, ]
2022-11-10 14:22:25,306 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ PTFixPNLoss: 4.1722, Acc: 1.0000, NetFixLoss: 0.0047, ]
2022-11-10 14:22:25,868 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ PTFixPNLoss: 4.1691, Acc: 1.0000, NetFixLoss: 0.0087, ]
2022-11-10 14:22:26,402 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ PTFixPNLoss: 4.1755, Acc: 1.0000, NetFixLoss: 0.0137, ]
2022-11-10 14:22:26,939 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ PTFixPNLoss: 4.1717, Acc: 1.0000, NetFixLoss: 0.0197, ]
2022-11-10 14:22:27,506 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ PTFixPNLoss: 4.1736, Acc: 1.0000, NetFixLoss: 0.0265, ]
2022-11-10 14:22:28,123 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ PTFixPNLoss: 4.1737, Acc: 1.0000, NetFixLoss: 0.0340, ]
2022-11-10 14:22:28,667 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ PTFixPNLoss: 4.1730, Acc: 1.0000, NetFixLoss: 0.0423, ]
2022-11-10 14:22:29,250 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ PTFixPNLoss: 4.1711, Acc: 1.0000, NetFixLoss: 0.0512, ]
2022-11-10 14:22:29,813 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ PTFixPNLoss: 4.1744, Acc: 1.0000, NetFixLoss: 0.0606, ]
2022-11-10 14:22:30,355 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ PTFixPNLoss: 4.1667, Acc: 1.0000, NetFixLoss: 0.0705, ]
2022-11-10 14:22:31,011 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ PTFixPNLoss: 4.1703, Acc: 1.0000, NetFixLoss: 0.0809, ]
2022-11-10 14:22:31,543 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ PTFixPNLoss: 4.1697, Acc: 1.0000, NetFixLoss: 0.0917, ]
2022-11-10 14:22:32,102 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ PTFixPNLoss: 4.1711, Acc: 1.0000, NetFixLoss: 0.1029, ]
2022-11-10 14:22:32,196 INFO: fine-tune procedure is finished!
2022-11-10 14:23:36,873 INFO: [Test_acc of task 8 on test 4: 0.43470][acc of former classes: 0.70433][acc of former samples in all classes: 0.69000]
[acc of novel samples in all classes: 0.05175]
2022-11-10 14:23:36,883 INFO: --------------------------Final Avg Acc-------------------------
2022-11-10 14:23:36,884 INFO: Session 1: 72.52+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7252]
2022-11-10 14:23:36,884 INFO: Session 2: 59.22+-1.23[acc of former classes: 0.6369][acc of former samples in all classes: 0.6348]
[acc of novel samples in all classes: 0.0820]
2022-11-10 14:23:36,884 INFO: Session 3: 55.84+-0.86[acc of former classes: 0.6454][acc of former samples in all classes: 0.6396]
[acc of novel samples in all classes: 0.0714]
2022-11-10 14:23:36,884 INFO: Session 4: 52.55+-0.94[acc of former classes: 0.6493][acc of former samples in all classes: 0.6392]
[acc of novel samples in all classes: 0.0705]
2022-11-10 14:23:36,884 INFO: Session 5: 50.25+-0.91[acc of former classes: 0.6595][acc of former samples in all classes: 0.6484]
[acc of novel samples in all classes: 0.0646]
2022-11-10 14:23:36,884 INFO: Session 6: 48.78+-0.77[acc of former classes: 0.6792][acc of former samples in all classes: 0.6644]
[acc of novel samples in all classes: 0.0640]
2022-11-10 14:23:36,884 INFO: Session 7: 47.56+-0.74[acc of former classes: 0.6955][acc of former samples in all classes: 0.6799]
[acc of novel samples in all classes: 0.0669]
2022-11-10 14:23:36,884 INFO: Session 8: 45.65+-0.64[acc of former classes: 0.6981][acc of former samples in all classes: 0.6814]
[acc of novel samples in all classes: 0.0710]
2022-11-10 14:23:36,884 INFO: Session 9: 43.61+-0.49[acc of former classes: 0.7020][acc of former samples in all classes: 0.6827]
[acc of novel samples in all classes: 0.0664]
2022-11-10 14:23:36,885 INFO: random seed: 1997
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/1S_FSIL_FSLLModel_res18_cifar_baseline_1shot_wandb_debug/models/test4_session_8.pth
finish!!
