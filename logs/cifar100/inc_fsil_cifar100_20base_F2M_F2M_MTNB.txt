/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-06 01:18:08,040 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-06 01:18:08,041 INFO: 
  name: F2M_res18_cifar_5shots_debug_20base_02
  model_type: MTNBModel
  gpu: 1
  manual_seed: 1997
  use_cosine: False
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  datasets:[
    train:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: None
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    val:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    test:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
  ]
  network_g:[
    type: Resnet20_cifar_small
    num_classes: 20
    adopt_classifier: False
    flatten: True
  ]
  path:[
    pretrain_model_g: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
    base_model: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02
    training_states: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/training_states
    log: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02
    models: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models
    prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.02
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [1000]
      gamma: 1e-05
    ]
    fine_tune: True
    random_noise:[
      distribution:[
        type: DiscreteBeta
      ]
      type: suffix_conv_weight
      num_layers: 4
      low: 0.1
      high: 5.0
      reduction_factor: 4
      bound_value: 0.01
      random_times: 0
    ]
    clamping: True
    rounding: True
    fine_tune_epoch: 6
    max_steps: 1
    ratio: 1
    novel_exemplars: 5
    warmup_iter: -1
    bases: 20
    tasks: 9
    shots: 5
    num_test: 5
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: False
    ]
  ]
  val:[
    val_freq: 5
    test_type: NCM
  ]
  logger:[
    print_freq: 1
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental-Results
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-06 01:18:08,041 INFO: Random seed: 1997
2022-11-06 01:18:11,411 INFO: Network: Resnet20_cifar_small, with parameters: 271,824
2022-11-06 01:18:11,411 INFO: Resnet20_cifar_small(
  (func): ResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (avg_pool): AdaptiveAvgPool2d(output_size=(1, 1))
  )
)
2022-11-06 01:18:11,411 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:18:11,418 WARNING: Current net - loaded net:
2022-11-06 01:18:11,418 WARNING: Loaded net - current net:
2022-11-06 01:18:11,418 WARNING:   func.fc.bias
2022-11-06 01:18:11,418 WARNING:   func.fc.weight
2022-11-06 01:18:11,431 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:18:11,437 WARNING: Current net - loaded net:
2022-11-06 01:18:11,437 WARNING: Loaded net - current net:
2022-11-06 01:18:11,437 WARNING:   func.fc.bias
2022-11-06 01:18:11,437 WARNING:   func.fc.weight
2022-11-06 01:18:11,450 INFO: Obtain parameters for train
2022-11-06 01:18:11,456 INFO: Model [MTNBModel] is created.
2022-11-06 01:18:26,278 INFO: [Test_acc of task 0 on test 0: 0.73400][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.73400]
2022-11-06 01:18:26,304 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:18:26,311 WARNING: Current net - loaded net:
2022-11-06 01:18:26,312 WARNING: Loaded net - current net:
2022-11-06 01:18:26,312 WARNING:   func.fc.bias
2022-11-06 01:18:26,312 WARNING:   func.fc.weight
2022-11-06 01:18:26,326 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth.
2022-11-06 01:18:26,356 INFO: Obtain parameters for train
2022-11-06 01:18:26,358 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:18:26,358 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:18:26,359 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:18:26,360 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:18:26,361 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:18:26,361 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:18:26,361 INFO: Model [MTNBModel] is created.
2022-11-06 01:18:26,375 INFO: Dataset NormalDataset - cifar-100 is created.
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
>>> Test >>>
Former classes: []
Novel classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:18:27,129 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.9499, Acc: 0.7600, ]
2022-11-06 01:18:28,543 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 1, n_lower: 21
2022-11-06 01:18:28,544 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 1, n_lower: 8
2022-11-06 01:18:28,545 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 1, n_lower: 43
2022-11-06 01:18:28,545 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 1
2022-11-06 01:18:28,546 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.7900, Acc: 0.7200, ]
2022-11-06 01:18:29,593 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 82, n_lower: 89
2022-11-06 01:18:29,594 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 28, n_lower: 119
2022-11-06 01:18:29,595 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 26, n_lower: 328
2022-11-06 01:18:29,596 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 32
2022-11-06 01:18:29,596 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6558, Acc: 0.7800, ]
2022-11-06 01:18:30,737 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 86, n_lower: 120
2022-11-06 01:18:30,738 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 30, n_lower: 121
2022-11-06 01:18:30,739 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 32, n_lower: 344
2022-11-06 01:18:30,740 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 32
2022-11-06 01:18:30,740 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.6254, Acc: 0.7600, ]
2022-11-06 01:18:31,700 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 86, n_lower: 121
2022-11-06 01:18:31,701 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 55, n_lower: 211
2022-11-06 01:18:31,701 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 32, n_lower: 345
2022-11-06 01:18:31,702 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 57
2022-11-06 01:18:31,703 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5954, Acc: 0.8000, ]
2022-11-06 01:18:31,744 INFO: Epoch 4, Validation Step:

2022-11-06 01:18:49,498 INFO: [Test_acc of task 1 on test 0: 0.54200][acc of former classes: 0.73050][acc of former samples in all classes: 0.67650]
[acc of novel samples in all classes: 0.27300]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:18:50,374 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 107, n_lower: 125
2022-11-06 01:18:50,375 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 55, n_lower: 212
2022-11-06 01:18:50,376 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 32, n_lower: 368
2022-11-06 01:18:50,377 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 57
2022-11-06 01:18:50,377 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5936, Acc: 0.8000, ]
2022-11-06 01:18:50,868 INFO: fine-tune procedure is finished!
2022-11-06 01:19:09,017 INFO: [Test_acc of task 1 on test 0: 0.54200][acc of former classes: 0.73000][acc of former samples in all classes: 0.67650]
[acc of novel samples in all classes: 0.27300]
2022-11-06 01:19:09,040 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:19:09,048 WARNING: Current net - loaded net:
2022-11-06 01:19:09,048 WARNING: Loaded net - current net:
2022-11-06 01:19:09,048 WARNING:   func.fc.bias
2022-11-06 01:19:09,048 WARNING:   func.fc.weight
2022-11-06 01:19:09,115 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_1.pth.
2022-11-06 01:19:09,145 INFO: Obtain parameters for train
2022-11-06 01:19:09,148 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:19:09,148 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:19:09,148 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:19:09,148 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:19:09,148 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:19:09,160 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:19:09,161 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:19:09,162 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:19:09,163 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:19:09,163 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:19:09,163 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:19:09,163 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:19:09,163 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:19:09,163 INFO: Model [MTNBModel] is created.
2022-11-06 01:19:09,178 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:19:09,192 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:19:09,981 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 34, n_lower: 85
2022-11-06 01:19:09,982 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 19, n_lower: 135
2022-11-06 01:19:09,983 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 16, n_lower: 245
2022-11-06 01:19:09,984 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 53
2022-11-06 01:19:09,984 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.2140, Acc: 0.6600, ]
2022-11-06 01:19:10,808 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 35, n_lower: 85
2022-11-06 01:19:10,809 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 19, n_lower: 136
2022-11-06 01:19:10,810 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 16, n_lower: 245
2022-11-06 01:19:10,811 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 53
2022-11-06 01:19:10,812 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.0541, Acc: 0.6700, ]
2022-11-06 01:19:11,449 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 35, n_lower: 85
2022-11-06 01:19:11,450 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 61, n_lower: 274
2022-11-06 01:19:11,451 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 16, n_lower: 246
2022-11-06 01:19:11,452 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 53
2022-11-06 01:19:11,452 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.2386, Acc: 0.6500, ]
2022-11-06 01:19:12,379 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 38, n_lower: 99
2022-11-06 01:19:12,380 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 61, n_lower: 275
2022-11-06 01:19:12,380 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 16, n_lower: 257
2022-11-06 01:19:12,381 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 53
2022-11-06 01:19:12,382 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.1617, Acc: 0.6500, ]
2022-11-06 01:19:13,337 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 40, n_lower: 103
2022-11-06 01:19:13,339 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 61, n_lower: 277
2022-11-06 01:19:13,340 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 272
2022-11-06 01:19:13,341 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 114
2022-11-06 01:19:13,341 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.3212, Acc: 0.5900, ]
2022-11-06 01:19:13,390 INFO: Epoch 4, Validation Step:

2022-11-06 01:19:36,668 INFO: [Test_acc of task 2 on test 0: 0.42625][acc of former classes: 0.73050][acc of former samples in all classes: 0.64600]
[acc of novel samples in all classes: 0.20650]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:19:37,467 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 44, n_lower: 151
2022-11-06 01:19:37,468 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 284
2022-11-06 01:19:37,469 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 21, n_lower: 289
2022-11-06 01:19:37,469 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 114
2022-11-06 01:19:37,470 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.9362, Acc: 0.6600, ]
2022-11-06 01:19:37,564 INFO: fine-tune procedure is finished!
2022-11-06 01:20:00,817 INFO: [Test_acc of task 2 on test 0: 0.42675][acc of former classes: 0.72900][acc of former samples in all classes: 0.64400]
[acc of novel samples in all classes: 0.20950]
2022-11-06 01:20:00,840 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:20:00,847 WARNING: Current net - loaded net:
2022-11-06 01:20:00,847 WARNING: Loaded net - current net:
2022-11-06 01:20:00,847 WARNING:   func.fc.bias
2022-11-06 01:20:00,847 WARNING:   func.fc.weight
2022-11-06 01:20:00,860 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_2.pth.
2022-11-06 01:20:00,880 INFO: Obtain parameters for train
2022-11-06 01:20:00,882 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:20:00,882 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:20:00,883 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:20:00,884 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:20:00,884 INFO: Model [MTNBModel] is created.
2022-11-06 01:20:00,897 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:20:00,910 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:20:00,921 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:20:01,773 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 36, n_lower: 131
2022-11-06 01:20:01,774 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 56, n_lower: 256
2022-11-06 01:20:01,775 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 269
2022-11-06 01:20:01,776 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 111
2022-11-06 01:20:01,776 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.5382, Acc: 0.5667, ]
2022-11-06 01:20:02,748 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 42, n_lower: 133
2022-11-06 01:20:02,749 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 57, n_lower: 256
2022-11-06 01:20:02,750 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 17, n_lower: 269
2022-11-06 01:20:02,750 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 125
2022-11-06 01:20:02,751 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.6398, Acc: 0.5267, ]
2022-11-06 01:20:03,508 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 50, n_lower: 139
2022-11-06 01:20:03,513 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 91, n_lower: 367
2022-11-06 01:20:03,514 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 21, n_lower: 312
2022-11-06 01:20:03,514 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 138
2022-11-06 01:20:03,515 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.2803, Acc: 0.5933, ]
2022-11-06 01:20:04,302 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 66, n_lower: 150
2022-11-06 01:20:04,303 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 94, n_lower: 374
2022-11-06 01:20:04,304 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 24, n_lower: 332
2022-11-06 01:20:04,305 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 192
2022-11-06 01:20:04,306 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.2659, Acc: 0.6533, ]
2022-11-06 01:20:05,111 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 104, n_lower: 242
2022-11-06 01:20:05,112 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 415
2022-11-06 01:20:05,112 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 49, n_lower: 459
2022-11-06 01:20:05,113 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 203
2022-11-06 01:20:05,114 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.3664, Acc: 0.5467, ]
2022-11-06 01:20:05,176 INFO: Epoch 4, Validation Step:

2022-11-06 01:20:34,951 INFO: [Test_acc of task 3 on test 0: 0.35780][acc of former classes: 0.73200][acc of former samples in all classes: 0.61500]
[acc of novel samples in all classes: 0.18633]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:20:36,005 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 138, n_lower: 263
2022-11-06 01:20:36,006 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 418
2022-11-06 01:20:36,007 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 66, n_lower: 502
2022-11-06 01:20:36,008 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 3, n_lower: 203
2022-11-06 01:20:36,009 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.2115, Acc: 0.6133, ]
2022-11-06 01:20:36,280 INFO: fine-tune procedure is finished!
2022-11-06 01:21:06,141 INFO: [Test_acc of task 3 on test 0: 0.35760][acc of former classes: 0.73250][acc of former samples in all classes: 0.61600]
[acc of novel samples in all classes: 0.18533]
2022-11-06 01:21:06,168 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:21:06,176 WARNING: Current net - loaded net:
2022-11-06 01:21:06,176 WARNING: Loaded net - current net:
2022-11-06 01:21:06,176 WARNING:   func.fc.bias
2022-11-06 01:21:06,176 WARNING:   func.fc.weight
2022-11-06 01:21:06,275 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_3.pth.
2022-11-06 01:21:06,294 INFO: Obtain parameters for train
2022-11-06 01:21:06,295 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:21:06,295 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:21:06,295 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:21:06,295 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:21:06,295 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:21:06,295 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:21:06,295 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:21:06,296 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:21:06,297 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:21:06,298 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:21:06,298 INFO: Model [MTNBModel] is created.
2022-11-06 01:21:06,308 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:21:06,321 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:21:06,337 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:21:06,354 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:21:07,173 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 51, n_lower: 228
2022-11-06 01:21:07,174 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 72, n_lower: 356
2022-11-06 01:21:07,175 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 37, n_lower: 411
2022-11-06 01:21:07,176 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 169
2022-11-06 01:21:07,176 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.4554, Acc: 0.5450, ]
2022-11-06 01:21:08,100 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 74, n_lower: 236
2022-11-06 01:21:08,101 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 95, n_lower: 366
2022-11-06 01:21:08,102 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 411
2022-11-06 01:21:08,103 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 171
2022-11-06 01:21:08,103 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.5232, Acc: 0.5450, ]
2022-11-06 01:21:09,185 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 98, n_lower: 244
2022-11-06 01:21:09,186 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 121, n_lower: 398
2022-11-06 01:21:09,186 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 411
2022-11-06 01:21:09,187 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 174
2022-11-06 01:21:09,188 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.6663, Acc: 0.5550, ]
2022-11-06 01:21:10,308 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 175, n_lower: 294
2022-11-06 01:21:10,310 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 129, n_lower: 423
2022-11-06 01:21:10,311 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 411
2022-11-06 01:21:10,311 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 189
2022-11-06 01:21:10,312 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.4545, Acc: 0.6050, ]
2022-11-06 01:21:11,351 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 377
2022-11-06 01:21:11,352 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 146, n_lower: 430
2022-11-06 01:21:11,353 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 411
2022-11-06 01:21:11,354 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 191
2022-11-06 01:21:11,355 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.4081, Acc: 0.6050, ]
2022-11-06 01:21:11,444 INFO: Epoch 4, Validation Step:

2022-11-06 01:21:44,701 INFO: [Test_acc of task 4 on test 0: 0.30933][acc of former classes: 0.73300][acc of former samples in all classes: 0.59250]
[acc of novel samples in all classes: 0.16775]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:21:45,780 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 224, n_lower: 383
2022-11-06 01:21:45,856 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 153, n_lower: 431
2022-11-06 01:21:45,857 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 415
2022-11-06 01:21:45,858 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 191
2022-11-06 01:21:45,858 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.2982, Acc: 0.6200, ]
2022-11-06 01:21:46,148 INFO: fine-tune procedure is finished!
2022-11-06 01:22:20,858 INFO: [Test_acc of task 4 on test 0: 0.30933][acc of former classes: 0.73350][acc of former samples in all classes: 0.59200]
[acc of novel samples in all classes: 0.16800]
2022-11-06 01:22:20,877 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:22:20,888 WARNING: Current net - loaded net:
2022-11-06 01:22:20,888 WARNING: Loaded net - current net:
2022-11-06 01:22:20,888 WARNING:   func.fc.bias
2022-11-06 01:22:20,888 WARNING:   func.fc.weight
2022-11-06 01:22:20,910 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_4.pth.
2022-11-06 01:22:20,929 INFO: Obtain parameters for train
2022-11-06 01:22:20,931 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:22:20,931 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:22:20,932 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:22:20,933 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:22:20,933 INFO: Model [MTNBModel] is created.
2022-11-06 01:22:20,947 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:22:20,971 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:22:20,983 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:22:21,001 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:22:21,019 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:22:22,083 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 91, n_lower: 341
2022-11-06 01:22:22,084 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 68, n_lower: 395
2022-11-06 01:22:22,089 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 38, n_lower: 415
2022-11-06 01:22:22,090 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 180
2022-11-06 01:22:22,091 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.5518, Acc: 0.5600, ]
2022-11-06 01:22:23,298 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 92, n_lower: 341
2022-11-06 01:22:23,299 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 94, n_lower: 415
2022-11-06 01:22:23,299 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 38, n_lower: 416
2022-11-06 01:22:23,300 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 184
2022-11-06 01:22:23,301 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.7759, Acc: 0.5280, ]
2022-11-06 01:22:24,223 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 103, n_lower: 345
2022-11-06 01:22:24,256 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 104, n_lower: 420
2022-11-06 01:22:24,257 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 431
2022-11-06 01:22:24,258 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:22:24,259 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.6769, Acc: 0.5520, ]
2022-11-06 01:22:25,042 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 110, n_lower: 352
2022-11-06 01:22:25,043 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 441
2022-11-06 01:22:25,044 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 433
2022-11-06 01:22:25,045 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 187
2022-11-06 01:22:25,045 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.5972, Acc: 0.5520, ]
2022-11-06 01:22:26,055 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 113, n_lower: 355
2022-11-06 01:22:26,056 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 446
2022-11-06 01:22:26,057 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 433
2022-11-06 01:22:26,059 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 189
2022-11-06 01:22:26,060 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.5984, Acc: 0.5480, ]
2022-11-06 01:22:26,282 INFO: Epoch 4, Validation Step:

2022-11-06 01:23:11,347 INFO: [Test_acc of task 5 on test 0: 0.27857][acc of former classes: 0.73400][acc of former samples in all classes: 0.58100]
[acc of novel samples in all classes: 0.15760]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:23:12,417 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 116, n_lower: 375
2022-11-06 01:23:12,418 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 452
2022-11-06 01:23:12,419 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 46, n_lower: 449
2022-11-06 01:23:12,420 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 189
2022-11-06 01:23:12,421 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.6272, Acc: 0.5680, ]
2022-11-06 01:23:12,674 INFO: fine-tune procedure is finished!
2022-11-06 01:23:55,192 INFO: [Test_acc of task 5 on test 0: 0.27800][acc of former classes: 0.73300][acc of former samples in all classes: 0.57900]
[acc of novel samples in all classes: 0.15760]
2022-11-06 01:23:55,222 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:23:55,232 WARNING: Current net - loaded net:
2022-11-06 01:23:55,232 WARNING: Loaded net - current net:
2022-11-06 01:23:55,232 WARNING:   func.fc.bias
2022-11-06 01:23:55,232 WARNING:   func.fc.weight
2022-11-06 01:23:55,249 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_5.pth.
2022-11-06 01:23:55,273 INFO: Obtain parameters for train
2022-11-06 01:23:55,275 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:23:55,275 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:23:55,275 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:23:55,275 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:23:55,275 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:23:55,276 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:23:55,277 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:23:55,278 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:23:55,278 INFO: Model [MTNBModel] is created.
2022-11-06 01:23:55,293 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:23:55,306 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:23:55,319 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:23:55,336 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:23:55,426 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:23:55,439 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:23:56,363 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 89, n_lower: 354
2022-11-06 01:23:56,364 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 422
2022-11-06 01:23:56,365 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 449
2022-11-06 01:23:56,366 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 184
2022-11-06 01:23:56,366 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.7793, Acc: 0.5200, ]
2022-11-06 01:23:57,550 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 91, n_lower: 357
2022-11-06 01:23:57,551 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 72, n_lower: 422
2022-11-06 01:23:57,552 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 449
2022-11-06 01:23:57,553 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:23:57,554 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.6535, Acc: 0.5667, ]
2022-11-06 01:23:58,456 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 101, n_lower: 362
2022-11-06 01:23:58,457 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 73, n_lower: 424
2022-11-06 01:23:58,458 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 464
2022-11-06 01:23:58,458 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:23:58,459 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.8001, Acc: 0.5067, ]
2022-11-06 01:24:00,341 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 102, n_lower: 362
2022-11-06 01:24:00,342 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 81, n_lower: 427
2022-11-06 01:24:00,342 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 45, n_lower: 466
2022-11-06 01:24:00,343 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:24:00,344 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8209, Acc: 0.5133, ]
2022-11-06 01:24:01,320 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 108, n_lower: 375
2022-11-06 01:24:01,321 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 81, n_lower: 428
2022-11-06 01:24:01,322 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 45, n_lower: 488
2022-11-06 01:24:01,323 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:24:01,323 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.7622, Acc: 0.5367, ]
2022-11-06 01:24:01,428 INFO: Epoch 4, Validation Step:

2022-11-06 01:24:48,050 INFO: [Test_acc of task 6 on test 0: 0.24825][acc of former classes: 0.73350][acc of former samples in all classes: 0.57100]
[acc of novel samples in all classes: 0.14067]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:24:49,123 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 113, n_lower: 376
2022-11-06 01:24:49,124 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 81, n_lower: 428
2022-11-06 01:24:49,125 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 45, n_lower: 488
2022-11-06 01:24:49,126 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:24:49,127 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.5937, Acc: 0.5433, ]
2022-11-06 01:24:49,340 INFO: fine-tune procedure is finished!
2022-11-06 01:25:33,839 INFO: [Test_acc of task 6 on test 0: 0.24863][acc of former classes: 0.73350][acc of former samples in all classes: 0.57150]
[acc of novel samples in all classes: 0.14100]
2022-11-06 01:25:33,859 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:25:33,865 WARNING: Current net - loaded net:
2022-11-06 01:25:33,865 WARNING: Loaded net - current net:
2022-11-06 01:25:33,865 WARNING:   func.fc.bias
2022-11-06 01:25:33,865 WARNING:   func.fc.weight
2022-11-06 01:25:33,879 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_6.pth.
2022-11-06 01:25:33,899 INFO: Obtain parameters for train
2022-11-06 01:25:33,901 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:25:33,901 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:25:33,901 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:25:33,901 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:25:33,901 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:25:33,901 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:25:33,901 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:25:33,901 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:25:33,902 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:25:33,903 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:25:33,904 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:25:33,904 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:25:33,904 INFO: Model [MTNBModel] is created.
2022-11-06 01:25:33,920 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:25:33,937 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:25:33,953 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:25:33,969 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:25:33,989 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:25:34,006 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:25:34,023 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:25:34,703 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 98, n_lower: 373
2022-11-06 01:25:34,704 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 428
2022-11-06 01:25:34,705 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 37, n_lower: 480
2022-11-06 01:25:34,706 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 184
2022-11-06 01:25:34,706 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.8101, Acc: 0.5171, ]
2022-11-06 01:25:35,670 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 103, n_lower: 381
2022-11-06 01:25:35,671 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 433
2022-11-06 01:25:35,672 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 38, n_lower: 483
2022-11-06 01:25:35,673 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 184
2022-11-06 01:25:35,674 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.8227, Acc: 0.4914, ]
2022-11-06 01:25:36,672 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 105, n_lower: 383
2022-11-06 01:25:36,673 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 434
2022-11-06 01:25:36,674 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 38, n_lower: 489
2022-11-06 01:25:36,674 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 184
2022-11-06 01:25:36,675 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.7107, Acc: 0.5571, ]
2022-11-06 01:25:37,958 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 112, n_lower: 384
2022-11-06 01:25:37,960 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 436
2022-11-06 01:25:37,960 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 499
2022-11-06 01:25:37,961 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 184
2022-11-06 01:25:37,962 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8431, Acc: 0.5029, ]
2022-11-06 01:25:38,902 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 112, n_lower: 389
2022-11-06 01:25:38,903 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 436
2022-11-06 01:25:38,904 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 502
2022-11-06 01:25:38,905 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:25:38,905 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.7441, Acc: 0.5286, ]
2022-11-06 01:25:39,028 INFO: Epoch 4, Validation Step:

2022-11-06 01:26:27,475 INFO: [Test_acc of task 7 on test 0: 0.22833][acc of former classes: 0.73300][acc of former samples in all classes: 0.54900]
[acc of novel samples in all classes: 0.13671]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:26:28,339 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 115, n_lower: 390
2022-11-06 01:26:28,341 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 437
2022-11-06 01:26:28,341 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 503
2022-11-06 01:26:28,342 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 185
2022-11-06 01:26:28,343 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.7152, Acc: 0.5600, ]
2022-11-06 01:26:28,421 INFO: fine-tune procedure is finished!
2022-11-06 01:27:19,187 INFO: [Test_acc of task 7 on test 0: 0.22833][acc of former classes: 0.73300][acc of former samples in all classes: 0.54900]
[acc of novel samples in all classes: 0.13671]
2022-11-06 01:27:19,210 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:27:19,217 WARNING: Current net - loaded net:
2022-11-06 01:27:19,217 WARNING: Loaded net - current net:
2022-11-06 01:27:19,217 WARNING:   func.fc.bias
2022-11-06 01:27:19,218 WARNING:   func.fc.weight
2022-11-06 01:27:19,231 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_7.pth.
2022-11-06 01:27:19,250 INFO: Obtain parameters for train
2022-11-06 01:27:19,252 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:27:19,252 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:27:19,253 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:27:19,254 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:27:19,255 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:27:19,255 INFO: Model [MTNBModel] is created.
2022-11-06 01:27:19,269 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:27:19,281 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:27:19,292 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:27:19,304 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:27:19,315 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:27:19,326 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:27:19,338 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:27:19,349 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 01:27:20,173 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 95, n_lower: 372
2022-11-06 01:27:20,175 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 429
2022-11-06 01:27:20,176 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 498
2022-11-06 01:27:20,177 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:27:20,177 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.9222, Acc: 0.5075, ]
2022-11-06 01:27:21,570 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 100, n_lower: 373
2022-11-06 01:27:21,571 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 429
2022-11-06 01:27:21,572 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 499
2022-11-06 01:27:21,573 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 185
2022-11-06 01:27:21,573 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.8524, Acc: 0.4975, ]
2022-11-06 01:27:22,660 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 104, n_lower: 374
2022-11-06 01:27:22,662 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 429
2022-11-06 01:27:22,663 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 503
2022-11-06 01:27:22,663 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 188
2022-11-06 01:27:22,664 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.8231, Acc: 0.5050, ]
2022-11-06 01:27:23,774 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 106, n_lower: 374
2022-11-06 01:27:23,775 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 429
2022-11-06 01:27:23,775 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 512
2022-11-06 01:27:23,776 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 189
2022-11-06 01:27:23,777 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8381, Acc: 0.5175, ]
2022-11-06 01:27:25,012 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 107, n_lower: 375
2022-11-06 01:27:25,013 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 430
2022-11-06 01:27:25,013 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 523
2022-11-06 01:27:25,014 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 190
2022-11-06 01:27:25,015 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.7647, Acc: 0.5275, ]
2022-11-06 01:27:25,150 INFO: Epoch 4, Validation Step:

2022-11-06 01:28:19,187 INFO: [Test_acc of task 8 on test 0: 0.21320][acc of former classes: 0.73250][acc of former samples in all classes: 0.53750]
[acc of novel samples in all classes: 0.13212]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 01:28:20,543 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 108, n_lower: 375
2022-11-06 01:28:20,544 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 431
2022-11-06 01:28:20,545 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 524
2022-11-06 01:28:20,545 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 192
2022-11-06 01:28:20,546 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.7494, Acc: 0.5250, ]
2022-11-06 01:28:20,766 INFO: fine-tune procedure is finished!
2022-11-06 01:29:11,616 INFO: [Test_acc of task 8 on test 0: 0.21300][acc of former classes: 0.73250][acc of former samples in all classes: 0.53700]
[acc of novel samples in all classes: 0.13200]
2022-11-06 01:29:11,645 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:29:11,654 WARNING: Current net - loaded net:
2022-11-06 01:29:11,654 WARNING: Loaded net - current net:
2022-11-06 01:29:11,654 WARNING:   func.fc.bias
2022-11-06 01:29:11,654 WARNING:   func.fc.weight
2022-11-06 01:29:11,671 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth.
2022-11-06 01:29:11,693 INFO: Obtain parameters for train
2022-11-06 01:29:11,695 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:29:11,695 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:29:11,696 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:29:11,697 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:29:11,698 INFO: Model [MTNBModel] is created.
2022-11-06 01:29:11,710 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:29:12,276 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.7162, Acc: 0.8200, ]
2022-11-06 01:29:13,152 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 30, n_lower: 3
2022-11-06 01:29:13,153 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 1, n_lower: 15
2022-11-06 01:29:13,154 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 2, n_lower: 53
2022-11-06 01:29:13,155 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 62
2022-11-06 01:29:13,155 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5235, Acc: 0.8800, ]
2022-11-06 01:29:14,548 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 104, n_lower: 32
2022-11-06 01:29:14,549 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 4, n_lower: 37
2022-11-06 01:29:14,550 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 138
2022-11-06 01:29:14,551 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 6, n_lower: 183
2022-11-06 01:29:14,552 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5654, Acc: 0.8400, ]
2022-11-06 01:29:15,216 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 156, n_lower: 41
2022-11-06 01:29:15,217 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 4, n_lower: 74
2022-11-06 01:29:15,218 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 18, n_lower: 183
2022-11-06 01:29:15,219 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 24, n_lower: 257
2022-11-06 01:29:15,220 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5209, Acc: 0.8800, ]
2022-11-06 01:29:16,320 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 199, n_lower: 82
2022-11-06 01:29:16,321 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 5, n_lower: 106
2022-11-06 01:29:16,321 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 29, n_lower: 236
2022-11-06 01:29:16,322 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 24, n_lower: 371
2022-11-06 01:29:16,323 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5737, Acc: 0.7800, ]
2022-11-06 01:29:16,358 INFO: Epoch 4, Validation Step:

2022-11-06 01:29:34,216 INFO: [Test_acc of task 1 on test 1: 0.53500][acc of former classes: 0.72550][acc of former samples in all classes: 0.68100]
[acc of novel samples in all classes: 0.24300]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:29:35,055 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 241, n_lower: 87
2022-11-06 01:29:35,056 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 8, n_lower: 113
2022-11-06 01:29:35,057 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 32, n_lower: 249
2022-11-06 01:29:35,058 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 24, n_lower: 456
2022-11-06 01:29:35,059 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.2831, Acc: 0.8800, ]
2022-11-06 01:29:35,201 INFO: fine-tune procedure is finished!
2022-11-06 01:29:53,876 INFO: [Test_acc of task 1 on test 1: 0.53600][acc of former classes: 0.72600][acc of former samples in all classes: 0.68000]
[acc of novel samples in all classes: 0.24800]
2022-11-06 01:29:53,903 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:29:53,911 WARNING: Current net - loaded net:
2022-11-06 01:29:53,911 WARNING: Loaded net - current net:
2022-11-06 01:29:53,911 WARNING:   func.fc.bias
2022-11-06 01:29:53,911 WARNING:   func.fc.weight
2022-11-06 01:29:53,928 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_1.pth.
2022-11-06 01:29:53,950 INFO: Obtain parameters for train
2022-11-06 01:29:53,952 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:29:53,952 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:29:53,953 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:29:53,954 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:29:53,955 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:29:53,955 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:29:53,955 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:29:53,955 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:29:53,955 INFO: Model [MTNBModel] is created.
2022-11-06 01:29:53,968 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:29:53,980 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:29:54,770 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 81, n_lower: 69
2022-11-06 01:29:54,772 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 0, n_lower: 77
2022-11-06 01:29:54,772 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 191
2022-11-06 01:29:54,773 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 294
2022-11-06 01:29:54,774 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.2147, Acc: 0.6600, ]
2022-11-06 01:29:55,669 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 91, n_lower: 69
2022-11-06 01:29:55,670 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 0, n_lower: 81
2022-11-06 01:29:55,671 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 199
2022-11-06 01:29:55,672 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 354
2022-11-06 01:29:55,672 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.9150, Acc: 0.7200, ]
2022-11-06 01:29:56,504 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 122, n_lower: 74
2022-11-06 01:29:56,505 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 8, n_lower: 100
2022-11-06 01:29:56,506 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 11, n_lower: 255
2022-11-06 01:29:56,507 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 525
2022-11-06 01:29:56,508 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.1613, Acc: 0.6600, ]
2022-11-06 01:29:57,216 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 180, n_lower: 92
2022-11-06 01:29:57,218 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 28, n_lower: 113
2022-11-06 01:29:57,219 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 17, n_lower: 266
2022-11-06 01:29:57,220 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 14, n_lower: 558
2022-11-06 01:29:57,220 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.0499, Acc: 0.7100, ]
2022-11-06 01:29:57,911 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 123
2022-11-06 01:29:57,912 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 119
2022-11-06 01:29:57,913 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 17, n_lower: 323
2022-11-06 01:29:57,919 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 14, n_lower: 656
2022-11-06 01:29:57,920 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.0152, Acc: 0.6800, ]
2022-11-06 01:29:57,981 INFO: Epoch 4, Validation Step:

2022-11-06 01:30:19,693 INFO: [Test_acc of task 2 on test 1: 0.42675][acc of former classes: 0.72750][acc of former samples in all classes: 0.63800]
[acc of novel samples in all classes: 0.21550]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:30:20,289 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 389, n_lower: 280
2022-11-06 01:30:20,291 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 121, n_lower: 240
2022-11-06 01:30:20,291 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 17, n_lower: 329
2022-11-06 01:30:20,292 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 14, n_lower: 666
2022-11-06 01:30:20,293 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.7898, Acc: 0.7300, ]
2022-11-06 01:30:20,371 INFO: fine-tune procedure is finished!
2022-11-06 01:30:44,304 INFO: [Test_acc of task 2 on test 1: 0.42725][acc of former classes: 0.72750][acc of former samples in all classes: 0.63750]
[acc of novel samples in all classes: 0.21700]
2022-11-06 01:30:44,336 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:30:44,344 WARNING: Current net - loaded net:
2022-11-06 01:30:44,344 WARNING: Loaded net - current net:
2022-11-06 01:30:44,344 WARNING:   func.fc.bias
2022-11-06 01:30:44,344 WARNING:   func.fc.weight
2022-11-06 01:30:44,362 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_2.pth.
2022-11-06 01:30:44,387 INFO: Obtain parameters for train
2022-11-06 01:30:44,389 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:30:44,389 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:30:44,390 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:30:44,391 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:30:44,391 INFO: Model [MTNBModel] is created.
2022-11-06 01:30:44,403 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:30:44,417 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:30:44,428 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:30:44,984 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 150, n_lower: 210
2022-11-06 01:30:44,986 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 171
2022-11-06 01:30:44,986 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 13, n_lower: 273
2022-11-06 01:30:44,987 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 496
2022-11-06 01:30:44,988 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.2199, Acc: 0.7000, ]
2022-11-06 01:30:46,194 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 152, n_lower: 210
2022-11-06 01:30:46,195 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 41, n_lower: 171
2022-11-06 01:30:46,196 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 13, n_lower: 273
2022-11-06 01:30:46,197 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 500
2022-11-06 01:30:46,197 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.2451, Acc: 0.6533, ]
2022-11-06 01:30:47,310 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 161, n_lower: 211
2022-11-06 01:30:47,311 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 44, n_lower: 171
2022-11-06 01:30:47,312 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 13, n_lower: 274
2022-11-06 01:30:47,313 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 538
2022-11-06 01:30:47,313 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.2592, Acc: 0.6467, ]
2022-11-06 01:30:48,144 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 165, n_lower: 211
2022-11-06 01:30:48,145 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 44, n_lower: 174
2022-11-06 01:30:48,146 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 13, n_lower: 274
2022-11-06 01:30:48,147 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 547
2022-11-06 01:30:48,147 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.3299, Acc: 0.6533, ]
2022-11-06 01:30:49,019 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 172, n_lower: 212
2022-11-06 01:30:49,020 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 62, n_lower: 195
2022-11-06 01:30:49,021 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 274
2022-11-06 01:30:49,022 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 556
2022-11-06 01:30:49,023 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.2771, Acc: 0.6267, ]
2022-11-06 01:30:49,085 INFO: Epoch 4, Validation Step:

2022-11-06 01:31:20,719 INFO: [Test_acc of task 3 on test 1: 0.36320][acc of former classes: 0.72750][acc of former samples in all classes: 0.62200]
[acc of novel samples in all classes: 0.19067]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:31:21,867 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 173, n_lower: 216
2022-11-06 01:31:21,868 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 195
2022-11-06 01:31:21,869 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 17, n_lower: 275
2022-11-06 01:31:21,869 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 557
2022-11-06 01:31:21,870 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.1432, Acc: 0.6733, ]
2022-11-06 01:31:22,037 INFO: fine-tune procedure is finished!
2022-11-06 01:31:51,018 INFO: [Test_acc of task 3 on test 1: 0.36360][acc of former classes: 0.72850][acc of former samples in all classes: 0.62250]
[acc of novel samples in all classes: 0.19100]
2022-11-06 01:31:51,041 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:31:51,048 WARNING: Current net - loaded net:
2022-11-06 01:31:51,048 WARNING: Loaded net - current net:
2022-11-06 01:31:51,048 WARNING:   func.fc.bias
2022-11-06 01:31:51,048 WARNING:   func.fc.weight
2022-11-06 01:31:51,062 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_3.pth.
2022-11-06 01:31:51,085 INFO: Obtain parameters for train
2022-11-06 01:31:51,088 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:31:51,088 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:31:51,088 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:31:51,088 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:31:51,088 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:31:51,089 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:31:51,090 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:31:51,091 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:31:51,092 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:31:51,092 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:31:51,092 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:31:51,092 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:31:51,092 INFO: Model [MTNBModel] is created.
2022-11-06 01:31:51,112 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:31:51,131 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:31:51,149 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:31:51,164 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:31:52,129 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 146, n_lower: 212
2022-11-06 01:31:52,131 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 42, n_lower: 173
2022-11-06 01:31:52,131 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 9, n_lower: 277
2022-11-06 01:31:52,132 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 499
2022-11-06 01:31:52,133 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.4179, Acc: 0.6300, ]
2022-11-06 01:31:53,462 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 160, n_lower: 212
2022-11-06 01:31:53,463 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 207
2022-11-06 01:31:53,464 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 9, n_lower: 278
2022-11-06 01:31:53,465 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 499
2022-11-06 01:31:53,465 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.4127, Acc: 0.6450, ]
2022-11-06 01:31:54,474 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 162, n_lower: 212
2022-11-06 01:31:54,476 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 88, n_lower: 214
2022-11-06 01:31:54,477 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 18, n_lower: 301
2022-11-06 01:31:54,478 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 518
2022-11-06 01:31:54,478 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.3107, Acc: 0.6600, ]
2022-11-06 01:31:55,253 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 168, n_lower: 212
2022-11-06 01:31:55,254 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 112, n_lower: 263
2022-11-06 01:31:55,255 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 18, n_lower: 302
2022-11-06 01:31:55,256 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 526
2022-11-06 01:31:55,257 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.4842, Acc: 0.5850, ]
2022-11-06 01:31:56,197 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 182, n_lower: 215
2022-11-06 01:31:56,198 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 121, n_lower: 276
2022-11-06 01:31:56,199 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 30, n_lower: 335
2022-11-06 01:31:56,200 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 530
2022-11-06 01:31:56,201 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.3418, Acc: 0.6450, ]
2022-11-06 01:31:56,285 INFO: Epoch 4, Validation Step:

2022-11-06 01:32:31,086 INFO: [Test_acc of task 4 on test 1: 0.32133][acc of former classes: 0.73000][acc of former samples in all classes: 0.60250]
[acc of novel samples in all classes: 0.18075]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:32:31,987 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 184, n_lower: 215
2022-11-06 01:32:31,988 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 121, n_lower: 276
2022-11-06 01:32:31,989 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 30, n_lower: 336
2022-11-06 01:32:31,990 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 534
2022-11-06 01:32:31,991 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.1513, Acc: 0.6750, ]
2022-11-06 01:32:32,136 INFO: fine-tune procedure is finished!
2022-11-06 01:33:06,210 INFO: [Test_acc of task 4 on test 1: 0.32183][acc of former classes: 0.73150][acc of former samples in all classes: 0.60300]
[acc of novel samples in all classes: 0.18125]
2022-11-06 01:33:06,254 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:33:06,263 WARNING: Current net - loaded net:
2022-11-06 01:33:06,263 WARNING: Loaded net - current net:
2022-11-06 01:33:06,263 WARNING:   func.fc.bias
2022-11-06 01:33:06,263 WARNING:   func.fc.weight
2022-11-06 01:33:06,280 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_4.pth.
2022-11-06 01:33:06,301 INFO: Obtain parameters for train
2022-11-06 01:33:06,303 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:33:06,303 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:33:06,304 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:33:06,305 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:33:06,306 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:33:06,306 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:33:06,306 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:33:06,306 INFO: Model [MTNBModel] is created.
2022-11-06 01:33:06,320 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:33:06,333 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:33:06,347 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:33:06,452 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:33:06,464 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:33:07,097 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 142, n_lower: 214
2022-11-06 01:33:07,098 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 69, n_lower: 226
2022-11-06 01:33:07,099 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 13, n_lower: 314
2022-11-06 01:33:07,100 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 525
2022-11-06 01:33:07,100 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.5239, Acc: 0.5720, ]
2022-11-06 01:33:07,919 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 142, n_lower: 214
2022-11-06 01:33:07,921 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 84, n_lower: 228
2022-11-06 01:33:07,922 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 16, n_lower: 314
2022-11-06 01:33:07,922 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 525
2022-11-06 01:33:07,923 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.4167, Acc: 0.6360, ]
2022-11-06 01:33:08,871 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 142, n_lower: 215
2022-11-06 01:33:08,873 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 232
2022-11-06 01:33:08,873 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 324
2022-11-06 01:33:08,874 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 525
2022-11-06 01:33:08,875 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.4792, Acc: 0.5920, ]
2022-11-06 01:33:09,772 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 142, n_lower: 216
2022-11-06 01:33:09,773 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 90, n_lower: 238
2022-11-06 01:33:09,773 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 349
2022-11-06 01:33:09,774 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 525
2022-11-06 01:33:09,775 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.5171, Acc: 0.6160, ]
2022-11-06 01:33:10,872 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 185, n_lower: 225
2022-11-06 01:33:10,873 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 95, n_lower: 248
2022-11-06 01:33:10,874 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 363
2022-11-06 01:33:10,875 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 525
2022-11-06 01:33:10,875 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.5843, Acc: 0.6000, ]
2022-11-06 01:33:10,984 INFO: Epoch 4, Validation Step:

2022-11-06 01:33:50,916 INFO: [Test_acc of task 5 on test 1: 0.29014][acc of former classes: 0.73200][acc of former samples in all classes: 0.58500]
[acc of novel samples in all classes: 0.17220]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:33:52,144 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 189, n_lower: 225
2022-11-06 01:33:52,145 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 96, n_lower: 253
2022-11-06 01:33:52,146 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 27, n_lower: 379
2022-11-06 01:33:52,146 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 525
2022-11-06 01:33:52,147 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.3314, Acc: 0.6600, ]
2022-11-06 01:33:52,231 INFO: fine-tune procedure is finished!
2022-11-06 01:34:34,243 INFO: [Test_acc of task 5 on test 1: 0.28971][acc of former classes: 0.73050][acc of former samples in all classes: 0.58450]
[acc of novel samples in all classes: 0.17180]
2022-11-06 01:34:34,266 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:34:34,273 WARNING: Current net - loaded net:
2022-11-06 01:34:34,273 WARNING: Loaded net - current net:
2022-11-06 01:34:34,273 WARNING:   func.fc.bias
2022-11-06 01:34:34,273 WARNING:   func.fc.weight
2022-11-06 01:34:34,295 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_5.pth.
2022-11-06 01:34:34,317 INFO: Obtain parameters for train
2022-11-06 01:34:34,319 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:34:34,319 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:34:34,319 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:34:34,319 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:34:34,320 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:34:34,321 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:34:34,322 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:34:34,322 INFO: Model [MTNBModel] is created.
2022-11-06 01:34:34,350 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:34:34,404 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:34:34,479 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:34:34,496 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:34:34,513 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:34:34,530 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:34:35,450 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 141, n_lower: 223
2022-11-06 01:34:35,451 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 90, n_lower: 246
2022-11-06 01:34:35,452 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 19, n_lower: 368
2022-11-06 01:34:35,453 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:34:35,453 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.6514, Acc: 0.5633, ]
2022-11-06 01:34:36,500 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 143, n_lower: 223
2022-11-06 01:34:36,501 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 255
2022-11-06 01:34:36,502 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 371
2022-11-06 01:34:36,503 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:34:36,504 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.7154, Acc: 0.5467, ]
2022-11-06 01:34:38,244 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 169, n_lower: 225
2022-11-06 01:34:38,246 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 268
2022-11-06 01:34:38,246 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 386
2022-11-06 01:34:38,247 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:34:38,248 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.6538, Acc: 0.5667, ]
2022-11-06 01:34:39,454 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 225, n_lower: 242
2022-11-06 01:34:39,455 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 271
2022-11-06 01:34:39,456 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 398
2022-11-06 01:34:39,457 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:34:39,458 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.6529, Acc: 0.5633, ]
2022-11-06 01:34:40,575 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 249, n_lower: 266
2022-11-06 01:34:40,576 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 280
2022-11-06 01:34:40,577 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 21, n_lower: 404
2022-11-06 01:34:40,578 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:34:40,579 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.7415, Acc: 0.5500, ]
2022-11-06 01:34:40,712 INFO: Epoch 4, Validation Step:

2022-11-06 01:35:26,057 INFO: [Test_acc of task 6 on test 1: 0.25712][acc of former classes: 0.72900][acc of former samples in all classes: 0.56650]
[acc of novel samples in all classes: 0.15400]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:35:27,148 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 318, n_lower: 284
2022-11-06 01:35:27,149 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 280
2022-11-06 01:35:27,150 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 21, n_lower: 404
2022-11-06 01:35:27,151 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:35:27,152 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.5113, Acc: 0.5933, ]
2022-11-06 01:35:27,430 INFO: fine-tune procedure is finished!
2022-11-06 01:36:13,176 INFO: [Test_acc of task 6 on test 1: 0.25750][acc of former classes: 0.72900][acc of former samples in all classes: 0.56750]
[acc of novel samples in all classes: 0.15417]
2022-11-06 01:36:13,200 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:36:13,208 WARNING: Current net - loaded net:
2022-11-06 01:36:13,208 WARNING: Loaded net - current net:
2022-11-06 01:36:13,208 WARNING:   func.fc.bias
2022-11-06 01:36:13,208 WARNING:   func.fc.weight
2022-11-06 01:36:13,222 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_6.pth.
2022-11-06 01:36:13,244 INFO: Obtain parameters for train
2022-11-06 01:36:13,246 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:36:13,247 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:36:13,248 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:36:13,249 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:36:13,250 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:36:13,250 INFO: Model [MTNBModel] is created.
2022-11-06 01:36:13,340 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:36:13,361 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:36:13,374 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:36:13,386 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:36:13,398 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:36:13,410 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:36:13,421 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:36:14,260 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 187, n_lower: 277
2022-11-06 01:36:14,261 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 73, n_lower: 255
2022-11-06 01:36:14,262 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 13, n_lower: 394
2022-11-06 01:36:14,262 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:36:14,263 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.7709, Acc: 0.5429, ]
2022-11-06 01:36:15,403 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 189, n_lower: 279
2022-11-06 01:36:15,404 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 73, n_lower: 255
2022-11-06 01:36:15,405 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 13, n_lower: 397
2022-11-06 01:36:15,406 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:36:15,407 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.7510, Acc: 0.5486, ]
2022-11-06 01:36:16,409 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 201, n_lower: 298
2022-11-06 01:36:16,411 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 74, n_lower: 264
2022-11-06 01:36:16,411 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 412
2022-11-06 01:36:16,412 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:36:16,413 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.7524, Acc: 0.5571, ]
2022-11-06 01:36:17,255 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 210, n_lower: 304
2022-11-06 01:36:17,256 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 78, n_lower: 266
2022-11-06 01:36:17,256 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 460
2022-11-06 01:36:17,257 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:36:17,258 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.7976, Acc: 0.5657, ]
2022-11-06 01:36:18,115 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 213, n_lower: 304
2022-11-06 01:36:18,116 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 78, n_lower: 271
2022-11-06 01:36:18,117 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 15, n_lower: 462
2022-11-06 01:36:18,118 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:36:18,119 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.7580, Acc: 0.5571, ]
2022-11-06 01:36:18,307 INFO: Epoch 4, Validation Step:

2022-11-06 01:37:09,071 INFO: [Test_acc of task 7 on test 1: 0.23911][acc of former classes: 0.72950][acc of former samples in all classes: 0.54650]
[acc of novel samples in all classes: 0.15129]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:37:10,633 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 216, n_lower: 312
2022-11-06 01:37:10,634 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 78, n_lower: 276
2022-11-06 01:37:10,635 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 15, n_lower: 463
2022-11-06 01:37:10,636 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:37:10,637 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.6901, Acc: 0.5714, ]
2022-11-06 01:37:10,747 INFO: fine-tune procedure is finished!
2022-11-06 01:38:02,771 INFO: [Test_acc of task 7 on test 1: 0.23922][acc of former classes: 0.72900][acc of former samples in all classes: 0.54600]
[acc of novel samples in all classes: 0.15157]
2022-11-06 01:38:02,802 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:38:02,811 WARNING: Current net - loaded net:
2022-11-06 01:38:02,811 WARNING: Loaded net - current net:
2022-11-06 01:38:02,811 WARNING:   func.fc.bias
2022-11-06 01:38:02,811 WARNING:   func.fc.weight
2022-11-06 01:38:02,828 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_7.pth.
2022-11-06 01:38:02,852 INFO: Obtain parameters for train
2022-11-06 01:38:02,854 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:38:02,854 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:38:02,855 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:38:02,856 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:38:02,857 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:38:02,857 INFO: Model [MTNBModel] is created.
2022-11-06 01:38:02,872 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:38:02,885 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:38:02,902 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:38:02,915 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:38:03,187 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:38:03,211 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:38:03,228 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:38:03,245 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 01:38:04,332 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 182, n_lower: 284
2022-11-06 01:38:04,333 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 82, n_lower: 267
2022-11-06 01:38:04,334 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 15, n_lower: 450
2022-11-06 01:38:04,334 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:38:04,335 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 2.0454, Acc: 0.4800, ]
2022-11-06 01:38:05,135 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 182, n_lower: 284
2022-11-06 01:38:05,136 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 83, n_lower: 267
2022-11-06 01:38:05,137 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 17, n_lower: 454
2022-11-06 01:38:05,138 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:38:05,139 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.9482, Acc: 0.4925, ]
2022-11-06 01:38:06,406 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 227, n_lower: 289
2022-11-06 01:38:06,407 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 91, n_lower: 269
2022-11-06 01:38:06,408 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 19, n_lower: 468
2022-11-06 01:38:06,409 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:38:06,410 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.8854, Acc: 0.5000, ]
2022-11-06 01:38:08,005 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 236, n_lower: 291
2022-11-06 01:38:08,007 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 91, n_lower: 278
2022-11-06 01:38:08,008 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 472
2022-11-06 01:38:08,009 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:38:08,009 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8840, Acc: 0.5150, ]
2022-11-06 01:38:09,036 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 243, n_lower: 301
2022-11-06 01:38:09,037 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 91, n_lower: 279
2022-11-06 01:38:09,037 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 472
2022-11-06 01:38:09,038 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:38:09,039 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.9772, Acc: 0.5225, ]
2022-11-06 01:38:09,177 INFO: Epoch 4, Validation Step:

2022-11-06 01:39:04,114 INFO: [Test_acc of task 8 on test 1: 0.22080][acc of former classes: 0.72800][acc of former samples in all classes: 0.53850]
[acc of novel samples in all classes: 0.14138]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 01:39:05,291 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 246, n_lower: 309
2022-11-06 01:39:05,292 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 91, n_lower: 280
2022-11-06 01:39:05,293 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 20, n_lower: 479
2022-11-06 01:39:05,293 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 523
2022-11-06 01:39:05,294 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.8055, Acc: 0.5675, ]
2022-11-06 01:39:05,396 INFO: fine-tune procedure is finished!
2022-11-06 01:40:02,339 INFO: [Test_acc of task 8 on test 1: 0.22100][acc of former classes: 0.72800][acc of former samples in all classes: 0.53850]
[acc of novel samples in all classes: 0.14163]
2022-11-06 01:40:02,373 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:40:02,381 WARNING: Current net - loaded net:
2022-11-06 01:40:02,381 WARNING: Loaded net - current net:
2022-11-06 01:40:02,381 WARNING:   func.fc.bias
2022-11-06 01:40:02,381 WARNING:   func.fc.weight
2022-11-06 01:40:02,396 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth.
2022-11-06 01:40:02,415 INFO: Obtain parameters for train
2022-11-06 01:40:02,417 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:40:02,417 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:40:02,417 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:40:02,417 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:40:02,417 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:40:02,417 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:40:02,418 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:40:02,419 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:40:02,420 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:40:02,420 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:40:02,420 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:40:02,420 INFO: Model [MTNBModel] is created.
2022-11-06 01:40:02,433 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:40:02,960 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 0, n_lower: 7
2022-11-06 01:40:02,962 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.1243, Acc: 0.7200, ]
2022-11-06 01:40:03,722 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 4, n_lower: 20
2022-11-06 01:40:03,723 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 1, n_lower: 4
2022-11-06 01:40:03,724 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 5, n_lower: 39
2022-11-06 01:40:03,724 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 2
2022-11-06 01:40:03,725 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.8180, Acc: 0.7000, ]
2022-11-06 01:40:04,385 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 304, n_lower: 797
2022-11-06 01:40:04,386 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 139, n_lower: 313
2022-11-06 01:40:04,386 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 145, n_lower: 566
2022-11-06 01:40:04,387 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 153
2022-11-06 01:40:04,388 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6394, Acc: 0.7400, ]
2022-11-06 01:40:05,103 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 318, n_lower: 832
2022-11-06 01:40:05,104 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 139, n_lower: 330
2022-11-06 01:40:05,105 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 145, n_lower: 593
2022-11-06 01:40:05,105 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 289
2022-11-06 01:40:05,106 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.7577, Acc: 0.7600, ]
2022-11-06 01:40:06,097 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 320, n_lower: 836
2022-11-06 01:40:06,099 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 139, n_lower: 330
2022-11-06 01:40:06,099 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 151, n_lower: 600
2022-11-06 01:40:06,100 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 289
2022-11-06 01:40:06,101 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5919, Acc: 0.7800, ]
2022-11-06 01:40:06,137 INFO: Epoch 4, Validation Step:

2022-11-06 01:40:24,228 INFO: [Test_acc of task 1 on test 2: 0.52767][acc of former classes: 0.73450][acc of former samples in all classes: 0.66650]
[acc of novel samples in all classes: 0.25000]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:40:25,004 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 336, n_lower: 849
2022-11-06 01:40:25,005 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 145, n_lower: 344
2022-11-06 01:40:25,006 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 151, n_lower: 619
2022-11-06 01:40:25,007 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 20, n_lower: 356
2022-11-06 01:40:25,008 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4522, Acc: 0.8000, ]
2022-11-06 01:40:25,243 INFO: fine-tune procedure is finished!
2022-11-06 01:40:43,331 INFO: [Test_acc of task 1 on test 2: 0.52767][acc of former classes: 0.73550][acc of former samples in all classes: 0.66650]
[acc of novel samples in all classes: 0.25000]
2022-11-06 01:40:43,436 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:40:43,443 WARNING: Current net - loaded net:
2022-11-06 01:40:43,444 WARNING: Loaded net - current net:
2022-11-06 01:40:43,444 WARNING:   func.fc.bias
2022-11-06 01:40:43,444 WARNING:   func.fc.weight
2022-11-06 01:40:43,457 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_1.pth.
2022-11-06 01:40:43,477 INFO: Obtain parameters for train
2022-11-06 01:40:43,479 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:40:43,479 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:40:43,480 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:40:43,481 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:40:43,481 INFO: Model [MTNBModel] is created.
2022-11-06 01:40:43,494 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:40:43,503 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:40:44,113 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 102, n_lower: 488
2022-11-06 01:40:44,114 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 51, n_lower: 214
2022-11-06 01:40:44,115 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 364
2022-11-06 01:40:44,116 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 281
2022-11-06 01:40:44,117 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.1162, Acc: 0.7300, ]
2022-11-06 01:40:44,814 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 102, n_lower: 490
2022-11-06 01:40:44,815 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 55, n_lower: 218
2022-11-06 01:40:44,816 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 365
2022-11-06 01:40:44,817 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 296
2022-11-06 01:40:44,817 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.0210, Acc: 0.7200, ]
2022-11-06 01:40:45,928 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 127, n_lower: 502
2022-11-06 01:40:45,929 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 56, n_lower: 224
2022-11-06 01:40:45,930 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 397
2022-11-06 01:40:45,931 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 353
2022-11-06 01:40:45,932 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.1069, Acc: 0.6600, ]
2022-11-06 01:40:46,632 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 131, n_lower: 519
2022-11-06 01:40:46,633 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 356
2022-11-06 01:40:46,634 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 399
2022-11-06 01:40:46,635 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 377
2022-11-06 01:40:46,635 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.0757, Acc: 0.6600, ]
2022-11-06 01:40:47,686 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 140, n_lower: 528
2022-11-06 01:40:47,687 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 363
2022-11-06 01:40:47,687 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 430
2022-11-06 01:40:47,688 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 407
2022-11-06 01:40:47,689 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.1147, Acc: 0.6700, ]
2022-11-06 01:40:47,730 INFO: Epoch 4, Validation Step:

2022-11-06 01:41:10,876 INFO: [Test_acc of task 2 on test 2: 0.41700][acc of former classes: 0.73200][acc of former samples in all classes: 0.62050]
[acc of novel samples in all classes: 0.21350]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:41:12,022 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 143, n_lower: 541
2022-11-06 01:41:12,023 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 365
2022-11-06 01:41:12,023 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 434
2022-11-06 01:41:12,024 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 424
2022-11-06 01:41:12,025 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.9671, Acc: 0.7300, ]
2022-11-06 01:41:12,194 INFO: fine-tune procedure is finished!
2022-11-06 01:41:36,688 INFO: [Test_acc of task 2 on test 2: 0.41675][acc of former classes: 0.73200][acc of former samples in all classes: 0.62000]
[acc of novel samples in all classes: 0.21350]
2022-11-06 01:41:36,718 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:41:36,726 WARNING: Current net - loaded net:
2022-11-06 01:41:36,726 WARNING: Loaded net - current net:
2022-11-06 01:41:36,726 WARNING:   func.fc.bias
2022-11-06 01:41:36,726 WARNING:   func.fc.weight
2022-11-06 01:41:36,740 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_2.pth.
2022-11-06 01:41:36,760 INFO: Obtain parameters for train
2022-11-06 01:41:36,762 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:41:36,762 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:41:36,763 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:41:36,764 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:41:36,765 INFO: Model [MTNBModel] is created.
2022-11-06 01:41:36,782 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:41:36,798 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:41:36,815 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:41:37,544 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 112, n_lower: 525
2022-11-06 01:41:37,545 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 56, n_lower: 320
2022-11-06 01:41:37,546 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 425
2022-11-06 01:41:37,547 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 385
2022-11-06 01:41:37,547 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.4811, Acc: 0.6000, ]
2022-11-06 01:41:38,328 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 115, n_lower: 528
2022-11-06 01:41:38,329 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 56, n_lower: 324
2022-11-06 01:41:38,330 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 428
2022-11-06 01:41:38,331 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 393
2022-11-06 01:41:38,332 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.4650, Acc: 0.6133, ]
2022-11-06 01:41:39,092 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 115, n_lower: 532
2022-11-06 01:41:39,093 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 56, n_lower: 326
2022-11-06 01:41:39,094 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 431
2022-11-06 01:41:39,095 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 414
2022-11-06 01:41:39,096 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.2879, Acc: 0.6600, ]
2022-11-06 01:41:39,975 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 539
2022-11-06 01:41:39,976 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 58, n_lower: 333
2022-11-06 01:41:39,977 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 431
2022-11-06 01:41:39,978 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 424
2022-11-06 01:41:39,979 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.1460, Acc: 0.7000, ]
2022-11-06 01:41:40,768 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 541
2022-11-06 01:41:40,769 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 58, n_lower: 334
2022-11-06 01:41:40,770 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 435
2022-11-06 01:41:40,771 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 442
2022-11-06 01:41:40,771 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.2956, Acc: 0.6333, ]
2022-11-06 01:41:40,847 INFO: Epoch 4, Validation Step:

2022-11-06 01:42:10,724 INFO: [Test_acc of task 3 on test 2: 0.35200][acc of former classes: 0.73150][acc of former samples in all classes: 0.59950]
[acc of novel samples in all classes: 0.18700]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:42:11,367 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 198, n_lower: 576
2022-11-06 01:42:11,368 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 371
2022-11-06 01:42:11,369 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 437
2022-11-06 01:42:11,370 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 451
2022-11-06 01:42:11,371 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.0697, Acc: 0.6800, ]
2022-11-06 01:42:11,464 INFO: fine-tune procedure is finished!
2022-11-06 01:42:37,673 INFO: [Test_acc of task 3 on test 2: 0.35160][acc of former classes: 0.73350][acc of former samples in all classes: 0.59950]
[acc of novel samples in all classes: 0.18633]
2022-11-06 01:42:37,702 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:42:37,711 WARNING: Current net - loaded net:
2022-11-06 01:42:37,711 WARNING: Loaded net - current net:
2022-11-06 01:42:37,711 WARNING:   func.fc.bias
2022-11-06 01:42:37,711 WARNING:   func.fc.weight
2022-11-06 01:42:37,729 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_3.pth.
2022-11-06 01:42:37,755 INFO: Obtain parameters for train
2022-11-06 01:42:37,757 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:42:37,757 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:42:37,758 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:42:37,759 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:42:37,760 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:42:37,760 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:42:37,760 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:42:37,760 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:42:37,760 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:42:37,760 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:42:37,760 INFO: Model [MTNBModel] is created.
2022-11-06 01:42:37,774 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:42:37,786 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:42:37,799 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:42:37,812 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:42:38,540 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 124, n_lower: 563
2022-11-06 01:42:38,542 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 57, n_lower: 355
2022-11-06 01:42:38,542 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 435
2022-11-06 01:42:38,543 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 419
2022-11-06 01:42:38,544 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.5375, Acc: 0.5950, ]
2022-11-06 01:42:39,543 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 563
2022-11-06 01:42:39,544 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 57, n_lower: 355
2022-11-06 01:42:39,545 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 437
2022-11-06 01:42:39,546 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 423
2022-11-06 01:42:39,546 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.4893, Acc: 0.6150, ]
2022-11-06 01:42:40,434 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 568
2022-11-06 01:42:40,435 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 59, n_lower: 376
2022-11-06 01:42:40,436 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 438
2022-11-06 01:42:40,437 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 423
2022-11-06 01:42:40,438 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.4679, Acc: 0.5500, ]
2022-11-06 01:42:41,472 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 569
2022-11-06 01:42:41,474 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 383
2022-11-06 01:42:41,475 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 439
2022-11-06 01:42:41,476 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 431
2022-11-06 01:42:41,476 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.3798, Acc: 0.6250, ]
2022-11-06 01:42:43,051 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 570
2022-11-06 01:42:43,052 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 423
2022-11-06 01:42:43,053 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 439
2022-11-06 01:42:43,054 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 432
2022-11-06 01:42:43,055 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.3342, Acc: 0.6150, ]
2022-11-06 01:42:43,128 INFO: Epoch 4, Validation Step:

2022-11-06 01:43:19,586 INFO: [Test_acc of task 4 on test 2: 0.30817][acc of former classes: 0.73250][acc of former samples in all classes: 0.57450]
[acc of novel samples in all classes: 0.17500]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:43:20,566 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 136, n_lower: 571
2022-11-06 01:43:20,567 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 70, n_lower: 442
2022-11-06 01:43:20,568 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 444
2022-11-06 01:43:20,569 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 432
2022-11-06 01:43:20,569 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.2726, Acc: 0.6550, ]
2022-11-06 01:43:20,674 INFO: fine-tune procedure is finished!
2022-11-06 01:43:56,483 INFO: [Test_acc of task 4 on test 2: 0.30833][acc of former classes: 0.73300][acc of former samples in all classes: 0.57500]
[acc of novel samples in all classes: 0.17500]
2022-11-06 01:43:56,508 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:43:56,515 WARNING: Current net - loaded net:
2022-11-06 01:43:56,515 WARNING: Loaded net - current net:
2022-11-06 01:43:56,515 WARNING:   func.fc.bias
2022-11-06 01:43:56,515 WARNING:   func.fc.weight
2022-11-06 01:43:56,530 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_4.pth.
2022-11-06 01:43:56,552 INFO: Obtain parameters for train
2022-11-06 01:43:56,555 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:43:56,555 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:43:56,556 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:43:56,557 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:43:56,558 INFO: Model [MTNBModel] is created.
2022-11-06 01:43:56,650 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:43:56,667 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:43:56,684 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:43:56,700 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:43:56,711 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:43:57,533 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 126, n_lower: 565
2022-11-06 01:43:57,534 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 403
2022-11-06 01:43:57,535 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 34, n_lower: 450
2022-11-06 01:43:57,535 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:43:57,536 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.6031, Acc: 0.5400, ]
2022-11-06 01:43:58,419 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 126, n_lower: 565
2022-11-06 01:43:58,420 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 69, n_lower: 413
2022-11-06 01:43:58,421 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 470
2022-11-06 01:43:58,422 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:43:58,422 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.5598, Acc: 0.5960, ]
2022-11-06 01:43:59,345 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 126, n_lower: 565
2022-11-06 01:43:59,346 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 70, n_lower: 420
2022-11-06 01:43:59,347 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 485
2022-11-06 01:43:59,348 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:43:59,349 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.4862, Acc: 0.5920, ]
2022-11-06 01:44:00,662 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 150, n_lower: 576
2022-11-06 01:44:00,663 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 74, n_lower: 438
2022-11-06 01:44:00,663 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 46, n_lower: 527
2022-11-06 01:44:00,664 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:44:00,665 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.5063, Acc: 0.5640, ]
2022-11-06 01:44:01,713 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 161, n_lower: 581
2022-11-06 01:44:01,714 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 74, n_lower: 438
2022-11-06 01:44:01,715 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 48, n_lower: 529
2022-11-06 01:44:01,715 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:44:01,716 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.4753, Acc: 0.5920, ]
2022-11-06 01:44:01,834 INFO: Epoch 4, Validation Step:

2022-11-06 01:44:43,136 INFO: [Test_acc of task 5 on test 2: 0.27943][acc of former classes: 0.73350][acc of former samples in all classes: 0.55950]
[acc of novel samples in all classes: 0.16740]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:44:44,280 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 187, n_lower: 602
2022-11-06 01:44:44,281 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 441
2022-11-06 01:44:44,282 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 50, n_lower: 550
2022-11-06 01:44:44,283 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:44:44,289 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.4411, Acc: 0.6120, ]
2022-11-06 01:44:44,399 INFO: fine-tune procedure is finished!
2022-11-06 01:45:25,986 INFO: [Test_acc of task 5 on test 2: 0.27957][acc of former classes: 0.73300][acc of former samples in all classes: 0.55950]
[acc of novel samples in all classes: 0.16760]
2022-11-06 01:45:26,012 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:45:26,020 WARNING: Current net - loaded net:
2022-11-06 01:45:26,020 WARNING: Loaded net - current net:
2022-11-06 01:45:26,020 WARNING:   func.fc.bias
2022-11-06 01:45:26,020 WARNING:   func.fc.weight
2022-11-06 01:45:26,035 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_5.pth.
2022-11-06 01:45:26,053 INFO: Obtain parameters for train
2022-11-06 01:45:26,055 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:45:26,055 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:45:26,056 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:45:26,057 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:45:26,058 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:45:26,058 INFO: Model [MTNBModel] is created.
2022-11-06 01:45:26,069 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:45:26,079 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:45:26,090 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:45:26,100 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:45:26,110 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:45:26,122 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:45:26,866 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 151, n_lower: 587
2022-11-06 01:45:26,867 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 415
2022-11-06 01:45:26,868 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 521
2022-11-06 01:45:26,869 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:45:26,869 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.6958, Acc: 0.5567, ]
2022-11-06 01:45:28,869 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 161, n_lower: 594
2022-11-06 01:45:28,870 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 415
2022-11-06 01:45:28,871 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 522
2022-11-06 01:45:28,872 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:45:28,873 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.7242, Acc: 0.5633, ]
2022-11-06 01:45:29,938 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 169, n_lower: 603
2022-11-06 01:45:29,939 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 62, n_lower: 439
2022-11-06 01:45:29,940 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 529
2022-11-06 01:45:29,941 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:45:29,941 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.7118, Acc: 0.5367, ]
2022-11-06 01:45:31,510 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 186, n_lower: 621
2022-11-06 01:45:31,512 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 442
2022-11-06 01:45:31,513 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 535
2022-11-06 01:45:31,514 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:45:31,514 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.6493, Acc: 0.5333, ]
2022-11-06 01:45:32,725 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 190, n_lower: 622
2022-11-06 01:45:32,726 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 464
2022-11-06 01:45:32,727 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 535
2022-11-06 01:45:32,728 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:45:32,729 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.6150, Acc: 0.5600, ]
2022-11-06 01:45:32,862 INFO: Epoch 4, Validation Step:

2022-11-06 01:46:16,924 INFO: [Test_acc of task 6 on test 2: 0.24750][acc of former classes: 0.73200][acc of former samples in all classes: 0.54350]
[acc of novel samples in all classes: 0.14883]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:46:18,147 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 196, n_lower: 623
2022-11-06 01:46:18,148 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 465
2022-11-06 01:46:18,148 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 547
2022-11-06 01:46:18,149 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:46:18,150 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.6184, Acc: 0.5533, ]
2022-11-06 01:46:18,680 INFO: fine-tune procedure is finished!
2022-11-06 01:47:03,417 INFO: [Test_acc of task 6 on test 2: 0.24750][acc of former classes: 0.73200][acc of former samples in all classes: 0.54350]
[acc of novel samples in all classes: 0.14883]
2022-11-06 01:47:03,503 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:47:03,511 WARNING: Current net - loaded net:
2022-11-06 01:47:03,511 WARNING: Loaded net - current net:
2022-11-06 01:47:03,511 WARNING:   func.fc.bias
2022-11-06 01:47:03,511 WARNING:   func.fc.weight
2022-11-06 01:47:03,526 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_6.pth.
2022-11-06 01:47:03,550 INFO: Obtain parameters for train
2022-11-06 01:47:03,552 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:47:03,552 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:47:03,552 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:47:03,552 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:47:03,552 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:47:03,552 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:47:03,552 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:47:03,552 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:47:03,553 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:47:03,554 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:47:03,555 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:47:03,556 INFO: Model [MTNBModel] is created.
2022-11-06 01:47:03,573 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:47:03,588 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:47:03,605 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:47:03,621 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:47:03,635 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:47:03,730 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:47:03,743 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:47:04,699 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 136, n_lower: 605
2022-11-06 01:47:04,700 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 434
2022-11-06 01:47:04,701 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 36, n_lower: 536
2022-11-06 01:47:04,702 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:47:04,703 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.9065, Acc: 0.4943, ]
2022-11-06 01:47:05,790 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 136, n_lower: 605
2022-11-06 01:47:05,791 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 446
2022-11-06 01:47:05,792 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 36, n_lower: 543
2022-11-06 01:47:05,793 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:47:05,793 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.9151, Acc: 0.5000, ]
2022-11-06 01:47:06,876 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 143, n_lower: 608
2022-11-06 01:47:06,877 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 465
2022-11-06 01:47:06,877 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 570
2022-11-06 01:47:06,878 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:47:06,879 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.8975, Acc: 0.4886, ]
2022-11-06 01:47:07,824 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 156, n_lower: 611
2022-11-06 01:47:07,825 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 471
2022-11-06 01:47:07,826 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 581
2022-11-06 01:47:07,827 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 423
2022-11-06 01:47:07,828 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8877, Acc: 0.5257, ]
2022-11-06 01:47:08,714 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 161, n_lower: 612
2022-11-06 01:47:08,715 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 66, n_lower: 473
2022-11-06 01:47:08,716 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 606
2022-11-06 01:47:08,717 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 425
2022-11-06 01:47:08,718 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.8115, Acc: 0.5314, ]
2022-11-06 01:47:08,883 INFO: Epoch 4, Validation Step:

2022-11-06 01:47:59,442 INFO: [Test_acc of task 7 on test 2: 0.23056][acc of former classes: 0.73100][acc of former samples in all classes: 0.51850]
[acc of novel samples in all classes: 0.14829]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:48:00,370 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 169, n_lower: 615
2022-11-06 01:48:00,371 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 66, n_lower: 473
2022-11-06 01:48:00,372 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 610
2022-11-06 01:48:00,372 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 425
2022-11-06 01:48:00,373 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.7254, Acc: 0.5286, ]
2022-11-06 01:48:00,592 INFO: fine-tune procedure is finished!
2022-11-06 01:48:50,374 INFO: [Test_acc of task 7 on test 2: 0.23056][acc of former classes: 0.73150][acc of former samples in all classes: 0.51850]
[acc of novel samples in all classes: 0.14829]
2022-11-06 01:48:50,403 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:48:50,411 WARNING: Current net - loaded net:
2022-11-06 01:48:50,411 WARNING: Loaded net - current net:
2022-11-06 01:48:50,411 WARNING:   func.fc.bias
2022-11-06 01:48:50,411 WARNING:   func.fc.weight
2022-11-06 01:48:50,426 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_7.pth.
2022-11-06 01:48:50,447 INFO: Obtain parameters for train
2022-11-06 01:48:50,449 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:48:50,449 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:48:50,449 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:48:50,449 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:48:50,449 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:48:50,449 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:48:50,449 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:48:50,450 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:48:50,451 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:48:50,452 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:48:50,452 INFO: Model [MTNBModel] is created.
2022-11-06 01:48:50,466 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:48:50,477 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:48:50,489 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:48:50,502 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:48:50,514 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:48:50,526 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:48:50,537 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:48:50,548 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 01:48:51,269 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 155, n_lower: 611
2022-11-06 01:48:51,270 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 459
2022-11-06 01:48:51,270 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 597
2022-11-06 01:48:51,271 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:48:51,272 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.9314, Acc: 0.5150, ]
2022-11-06 01:48:52,279 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 159, n_lower: 612
2022-11-06 01:48:52,280 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 462
2022-11-06 01:48:52,281 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 600
2022-11-06 01:48:52,282 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:48:52,283 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.9891, Acc: 0.4975, ]
2022-11-06 01:48:53,563 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 167, n_lower: 622
2022-11-06 01:48:53,564 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 462
2022-11-06 01:48:53,565 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 46, n_lower: 610
2022-11-06 01:48:53,566 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 420
2022-11-06 01:48:53,566 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 2.0187, Acc: 0.5050, ]
2022-11-06 01:48:54,563 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 167, n_lower: 623
2022-11-06 01:48:54,565 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 467
2022-11-06 01:48:54,566 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 610
2022-11-06 01:48:54,567 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:48:54,568 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8949, Acc: 0.5250, ]
2022-11-06 01:48:55,732 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 169, n_lower: 630
2022-11-06 01:48:55,733 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 471
2022-11-06 01:48:55,734 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 613
2022-11-06 01:48:55,735 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:48:55,735 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.9874, Acc: 0.5125, ]
2022-11-06 01:48:55,895 INFO: Epoch 4, Validation Step:

2022-11-06 01:49:48,000 INFO: [Test_acc of task 8 on test 2: 0.21400][acc of former classes: 0.73050][acc of former samples in all classes: 0.50900]
[acc of novel samples in all classes: 0.14025]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 01:49:48,776 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 170, n_lower: 630
2022-11-06 01:49:48,777 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 472
2022-11-06 01:49:48,778 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 615
2022-11-06 01:49:48,779 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 7, n_lower: 422
2022-11-06 01:49:48,779 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.8169, Acc: 0.5425, ]
2022-11-06 01:49:48,857 INFO: fine-tune procedure is finished!
2022-11-06 01:50:44,935 INFO: [Test_acc of task 8 on test 2: 0.21380][acc of former classes: 0.73000][acc of former samples in all classes: 0.50850]
[acc of novel samples in all classes: 0.14012]
2022-11-06 01:50:44,962 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:50:44,969 WARNING: Current net - loaded net:
2022-11-06 01:50:44,969 WARNING: Loaded net - current net:
2022-11-06 01:50:44,970 WARNING:   func.fc.bias
2022-11-06 01:50:44,970 WARNING:   func.fc.weight
2022-11-06 01:50:44,983 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth.
2022-11-06 01:50:45,003 INFO: Obtain parameters for train
2022-11-06 01:50:45,005 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:50:45,005 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:50:45,006 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:50:45,007 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:50:45,008 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:50:45,008 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:50:45,008 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:50:45,008 INFO: Model [MTNBModel] is created.
2022-11-06 01:50:45,020 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:50:45,631 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.1107, Acc: 0.7000, ]
2022-11-06 01:50:46,293 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 105, n_lower: 113
2022-11-06 01:50:46,295 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 34, n_lower: 64
2022-11-06 01:50:46,296 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 8, n_lower: 137
2022-11-06 01:50:46,297 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 38
2022-11-06 01:50:46,297 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.0895, Acc: 0.7200, ]
2022-11-06 01:50:47,353 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 306, n_lower: 524
2022-11-06 01:50:47,354 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 76, n_lower: 276
2022-11-06 01:50:47,355 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 43, n_lower: 395
2022-11-06 01:50:47,355 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 57
2022-11-06 01:50:47,356 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.8707, Acc: 0.7200, ]
2022-11-06 01:50:48,151 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 551, n_lower: 654
2022-11-06 01:50:48,152 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 124, n_lower: 405
2022-11-06 01:50:48,153 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 77, n_lower: 556
2022-11-06 01:50:48,153 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 97
2022-11-06 01:50:48,154 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.9708, Acc: 0.7200, ]
2022-11-06 01:50:48,906 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 694, n_lower: 701
2022-11-06 01:50:48,907 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 141, n_lower: 457
2022-11-06 01:50:48,908 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 88, n_lower: 691
2022-11-06 01:50:48,909 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 100
2022-11-06 01:50:48,910 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.7227, Acc: 0.8200, ]
2022-11-06 01:50:48,938 INFO: Epoch 4, Validation Step:

2022-11-06 01:51:06,252 INFO: [Test_acc of task 1 on test 3: 0.52500][acc of former classes: 0.72750][acc of former samples in all classes: 0.67450]
[acc of novel samples in all classes: 0.22600]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 01:51:06,978 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 760, n_lower: 740
2022-11-06 01:51:06,980 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 146, n_lower: 476
2022-11-06 01:51:06,980 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 135, n_lower: 754
2022-11-06 01:51:06,981 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 94
2022-11-06 01:51:06,982 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.9427, Acc: 0.7200, ]
2022-11-06 01:51:07,289 INFO: fine-tune procedure is finished!
2022-11-06 01:51:25,433 INFO: [Test_acc of task 1 on test 3: 0.52333][acc of former classes: 0.72750][acc of former samples in all classes: 0.67150]
[acc of novel samples in all classes: 0.22700]
2022-11-06 01:51:25,457 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:51:25,464 WARNING: Current net - loaded net:
2022-11-06 01:51:25,464 WARNING: Loaded net - current net:
2022-11-06 01:51:25,464 WARNING:   func.fc.bias
2022-11-06 01:51:25,464 WARNING:   func.fc.weight
2022-11-06 01:51:25,481 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_1.pth.
2022-11-06 01:51:25,507 INFO: Obtain parameters for train
2022-11-06 01:51:25,509 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:51:25,509 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:51:25,510 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:51:25,511 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:51:25,512 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:51:25,513 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:51:25,513 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:51:25,513 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:51:25,513 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:51:25,513 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:51:25,513 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:51:25,513 INFO: Model [MTNBModel] is created.
2022-11-06 01:51:25,530 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:51:25,547 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:51:25,985 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 267, n_lower: 502
2022-11-06 01:51:25,986 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 45, n_lower: 330
2022-11-06 01:51:25,987 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 43, n_lower: 542
2022-11-06 01:51:25,987 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 77
2022-11-06 01:51:25,988 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.0641, Acc: 0.6800, ]
2022-11-06 01:51:26,896 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 274, n_lower: 508
2022-11-06 01:51:26,897 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 56, n_lower: 332
2022-11-06 01:51:26,898 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 49, n_lower: 543
2022-11-06 01:51:26,898 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 3, n_lower: 109
2022-11-06 01:51:26,899 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.1368, Acc: 0.6100, ]
2022-11-06 01:51:27,659 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 310, n_lower: 514
2022-11-06 01:51:27,660 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 72, n_lower: 336
2022-11-06 01:51:27,661 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 51, n_lower: 562
2022-11-06 01:51:27,662 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 4, n_lower: 141
2022-11-06 01:51:27,663 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.3797, Acc: 0.6400, ]
2022-11-06 01:51:28,487 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 341, n_lower: 521
2022-11-06 01:51:28,488 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 77, n_lower: 338
2022-11-06 01:51:28,489 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 51, n_lower: 581
2022-11-06 01:51:28,490 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 5, n_lower: 191
2022-11-06 01:51:28,490 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.2092, Acc: 0.6300, ]
2022-11-06 01:51:29,324 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 363, n_lower: 539
2022-11-06 01:51:29,325 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 349
2022-11-06 01:51:29,326 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 63, n_lower: 600
2022-11-06 01:51:29,327 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 5, n_lower: 191
2022-11-06 01:51:29,327 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.4214, Acc: 0.5500, ]
2022-11-06 01:51:29,367 INFO: Epoch 4, Validation Step:

2022-11-06 01:51:52,393 INFO: [Test_acc of task 2 on test 3: 0.41000][acc of former classes: 0.72500][acc of former samples in all classes: 0.62350]
[acc of novel samples in all classes: 0.19650]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 01:51:53,006 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 368, n_lower: 542
2022-11-06 01:51:53,007 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 85, n_lower: 349
2022-11-06 01:51:53,008 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 62, n_lower: 614
2022-11-06 01:51:53,009 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 267
2022-11-06 01:51:53,010 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.1549, Acc: 0.6800, ]
2022-11-06 01:51:53,226 INFO: fine-tune procedure is finished!
2022-11-06 01:52:15,323 INFO: [Test_acc of task 2 on test 3: 0.41000][acc of former classes: 0.72450][acc of former samples in all classes: 0.62250]
[acc of novel samples in all classes: 0.19750]
2022-11-06 01:52:15,344 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:52:15,351 WARNING: Current net - loaded net:
2022-11-06 01:52:15,351 WARNING: Loaded net - current net:
2022-11-06 01:52:15,351 WARNING:   func.fc.bias
2022-11-06 01:52:15,351 WARNING:   func.fc.weight
2022-11-06 01:52:15,368 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_2.pth.
2022-11-06 01:52:15,395 INFO: Obtain parameters for train
2022-11-06 01:52:15,397 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:52:15,397 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:52:15,397 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:52:15,397 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:52:15,397 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:52:15,397 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:52:15,397 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:52:15,397 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:52:15,398 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:52:15,399 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:52:15,400 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:52:15,401 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:52:15,401 INFO: Model [MTNBModel] is created.
2022-11-06 01:52:15,419 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:52:15,436 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:52:15,453 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:52:16,224 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 256, n_lower: 520
2022-11-06 01:52:16,226 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 52, n_lower: 334
2022-11-06 01:52:16,226 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 591
2022-11-06 01:52:16,227 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 42, n_lower: 220
2022-11-06 01:52:16,228 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.4794, Acc: 0.6067, ]
2022-11-06 01:52:16,943 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 261, n_lower: 520
2022-11-06 01:52:16,944 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 335
2022-11-06 01:52:16,945 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 593
2022-11-06 01:52:16,946 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 42, n_lower: 234
2022-11-06 01:52:16,946 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.5375, Acc: 0.6400, ]
2022-11-06 01:52:17,706 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 274, n_lower: 522
2022-11-06 01:52:17,707 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 338
2022-11-06 01:52:17,708 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 597
2022-11-06 01:52:17,709 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 44, n_lower: 268
2022-11-06 01:52:17,710 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.4740, Acc: 0.6133, ]
2022-11-06 01:52:18,621 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 283, n_lower: 521
2022-11-06 01:52:18,622 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 340
2022-11-06 01:52:18,623 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 604
2022-11-06 01:52:18,624 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 44, n_lower: 276
2022-11-06 01:52:18,625 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.3990, Acc: 0.5600, ]
2022-11-06 01:52:19,568 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 292, n_lower: 521
2022-11-06 01:52:19,569 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 340
2022-11-06 01:52:19,570 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 45, n_lower: 634
2022-11-06 01:52:19,571 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 45, n_lower: 326
2022-11-06 01:52:19,572 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.4865, Acc: 0.5933, ]
2022-11-06 01:52:19,677 INFO: Epoch 4, Validation Step:

2022-11-06 01:52:47,813 INFO: [Test_acc of task 3 on test 3: 0.34380][acc of former classes: 0.72450][acc of former samples in all classes: 0.60100]
[acc of novel samples in all classes: 0.17233]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 01:52:48,890 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 295, n_lower: 526
2022-11-06 01:52:48,891 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 80, n_lower: 341
2022-11-06 01:52:48,891 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 44, n_lower: 637
2022-11-06 01:52:48,892 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 67, n_lower: 327
2022-11-06 01:52:48,893 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.4419, Acc: 0.6467, ]
2022-11-06 01:52:49,001 INFO: fine-tune procedure is finished!
2022-11-06 01:53:16,863 INFO: [Test_acc of task 3 on test 3: 0.34360][acc of former classes: 0.72400][acc of former samples in all classes: 0.60150]
[acc of novel samples in all classes: 0.17167]
2022-11-06 01:53:16,886 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:53:16,893 WARNING: Current net - loaded net:
2022-11-06 01:53:16,893 WARNING: Loaded net - current net:
2022-11-06 01:53:16,894 WARNING:   func.fc.bias
2022-11-06 01:53:16,894 WARNING:   func.fc.weight
2022-11-06 01:53:16,907 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_3.pth.
2022-11-06 01:53:16,927 INFO: Obtain parameters for train
2022-11-06 01:53:16,929 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:53:16,929 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:53:16,929 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:53:16,929 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:53:16,929 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:53:16,929 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:53:16,929 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:53:16,930 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:53:16,931 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:53:16,932 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:53:16,932 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:53:16,932 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:53:16,932 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:53:16,932 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:53:16,932 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:53:16,932 INFO: Model [MTNBModel] is created.
2022-11-06 01:53:16,944 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:53:16,955 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:53:16,978 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:53:16,990 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:53:17,598 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 257, n_lower: 525
2022-11-06 01:53:17,599 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 338
2022-11-06 01:53:17,600 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 618
2022-11-06 01:53:17,601 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 283
2022-11-06 01:53:17,602 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.6885, Acc: 0.5500, ]
2022-11-06 01:53:18,293 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 257, n_lower: 531
2022-11-06 01:53:18,294 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 61, n_lower: 340
2022-11-06 01:53:18,294 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 618
2022-11-06 01:53:18,295 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 299
2022-11-06 01:53:18,296 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.5743, Acc: 0.5950, ]
2022-11-06 01:53:18,927 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 257, n_lower: 532
2022-11-06 01:53:18,928 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 352
2022-11-06 01:53:18,929 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 623
2022-11-06 01:53:18,930 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 312
2022-11-06 01:53:18,930 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.5891, Acc: 0.6050, ]
2022-11-06 01:53:19,918 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 257, n_lower: 532
2022-11-06 01:53:19,919 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 78, n_lower: 377
2022-11-06 01:53:19,920 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 627
2022-11-06 01:53:19,921 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 336
2022-11-06 01:53:19,922 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.4934, Acc: 0.5750, ]
2022-11-06 01:53:20,841 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 323, n_lower: 541
2022-11-06 01:53:20,843 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 419
2022-11-06 01:53:20,844 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 627
2022-11-06 01:53:20,844 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:53:20,845 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.6151, Acc: 0.5650, ]
2022-11-06 01:53:21,043 INFO: Epoch 4, Validation Step:

2022-11-06 01:53:55,159 INFO: [Test_acc of task 4 on test 3: 0.30217][acc of former classes: 0.72400][acc of former samples in all classes: 0.57900]
[acc of novel samples in all classes: 0.16375]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 01:53:56,174 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 323, n_lower: 544
2022-11-06 01:53:56,175 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 103, n_lower: 457
2022-11-06 01:53:56,176 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 627
2022-11-06 01:53:56,177 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 54, n_lower: 354
2022-11-06 01:53:56,177 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.4271, Acc: 0.5950, ]
2022-11-06 01:53:56,502 INFO: fine-tune procedure is finished!
2022-11-06 01:54:30,617 INFO: [Test_acc of task 4 on test 3: 0.30217][acc of former classes: 0.72450][acc of former samples in all classes: 0.57900]
[acc of novel samples in all classes: 0.16375]
2022-11-06 01:54:30,644 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:54:30,652 WARNING: Current net - loaded net:
2022-11-06 01:54:30,652 WARNING: Loaded net - current net:
2022-11-06 01:54:30,652 WARNING:   func.fc.bias
2022-11-06 01:54:30,652 WARNING:   func.fc.weight
2022-11-06 01:54:30,664 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_4.pth.
2022-11-06 01:54:30,681 INFO: Obtain parameters for train
2022-11-06 01:54:30,683 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:54:30,683 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:54:30,684 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:54:30,685 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:54:30,685 INFO: Model [MTNBModel] is created.
2022-11-06 01:54:30,696 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:54:30,706 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:54:30,720 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:54:30,736 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:54:30,753 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:54:31,845 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 305, n_lower: 537
2022-11-06 01:54:31,847 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 408
2022-11-06 01:54:31,848 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 627
2022-11-06 01:54:31,849 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 343
2022-11-06 01:54:31,850 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.7149, Acc: 0.5520, ]
2022-11-06 01:54:32,702 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 329, n_lower: 541
2022-11-06 01:54:32,703 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 78, n_lower: 417
2022-11-06 01:54:32,704 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 627
2022-11-06 01:54:32,705 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 343
2022-11-06 01:54:32,706 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.8283, Acc: 0.5040, ]
2022-11-06 01:54:33,482 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 358, n_lower: 564
2022-11-06 01:54:33,483 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 437
2022-11-06 01:54:33,484 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 627
2022-11-06 01:54:33,485 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 345
2022-11-06 01:54:33,485 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.6571, Acc: 0.6080, ]
2022-11-06 01:54:34,555 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 366, n_lower: 571
2022-11-06 01:54:34,556 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 451
2022-11-06 01:54:34,557 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 51, n_lower: 633
2022-11-06 01:54:34,558 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 345
2022-11-06 01:54:34,559 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.6645, Acc: 0.5440, ]
2022-11-06 01:54:35,316 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 380, n_lower: 581
2022-11-06 01:54:35,317 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 93, n_lower: 459
2022-11-06 01:54:35,318 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 52, n_lower: 642
2022-11-06 01:54:35,319 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 345
2022-11-06 01:54:35,320 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.6534, Acc: 0.5640, ]
2022-11-06 01:54:35,421 INFO: Epoch 4, Validation Step:

2022-11-06 01:55:14,907 INFO: [Test_acc of task 5 on test 3: 0.27586][acc of former classes: 0.72550][acc of former samples in all classes: 0.56600]
[acc of novel samples in all classes: 0.15980]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 01:55:15,879 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 380, n_lower: 594
2022-11-06 01:55:15,880 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 96, n_lower: 477
2022-11-06 01:55:15,881 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 55, n_lower: 687
2022-11-06 01:55:15,882 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 345
2022-11-06 01:55:15,883 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.6758, Acc: 0.5680, ]
2022-11-06 01:55:16,131 INFO: fine-tune procedure is finished!
2022-11-06 01:55:55,903 INFO: [Test_acc of task 5 on test 3: 0.27471][acc of former classes: 0.72400][acc of former samples in all classes: 0.56350]
[acc of novel samples in all classes: 0.15920]
2022-11-06 01:55:55,930 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:55:55,938 WARNING: Current net - loaded net:
2022-11-06 01:55:55,938 WARNING: Loaded net - current net:
2022-11-06 01:55:55,938 WARNING:   func.fc.bias
2022-11-06 01:55:55,938 WARNING:   func.fc.weight
2022-11-06 01:55:55,961 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_5.pth.
2022-11-06 01:55:55,980 INFO: Obtain parameters for train
2022-11-06 01:55:55,982 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:55:55,982 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:55:55,983 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:55:55,984 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:55:55,984 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:55:55,984 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:55:55,984 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:55:55,984 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:55:55,984 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:55:55,984 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:55:55,984 INFO: Model [MTNBModel] is created.
2022-11-06 01:55:55,995 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:55:56,005 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:55:56,020 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:55:56,036 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:55:56,052 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:55:56,068 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:55:56,764 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 289, n_lower: 566
2022-11-06 01:55:56,765 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 65, n_lower: 442
2022-11-06 01:55:56,766 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 677
2022-11-06 01:55:56,766 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 343
2022-11-06 01:55:56,767 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.8020, Acc: 0.5133, ]
2022-11-06 01:55:57,560 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 310, n_lower: 568
2022-11-06 01:55:57,561 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 449
2022-11-06 01:55:57,562 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 687
2022-11-06 01:55:57,563 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 343
2022-11-06 01:55:57,563 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.7374, Acc: 0.5267, ]
2022-11-06 01:55:58,565 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 316, n_lower: 570
2022-11-06 01:55:58,566 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 451
2022-11-06 01:55:58,567 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 694
2022-11-06 01:55:58,568 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 346
2022-11-06 01:55:58,569 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.7163, Acc: 0.5200, ]
2022-11-06 01:55:59,566 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 325, n_lower: 577
2022-11-06 01:55:59,567 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 454
2022-11-06 01:55:59,568 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 706
2022-11-06 01:55:59,569 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 346
2022-11-06 01:55:59,569 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.7251, Acc: 0.5333, ]
2022-11-06 01:56:00,500 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 340, n_lower: 587
2022-11-06 01:56:00,501 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 82, n_lower: 459
2022-11-06 01:56:00,501 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 48, n_lower: 710
2022-11-06 01:56:00,502 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:56:00,503 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.7920, Acc: 0.5333, ]
2022-11-06 01:56:00,598 INFO: Epoch 4, Validation Step:

2022-11-06 01:56:45,308 INFO: [Test_acc of task 6 on test 3: 0.24288][acc of former classes: 0.72400][acc of former samples in all classes: 0.55550]
[acc of novel samples in all classes: 0.13867]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 01:56:46,379 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 341, n_lower: 591
2022-11-06 01:56:46,380 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 459
2022-11-06 01:56:46,381 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 49, n_lower: 715
2022-11-06 01:56:46,382 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 49, n_lower: 347
2022-11-06 01:56:46,383 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.7264, Acc: 0.5433, ]
2022-11-06 01:56:46,490 INFO: fine-tune procedure is finished!
2022-11-06 01:57:33,240 INFO: [Test_acc of task 6 on test 3: 0.24313][acc of former classes: 0.72350][acc of former samples in all classes: 0.55600]
[acc of novel samples in all classes: 0.13883]
2022-11-06 01:57:33,271 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:57:33,280 WARNING: Current net - loaded net:
2022-11-06 01:57:33,280 WARNING: Loaded net - current net:
2022-11-06 01:57:33,280 WARNING:   func.fc.bias
2022-11-06 01:57:33,280 WARNING:   func.fc.weight
2022-11-06 01:57:33,296 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_6.pth.
2022-11-06 01:57:33,334 INFO: Obtain parameters for train
2022-11-06 01:57:33,336 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:57:33,336 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:57:33,336 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:57:33,336 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:57:33,336 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:57:33,336 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:57:33,336 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:57:33,336 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:57:33,337 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:57:33,338 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:57:33,339 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:57:33,339 INFO: Model [MTNBModel] is created.
2022-11-06 01:57:33,354 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:57:33,365 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:57:33,383 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:57:33,398 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:57:33,413 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:57:33,426 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:57:33,443 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:57:34,177 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 268, n_lower: 574
2022-11-06 01:57:34,178 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 451
2022-11-06 01:57:34,179 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 702
2022-11-06 01:57:34,180 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:57:34,180 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.9156, Acc: 0.4914, ]
2022-11-06 01:57:35,238 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 311, n_lower: 587
2022-11-06 01:57:35,239 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 73, n_lower: 451
2022-11-06 01:57:35,240 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 45, n_lower: 714
2022-11-06 01:57:35,240 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:57:35,241 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.9182, Acc: 0.5343, ]
2022-11-06 01:57:36,293 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 318, n_lower: 594
2022-11-06 01:57:36,294 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 74, n_lower: 457
2022-11-06 01:57:36,295 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 45, n_lower: 725
2022-11-06 01:57:36,295 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:57:36,296 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.9224, Acc: 0.4971, ]
2022-11-06 01:57:37,290 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 334, n_lower: 606
2022-11-06 01:57:37,291 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 458
2022-11-06 01:57:37,292 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 46, n_lower: 746
2022-11-06 01:57:37,293 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:57:37,293 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8740, Acc: 0.5114, ]
2022-11-06 01:57:38,298 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 345, n_lower: 607
2022-11-06 01:57:38,300 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 461
2022-11-06 01:57:38,300 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 46, n_lower: 769
2022-11-06 01:57:38,301 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:57:38,302 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.8923, Acc: 0.5371, ]
2022-11-06 01:57:38,501 INFO: Epoch 4, Validation Step:

2022-11-06 01:58:32,143 INFO: [Test_acc of task 7 on test 3: 0.22267][acc of former classes: 0.72350][acc of former samples in all classes: 0.53700]
[acc of novel samples in all classes: 0.13286]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 01:58:34,258 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 345, n_lower: 610
2022-11-06 01:58:34,259 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 82, n_lower: 463
2022-11-06 01:58:34,260 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 46, n_lower: 782
2022-11-06 01:58:34,260 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:58:34,261 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.8146, Acc: 0.5343, ]
2022-11-06 01:58:34,447 INFO: fine-tune procedure is finished!
2022-11-06 01:59:26,102 INFO: [Test_acc of task 7 on test 3: 0.22233][acc of former classes: 0.72300][acc of former samples in all classes: 0.53600]
[acc of novel samples in all classes: 0.13271]
2022-11-06 01:59:26,161 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 01:59:26,171 WARNING: Current net - loaded net:
2022-11-06 01:59:26,171 WARNING: Loaded net - current net:
2022-11-06 01:59:26,171 WARNING:   func.fc.bias
2022-11-06 01:59:26,171 WARNING:   func.fc.weight
2022-11-06 01:59:26,190 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_7.pth.
2022-11-06 01:59:26,216 INFO: Obtain parameters for train
2022-11-06 01:59:26,218 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 01:59:26,218 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 01:59:26,218 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 01:59:26,218 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 01:59:26,218 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 01:59:26,218 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 01:59:26,218 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 01:59:26,218 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 01:59:26,219 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 01:59:26,220 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 01:59:26,221 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 01:59:26,221 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 01:59:26,221 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 01:59:26,221 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 01:59:26,221 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 01:59:26,221 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 01:59:26,221 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 01:59:26,221 INFO: Model [MTNBModel] is created.
2022-11-06 01:59:26,238 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:59:26,250 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:59:26,261 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:59:26,272 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:59:26,284 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:59:26,295 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:59:26,307 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 01:59:26,318 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 01:59:27,214 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 275, n_lower: 589
2022-11-06 01:59:27,216 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 455
2022-11-06 01:59:27,216 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 754
2022-11-06 01:59:27,217 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:59:27,218 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.8849, Acc: 0.5175, ]
2022-11-06 01:59:28,227 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 285, n_lower: 599
2022-11-06 01:59:28,228 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 456
2022-11-06 01:59:28,229 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 756
2022-11-06 01:59:28,230 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:59:28,230 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.9236, Acc: 0.4925, ]
2022-11-06 01:59:29,249 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 293, n_lower: 601
2022-11-06 01:59:29,251 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 460
2022-11-06 01:59:29,251 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 773
2022-11-06 01:59:29,252 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:59:29,253 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.8977, Acc: 0.5225, ]
2022-11-06 01:59:29,952 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 297, n_lower: 605
2022-11-06 01:59:29,953 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 460
2022-11-06 01:59:29,954 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 779
2022-11-06 01:59:29,955 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:59:29,956 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8239, Acc: 0.5150, ]
2022-11-06 01:59:31,005 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 299, n_lower: 609
2022-11-06 01:59:31,006 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 463
2022-11-06 01:59:31,007 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 794
2022-11-06 01:59:31,008 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 01:59:31,008 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.8824, Acc: 0.5100, ]
2022-11-06 01:59:31,164 INFO: Epoch 4, Validation Step:

2022-11-06 02:00:23,885 INFO: [Test_acc of task 8 on test 3: 0.20590][acc of former classes: 0.72250][acc of former samples in all classes: 0.52250]
[acc of novel samples in all classes: 0.12675]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 02:00:24,653 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 299, n_lower: 610
2022-11-06 02:00:24,654 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 463
2022-11-06 02:00:24,655 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 799
2022-11-06 02:00:24,656 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 347
2022-11-06 02:00:24,656 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.8362, Acc: 0.5175, ]
2022-11-06 02:00:24,773 INFO: fine-tune procedure is finished!
2022-11-06 02:01:17,005 INFO: [Test_acc of task 8 on test 3: 0.20580][acc of former classes: 0.72250][acc of former samples in all classes: 0.52250]
[acc of novel samples in all classes: 0.12662]
2022-11-06 02:01:17,039 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:01:17,048 WARNING: Current net - loaded net:
2022-11-06 02:01:17,048 WARNING: Loaded net - current net:
2022-11-06 02:01:17,049 WARNING:   func.fc.bias
2022-11-06 02:01:17,049 WARNING:   func.fc.weight
2022-11-06 02:01:17,067 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth.
2022-11-06 02:01:17,093 INFO: Obtain parameters for train
2022-11-06 02:01:17,095 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:01:17,095 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:01:17,095 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:01:17,095 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:01:17,096 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:01:17,097 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:01:17,098 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:01:17,099 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:01:17,099 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:01:17,099 INFO: Model [MTNBModel] is created.
2022-11-06 02:01:17,113 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 02:01:17,578 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4648, Acc: 0.8000, ]
2022-11-06 02:01:18,151 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 1, n_lower: 9
2022-11-06 02:01:18,152 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 0, n_lower: 8
2022-11-06 02:01:18,153 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 0, n_lower: 14
2022-11-06 02:01:18,154 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 17
2022-11-06 02:01:18,154 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.9952, Acc: 0.7600, ]
2022-11-06 02:01:18,728 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 38, n_lower: 34
2022-11-06 02:01:18,729 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 0, n_lower: 40
2022-11-06 02:01:18,730 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 0, n_lower: 53
2022-11-06 02:01:18,731 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 40
2022-11-06 02:01:18,731 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.7840, Acc: 0.7600, ]
2022-11-06 02:01:19,481 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 178, n_lower: 323
2022-11-06 02:01:19,482 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 23, n_lower: 167
2022-11-06 02:01:19,483 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 22, n_lower: 307
2022-11-06 02:01:19,484 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 70
2022-11-06 02:01:19,485 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.8557, Acc: 0.7600, ]
2022-11-06 02:01:20,174 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 250, n_lower: 372
2022-11-06 02:01:20,176 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 26, n_lower: 221
2022-11-06 02:01:20,177 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 416
2022-11-06 02:01:20,178 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 80
2022-11-06 02:01:20,178 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.6734, Acc: 0.8000, ]
2022-11-06 02:01:20,210 INFO: Epoch 4, Validation Step:

2022-11-06 02:01:38,421 INFO: [Test_acc of task 1 on test 4: 0.53400][acc of former classes: 0.73100][acc of former samples in all classes: 0.67350]
[acc of novel samples in all classes: 0.25500]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-06 02:01:39,120 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 322, n_lower: 413
2022-11-06 02:01:39,121 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 284
2022-11-06 02:01:39,122 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 94, n_lower: 496
2022-11-06 02:01:39,123 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 399
2022-11-06 02:01:39,124 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3444, Acc: 0.8600, ]
2022-11-06 02:01:39,238 INFO: fine-tune procedure is finished!
2022-11-06 02:01:57,661 INFO: [Test_acc of task 1 on test 4: 0.53367][acc of former classes: 0.73150][acc of former samples in all classes: 0.67350]
[acc of novel samples in all classes: 0.25400]
2022-11-06 02:01:57,682 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:01:57,688 WARNING: Current net - loaded net:
2022-11-06 02:01:57,688 WARNING: Loaded net - current net:
2022-11-06 02:01:57,688 WARNING:   func.fc.bias
2022-11-06 02:01:57,689 WARNING:   func.fc.weight
2022-11-06 02:01:57,702 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_1.pth.
2022-11-06 02:01:57,720 INFO: Obtain parameters for train
2022-11-06 02:01:57,722 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:01:57,722 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:01:57,723 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:01:57,724 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:01:57,725 INFO: Model [MTNBModel] is created.
2022-11-06 02:01:57,736 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:01:57,747 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 02:01:58,421 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 124, n_lower: 259
2022-11-06 02:01:58,423 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 16, n_lower: 185
2022-11-06 02:01:58,423 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 340
2022-11-06 02:01:58,424 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 247
2022-11-06 02:01:58,425 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.0324, Acc: 0.7100, ]
2022-11-06 02:01:59,102 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 123, n_lower: 260
2022-11-06 02:01:59,103 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 22, n_lower: 185
2022-11-06 02:01:59,104 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 36, n_lower: 340
2022-11-06 02:01:59,105 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 282
2022-11-06 02:01:59,105 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.2008, Acc: 0.6800, ]
2022-11-06 02:01:59,854 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 134, n_lower: 290
2022-11-06 02:01:59,856 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 34, n_lower: 199
2022-11-06 02:01:59,857 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 39, n_lower: 342
2022-11-06 02:01:59,858 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 347
2022-11-06 02:01:59,859 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.2701, Acc: 0.6300, ]
2022-11-06 02:02:00,717 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 174, n_lower: 319
2022-11-06 02:02:00,718 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 38, n_lower: 214
2022-11-06 02:02:00,719 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 407
2022-11-06 02:02:00,720 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 408
2022-11-06 02:02:00,720 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.3183, Acc: 0.6000, ]
2022-11-06 02:02:01,433 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 196, n_lower: 336
2022-11-06 02:02:01,434 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 239
2022-11-06 02:02:01,435 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 46, n_lower: 417
2022-11-06 02:02:01,436 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 476
2022-11-06 02:02:01,436 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.3592, Acc: 0.6100, ]
2022-11-06 02:02:01,478 INFO: Epoch 4, Validation Step:

2022-11-06 02:02:24,794 INFO: [Test_acc of task 2 on test 4: 0.42275][acc of former classes: 0.72750][acc of former samples in all classes: 0.63500]
[acc of novel samples in all classes: 0.21050]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-06 02:02:25,857 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 202, n_lower: 356
2022-11-06 02:02:25,859 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 242
2022-11-06 02:02:25,860 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 49, n_lower: 422
2022-11-06 02:02:25,860 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 528
2022-11-06 02:02:25,861 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.9224, Acc: 0.7100, ]
2022-11-06 02:02:25,984 INFO: fine-tune procedure is finished!
2022-11-06 02:02:48,237 INFO: [Test_acc of task 2 on test 4: 0.42400][acc of former classes: 0.72850][acc of former samples in all classes: 0.63600]
[acc of novel samples in all classes: 0.21200]
2022-11-06 02:02:48,270 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:02:48,280 WARNING: Current net - loaded net:
2022-11-06 02:02:48,280 WARNING: Loaded net - current net:
2022-11-06 02:02:48,280 WARNING:   func.fc.bias
2022-11-06 02:02:48,280 WARNING:   func.fc.weight
2022-11-06 02:02:48,299 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_2.pth.
2022-11-06 02:02:48,317 INFO: Obtain parameters for train
2022-11-06 02:02:48,318 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:02:48,318 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:02:48,318 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:02:48,318 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:02:48,318 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:02:48,318 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:02:48,318 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:02:48,318 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:02:48,319 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:02:48,320 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:02:48,321 INFO: Model [MTNBModel] is created.
2022-11-06 02:02:48,331 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:02:48,341 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:02:48,351 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 02:02:48,783 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 163, n_lower: 328
2022-11-06 02:02:48,785 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 28, n_lower: 218
2022-11-06 02:02:48,786 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 37, n_lower: 398
2022-11-06 02:02:48,786 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 420
2022-11-06 02:02:48,787 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.3672, Acc: 0.5733, ]
2022-11-06 02:02:49,500 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 163, n_lower: 329
2022-11-06 02:02:49,530 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 29, n_lower: 218
2022-11-06 02:02:49,531 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 38, n_lower: 400
2022-11-06 02:02:49,532 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 434
2022-11-06 02:02:49,533 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.5217, Acc: 0.5800, ]
2022-11-06 02:02:50,177 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 403
2022-11-06 02:02:50,178 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 33, n_lower: 264
2022-11-06 02:02:50,179 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 38, n_lower: 402
2022-11-06 02:02:50,180 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 458
2022-11-06 02:02:50,181 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.5258, Acc: 0.5867, ]
2022-11-06 02:02:52,017 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 216, n_lower: 405
2022-11-06 02:02:52,018 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 33, n_lower: 264
2022-11-06 02:02:52,019 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 38, n_lower: 406
2022-11-06 02:02:52,019 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 473
2022-11-06 02:02:52,020 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.4985, Acc: 0.5933, ]
2022-11-06 02:02:52,617 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 217, n_lower: 408
2022-11-06 02:02:52,619 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 33, n_lower: 264
2022-11-06 02:02:52,620 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 436
2022-11-06 02:02:52,620 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 12, n_lower: 529
2022-11-06 02:02:52,621 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.3687, Acc: 0.6200, ]
2022-11-06 02:02:52,730 INFO: Epoch 4, Validation Step:

2022-11-06 02:03:19,988 INFO: [Test_acc of task 3 on test 4: 0.35460][acc of former classes: 0.72650][acc of former samples in all classes: 0.60800]
[acc of novel samples in all classes: 0.18567]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-06 02:03:20,727 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 219, n_lower: 412
2022-11-06 02:03:20,728 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 35, n_lower: 271
2022-11-06 02:03:20,729 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 40, n_lower: 438
2022-11-06 02:03:20,730 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 12, n_lower: 531
2022-11-06 02:03:20,730 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.2703, Acc: 0.6000, ]
2022-11-06 02:03:20,809 INFO: fine-tune procedure is finished!
2022-11-06 02:03:49,052 INFO: [Test_acc of task 3 on test 4: 0.35460][acc of former classes: 0.72800][acc of former samples in all classes: 0.60850]
[acc of novel samples in all classes: 0.18533]
2022-11-06 02:03:49,073 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:03:49,080 WARNING: Current net - loaded net:
2022-11-06 02:03:49,080 WARNING: Loaded net - current net:
2022-11-06 02:03:49,080 WARNING:   func.fc.bias
2022-11-06 02:03:49,080 WARNING:   func.fc.weight
2022-11-06 02:03:49,100 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_3.pth.
2022-11-06 02:03:49,184 INFO: Obtain parameters for train
2022-11-06 02:03:49,187 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:03:49,187 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:03:49,188 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:03:49,189 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:03:49,190 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:03:49,190 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:03:49,190 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:03:49,190 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:03:49,190 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:03:49,190 INFO: Model [MTNBModel] is created.
2022-11-06 02:03:49,208 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:03:49,225 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:03:49,242 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:03:49,254 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 02:03:49,712 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 180, n_lower: 389
2022-11-06 02:03:49,713 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 14, n_lower: 254
2022-11-06 02:03:49,714 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 61, n_lower: 442
2022-11-06 02:03:49,715 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 465
2022-11-06 02:03:49,716 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.5726, Acc: 0.5500, ]
2022-11-06 02:03:50,470 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 180, n_lower: 389
2022-11-06 02:03:50,471 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 37, n_lower: 271
2022-11-06 02:03:50,472 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 62, n_lower: 456
2022-11-06 02:03:50,473 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 468
2022-11-06 02:03:50,474 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.5785, Acc: 0.5450, ]
2022-11-06 02:03:51,267 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 399
2022-11-06 02:03:51,268 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 38, n_lower: 274
2022-11-06 02:03:51,269 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 94, n_lower: 537
2022-11-06 02:03:51,270 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 469
2022-11-06 02:03:51,270 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.5183, Acc: 0.5700, ]
2022-11-06 02:03:52,087 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 219, n_lower: 399
2022-11-06 02:03:52,088 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 288
2022-11-06 02:03:52,089 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 100, n_lower: 566
2022-11-06 02:03:52,089 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 487
2022-11-06 02:03:52,090 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.4182, Acc: 0.6100, ]
2022-11-06 02:03:52,747 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 219, n_lower: 401
2022-11-06 02:03:52,748 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 288
2022-11-06 02:03:52,749 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 113, n_lower: 610
2022-11-06 02:03:52,750 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 510
2022-11-06 02:03:52,750 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.4940, Acc: 0.5450, ]
2022-11-06 02:03:52,829 INFO: Epoch 4, Validation Step:

2022-11-06 02:04:25,572 INFO: [Test_acc of task 4 on test 4: 0.30967][acc of former classes: 0.72700][acc of former samples in all classes: 0.58650]
[acc of novel samples in all classes: 0.17125]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-06 02:04:26,418 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 219, n_lower: 401
2022-11-06 02:04:26,419 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 358
2022-11-06 02:04:26,420 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 113, n_lower: 611
2022-11-06 02:04:26,421 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 512
2022-11-06 02:04:26,422 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.3972, Acc: 0.6100, ]
2022-11-06 02:04:26,535 INFO: fine-tune procedure is finished!
2022-11-06 02:04:58,717 INFO: [Test_acc of task 4 on test 4: 0.30967][acc of former classes: 0.72650][acc of former samples in all classes: 0.58650]
[acc of novel samples in all classes: 0.17125]
2022-11-06 02:04:58,738 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:04:58,744 WARNING: Current net - loaded net:
2022-11-06 02:04:58,744 WARNING: Loaded net - current net:
2022-11-06 02:04:58,744 WARNING:   func.fc.bias
2022-11-06 02:04:58,744 WARNING:   func.fc.weight
2022-11-06 02:04:58,756 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_4.pth.
2022-11-06 02:04:58,775 INFO: Obtain parameters for train
2022-11-06 02:04:58,777 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:04:58,778 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:04:58,779 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:04:58,780 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:04:58,781 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:04:58,781 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:04:58,781 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:04:58,781 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:04:58,781 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:04:58,781 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:04:58,781 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:04:58,781 INFO: Model [MTNBModel] is created.
2022-11-06 02:04:58,800 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:04:58,817 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:04:58,834 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:04:58,852 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:04:58,869 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 02:04:59,595 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 151, n_lower: 387
2022-11-06 02:04:59,596 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 27, n_lower: 316
2022-11-06 02:04:59,597 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 566
2022-11-06 02:04:59,598 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 484
2022-11-06 02:04:59,598 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.6885, Acc: 0.5200, ]
2022-11-06 02:05:00,299 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 151, n_lower: 388
2022-11-06 02:05:00,300 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 33, n_lower: 319
2022-11-06 02:05:00,301 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 575
2022-11-06 02:05:00,301 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 488
2022-11-06 02:05:00,302 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.7918, Acc: 0.5040, ]
2022-11-06 02:05:01,252 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 163, n_lower: 404
2022-11-06 02:05:01,254 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 329
2022-11-06 02:05:01,254 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 615
2022-11-06 02:05:01,255 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 497
2022-11-06 02:05:01,256 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.6966, Acc: 0.5440, ]
2022-11-06 02:05:01,995 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 186, n_lower: 409
2022-11-06 02:05:01,997 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 333
2022-11-06 02:05:01,998 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 615
2022-11-06 02:05:01,999 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 507
2022-11-06 02:05:01,999 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.6234, Acc: 0.5640, ]
2022-11-06 02:05:02,908 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 203, n_lower: 427
2022-11-06 02:05:02,909 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 44, n_lower: 343
2022-11-06 02:05:02,910 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 70, n_lower: 625
2022-11-06 02:05:02,911 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 516
2022-11-06 02:05:02,911 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.5286, Acc: 0.6040, ]
2022-11-06 02:05:03,097 INFO: Epoch 4, Validation Step:

2022-11-06 02:05:40,717 INFO: [Test_acc of task 5 on test 4: 0.28386][acc of former classes: 0.72600][acc of former samples in all classes: 0.57000]
[acc of novel samples in all classes: 0.16940]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-06 02:05:41,475 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 221, n_lower: 440
2022-11-06 02:05:41,476 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 44, n_lower: 343
2022-11-06 02:05:41,476 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 67, n_lower: 627
2022-11-06 02:05:41,477 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 516
2022-11-06 02:05:41,478 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.5865, Acc: 0.5520, ]
2022-11-06 02:05:41,554 INFO: fine-tune procedure is finished!
2022-11-06 02:06:18,372 INFO: [Test_acc of task 5 on test 4: 0.28386][acc of former classes: 0.72550][acc of former samples in all classes: 0.56950]
[acc of novel samples in all classes: 0.16960]
2022-11-06 02:06:18,397 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:06:18,404 WARNING: Current net - loaded net:
2022-11-06 02:06:18,404 WARNING: Loaded net - current net:
2022-11-06 02:06:18,405 WARNING:   func.fc.bias
2022-11-06 02:06:18,405 WARNING:   func.fc.weight
2022-11-06 02:06:18,419 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_5.pth.
2022-11-06 02:06:18,437 INFO: Obtain parameters for train
2022-11-06 02:06:18,439 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:06:18,439 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:06:18,440 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:06:18,441 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:06:18,441 INFO: Model [MTNBModel] is created.
2022-11-06 02:06:18,452 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:06:18,462 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:06:18,472 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:06:18,482 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:06:18,492 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:06:18,501 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 02:06:19,075 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 198, n_lower: 409
2022-11-06 02:06:19,076 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 50, n_lower: 330
2022-11-06 02:06:19,077 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 54, n_lower: 608
2022-11-06 02:06:19,078 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 501
2022-11-06 02:06:19,079 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.8687, Acc: 0.4800, ]
2022-11-06 02:06:19,926 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 207, n_lower: 411
2022-11-06 02:06:19,928 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 52, n_lower: 333
2022-11-06 02:06:19,929 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 57, n_lower: 609
2022-11-06 02:06:19,929 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 501
2022-11-06 02:06:19,930 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.7949, Acc: 0.5033, ]
2022-11-06 02:06:20,700 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 227, n_lower: 419
2022-11-06 02:06:20,701 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 54, n_lower: 340
2022-11-06 02:06:20,702 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 57, n_lower: 625
2022-11-06 02:06:20,703 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 501
2022-11-06 02:06:20,704 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.7307, Acc: 0.5200, ]
2022-11-06 02:06:21,554 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 239, n_lower: 425
2022-11-06 02:06:21,555 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 55, n_lower: 349
2022-11-06 02:06:21,556 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 637
2022-11-06 02:06:21,557 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 501
2022-11-06 02:06:21,558 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.8270, Acc: 0.5233, ]
2022-11-06 02:06:22,266 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 241, n_lower: 427
2022-11-06 02:06:22,267 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 55, n_lower: 349
2022-11-06 02:06:22,268 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 62, n_lower: 641
2022-11-06 02:06:22,268 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 501
2022-11-06 02:06:22,269 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.8336, Acc: 0.5133, ]
2022-11-06 02:06:22,380 INFO: Epoch 4, Validation Step:

2022-11-06 02:07:04,460 INFO: [Test_acc of task 6 on test 4: 0.25100][acc of former classes: 0.72600][acc of former samples in all classes: 0.55750]
[acc of novel samples in all classes: 0.14883]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-06 02:07:05,286 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 242, n_lower: 434
2022-11-06 02:07:05,288 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 55, n_lower: 350
2022-11-06 02:07:05,289 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 63, n_lower: 646
2022-11-06 02:07:05,289 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 501
2022-11-06 02:07:05,290 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.6211, Acc: 0.5700, ]
2022-11-06 02:07:05,394 INFO: fine-tune procedure is finished!
2022-11-06 02:07:48,964 INFO: [Test_acc of task 6 on test 4: 0.25100][acc of former classes: 0.72600][acc of former samples in all classes: 0.55700]
[acc of novel samples in all classes: 0.14900]
2022-11-06 02:07:48,984 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:07:48,990 WARNING: Current net - loaded net:
2022-11-06 02:07:48,990 WARNING: Loaded net - current net:
2022-11-06 02:07:48,990 WARNING:   func.fc.bias
2022-11-06 02:07:48,990 WARNING:   func.fc.weight
2022-11-06 02:07:49,002 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_6.pth.
2022-11-06 02:07:49,020 INFO: Obtain parameters for train
2022-11-06 02:07:49,021 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:07:49,021 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:07:49,021 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:07:49,021 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:07:49,021 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:07:49,021 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:07:49,021 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:07:49,022 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:07:49,023 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:07:49,024 INFO: Model [MTNBModel] is created.
2022-11-06 02:07:49,034 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:07:49,046 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:07:49,064 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:07:49,083 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:07:49,100 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:07:49,118 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:07:49,135 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 02:07:49,776 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 186, n_lower: 423
2022-11-06 02:07:49,777 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 28, n_lower: 340
2022-11-06 02:07:49,778 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 54, n_lower: 614
2022-11-06 02:07:49,779 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 499
2022-11-06 02:07:49,779 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.9434, Acc: 0.4857, ]
2022-11-06 02:07:50,630 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 188, n_lower: 423
2022-11-06 02:07:50,631 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 32, n_lower: 347
2022-11-06 02:07:50,632 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 615
2022-11-06 02:07:50,633 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 499
2022-11-06 02:07:50,634 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 1.9864, Acc: 0.4714, ]
2022-11-06 02:07:51,516 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 209, n_lower: 430
2022-11-06 02:07:51,518 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 38, n_lower: 351
2022-11-06 02:07:51,518 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 62, n_lower: 626
2022-11-06 02:07:51,519 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 499
2022-11-06 02:07:51,520 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 1.8857, Acc: 0.4971, ]
2022-11-06 02:07:52,484 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 209, n_lower: 434
2022-11-06 02:07:52,485 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 59, n_lower: 362
2022-11-06 02:07:52,486 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 66, n_lower: 641
2022-11-06 02:07:52,487 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 499
2022-11-06 02:07:52,487 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 1.9405, Acc: 0.5000, ]
2022-11-06 02:07:53,362 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 212, n_lower: 435
2022-11-06 02:07:53,363 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 63, n_lower: 363
2022-11-06 02:07:53,364 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 72, n_lower: 654
2022-11-06 02:07:53,365 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 499
2022-11-06 02:07:53,366 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.9500, Acc: 0.5143, ]
2022-11-06 02:07:53,908 INFO: Epoch 4, Validation Step:

2022-11-06 02:08:41,619 INFO: [Test_acc of task 7 on test 4: 0.23178][acc of former classes: 0.72650][acc of former samples in all classes: 0.53550]
[acc of novel samples in all classes: 0.14500]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-06 02:08:42,549 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 212, n_lower: 436
2022-11-06 02:08:42,550 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 66, n_lower: 372
2022-11-06 02:08:42,551 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 72, n_lower: 659
2022-11-06 02:08:42,552 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 499
2022-11-06 02:08:42,553 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.6863, Acc: 0.5429, ]
2022-11-06 02:08:42,714 INFO: fine-tune procedure is finished!
2022-11-06 02:09:29,679 INFO: [Test_acc of task 7 on test 4: 0.23156][acc of former classes: 0.72650][acc of former samples in all classes: 0.53550]
[acc of novel samples in all classes: 0.14471]
2022-11-06 02:09:29,703 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth.
2022-11-06 02:09:29,710 WARNING: Current net - loaded net:
2022-11-06 02:09:29,710 WARNING: Loaded net - current net:
2022-11-06 02:09:29,710 WARNING:   func.fc.bias
2022-11-06 02:09:29,710 WARNING:   func.fc.weight
2022-11-06 02:09:29,725 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_7.pth.
2022-11-06 02:09:29,745 INFO: Obtain parameters for train
2022-11-06 02:09:29,747 WARNING: Params func.conv1.weight will not be optimized.
2022-11-06 02:09:29,747 WARNING: Params func.bn1.weight will not be optimized.
2022-11-06 02:09:29,747 WARNING: Params func.bn1.bias will not be optimized.
2022-11-06 02:09:29,747 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-06 02:09:29,747 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-06 02:09:29,748 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-06 02:09:29,749 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-06 02:09:29,750 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-06 02:09:29,750 INFO: Model [MTNBModel] is created.
2022-11-06 02:09:29,762 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:09:29,772 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:09:29,784 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:09:29,794 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:09:29,804 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:09:29,816 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:09:29,826 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-06 02:09:29,836 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/CFRPModel_res18_cifar_20base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 02:09:30,433 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 177, n_lower: 431
2022-11-06 02:09:30,434 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 29, n_lower: 362
2022-11-06 02:09:30,435 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 59, n_lower: 644
2022-11-06 02:09:30,435 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 499
2022-11-06 02:09:30,436 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 1.9441, Acc: 0.4975, ]
2022-11-06 02:09:31,262 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 181, n_lower: 438
2022-11-06 02:09:31,264 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 31, n_lower: 362
2022-11-06 02:09:31,265 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 61, n_lower: 649
2022-11-06 02:09:31,266 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 499
2022-11-06 02:09:31,266 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 2.0540, Acc: 0.4675, ]
2022-11-06 02:09:32,062 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 197, n_lower: 439
2022-11-06 02:09:32,063 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 31, n_lower: 367
2022-11-06 02:09:32,064 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 61, n_lower: 654
2022-11-06 02:09:32,065 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 499
2022-11-06 02:09:32,066 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 2.0084, Acc: 0.4950, ]
2022-11-06 02:09:32,856 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 199, n_lower: 444
2022-11-06 02:09:32,857 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 31, n_lower: 369
2022-11-06 02:09:32,858 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 63, n_lower: 660
2022-11-06 02:09:32,858 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 499
2022-11-06 02:09:32,859 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 2.0631, Acc: 0.4850, ]
2022-11-06 02:09:34,097 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 202, n_lower: 445
2022-11-06 02:09:34,098 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 31, n_lower: 371
2022-11-06 02:09:34,099 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 63, n_lower: 660
2022-11-06 02:09:34,100 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 499
2022-11-06 02:09:34,101 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 1.9603, Acc: 0.4675, ]
2022-11-06 02:09:34,265 INFO: Epoch 4, Validation Step:

2022-11-06 02:10:27,647 INFO: [Test_acc of task 8 on test 4: 0.21550][acc of former classes: 0.72600][acc of former samples in all classes: 0.52200]
[acc of novel samples in all classes: 0.13887]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-06 02:10:28,430 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 202, n_lower: 448
2022-11-06 02:10:28,432 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 31, n_lower: 372
2022-11-06 02:10:28,432 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 63, n_lower: 664
2022-11-06 02:10:28,433 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 499
2022-11-06 02:10:28,434 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 1.7864, Acc: 0.5400, ]
2022-11-06 02:10:28,571 INFO: fine-tune procedure is finished!
2022-11-06 02:11:23,881 INFO: [Test_acc of task 8 on test 4: 0.21540][acc of former classes: 0.72600][acc of former samples in all classes: 0.52200]
[acc of novel samples in all classes: 0.13875]
2022-11-06 02:11:23,898 INFO: --------------------------Final Avg Acc-------------------------
2022-11-06 02:11:23,899 INFO: Session 1: 73.40+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7340]
2022-11-06 02:11:23,899 INFO: Session 2: 53.25+-0.57[acc of former classes: 0.7301][acc of former samples in all classes: 0.6736]
[acc of novel samples in all classes: 0.2504]
2022-11-06 02:11:23,899 INFO: Session 3: 42.10+-0.58[acc of former classes: 0.7283][acc of former samples in all classes: 0.6320]
[acc of novel samples in all classes: 0.2099]
2022-11-06 02:11:23,899 INFO: Session 4: 35.42+-0.58[acc of former classes: 0.7293][acc of former samples in all classes: 0.6096]
[acc of novel samples in all classes: 0.1839]
2022-11-06 02:11:23,899 INFO: Session 5: 31.03+-0.56[acc of former classes: 0.7298][acc of former samples in all classes: 0.5871]
[acc of novel samples in all classes: 0.1719]
2022-11-06 02:11:23,899 INFO: Session 6: 28.12+-0.45[acc of former classes: 0.7292][acc of former samples in all classes: 0.5712]
[acc of novel samples in all classes: 0.1652]
2022-11-06 02:11:23,899 INFO: Session 7: 24.95+-0.41[acc of former classes: 0.7288][acc of former samples in all classes: 0.5591]
[acc of novel samples in all classes: 0.1464]
2022-11-06 02:11:23,899 INFO: Session 8: 23.04+-0.48[acc of former classes: 0.7286][acc of former samples in all classes: 0.5370]
[acc of novel samples in all classes: 0.1428]
2022-11-06 02:11:23,900 INFO: Session 9: 21.38+-0.43[acc of former classes: 0.7278][acc of former samples in all classes: 0.5257]
[acc of novel samples in all classes: 0.1358]
2022-11-06 02:11:23,900 INFO: random seed: 1997
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/F2M_res18_cifar_5shots_debug_20base_02/models/test4_session_8.pth
finish!!
