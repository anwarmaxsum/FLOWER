/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-05 14:32:28,278 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-05 14:32:28,278 INFO: 
  name: FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base
  model_type: FSLLModel
  gpu: 1
  manual_seed: 1997
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  datasets:[
    train:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: 25
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    val:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    test:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: True
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
  ]
  network_g:[
    type: Resnet20_cifar_small
    num_classes: 20
    adopt_classifier: False
    flatten: True
  ]
  path:[
    pretrain_model_g: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
    base_model: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base
    training_states: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/training_states
    log: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base
    models: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models
    prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.001
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [160]
      gamma: 0.1
    ]
    fine_tune: True
    fine_tune_epoch: 15
    threshold: 0.4
    warmup_iter: -1
    bases: 20
    tasks: 9
    shots: 5
    novel_exemplars: 5
    num_test: 5
    metric_opt:[
      type: TripletLossNoHardMining
      margin: 0.0
      num_instances: 5
    ]
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
    regularization:[
      type: IncrementalNetworkFixLoss
      w: 5.0
    ]
  ]
  val:[
    val_freq: 1000
    test_type: NCM
    p_norm: None
  ]
  logger:[
    print_freq: 2
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-05 14:32:28,278 INFO: Random seed: 1997
2022-11-05 14:32:30,384 INFO: Network: Resnet20_cifar_small, with parameters: 271,824
2022-11-05 14:32:30,385 INFO: Resnet20_cifar_small(
  (func): ResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (avg_pool): AdaptiveAvgPool2d(output_size=(1, 1))
  )
)
2022-11-05 14:32:30,385 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:32:30,390 WARNING: Current net - loaded net:
2022-11-05 14:32:30,391 WARNING: Loaded net - current net:
2022-11-05 14:32:30,391 WARNING:   func.fc.bias
2022-11-05 14:32:30,391 WARNING:   func.fc.weight
2022-11-05 14:32:30,446 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:32:30,451 WARNING: Current net - loaded net:
2022-11-05 14:32:30,452 WARNING: Loaded net - current net:
2022-11-05 14:32:30,452 WARNING:   func.fc.bias
2022-11-05 14:32:30,452 WARNING:   func.fc.weight
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:32:30,539 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:32:30,540 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:32:30,540 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:32:30,540 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:32:30,540 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:32:30,541 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:32:30,542 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:32:30,542 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:32:30,542 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:32:30,542 INFO: Model [FSLLModel] is created.
2022-11-05 14:32:50,383 INFO: [Test_acc of task 0 on test 0: 0.75000][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.75000]
2022-11-05 14:32:50,439 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:32:50,447 WARNING: Current net - loaded net:
2022-11-05 14:32:50,447 WARNING: Loaded net - current net:
2022-11-05 14:32:50,447 WARNING:   func.fc.bias
2022-11-05 14:32:50,447 WARNING:   func.fc.weight
2022-11-05 14:32:50,506 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth.
2022-11-05 14:32:50,565 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:32:50,604 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:32:50,605 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:32:50,605 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:32:50,606 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:32:50,607 INFO: Model [FSLLModel] is created.
2022-11-05 14:32:50,618 INFO: Dataset NormalDataset - cifar-100 is created.
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
/workspace/FLOWER/f2m/methods/losses/losses.py:736: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1005.)
  dist.addmm_(1, -2, inputs, inputs.t())
2022-11-05 14:32:54,315 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3381, Pos_dist: 4.7552, Neg_dist: 6.8359, Acc: 0.6800, PTFixPNLoss: 3.1674, NetFixLoss: 0.0000, ]
2022-11-05 14:32:55,903 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3309, Pos_dist: 4.9210, Neg_dist: 6.6497, Acc: 0.5200, PTFixPNLoss: 3.1810, NetFixLoss: 0.0205, ]
2022-11-05 14:32:57,579 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2537, Pos_dist: 4.7258, Neg_dist: 7.1165, Acc: 0.6400, PTFixPNLoss: 3.1666, NetFixLoss: 0.0495, ]
2022-11-05 14:32:59,113 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1951, Pos_dist: 4.7851, Neg_dist: 7.3203, Acc: 0.6200, PTFixPNLoss: 3.1744, NetFixLoss: 0.0893, ]
2022-11-05 14:33:00,627 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2387, Pos_dist: 4.7719, Neg_dist: 7.3991, Acc: 0.5800, PTFixPNLoss: 3.1764, NetFixLoss: 0.1375, ]
2022-11-05 14:33:02,262 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2706, Pos_dist: 4.8571, Neg_dist: 6.8986, Acc: 0.5200, PTFixPNLoss: 3.1763, NetFixLoss: 0.1921, ]
2022-11-05 14:33:03,470 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1875, Pos_dist: 4.6821, Neg_dist: 7.0501, Acc: 0.6200, PTFixPNLoss: 3.1638, NetFixLoss: 0.2492, ]
2022-11-05 14:33:04,998 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2556, Pos_dist: 4.8781, Neg_dist: 7.1765, Acc: 0.5400, PTFixPNLoss: 3.1712, NetFixLoss: 0.3088, ]
2022-11-05 14:33:06,554 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4415, Pos_dist: 4.7194, Neg_dist: 6.1690, Acc: 0.5200, PTFixPNLoss: 3.1771, NetFixLoss: 0.3740, ]
2022-11-05 14:33:07,560 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3189, Pos_dist: 4.8029, Neg_dist: 6.9968, Acc: 0.5800, PTFixPNLoss: 3.1721, NetFixLoss: 0.4439, ]
2022-11-05 14:33:09,155 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1224, Pos_dist: 4.7250, Neg_dist: 7.0289, Acc: 0.5800, PTFixPNLoss: 3.1693, NetFixLoss: 0.5172, ]
2022-11-05 14:33:10,685 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2292, Pos_dist: 4.7822, Neg_dist: 6.7785, Acc: 0.5600, PTFixPNLoss: 3.1736, NetFixLoss: 0.5888, ]
2022-11-05 14:33:12,154 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3841, Pos_dist: 4.7780, Neg_dist: 6.3310, Acc: 0.5600, PTFixPNLoss: 3.1689, NetFixLoss: 0.6614, ]
2022-11-05 14:33:13,337 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1414, Pos_dist: 4.9265, Neg_dist: 7.4472, Acc: 0.5000, PTFixPNLoss: 3.1801, NetFixLoss: 0.7364, ]
2022-11-05 14:33:14,740 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4008, Pos_dist: 4.7490, Neg_dist: 6.7588, Acc: 0.5800, PTFixPNLoss: 3.1744, NetFixLoss: 0.8138, ]
2022-11-05 14:33:14,821 INFO: fine-tune procedure is finished!
2022-11-05 14:33:38,476 INFO: [Test_acc of task 1 on test 0: 0.53100][acc of former classes: 0.72500][acc of former samples in all classes: 0.67150]
[acc of novel samples in all classes: 0.25000]
2022-11-05 14:33:38,530 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:33:38,536 WARNING: Current net - loaded net:
2022-11-05 14:33:38,536 WARNING: Loaded net - current net:
2022-11-05 14:33:38,536 WARNING:   func.fc.bias
2022-11-05 14:33:38,536 WARNING:   func.fc.weight
2022-11-05 14:33:38,573 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_1.pth.
2022-11-05 14:33:38,632 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:33:38,674 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:33:38,674 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:33:38,674 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:33:38,674 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:33:38,675 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:33:38,676 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:33:38,676 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:33:38,677 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:33:38,678 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:33:38,678 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:33:38,678 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:33:38,678 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:33:38,678 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:33:38,678 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:33:38,678 INFO: Model [FSLLModel] is created.
2022-11-05 14:33:38,692 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:33:38,702 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-05 14:33:40,659 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2685, Pos_dist: 4.7783, Neg_dist: 6.7530, Acc: 0.5200, PTFixPNLoss: 3.4712, NetFixLoss: 0.0000, ]
2022-11-05 14:33:42,885 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1781, Pos_dist: 4.7295, Neg_dist: 7.0612, Acc: 0.5400, PTFixPNLoss: 3.4646, NetFixLoss: 0.0220, ]
2022-11-05 14:33:45,082 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3294, Pos_dist: 4.8585, Neg_dist: 7.2676, Acc: 0.5500, PTFixPNLoss: 3.4710, NetFixLoss: 0.0471, ]
2022-11-05 14:33:47,460 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4850, Pos_dist: 4.8546, Neg_dist: 6.2609, Acc: 0.4800, PTFixPNLoss: 3.4728, NetFixLoss: 0.0793, ]
2022-11-05 14:33:49,122 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2448, Pos_dist: 4.7127, Neg_dist: 6.9203, Acc: 0.4700, PTFixPNLoss: 3.4645, NetFixLoss: 0.1203, ]
2022-11-05 14:33:51,206 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2211, Pos_dist: 4.7541, Neg_dist: 7.2643, Acc: 0.5400, PTFixPNLoss: 3.4756, NetFixLoss: 0.1674, ]
2022-11-05 14:33:53,591 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3871, Pos_dist: 4.7946, Neg_dist: 6.4961, Acc: 0.4700, PTFixPNLoss: 3.4670, NetFixLoss: 0.2140, ]
2022-11-05 14:33:56,374 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4804, Pos_dist: 4.7335, Neg_dist: 6.1401, Acc: 0.5300, PTFixPNLoss: 3.4701, NetFixLoss: 0.2623, ]
2022-11-05 14:33:58,767 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4277, Pos_dist: 4.8089, Neg_dist: 6.1978, Acc: 0.4900, PTFixPNLoss: 3.4717, NetFixLoss: 0.3137, ]
2022-11-05 14:34:01,487 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1637, Pos_dist: 4.7529, Neg_dist: 7.3980, Acc: 0.4600, PTFixPNLoss: 3.4705, NetFixLoss: 0.3677, ]
2022-11-05 14:34:03,647 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2443, Pos_dist: 4.7839, Neg_dist: 6.9960, Acc: 0.5100, PTFixPNLoss: 3.4700, NetFixLoss: 0.4215, ]
2022-11-05 14:34:05,228 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3980, Pos_dist: 4.8306, Neg_dist: 6.2085, Acc: 0.5100, PTFixPNLoss: 3.4701, NetFixLoss: 0.4736, ]
2022-11-05 14:34:07,612 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4721, Pos_dist: 4.7824, Neg_dist: 6.0940, Acc: 0.5200, PTFixPNLoss: 3.4726, NetFixLoss: 0.5276, ]
2022-11-05 14:34:10,477 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2196, Pos_dist: 4.6466, Neg_dist: 7.2841, Acc: 0.5300, PTFixPNLoss: 3.4637, NetFixLoss: 0.5843, ]
2022-11-05 14:34:12,731 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1979, Pos_dist: 4.8390, Neg_dist: 7.2671, Acc: 0.4300, PTFixPNLoss: 3.4728, NetFixLoss: 0.6427, ]
2022-11-05 14:34:12,857 INFO: fine-tune procedure is finished!
2022-11-05 14:34:45,326 INFO: [Test_acc of task 2 on test 0: 0.38675][acc of former classes: 0.71650][acc of former samples in all classes: 0.58550]
[acc of novel samples in all classes: 0.18800]
2022-11-05 14:34:45,358 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:34:45,368 WARNING: Current net - loaded net:
2022-11-05 14:34:45,368 WARNING: Loaded net - current net:
2022-11-05 14:34:45,368 WARNING:   func.fc.bias
2022-11-05 14:34:45,368 WARNING:   func.fc.weight
2022-11-05 14:34:45,375 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_2.pth.
2022-11-05 14:34:45,389 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:34:45,408 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:34:45,409 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:34:45,409 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:34:45,410 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:34:45,411 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:34:45,412 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:34:45,413 INFO: Model [FSLLModel] is created.
2022-11-05 14:34:45,431 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:34:45,449 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:34:45,468 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-05 14:34:47,891 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1366, Pos_dist: 4.6308, Neg_dist: 7.6926, Acc: 0.4867, PTFixPNLoss: 3.6935, NetFixLoss: 0.0000, ]
2022-11-05 14:34:50,804 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4101, Pos_dist: 4.7007, Neg_dist: 6.0866, Acc: 0.4867, PTFixPNLoss: 3.6967, NetFixLoss: 0.0154, ]
2022-11-05 14:34:53,390 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2496, Pos_dist: 4.6145, Neg_dist: 6.9651, Acc: 0.4933, PTFixPNLoss: 3.6977, NetFixLoss: 0.0421, ]
2022-11-05 14:34:56,523 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2939, Pos_dist: 4.6506, Neg_dist: 6.7067, Acc: 0.4933, PTFixPNLoss: 3.6969, NetFixLoss: 0.0748, ]
2022-11-05 14:34:59,894 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2711, Pos_dist: 4.6463, Neg_dist: 6.6013, Acc: 0.5000, PTFixPNLoss: 3.6954, NetFixLoss: 0.1121, ]
2022-11-05 14:35:01,189 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4646, Pos_dist: 4.6594, Neg_dist: 6.0627, Acc: 0.5333, PTFixPNLoss: 3.6861, NetFixLoss: 0.1529, ]
2022-11-05 14:35:03,983 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4080, Pos_dist: 4.6848, Neg_dist: 6.4862, Acc: 0.5267, PTFixPNLoss: 3.6936, NetFixLoss: 0.1966, ]
2022-11-05 14:35:06,524 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2584, Pos_dist: 4.5997, Neg_dist: 6.5432, Acc: 0.5067, PTFixPNLoss: 3.6927, NetFixLoss: 0.2422, ]
2022-11-05 14:35:09,556 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1445, Pos_dist: 4.6481, Neg_dist: 7.4756, Acc: 0.4600, PTFixPNLoss: 3.6929, NetFixLoss: 0.2900, ]
2022-11-05 14:35:12,960 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2586, Pos_dist: 4.6333, Neg_dist: 6.7797, Acc: 0.5067, PTFixPNLoss: 3.6919, NetFixLoss: 0.3384, ]
2022-11-05 14:35:15,759 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2153, Pos_dist: 4.6670, Neg_dist: 6.7199, Acc: 0.4400, PTFixPNLoss: 3.6920, NetFixLoss: 0.3894, ]
2022-11-05 14:35:18,123 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3616, Pos_dist: 4.6545, Neg_dist: 6.2984, Acc: 0.4600, PTFixPNLoss: 3.6923, NetFixLoss: 0.4422, ]
2022-11-05 14:35:21,753 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3571, Pos_dist: 4.6424, Neg_dist: 6.2555, Acc: 0.5133, PTFixPNLoss: 3.6881, NetFixLoss: 0.4956, ]
2022-11-05 14:35:24,633 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2043, Pos_dist: 4.5939, Neg_dist: 6.7202, Acc: 0.5133, PTFixPNLoss: 3.6905, NetFixLoss: 0.5495, ]
2022-11-05 14:35:27,626 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2237, Pos_dist: 4.6067, Neg_dist: 6.5162, Acc: 0.4667, PTFixPNLoss: 3.6905, NetFixLoss: 0.6042, ]
2022-11-05 14:35:27,739 INFO: fine-tune procedure is finished!
2022-11-05 14:36:07,122 INFO: [Test_acc of task 3 on test 0: 0.31360][acc of former classes: 0.72600][acc of former samples in all classes: 0.53400]
[acc of novel samples in all classes: 0.16667]
2022-11-05 14:36:07,194 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:36:07,203 WARNING: Current net - loaded net:
2022-11-05 14:36:07,203 WARNING: Loaded net - current net:
2022-11-05 14:36:07,203 WARNING:   func.fc.bias
2022-11-05 14:36:07,203 WARNING:   func.fc.weight
2022-11-05 14:36:07,253 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_3.pth.
2022-11-05 14:36:07,315 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:36:07,361 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:36:07,361 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:36:07,361 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:36:07,362 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:36:07,363 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:36:07,363 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:36:07,363 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:36:07,364 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:36:07,365 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:36:07,366 INFO: Model [FSLLModel] is created.
2022-11-05 14:36:07,380 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:36:07,391 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:36:07,403 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:36:07,414 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-05 14:36:11,450 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1602, Pos_dist: 4.5751, Neg_dist: 7.3615, Acc: 0.5100, PTFixPNLoss: 3.8660, NetFixLoss: 0.0000, ]
2022-11-05 14:36:15,221 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1128, Pos_dist: 4.6206, Neg_dist: 8.0312, Acc: 0.4650, PTFixPNLoss: 3.8700, NetFixLoss: 0.0130, ]
2022-11-05 14:36:19,195 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2470, Pos_dist: 4.5852, Neg_dist: 6.6827, Acc: 0.5000, PTFixPNLoss: 3.8677, NetFixLoss: 0.0287, ]
2022-11-05 14:36:23,398 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2015, Pos_dist: 4.5445, Neg_dist: 7.5512, Acc: 0.5550, PTFixPNLoss: 3.8666, NetFixLoss: 0.0505, ]
2022-11-05 14:36:26,209 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0538, Pos_dist: 4.5437, Neg_dist: 7.9520, Acc: 0.5500, PTFixPNLoss: 3.8637, NetFixLoss: 0.0760, ]
2022-11-05 14:36:29,510 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1833, Pos_dist: 4.5540, Neg_dist: 7.1606, Acc: 0.4850, PTFixPNLoss: 3.8668, NetFixLoss: 0.1029, ]
2022-11-05 14:36:33,247 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2363, Pos_dist: 4.5507, Neg_dist: 6.8736, Acc: 0.4600, PTFixPNLoss: 3.8686, NetFixLoss: 0.1306, ]
2022-11-05 14:36:36,980 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3036, Pos_dist: 4.6207, Neg_dist: 6.6940, Acc: 0.4900, PTFixPNLoss: 3.8675, NetFixLoss: 0.1599, ]
2022-11-05 14:36:40,762 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3481, Pos_dist: 4.6196, Neg_dist: 6.3609, Acc: 0.4850, PTFixPNLoss: 3.8669, NetFixLoss: 0.1912, ]
2022-11-05 14:36:44,090 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2029, Pos_dist: 4.6517, Neg_dist: 7.0097, Acc: 0.4600, PTFixPNLoss: 3.8714, NetFixLoss: 0.2245, ]
2022-11-05 14:36:49,080 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0702, Pos_dist: 4.5725, Neg_dist: 8.3026, Acc: 0.5300, PTFixPNLoss: 3.8665, NetFixLoss: 0.2594, ]
2022-11-05 14:36:53,443 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2772, Pos_dist: 4.5615, Neg_dist: 6.6286, Acc: 0.4750, PTFixPNLoss: 3.8741, NetFixLoss: 0.2964, ]
2022-11-05 14:36:57,292 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1653, Pos_dist: 4.6351, Neg_dist: 7.7358, Acc: 0.5000, PTFixPNLoss: 3.8673, NetFixLoss: 0.3335, ]
2022-11-05 14:37:00,808 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3309, Pos_dist: 4.6098, Neg_dist: 6.5228, Acc: 0.4800, PTFixPNLoss: 3.8717, NetFixLoss: 0.3711, ]
2022-11-05 14:37:04,661 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2969, Pos_dist: 4.6060, Neg_dist: 6.7060, Acc: 0.5100, PTFixPNLoss: 3.8656, NetFixLoss: 0.4118, ]
2022-11-05 14:37:04,797 INFO: fine-tune procedure is finished!
2022-11-05 14:37:53,343 INFO: [Test_acc of task 4 on test 0: 0.28467][acc of former classes: 0.74200][acc of former samples in all classes: 0.51700]
[acc of novel samples in all classes: 0.16850]
2022-11-05 14:37:53,415 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:37:53,422 WARNING: Current net - loaded net:
2022-11-05 14:37:53,422 WARNING: Loaded net - current net:
2022-11-05 14:37:53,422 WARNING:   func.fc.bias
2022-11-05 14:37:53,422 WARNING:   func.fc.weight
2022-11-05 14:37:53,477 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_4.pth.
2022-11-05 14:37:53,539 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:37:53,629 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:37:53,629 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:37:53,629 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:37:53,629 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:37:53,629 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:37:53,630 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:37:53,631 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:37:53,631 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:37:53,632 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:37:53,633 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:37:53,634 INFO: Model [FSLLModel] is created.
2022-11-05 14:37:53,652 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:37:53,669 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:37:53,686 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:37:53,698 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:37:53,711 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:37:58,124 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2957, Pos_dist: 4.5452, Neg_dist: 6.4153, Acc: 0.4960, PTFixPNLoss: 4.0186, NetFixLoss: 0.0000, ]
2022-11-05 14:38:01,833 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1991, Pos_dist: 4.5966, Neg_dist: 7.4250, Acc: 0.4400, PTFixPNLoss: 4.0275, NetFixLoss: 0.0202, ]
2022-11-05 14:38:05,906 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2620, Pos_dist: 4.5800, Neg_dist: 7.0786, Acc: 0.4480, PTFixPNLoss: 4.0262, NetFixLoss: 0.0437, ]
2022-11-05 14:38:10,279 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4076, Pos_dist: 4.5994, Neg_dist: 6.1939, Acc: 0.4520, PTFixPNLoss: 4.0280, NetFixLoss: 0.0705, ]
2022-11-05 14:38:14,554 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3173, Pos_dist: 4.5246, Neg_dist: 6.4676, Acc: 0.4720, PTFixPNLoss: 4.0232, NetFixLoss: 0.1001, ]
2022-11-05 14:38:19,291 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2938, Pos_dist: 4.5716, Neg_dist: 6.3870, Acc: 0.4880, PTFixPNLoss: 4.0245, NetFixLoss: 0.1331, ]
2022-11-05 14:38:23,427 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3214, Pos_dist: 4.5521, Neg_dist: 6.3373, Acc: 0.4600, PTFixPNLoss: 4.0254, NetFixLoss: 0.1689, ]
2022-11-05 14:38:28,463 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3762, Pos_dist: 4.6107, Neg_dist: 6.2165, Acc: 0.5080, PTFixPNLoss: 4.0244, NetFixLoss: 0.2062, ]
2022-11-05 14:38:32,697 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3356, Pos_dist: 4.6072, Neg_dist: 6.3375, Acc: 0.4360, PTFixPNLoss: 4.0244, NetFixLoss: 0.2462, ]
2022-11-05 14:38:37,228 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1414, Pos_dist: 4.5966, Neg_dist: 8.1764, Acc: 0.4920, PTFixPNLoss: 4.0269, NetFixLoss: 0.2871, ]
2022-11-05 14:38:41,186 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3350, Pos_dist: 4.5775, Neg_dist: 6.5042, Acc: 0.4480, PTFixPNLoss: 4.0263, NetFixLoss: 0.3275, ]
2022-11-05 14:38:45,525 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2689, Pos_dist: 4.5855, Neg_dist: 6.6465, Acc: 0.4560, PTFixPNLoss: 4.0228, NetFixLoss: 0.3679, ]
2022-11-05 14:38:50,138 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3464, Pos_dist: 4.5200, Neg_dist: 6.3736, Acc: 0.4880, PTFixPNLoss: 4.0232, NetFixLoss: 0.4078, ]
2022-11-05 14:38:54,261 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3377, Pos_dist: 4.5279, Neg_dist: 6.4978, Acc: 0.4320, PTFixPNLoss: 4.0233, NetFixLoss: 0.4484, ]
2022-11-05 14:38:58,223 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4011, Pos_dist: 4.5733, Neg_dist: 6.2261, Acc: 0.4920, PTFixPNLoss: 4.0232, NetFixLoss: 0.4906, ]
2022-11-05 14:38:58,470 INFO: fine-tune procedure is finished!
2022-11-05 14:39:51,214 INFO: [Test_acc of task 5 on test 0: 0.25686][acc of former classes: 0.74350][acc of former samples in all classes: 0.49050]
[acc of novel samples in all classes: 0.16340]
2022-11-05 14:39:51,290 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:39:51,300 WARNING: Current net - loaded net:
2022-11-05 14:39:51,300 WARNING: Loaded net - current net:
2022-11-05 14:39:51,300 WARNING:   func.fc.bias
2022-11-05 14:39:51,300 WARNING:   func.fc.weight
2022-11-05 14:39:51,331 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_5.pth.
2022-11-05 14:39:51,386 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:39:51,431 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:39:51,432 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:39:51,432 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:39:51,432 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:39:51,433 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:39:51,434 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:39:51,434 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:39:51,434 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:39:51,434 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:39:51,434 INFO: Model [FSLLModel] is created.
2022-11-05 14:39:51,445 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:39:51,455 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:39:51,465 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:39:51,475 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:39:51,485 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:39:51,495 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:39:57,020 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3110, Pos_dist: 4.5487, Neg_dist: 6.4997, Acc: 0.4800, PTFixPNLoss: 4.1585, NetFixLoss: 0.0000, ]
2022-11-05 14:40:02,416 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1815, Pos_dist: 4.5504, Neg_dist: 6.9558, Acc: 0.4933, PTFixPNLoss: 4.1670, NetFixLoss: 0.0188, ]
2022-11-05 14:40:08,560 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2924, Pos_dist: 4.5840, Neg_dist: 6.6018, Acc: 0.4733, PTFixPNLoss: 4.1617, NetFixLoss: 0.0415, ]
2022-11-05 14:40:13,118 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3967, Pos_dist: 4.6163, Neg_dist: 6.3036, Acc: 0.4367, PTFixPNLoss: 4.1613, NetFixLoss: 0.0698, ]
2022-11-05 14:40:18,260 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2103, Pos_dist: 4.5411, Neg_dist: 6.8596, Acc: 0.5100, PTFixPNLoss: 4.1641, NetFixLoss: 0.1021, ]
2022-11-05 14:40:23,404 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1363, Pos_dist: 4.5751, Neg_dist: 7.6210, Acc: 0.4900, PTFixPNLoss: 4.1643, NetFixLoss: 0.1369, ]
2022-11-05 14:40:28,555 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1510, Pos_dist: 4.5514, Neg_dist: 7.2882, Acc: 0.4633, PTFixPNLoss: 4.1581, NetFixLoss: 0.1732, ]
2022-11-05 14:40:34,105 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2476, Pos_dist: 4.5792, Neg_dist: 6.6643, Acc: 0.4700, PTFixPNLoss: 4.1623, NetFixLoss: 0.2087, ]
2022-11-05 14:40:38,640 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2546, Pos_dist: 4.5303, Neg_dist: 6.5315, Acc: 0.4367, PTFixPNLoss: 4.1645, NetFixLoss: 0.2450, ]
2022-11-05 14:40:43,675 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3304, Pos_dist: 4.6004, Neg_dist: 6.5338, Acc: 0.4300, PTFixPNLoss: 4.1668, NetFixLoss: 0.2821, ]
2022-11-05 14:40:48,962 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2658, Pos_dist: 4.5536, Neg_dist: 6.6100, Acc: 0.4733, PTFixPNLoss: 4.1635, NetFixLoss: 0.3217, ]
2022-11-05 14:40:54,818 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1226, Pos_dist: 4.5365, Neg_dist: 7.4817, Acc: 0.4700, PTFixPNLoss: 4.1624, NetFixLoss: 0.3629, ]
2022-11-05 14:41:00,265 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2355, Pos_dist: 4.5550, Neg_dist: 6.7419, Acc: 0.4233, PTFixPNLoss: 4.1641, NetFixLoss: 0.4037, ]
2022-11-05 14:41:05,247 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2693, Pos_dist: 4.5483, Neg_dist: 6.6122, Acc: 0.4767, PTFixPNLoss: 4.1596, NetFixLoss: 0.4441, ]
2022-11-05 14:41:10,500 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2666, Pos_dist: 4.5764, Neg_dist: 6.5377, Acc: 0.4600, PTFixPNLoss: 4.1598, NetFixLoss: 0.4887, ]
2022-11-05 14:41:10,748 INFO: fine-tune procedure is finished!
2022-11-05 14:42:10,888 INFO: [Test_acc of task 6 on test 0: 0.23463][acc of former classes: 0.74950][acc of former samples in all classes: 0.48950]
[acc of novel samples in all classes: 0.14967]
2022-11-05 14:42:10,982 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:42:10,989 WARNING: Current net - loaded net:
2022-11-05 14:42:10,989 WARNING: Loaded net - current net:
2022-11-05 14:42:10,989 WARNING:   func.fc.bias
2022-11-05 14:42:10,989 WARNING:   func.fc.weight
2022-11-05 14:42:11,054 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_6.pth.
2022-11-05 14:42:11,124 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:42:11,155 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:42:11,156 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:42:11,156 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:42:11,156 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:42:11,157 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:42:11,158 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:42:11,159 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:42:11,159 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:42:11,159 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:42:11,159 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:42:11,159 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:42:11,159 INFO: Model [FSLLModel] is created.
2022-11-05 14:42:11,177 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:11,190 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:11,201 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:11,230 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:11,243 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:11,254 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:11,265 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:42:16,864 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3400, Pos_dist: 4.4749, Neg_dist: 6.0595, Acc: 0.4629, PTFixPNLoss: 4.2774, NetFixLoss: 0.0000, ]
2022-11-05 14:42:22,480 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3004, Pos_dist: 4.5046, Neg_dist: 6.4052, Acc: 0.4714, PTFixPNLoss: 4.2745, NetFixLoss: 0.0195, ]
2022-11-05 14:42:27,738 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2962, Pos_dist: 4.5528, Neg_dist: 6.5296, Acc: 0.4343, PTFixPNLoss: 4.2762, NetFixLoss: 0.0424, ]
2022-11-05 14:42:34,166 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2647, Pos_dist: 4.5118, Neg_dist: 6.5868, Acc: 0.4429, PTFixPNLoss: 4.2809, NetFixLoss: 0.0702, ]
2022-11-05 14:42:39,479 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1987, Pos_dist: 4.5336, Neg_dist: 7.1975, Acc: 0.4571, PTFixPNLoss: 4.2751, NetFixLoss: 0.1011, ]
2022-11-05 14:42:44,845 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2276, Pos_dist: 4.4877, Neg_dist: 6.6207, Acc: 0.4571, PTFixPNLoss: 4.2755, NetFixLoss: 0.1341, ]
2022-11-05 14:42:50,965 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1027, Pos_dist: 4.5517, Neg_dist: 8.0321, Acc: 0.4686, PTFixPNLoss: 4.2762, NetFixLoss: 0.1690, ]
2022-11-05 14:42:57,472 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2488, Pos_dist: 4.5209, Neg_dist: 6.8232, Acc: 0.4429, PTFixPNLoss: 4.2766, NetFixLoss: 0.2036, ]
2022-11-05 14:43:02,972 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3462, Pos_dist: 4.5657, Neg_dist: 6.2863, Acc: 0.4629, PTFixPNLoss: 4.2770, NetFixLoss: 0.2385, ]
2022-11-05 14:43:07,910 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2565, Pos_dist: 4.4989, Neg_dist: 6.4960, Acc: 0.4486, PTFixPNLoss: 4.2748, NetFixLoss: 0.2746, ]
2022-11-05 14:43:13,891 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2400, Pos_dist: 4.4875, Neg_dist: 6.6566, Acc: 0.4486, PTFixPNLoss: 4.2726, NetFixLoss: 0.3128, ]
2022-11-05 14:43:19,843 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3317, Pos_dist: 4.5548, Neg_dist: 6.4044, Acc: 0.4286, PTFixPNLoss: 4.2757, NetFixLoss: 0.3515, ]
2022-11-05 14:43:25,701 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1299, Pos_dist: 4.5236, Neg_dist: 7.4891, Acc: 0.4600, PTFixPNLoss: 4.2753, NetFixLoss: 0.3908, ]
2022-11-05 14:43:30,441 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2686, Pos_dist: 4.5081, Neg_dist: 6.5355, Acc: 0.4629, PTFixPNLoss: 4.2744, NetFixLoss: 0.4310, ]
2022-11-05 14:43:36,235 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1906, Pos_dist: 4.5016, Neg_dist: 7.2478, Acc: 0.4771, PTFixPNLoss: 4.2756, NetFixLoss: 0.4708, ]
2022-11-05 14:43:36,376 INFO: fine-tune procedure is finished!
2022-11-05 14:44:44,286 INFO: [Test_acc of task 7 on test 0: 0.21922][acc of former classes: 0.75150][acc of former samples in all classes: 0.48050]
[acc of novel samples in all classes: 0.14457]
2022-11-05 14:44:44,364 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:44:44,372 WARNING: Current net - loaded net:
2022-11-05 14:44:44,372 WARNING: Loaded net - current net:
2022-11-05 14:44:44,372 WARNING:   func.fc.bias
2022-11-05 14:44:44,372 WARNING:   func.fc.weight
2022-11-05 14:44:44,429 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_7.pth.
2022-11-05 14:44:44,444 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:44:44,465 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:44:44,465 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:44:44,465 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:44:44,466 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:44:44,466 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:44:44,466 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:44:44,466 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:44:44,467 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:44:44,468 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:44:44,468 INFO: Model [FSLLModel] is created.
2022-11-05 14:44:44,480 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:44,490 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:44,500 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:44,510 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:44,520 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:44,530 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:44,539 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:44,549 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:44:48,217 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3118, Pos_dist: 4.5040, Neg_dist: 6.5486, Acc: 0.4700, PTFixPNLoss: 4.3794, NetFixLoss: 0.0000, ]
2022-11-05 14:44:53,843 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0478, Pos_dist: 4.4800, Neg_dist: 8.2435, Acc: 0.4500, PTFixPNLoss: 4.3791, NetFixLoss: 0.0177, ]
2022-11-05 14:44:59,042 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3841, Pos_dist: 4.4650, Neg_dist: 5.9693, Acc: 0.4550, PTFixPNLoss: 4.3769, NetFixLoss: 0.0355, ]
2022-11-05 14:45:04,472 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2170, Pos_dist: 4.4858, Neg_dist: 6.8052, Acc: 0.4575, PTFixPNLoss: 4.3804, NetFixLoss: 0.0571, ]
2022-11-05 14:45:10,168 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3337, Pos_dist: 4.5044, Neg_dist: 6.2485, Acc: 0.4600, PTFixPNLoss: 4.3836, NetFixLoss: 0.0825, ]
2022-11-05 14:45:13,222 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1550, Pos_dist: 4.5118, Neg_dist: 7.2141, Acc: 0.4225, PTFixPNLoss: 4.3810, NetFixLoss: 0.1111, ]
2022-11-05 14:45:19,043 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0397, Pos_dist: 4.5027, Neg_dist: 9.2290, Acc: 0.4625, PTFixPNLoss: 4.3765, NetFixLoss: 0.1416, ]
2022-11-05 14:45:25,230 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3134, Pos_dist: 4.5222, Neg_dist: 6.4052, Acc: 0.4075, PTFixPNLoss: 4.3822, NetFixLoss: 0.1716, ]
2022-11-05 14:45:31,046 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2756, Pos_dist: 4.4697, Neg_dist: 6.4062, Acc: 0.4500, PTFixPNLoss: 4.3778, NetFixLoss: 0.2027, ]
2022-11-05 14:45:37,395 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3317, Pos_dist: 4.5193, Neg_dist: 6.2329, Acc: 0.4625, PTFixPNLoss: 4.3809, NetFixLoss: 0.2347, ]
2022-11-05 14:45:43,235 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2878, Pos_dist: 4.4642, Neg_dist: 6.2753, Acc: 0.4250, PTFixPNLoss: 4.3809, NetFixLoss: 0.2675, ]
2022-11-05 14:45:48,965 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2889, Pos_dist: 4.5190, Neg_dist: 6.4031, Acc: 0.4475, PTFixPNLoss: 4.3820, NetFixLoss: 0.3007, ]
2022-11-05 14:45:54,356 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3539, Pos_dist: 4.5201, Neg_dist: 6.3340, Acc: 0.4625, PTFixPNLoss: 4.3789, NetFixLoss: 0.3350, ]
2022-11-05 14:46:00,305 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3065, Pos_dist: 4.4952, Neg_dist: 6.2174, Acc: 0.4525, PTFixPNLoss: 4.3794, NetFixLoss: 0.3710, ]
2022-11-05 14:46:06,725 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1331, Pos_dist: 4.4723, Neg_dist: 7.2945, Acc: 0.4625, PTFixPNLoss: 4.3769, NetFixLoss: 0.4087, ]
2022-11-05 14:46:06,950 INFO: fine-tune procedure is finished!
2022-11-05 14:47:24,656 INFO: [Test_acc of task 8 on test 0: 0.19810][acc of former classes: 0.75050][acc of former samples in all classes: 0.45800]
[acc of novel samples in all classes: 0.13312]
2022-11-05 14:47:24,738 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:47:24,745 WARNING: Current net - loaded net:
2022-11-05 14:47:24,745 WARNING: Loaded net - current net:
2022-11-05 14:47:24,745 WARNING:   func.fc.bias
2022-11-05 14:47:24,745 WARNING:   func.fc.weight
2022-11-05 14:47:24,806 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth.
2022-11-05 14:47:24,873 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:47:24,913 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:47:24,913 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:47:24,913 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:47:24,913 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:47:24,914 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:47:24,915 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:47:24,915 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:47:24,916 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:47:24,916 INFO: Model [FSLLModel] is created.
2022-11-05 14:47:24,930 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-05 14:47:26,494 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2301, Pos_dist: 4.5400, Neg_dist: 6.4843, Acc: 0.5200, PTFixPNLoss: 3.1535, NetFixLoss: 0.0000, ]
2022-11-05 14:47:27,757 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2594, Pos_dist: 4.6316, Neg_dist: 6.6839, Acc: 0.6200, PTFixPNLoss: 3.1533, NetFixLoss: 0.0250, ]
2022-11-05 14:47:29,566 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2043, Pos_dist: 4.5212, Neg_dist: 6.7493, Acc: 0.6600, PTFixPNLoss: 3.1555, NetFixLoss: 0.0620, ]
2022-11-05 14:47:31,003 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1810, Pos_dist: 4.4467, Neg_dist: 6.6592, Acc: 0.7200, PTFixPNLoss: 3.1535, NetFixLoss: 0.1093, ]
2022-11-05 14:47:32,205 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2300, Pos_dist: 4.4770, Neg_dist: 6.4873, Acc: 0.6800, PTFixPNLoss: 3.1581, NetFixLoss: 0.1593, ]
2022-11-05 14:47:33,948 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1673, Pos_dist: 4.4751, Neg_dist: 6.9435, Acc: 0.7000, PTFixPNLoss: 3.1529, NetFixLoss: 0.2121, ]
2022-11-05 14:47:35,385 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1887, Pos_dist: 4.4812, Neg_dist: 7.0052, Acc: 0.6800, PTFixPNLoss: 3.1542, NetFixLoss: 0.2658, ]
2022-11-05 14:47:36,564 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1604, Pos_dist: 4.5597, Neg_dist: 6.8353, Acc: 0.6800, PTFixPNLoss: 3.1543, NetFixLoss: 0.3220, ]
2022-11-05 14:47:38,622 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1673, Pos_dist: 4.5164, Neg_dist: 6.9683, Acc: 0.8200, PTFixPNLoss: 3.1547, NetFixLoss: 0.3879, ]
2022-11-05 14:47:40,242 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1511, Pos_dist: 4.5965, Neg_dist: 7.2976, Acc: 0.6400, PTFixPNLoss: 3.1530, NetFixLoss: 0.4538, ]
2022-11-05 14:47:41,956 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1567, Pos_dist: 4.4936, Neg_dist: 7.2856, Acc: 0.6600, PTFixPNLoss: 3.1479, NetFixLoss: 0.5198, ]
2022-11-05 14:47:43,341 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1109, Pos_dist: 4.5369, Neg_dist: 7.6413, Acc: 0.6400, PTFixPNLoss: 3.1527, NetFixLoss: 0.5907, ]
2022-11-05 14:47:44,896 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2905, Pos_dist: 4.6389, Neg_dist: 6.6266, Acc: 0.5800, PTFixPNLoss: 3.1578, NetFixLoss: 0.6608, ]
2022-11-05 14:47:46,541 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1509, Pos_dist: 4.5175, Neg_dist: 7.1208, Acc: 0.7000, PTFixPNLoss: 3.1494, NetFixLoss: 0.7326, ]
2022-11-05 14:47:47,968 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0765, Pos_dist: 4.4440, Neg_dist: 7.4549, Acc: 0.6800, PTFixPNLoss: 3.1492, NetFixLoss: 0.8045, ]
2022-11-05 14:47:48,111 INFO: fine-tune procedure is finished!
2022-11-05 14:48:12,982 INFO: [Test_acc of task 1 on test 1: 0.52700][acc of former classes: 0.72800][acc of former samples in all classes: 0.66950]
[acc of novel samples in all classes: 0.24200]
2022-11-05 14:48:13,009 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:48:13,016 WARNING: Current net - loaded net:
2022-11-05 14:48:13,016 WARNING: Loaded net - current net:
2022-11-05 14:48:13,017 WARNING:   func.fc.bias
2022-11-05 14:48:13,017 WARNING:   func.fc.weight
2022-11-05 14:48:13,022 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_1.pth.
2022-11-05 14:48:13,033 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:48:13,052 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:48:13,053 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:48:13,053 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:48:13,053 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:48:13,053 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:48:13,053 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:48:13,053 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:48:13,054 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:48:13,055 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:48:13,055 INFO: Model [FSLLModel] is created.
2022-11-05 14:48:13,071 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:13,083 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-05 14:48:14,846 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2512, Pos_dist: 4.4753, Neg_dist: 6.8098, Acc: 0.6000, PTFixPNLoss: 3.4588, NetFixLoss: 0.0000, ]
2022-11-05 14:48:17,146 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3188, Pos_dist: 4.5202, Neg_dist: 6.3223, Acc: 0.6200, PTFixPNLoss: 3.4556, NetFixLoss: 0.0165, ]
2022-11-05 14:48:19,817 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2583, Pos_dist: 4.5337, Neg_dist: 6.4671, Acc: 0.5500, PTFixPNLoss: 3.4553, NetFixLoss: 0.0403, ]
2022-11-05 14:48:21,540 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1667, Pos_dist: 4.5380, Neg_dist: 7.2275, Acc: 0.6100, PTFixPNLoss: 3.4545, NetFixLoss: 0.0706, ]
2022-11-05 14:48:23,537 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2755, Pos_dist: 4.5448, Neg_dist: 6.3880, Acc: 0.6200, PTFixPNLoss: 3.4545, NetFixLoss: 0.1055, ]
2022-11-05 14:48:26,156 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2884, Pos_dist: 4.6274, Neg_dist: 6.4372, Acc: 0.5600, PTFixPNLoss: 3.4554, NetFixLoss: 0.1454, ]
2022-11-05 14:48:29,179 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2600, Pos_dist: 4.5808, Neg_dist: 6.8537, Acc: 0.6300, PTFixPNLoss: 3.4564, NetFixLoss: 0.1878, ]
2022-11-05 14:48:31,728 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0582, Pos_dist: 4.4762, Neg_dist: 8.2156, Acc: 0.5600, PTFixPNLoss: 3.4506, NetFixLoss: 0.2330, ]
2022-11-05 14:48:34,127 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1729, Pos_dist: 4.5879, Neg_dist: 6.9565, Acc: 0.6100, PTFixPNLoss: 3.4549, NetFixLoss: 0.2778, ]
2022-11-05 14:48:35,936 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1839, Pos_dist: 4.4851, Neg_dist: 7.2215, Acc: 0.5900, PTFixPNLoss: 3.4520, NetFixLoss: 0.3257, ]
2022-11-05 14:48:39,005 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1800, Pos_dist: 4.5907, Neg_dist: 7.4903, Acc: 0.5400, PTFixPNLoss: 3.4557, NetFixLoss: 0.3740, ]
2022-11-05 14:48:42,416 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2079, Pos_dist: 4.6714, Neg_dist: 7.0799, Acc: 0.5800, PTFixPNLoss: 3.4564, NetFixLoss: 0.4230, ]
2022-11-05 14:48:44,384 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2221, Pos_dist: 4.5572, Neg_dist: 7.2852, Acc: 0.6700, PTFixPNLoss: 3.4529, NetFixLoss: 0.4732, ]
2022-11-05 14:48:46,810 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2351, Pos_dist: 4.5319, Neg_dist: 6.6035, Acc: 0.5700, PTFixPNLoss: 3.4500, NetFixLoss: 0.5240, ]
2022-11-05 14:48:48,899 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3267, Pos_dist: 4.5466, Neg_dist: 6.4991, Acc: 0.5800, PTFixPNLoss: 3.4516, NetFixLoss: 0.5788, ]
2022-11-05 14:48:49,195 INFO: fine-tune procedure is finished!
2022-11-05 14:49:21,659 INFO: [Test_acc of task 2 on test 1: 0.40050][acc of former classes: 0.72750][acc of former samples in all classes: 0.60400]
[acc of novel samples in all classes: 0.19700]
2022-11-05 14:49:21,691 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:49:21,697 WARNING: Current net - loaded net:
2022-11-05 14:49:21,697 WARNING: Loaded net - current net:
2022-11-05 14:49:21,697 WARNING:   func.fc.bias
2022-11-05 14:49:21,697 WARNING:   func.fc.weight
2022-11-05 14:49:21,749 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_2.pth.
2022-11-05 14:49:21,811 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:49:21,853 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:49:21,853 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:49:21,853 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:49:21,853 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:49:21,854 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:49:21,854 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:49:21,854 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:49:21,854 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:49:21,854 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:49:21,854 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:49:21,854 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:49:21,855 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:49:21,856 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:49:21,856 INFO: Model [FSLLModel] is created.
2022-11-05 14:49:21,869 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:49:21,880 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:49:21,890 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-05 14:49:24,907 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2425, Pos_dist: 4.5778, Neg_dist: 6.6082, Acc: 0.5400, PTFixPNLoss: 3.6807, NetFixLoss: 0.0000, ]
2022-11-05 14:49:27,232 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3554, Pos_dist: 4.7100, Neg_dist: 6.5385, Acc: 0.4933, PTFixPNLoss: 3.6836, NetFixLoss: 0.0180, ]
2022-11-05 14:49:29,990 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1071, Pos_dist: 4.6272, Neg_dist: 7.7007, Acc: 0.5533, PTFixPNLoss: 3.6807, NetFixLoss: 0.0420, ]
2022-11-05 14:49:32,715 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3268, Pos_dist: 4.5796, Neg_dist: 6.3860, Acc: 0.4800, PTFixPNLoss: 3.6802, NetFixLoss: 0.0702, ]
2022-11-05 14:49:35,508 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2753, Pos_dist: 4.5867, Neg_dist: 6.6850, Acc: 0.5733, PTFixPNLoss: 3.6765, NetFixLoss: 0.1027, ]
2022-11-05 14:49:38,565 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1380, Pos_dist: 4.6469, Neg_dist: 7.7497, Acc: 0.5133, PTFixPNLoss: 3.6884, NetFixLoss: 0.1381, ]
2022-11-05 14:49:41,563 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2663, Pos_dist: 4.5831, Neg_dist: 6.3344, Acc: 0.5467, PTFixPNLoss: 3.6772, NetFixLoss: 0.1748, ]
2022-11-05 14:49:43,914 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1864, Pos_dist: 4.4855, Neg_dist: 7.4503, Acc: 0.5200, PTFixPNLoss: 3.6779, NetFixLoss: 0.2126, ]
2022-11-05 14:49:46,763 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2614, Pos_dist: 4.5990, Neg_dist: 6.7224, Acc: 0.5600, PTFixPNLoss: 3.6781, NetFixLoss: 0.2512, ]
2022-11-05 14:49:49,363 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0977, Pos_dist: 4.6541, Neg_dist: 8.4368, Acc: 0.5000, PTFixPNLoss: 3.6806, NetFixLoss: 0.2932, ]
2022-11-05 14:49:52,457 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2438, Pos_dist: 4.6860, Neg_dist: 6.7484, Acc: 0.4733, PTFixPNLoss: 3.6840, NetFixLoss: 0.3354, ]
2022-11-05 14:49:55,129 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0847, Pos_dist: 4.5349, Neg_dist: 8.1667, Acc: 0.5067, PTFixPNLoss: 3.6845, NetFixLoss: 0.3791, ]
2022-11-05 14:49:57,295 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3097, Pos_dist: 4.5916, Neg_dist: 6.3936, Acc: 0.5000, PTFixPNLoss: 3.6811, NetFixLoss: 0.4234, ]
2022-11-05 14:50:00,130 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2975, Pos_dist: 4.4664, Neg_dist: 6.3496, Acc: 0.5667, PTFixPNLoss: 3.6729, NetFixLoss: 0.4691, ]
2022-11-05 14:50:03,401 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2699, Pos_dist: 4.6418, Neg_dist: 6.5560, Acc: 0.4733, PTFixPNLoss: 3.6824, NetFixLoss: 0.5155, ]
2022-11-05 14:50:03,589 INFO: fine-tune procedure is finished!
2022-11-05 14:50:41,973 INFO: [Test_acc of task 3 on test 1: 0.33800][acc of former classes: 0.73350][acc of former samples in all classes: 0.57750]
[acc of novel samples in all classes: 0.17833]
2022-11-05 14:50:42,031 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:50:42,039 WARNING: Current net - loaded net:
2022-11-05 14:50:42,039 WARNING: Loaded net - current net:
2022-11-05 14:50:42,039 WARNING:   func.fc.bias
2022-11-05 14:50:42,040 WARNING:   func.fc.weight
2022-11-05 14:50:42,076 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_3.pth.
2022-11-05 14:50:42,119 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:50:42,150 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:50:42,151 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:50:42,151 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:50:42,152 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:50:42,153 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:50:42,154 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:50:42,154 INFO: Model [FSLLModel] is created.
2022-11-05 14:50:42,168 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:50:42,181 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:50:42,259 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:50:42,273 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-05 14:50:45,332 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3031, Pos_dist: 4.4910, Neg_dist: 6.6315, Acc: 0.5050, PTFixPNLoss: 3.8566, NetFixLoss: 0.0000, ]
2022-11-05 14:50:49,156 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2148, Pos_dist: 4.4672, Neg_dist: 6.7252, Acc: 0.5050, PTFixPNLoss: 3.8561, NetFixLoss: 0.0163, ]
2022-11-05 14:50:51,527 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2560, Pos_dist: 4.5460, Neg_dist: 6.7942, Acc: 0.5200, PTFixPNLoss: 3.8627, NetFixLoss: 0.0370, ]
2022-11-05 14:50:55,308 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2196, Pos_dist: 4.5162, Neg_dist: 6.7237, Acc: 0.5100, PTFixPNLoss: 3.8617, NetFixLoss: 0.0619, ]
2022-11-05 14:50:58,770 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1209, Pos_dist: 4.5128, Neg_dist: 7.3975, Acc: 0.5150, PTFixPNLoss: 3.8582, NetFixLoss: 0.0899, ]
2022-11-05 14:51:03,368 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2434, Pos_dist: 4.4873, Neg_dist: 6.5536, Acc: 0.5600, PTFixPNLoss: 3.8538, NetFixLoss: 0.1189, ]
2022-11-05 14:51:06,568 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1776, Pos_dist: 4.5662, Neg_dist: 7.1632, Acc: 0.5300, PTFixPNLoss: 3.8592, NetFixLoss: 0.1492, ]
2022-11-05 14:51:10,899 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0277, Pos_dist: 4.4572, Neg_dist: 9.4380, Acc: 0.5350, PTFixPNLoss: 3.8537, NetFixLoss: 0.1811, ]
2022-11-05 14:51:14,433 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2837, Pos_dist: 4.4829, Neg_dist: 6.3972, Acc: 0.5350, PTFixPNLoss: 3.8546, NetFixLoss: 0.2129, ]
2022-11-05 14:51:18,856 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1490, Pos_dist: 4.5905, Neg_dist: 8.2395, Acc: 0.5100, PTFixPNLoss: 3.8598, NetFixLoss: 0.2458, ]
2022-11-05 14:51:23,163 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1637, Pos_dist: 4.4668, Neg_dist: 7.1530, Acc: 0.5350, PTFixPNLoss: 3.8535, NetFixLoss: 0.2797, ]
2022-11-05 14:51:27,514 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2852, Pos_dist: 4.5140, Neg_dist: 6.6018, Acc: 0.5200, PTFixPNLoss: 3.8564, NetFixLoss: 0.3150, ]
2022-11-05 14:51:32,263 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2844, Pos_dist: 4.5407, Neg_dist: 6.4079, Acc: 0.5450, PTFixPNLoss: 3.8560, NetFixLoss: 0.3513, ]
2022-11-05 14:51:36,016 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2334, Pos_dist: 4.5051, Neg_dist: 7.2328, Acc: 0.5150, PTFixPNLoss: 3.8555, NetFixLoss: 0.3892, ]
2022-11-05 14:51:40,211 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2504, Pos_dist: 4.4772, Neg_dist: 6.5195, Acc: 0.5250, PTFixPNLoss: 3.8571, NetFixLoss: 0.4300, ]
2022-11-05 14:51:40,456 INFO: fine-tune procedure is finished!
2022-11-05 14:52:29,777 INFO: [Test_acc of task 4 on test 1: 0.30283][acc of former classes: 0.74300][acc of former samples in all classes: 0.55050]
[acc of novel samples in all classes: 0.17900]
2022-11-05 14:52:29,830 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:52:29,839 WARNING: Current net - loaded net:
2022-11-05 14:52:29,839 WARNING: Loaded net - current net:
2022-11-05 14:52:29,839 WARNING:   func.fc.bias
2022-11-05 14:52:29,839 WARNING:   func.fc.weight
2022-11-05 14:52:29,873 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_4.pth.
2022-11-05 14:52:29,890 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:52:29,906 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:52:29,906 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:52:29,906 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:52:29,906 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:52:29,907 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:52:29,908 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:52:29,908 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:52:29,909 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:52:29,910 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:52:29,910 INFO: Model [FSLLModel] is created.
2022-11-05 14:52:29,928 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:29,942 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:29,953 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:29,964 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:29,977 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:52:34,208 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3295, Pos_dist: 4.4540, Neg_dist: 6.2908, Acc: 0.5360, PTFixPNLoss: 4.0154, NetFixLoss: 0.0000, ]
2022-11-05 14:52:39,001 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2021, Pos_dist: 4.4217, Neg_dist: 6.6791, Acc: 0.5000, PTFixPNLoss: 4.0180, NetFixLoss: 0.0211, ]
2022-11-05 14:52:43,609 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4159, Pos_dist: 4.4644, Neg_dist: 5.9694, Acc: 0.5320, PTFixPNLoss: 4.0163, NetFixLoss: 0.0445, ]
2022-11-05 14:52:47,035 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2708, Pos_dist: 4.4616, Neg_dist: 7.1813, Acc: 0.5560, PTFixPNLoss: 4.0152, NetFixLoss: 0.0712, ]
2022-11-05 14:52:50,632 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2275, Pos_dist: 4.4737, Neg_dist: 6.7863, Acc: 0.5000, PTFixPNLoss: 4.0108, NetFixLoss: 0.1009, ]
2022-11-05 14:52:53,805 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2666, Pos_dist: 4.4411, Neg_dist: 6.4422, Acc: 0.5320, PTFixPNLoss: 4.0072, NetFixLoss: 0.1326, ]
2022-11-05 14:52:58,668 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3803, Pos_dist: 4.4817, Neg_dist: 6.1670, Acc: 0.4960, PTFixPNLoss: 4.0146, NetFixLoss: 0.1669, ]
2022-11-05 14:53:03,624 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3244, Pos_dist: 4.4621, Neg_dist: 6.2887, Acc: 0.5480, PTFixPNLoss: 4.0153, NetFixLoss: 0.2039, ]
2022-11-05 14:53:07,344 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2298, Pos_dist: 4.4612, Neg_dist: 6.6208, Acc: 0.5560, PTFixPNLoss: 4.0128, NetFixLoss: 0.2435, ]
2022-11-05 14:53:12,037 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1916, Pos_dist: 4.4067, Neg_dist: 6.7382, Acc: 0.5080, PTFixPNLoss: 4.0129, NetFixLoss: 0.2860, ]
2022-11-05 14:53:15,953 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2005, Pos_dist: 4.4083, Neg_dist: 6.9138, Acc: 0.4920, PTFixPNLoss: 4.0124, NetFixLoss: 0.3291, ]
2022-11-05 14:53:19,241 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1725, Pos_dist: 4.4438, Neg_dist: 7.1608, Acc: 0.5080, PTFixPNLoss: 4.0144, NetFixLoss: 0.3719, ]
2022-11-05 14:53:23,822 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0891, Pos_dist: 4.3976, Neg_dist: 8.2506, Acc: 0.5560, PTFixPNLoss: 4.0116, NetFixLoss: 0.4153, ]
2022-11-05 14:53:27,751 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0137, Pos_dist: 4.4625, Neg_dist: 9.6228, Acc: 0.5320, PTFixPNLoss: 4.0110, NetFixLoss: 0.4584, ]
2022-11-05 14:53:32,083 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2121, Pos_dist: 4.3250, Neg_dist: 6.5758, Acc: 0.5560, PTFixPNLoss: 4.0098, NetFixLoss: 0.4994, ]
2022-11-05 14:53:32,245 INFO: fine-tune procedure is finished!
2022-11-05 14:54:23,734 INFO: [Test_acc of task 5 on test 1: 0.27586][acc of former classes: 0.74300][acc of former samples in all classes: 0.53050]
[acc of novel samples in all classes: 0.17400]
2022-11-05 14:54:23,818 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:54:23,827 WARNING: Current net - loaded net:
2022-11-05 14:54:23,827 WARNING: Loaded net - current net:
2022-11-05 14:54:23,827 WARNING:   func.fc.bias
2022-11-05 14:54:23,827 WARNING:   func.fc.weight
2022-11-05 14:54:23,871 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_5.pth.
2022-11-05 14:54:23,928 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:54:23,968 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:54:23,969 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:54:23,969 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:54:23,969 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:54:23,970 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:54:23,971 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:54:23,971 INFO: Model [FSLLModel] is created.
2022-11-05 14:54:23,987 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:54:24,004 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:54:24,019 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:54:24,036 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:54:24,053 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:54:24,087 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:54:29,079 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2443, Pos_dist: 4.4468, Neg_dist: 6.4533, Acc: 0.5100, PTFixPNLoss: 4.1509, NetFixLoss: 0.0000, ]
2022-11-05 14:54:32,774 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2501, Pos_dist: 4.5007, Neg_dist: 6.7551, Acc: 0.4700, PTFixPNLoss: 4.1553, NetFixLoss: 0.0185, ]
2022-11-05 14:54:37,883 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0598, Pos_dist: 4.4411, Neg_dist: 8.3891, Acc: 0.4833, PTFixPNLoss: 4.1526, NetFixLoss: 0.0409, ]
2022-11-05 14:54:42,996 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2421, Pos_dist: 4.4927, Neg_dist: 6.6872, Acc: 0.4867, PTFixPNLoss: 4.1528, NetFixLoss: 0.0652, ]
2022-11-05 14:54:47,006 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2892, Pos_dist: 4.5343, Neg_dist: 6.5263, Acc: 0.4567, PTFixPNLoss: 4.1563, NetFixLoss: 0.0918, ]
2022-11-05 14:54:51,614 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2539, Pos_dist: 4.4631, Neg_dist: 6.6225, Acc: 0.5000, PTFixPNLoss: 4.1539, NetFixLoss: 0.1252, ]
2022-11-05 14:54:56,838 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1564, Pos_dist: 4.4643, Neg_dist: 7.0317, Acc: 0.5067, PTFixPNLoss: 4.1505, NetFixLoss: 0.1600, ]
2022-11-05 14:55:02,041 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2168, Pos_dist: 4.4899, Neg_dist: 6.7108, Acc: 0.4933, PTFixPNLoss: 4.1523, NetFixLoss: 0.1958, ]
2022-11-05 14:55:05,774 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2400, Pos_dist: 4.4862, Neg_dist: 6.6974, Acc: 0.5000, PTFixPNLoss: 4.1520, NetFixLoss: 0.2332, ]
2022-11-05 14:55:11,099 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3611, Pos_dist: 4.4468, Neg_dist: 6.1734, Acc: 0.5000, PTFixPNLoss: 4.1502, NetFixLoss: 0.2717, ]
2022-11-05 14:55:16,032 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0460, Pos_dist: 4.4702, Neg_dist: 8.6944, Acc: 0.5133, PTFixPNLoss: 4.1483, NetFixLoss: 0.3114, ]
2022-11-05 14:55:20,173 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3015, Pos_dist: 4.4916, Neg_dist: 6.3502, Acc: 0.5133, PTFixPNLoss: 4.1508, NetFixLoss: 0.3513, ]
2022-11-05 14:55:24,012 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1541, Pos_dist: 4.4653, Neg_dist: 7.1792, Acc: 0.4767, PTFixPNLoss: 4.1495, NetFixLoss: 0.3910, ]
2022-11-05 14:55:29,362 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2172, Pos_dist: 4.4667, Neg_dist: 6.9554, Acc: 0.4900, PTFixPNLoss: 4.1494, NetFixLoss: 0.4313, ]
2022-11-05 14:55:33,995 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0148, Pos_dist: 4.4341, Neg_dist: 9.5512, Acc: 0.5033, PTFixPNLoss: 4.1532, NetFixLoss: 0.4713, ]
2022-11-05 14:55:34,446 INFO: fine-tune procedure is finished!
2022-11-05 14:56:35,318 INFO: [Test_acc of task 6 on test 1: 0.24913][acc of former classes: 0.75100][acc of former samples in all classes: 0.52650]
[acc of novel samples in all classes: 0.15667]
2022-11-05 14:56:35,406 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:56:35,420 WARNING: Current net - loaded net:
2022-11-05 14:56:35,420 WARNING: Loaded net - current net:
2022-11-05 14:56:35,420 WARNING:   func.fc.bias
2022-11-05 14:56:35,420 WARNING:   func.fc.weight
2022-11-05 14:56:35,451 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_6.pth.
2022-11-05 14:56:35,464 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:56:35,486 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:56:35,487 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:56:35,487 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:56:35,487 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:56:35,487 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:56:35,487 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:56:35,487 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:56:35,488 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:56:35,489 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:56:35,490 INFO: Model [FSLLModel] is created.
2022-11-05 14:56:35,505 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:56:35,519 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:56:35,581 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:56:35,615 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:56:35,629 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:56:35,641 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:56:35,654 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:56:40,991 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1884, Pos_dist: 4.5039, Neg_dist: 7.1604, Acc: 0.4714, PTFixPNLoss: 4.2655, NetFixLoss: 0.0000, ]
2022-11-05 14:56:47,043 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2424, Pos_dist: 4.4601, Neg_dist: 6.5282, Acc: 0.4943, PTFixPNLoss: 4.2652, NetFixLoss: 0.0149, ]
2022-11-05 14:56:50,873 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1797, Pos_dist: 4.4080, Neg_dist: 7.3770, Acc: 0.5229, PTFixPNLoss: 4.2602, NetFixLoss: 0.0361, ]
2022-11-05 14:56:57,761 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1926, Pos_dist: 4.4379, Neg_dist: 6.9670, Acc: 0.4971, PTFixPNLoss: 4.2632, NetFixLoss: 0.0613, ]
2022-11-05 14:57:04,187 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2473, Pos_dist: 4.4413, Neg_dist: 6.6403, Acc: 0.5286, PTFixPNLoss: 4.2612, NetFixLoss: 0.0875, ]
2022-11-05 14:57:10,326 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2552, Pos_dist: 4.4947, Neg_dist: 7.3499, Acc: 0.5057, PTFixPNLoss: 4.2651, NetFixLoss: 0.1172, ]
2022-11-05 14:57:15,686 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2968, Pos_dist: 4.4873, Neg_dist: 6.9426, Acc: 0.4571, PTFixPNLoss: 4.2626, NetFixLoss: 0.1481, ]
2022-11-05 14:57:20,143 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1552, Pos_dist: 4.4442, Neg_dist: 7.2107, Acc: 0.4914, PTFixPNLoss: 4.2647, NetFixLoss: 0.1800, ]
2022-11-05 14:57:24,825 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2046, Pos_dist: 4.4545, Neg_dist: 6.7844, Acc: 0.5286, PTFixPNLoss: 4.2646, NetFixLoss: 0.2122, ]
2022-11-05 14:57:30,806 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2615, Pos_dist: 4.4119, Neg_dist: 6.7459, Acc: 0.5000, PTFixPNLoss: 4.2664, NetFixLoss: 0.2472, ]
2022-11-05 14:57:36,686 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2688, Pos_dist: 4.4353, Neg_dist: 6.6493, Acc: 0.4686, PTFixPNLoss: 4.2599, NetFixLoss: 0.2826, ]
2022-11-05 14:57:41,888 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2734, Pos_dist: 4.3633, Neg_dist: 6.2540, Acc: 0.5200, PTFixPNLoss: 4.2644, NetFixLoss: 0.3186, ]
2022-11-05 14:57:48,474 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2390, Pos_dist: 4.4500, Neg_dist: 6.6879, Acc: 0.4886, PTFixPNLoss: 4.2659, NetFixLoss: 0.3548, ]
2022-11-05 14:57:54,542 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3184, Pos_dist: 4.4347, Neg_dist: 6.2423, Acc: 0.5114, PTFixPNLoss: 4.2643, NetFixLoss: 0.3919, ]
2022-11-05 14:57:59,996 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2242, Pos_dist: 4.4700, Neg_dist: 6.8007, Acc: 0.4886, PTFixPNLoss: 4.2625, NetFixLoss: 0.4297, ]
2022-11-05 14:58:00,141 INFO: fine-tune procedure is finished!
2022-11-05 14:59:08,133 INFO: [Test_acc of task 7 on test 1: 0.23178][acc of former classes: 0.75200][acc of former samples in all classes: 0.49450]
[acc of novel samples in all classes: 0.15671]
2022-11-05 14:59:08,201 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:59:08,209 WARNING: Current net - loaded net:
2022-11-05 14:59:08,209 WARNING: Loaded net - current net:
2022-11-05 14:59:08,209 WARNING:   func.fc.bias
2022-11-05 14:59:08,210 WARNING:   func.fc.weight
2022-11-05 14:59:08,246 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_7.pth.
2022-11-05 14:59:08,291 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 14:59:08,325 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 14:59:08,326 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 14:59:08,326 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 14:59:08,326 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:59:08,326 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:59:08,326 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 14:59:08,326 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:59:08,326 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:59:08,326 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:59:08,327 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:59:08,328 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:59:08,328 INFO: Model [FSLLModel] is created.
2022-11-05 14:59:08,343 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:08,355 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:08,367 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:08,378 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:08,388 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:08,399 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:08,409 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:08,419 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:59:14,755 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3871, Pos_dist: 4.4855, Neg_dist: 6.0064, Acc: 0.4950, PTFixPNLoss: 4.3741, NetFixLoss: 0.0000, ]
2022-11-05 14:59:21,228 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2885, Pos_dist: 4.4887, Neg_dist: 6.5148, Acc: 0.4775, PTFixPNLoss: 4.3750, NetFixLoss: 0.0159, ]
2022-11-05 14:59:26,532 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0665, Pos_dist: 4.5399, Neg_dist: 9.0849, Acc: 0.4375, PTFixPNLoss: 4.3764, NetFixLoss: 0.0373, ]
2022-11-05 14:59:32,043 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2424, Pos_dist: 4.4533, Neg_dist: 6.5763, Acc: 0.4750, PTFixPNLoss: 4.3735, NetFixLoss: 0.0611, ]
2022-11-05 14:59:38,245 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2927, Pos_dist: 4.4645, Neg_dist: 6.4896, Acc: 0.4700, PTFixPNLoss: 4.3735, NetFixLoss: 0.0865, ]
2022-11-05 14:59:44,555 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2802, Pos_dist: 4.4937, Neg_dist: 6.8143, Acc: 0.4525, PTFixPNLoss: 4.3721, NetFixLoss: 0.1153, ]
2022-11-05 14:59:50,417 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2706, Pos_dist: 4.4305, Neg_dist: 6.3152, Acc: 0.5050, PTFixPNLoss: 4.3695, NetFixLoss: 0.1463, ]
2022-11-05 14:59:54,504 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3215, Pos_dist: 4.5118, Neg_dist: 6.2208, Acc: 0.4525, PTFixPNLoss: 4.3718, NetFixLoss: 0.1785, ]
2022-11-05 15:00:01,215 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1272, Pos_dist: 4.4569, Neg_dist: 7.5643, Acc: 0.4675, PTFixPNLoss: 4.3731, NetFixLoss: 0.2140, ]
2022-11-05 15:00:07,890 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1835, Pos_dist: 4.4366, Neg_dist: 6.8290, Acc: 0.4900, PTFixPNLoss: 4.3696, NetFixLoss: 0.2499, ]
2022-11-05 15:00:14,611 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1562, Pos_dist: 4.4715, Neg_dist: 7.3084, Acc: 0.4750, PTFixPNLoss: 4.3666, NetFixLoss: 0.2849, ]
2022-11-05 15:00:20,558 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1130, Pos_dist: 4.4312, Neg_dist: 8.0875, Acc: 0.4975, PTFixPNLoss: 4.3695, NetFixLoss: 0.3207, ]
2022-11-05 15:00:26,471 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3220, Pos_dist: 4.5176, Neg_dist: 6.4950, Acc: 0.4850, PTFixPNLoss: 4.3752, NetFixLoss: 0.3559, ]
2022-11-05 15:00:33,227 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1821, Pos_dist: 4.5193, Neg_dist: 7.1658, Acc: 0.4575, PTFixPNLoss: 4.3704, NetFixLoss: 0.3907, ]
2022-11-05 15:00:40,236 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1240, Pos_dist: 4.4281, Neg_dist: 7.3179, Acc: 0.4575, PTFixPNLoss: 4.3731, NetFixLoss: 0.4257, ]
2022-11-05 15:00:40,336 INFO: fine-tune procedure is finished!
2022-11-05 15:01:55,881 INFO: [Test_acc of task 8 on test 1: 0.20910][acc of former classes: 0.75000][acc of former samples in all classes: 0.47650]
[acc of novel samples in all classes: 0.14225]
2022-11-05 15:01:55,967 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:01:55,973 WARNING: Current net - loaded net:
2022-11-05 15:01:55,973 WARNING: Loaded net - current net:
2022-11-05 15:01:55,974 WARNING:   func.fc.bias
2022-11-05 15:01:55,974 WARNING:   func.fc.weight
2022-11-05 15:01:56,028 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth.
2022-11-05 15:01:56,092 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:01:56,127 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:01:56,128 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:01:56,128 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:01:56,128 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:01:56,128 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:01:56,128 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:01:56,128 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:01:56,128 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:01:56,128 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:01:56,128 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:01:56,128 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:01:56,128 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:01:56,129 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:01:56,130 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:01:56,131 INFO: Model [FSLLModel] is created.
2022-11-05 15:01:56,149 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-05 15:01:57,620 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1588, Pos_dist: 4.9594, Neg_dist: 7.8108, Acc: 0.5400, PTFixPNLoss: 3.1791, NetFixLoss: 0.0000, ]
2022-11-05 15:01:59,068 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1702, Pos_dist: 4.8060, Neg_dist: 7.7807, Acc: 0.5600, PTFixPNLoss: 3.1698, NetFixLoss: 0.0183, ]
2022-11-05 15:02:00,927 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3206, Pos_dist: 4.8990, Neg_dist: 6.8771, Acc: 0.6000, PTFixPNLoss: 3.1756, NetFixLoss: 0.0416, ]
2022-11-05 15:02:02,539 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3642, Pos_dist: 4.8058, Neg_dist: 6.3869, Acc: 0.6400, PTFixPNLoss: 3.1694, NetFixLoss: 0.0731, ]
2022-11-05 15:02:04,199 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3686, Pos_dist: 4.8507, Neg_dist: 6.7352, Acc: 0.6600, PTFixPNLoss: 3.1706, NetFixLoss: 0.1143, ]
2022-11-05 15:02:05,426 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3112, Pos_dist: 4.8387, Neg_dist: 6.7592, Acc: 0.6200, PTFixPNLoss: 3.1707, NetFixLoss: 0.1641, ]
2022-11-05 15:02:06,945 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1321, Pos_dist: 4.6378, Neg_dist: 7.1848, Acc: 0.5400, PTFixPNLoss: 3.1647, NetFixLoss: 0.2211, ]
2022-11-05 15:02:07,909 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2592, Pos_dist: 4.6475, Neg_dist: 6.4812, Acc: 0.5400, PTFixPNLoss: 3.1703, NetFixLoss: 0.2791, ]
2022-11-05 15:02:08,790 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1439, Pos_dist: 4.7094, Neg_dist: 8.2024, Acc: 0.6600, PTFixPNLoss: 3.1657, NetFixLoss: 0.3393, ]
2022-11-05 15:02:10,057 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1213, Pos_dist: 4.7638, Neg_dist: 8.2317, Acc: 0.6000, PTFixPNLoss: 3.1657, NetFixLoss: 0.3988, ]
2022-11-05 15:02:11,582 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3612, Pos_dist: 4.7891, Neg_dist: 6.5563, Acc: 0.6400, PTFixPNLoss: 3.1704, NetFixLoss: 0.4587, ]
2022-11-05 15:02:13,115 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2072, Pos_dist: 4.7728, Neg_dist: 7.0282, Acc: 0.5800, PTFixPNLoss: 3.1653, NetFixLoss: 0.5235, ]
2022-11-05 15:02:14,670 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.5058, Pos_dist: 4.8169, Neg_dist: 6.0028, Acc: 0.6400, PTFixPNLoss: 3.1719, NetFixLoss: 0.5910, ]
2022-11-05 15:02:16,496 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2844, Pos_dist: 4.8111, Neg_dist: 6.7401, Acc: 0.6000, PTFixPNLoss: 3.1715, NetFixLoss: 0.6609, ]
2022-11-05 15:02:18,011 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3144, Pos_dist: 4.7739, Neg_dist: 6.3889, Acc: 0.5800, PTFixPNLoss: 3.1704, NetFixLoss: 0.7338, ]
2022-11-05 15:02:18,121 INFO: fine-tune procedure is finished!
2022-11-05 15:02:41,477 INFO: [Test_acc of task 1 on test 2: 0.52100][acc of former classes: 0.74150][acc of former samples in all classes: 0.66900]
[acc of novel samples in all classes: 0.22500]
2022-11-05 15:02:41,536 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:02:41,544 WARNING: Current net - loaded net:
2022-11-05 15:02:41,544 WARNING: Loaded net - current net:
2022-11-05 15:02:41,544 WARNING:   func.fc.bias
2022-11-05 15:02:41,544 WARNING:   func.fc.weight
2022-11-05 15:02:41,571 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_1.pth.
2022-11-05 15:02:41,586 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:02:41,601 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:02:41,602 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:02:41,602 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:02:41,602 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:02:41,603 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:02:41,604 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:02:41,605 INFO: Model [FSLLModel] is created.
2022-11-05 15:02:41,619 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:41,631 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-05 15:02:43,482 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1500, Pos_dist: 4.7322, Neg_dist: 8.1109, Acc: 0.4900, PTFixPNLoss: 3.4577, NetFixLoss: 0.0000, ]
2022-11-05 15:02:45,755 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2225, Pos_dist: 4.7520, Neg_dist: 7.0416, Acc: 0.5300, PTFixPNLoss: 3.4572, NetFixLoss: 0.0162, ]
2022-11-05 15:02:47,969 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1591, Pos_dist: 4.6854, Neg_dist: 7.8860, Acc: 0.5300, PTFixPNLoss: 3.4645, NetFixLoss: 0.0385, ]
2022-11-05 15:02:50,096 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3124, Pos_dist: 4.7937, Neg_dist: 6.8595, Acc: 0.4900, PTFixPNLoss: 3.4623, NetFixLoss: 0.0692, ]
2022-11-05 15:02:52,346 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4080, Pos_dist: 4.6498, Neg_dist: 6.1270, Acc: 0.5400, PTFixPNLoss: 3.4557, NetFixLoss: 0.1040, ]
2022-11-05 15:02:54,684 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3676, Pos_dist: 4.6728, Neg_dist: 6.3322, Acc: 0.5500, PTFixPNLoss: 3.4535, NetFixLoss: 0.1436, ]
2022-11-05 15:02:57,156 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4288, Pos_dist: 4.7203, Neg_dist: 6.2775, Acc: 0.5500, PTFixPNLoss: 3.4550, NetFixLoss: 0.1877, ]
2022-11-05 15:02:59,504 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2641, Pos_dist: 4.7243, Neg_dist: 6.8586, Acc: 0.5500, PTFixPNLoss: 3.4604, NetFixLoss: 0.2369, ]
2022-11-05 15:03:01,790 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1923, Pos_dist: 4.6257, Neg_dist: 7.2416, Acc: 0.5700, PTFixPNLoss: 3.4618, NetFixLoss: 0.2896, ]
2022-11-05 15:03:04,225 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4325, Pos_dist: 4.6933, Neg_dist: 5.9869, Acc: 0.5500, PTFixPNLoss: 3.4577, NetFixLoss: 0.3434, ]
2022-11-05 15:03:05,256 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1911, Pos_dist: 4.7726, Neg_dist: 7.3106, Acc: 0.4800, PTFixPNLoss: 3.4631, NetFixLoss: 0.3993, ]
2022-11-05 15:03:07,562 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2466, Pos_dist: 4.7478, Neg_dist: 7.1247, Acc: 0.5900, PTFixPNLoss: 3.4575, NetFixLoss: 0.4601, ]
2022-11-05 15:03:09,285 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4366, Pos_dist: 4.7022, Neg_dist: 6.0736, Acc: 0.5400, PTFixPNLoss: 3.4557, NetFixLoss: 0.5227, ]
2022-11-05 15:03:11,238 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2099, Pos_dist: 4.7623, Neg_dist: 7.3057, Acc: 0.5300, PTFixPNLoss: 3.4647, NetFixLoss: 0.5887, ]
2022-11-05 15:03:13,154 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4047, Pos_dist: 4.7172, Neg_dist: 6.1308, Acc: 0.5100, PTFixPNLoss: 3.4628, NetFixLoss: 0.6541, ]
2022-11-05 15:03:13,326 INFO: fine-tune procedure is finished!
2022-11-05 15:03:43,286 INFO: [Test_acc of task 2 on test 2: 0.39525][acc of former classes: 0.72550][acc of former samples in all classes: 0.58550]
[acc of novel samples in all classes: 0.20500]
2022-11-05 15:03:43,365 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:03:43,371 WARNING: Current net - loaded net:
2022-11-05 15:03:43,371 WARNING: Loaded net - current net:
2022-11-05 15:03:43,371 WARNING:   func.fc.bias
2022-11-05 15:03:43,371 WARNING:   func.fc.weight
2022-11-05 15:03:43,427 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_2.pth.
2022-11-05 15:03:43,478 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:03:43,516 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:03:43,517 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:03:43,517 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:03:43,517 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:03:43,517 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:03:43,517 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:03:43,517 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:03:43,517 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:03:43,517 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:03:43,517 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:03:43,518 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:03:43,519 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:03:43,519 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:03:43,519 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:03:43,519 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:03:43,519 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:03:43,519 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:03:43,519 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:03:43,519 INFO: Model [FSLLModel] is created.
2022-11-05 15:03:43,530 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:03:43,540 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:03:43,552 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-05 15:03:46,421 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3103, Pos_dist: 4.6430, Neg_dist: 6.5424, Acc: 0.5267, PTFixPNLoss: 3.6892, NetFixLoss: 0.0000, ]
2022-11-05 15:03:49,103 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3626, Pos_dist: 4.7175, Neg_dist: 6.3234, Acc: 0.4400, PTFixPNLoss: 3.6944, NetFixLoss: 0.0222, ]
2022-11-05 15:03:52,283 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2610, Pos_dist: 4.6042, Neg_dist: 6.9066, Acc: 0.5400, PTFixPNLoss: 3.6889, NetFixLoss: 0.0496, ]
2022-11-05 15:03:56,054 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3644, Pos_dist: 4.7121, Neg_dist: 6.5337, Acc: 0.4600, PTFixPNLoss: 3.6950, NetFixLoss: 0.0817, ]
2022-11-05 15:03:58,801 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1818, Pos_dist: 4.6847, Neg_dist: 7.2716, Acc: 0.5133, PTFixPNLoss: 3.6883, NetFixLoss: 0.1207, ]
2022-11-05 15:04:01,935 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4283, Pos_dist: 4.7426, Neg_dist: 6.1393, Acc: 0.5400, PTFixPNLoss: 3.6941, NetFixLoss: 0.1623, ]
2022-11-05 15:04:04,881 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3043, Pos_dist: 4.7181, Neg_dist: 6.7125, Acc: 0.4933, PTFixPNLoss: 3.6898, NetFixLoss: 0.2066, ]
2022-11-05 15:04:07,692 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4688, Pos_dist: 4.7012, Neg_dist: 5.9064, Acc: 0.5000, PTFixPNLoss: 3.6937, NetFixLoss: 0.2524, ]
2022-11-05 15:04:09,123 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2130, Pos_dist: 4.6159, Neg_dist: 7.1763, Acc: 0.5267, PTFixPNLoss: 3.6876, NetFixLoss: 0.3010, ]
2022-11-05 15:04:12,099 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1436, Pos_dist: 4.6209, Neg_dist: 7.5885, Acc: 0.5267, PTFixPNLoss: 3.6879, NetFixLoss: 0.3531, ]
2022-11-05 15:04:15,557 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2165, Pos_dist: 4.5917, Neg_dist: 7.1774, Acc: 0.5600, PTFixPNLoss: 3.6880, NetFixLoss: 0.4043, ]
2022-11-05 15:04:18,869 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3013, Pos_dist: 4.6258, Neg_dist: 6.5868, Acc: 0.5200, PTFixPNLoss: 3.6898, NetFixLoss: 0.4600, ]
2022-11-05 15:04:21,987 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3621, Pos_dist: 4.6282, Neg_dist: 6.2388, Acc: 0.4800, PTFixPNLoss: 3.6868, NetFixLoss: 0.5169, ]
2022-11-05 15:04:25,213 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1969, Pos_dist: 4.6990, Neg_dist: 7.9036, Acc: 0.5667, PTFixPNLoss: 3.6882, NetFixLoss: 0.5754, ]
2022-11-05 15:04:27,722 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1766, Pos_dist: 4.6097, Neg_dist: 7.3796, Acc: 0.5067, PTFixPNLoss: 3.6864, NetFixLoss: 0.6317, ]
2022-11-05 15:04:27,873 INFO: fine-tune procedure is finished!
2022-11-05 15:05:06,409 INFO: [Test_acc of task 3 on test 2: 0.33680][acc of former classes: 0.73350][acc of former samples in all classes: 0.57400]
[acc of novel samples in all classes: 0.17867]
2022-11-05 15:05:06,491 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:05:06,497 WARNING: Current net - loaded net:
2022-11-05 15:05:06,497 WARNING: Loaded net - current net:
2022-11-05 15:05:06,497 WARNING:   func.fc.bias
2022-11-05 15:05:06,497 WARNING:   func.fc.weight
2022-11-05 15:05:06,557 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_3.pth.
2022-11-05 15:05:06,622 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:05:06,666 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:05:06,667 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:05:06,667 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:05:06,668 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:05:06,669 INFO: Model [FSLLModel] is created.
2022-11-05 15:05:06,681 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:05:06,691 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:05:06,702 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:05:06,716 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-05 15:05:10,262 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2566, Pos_dist: 4.6453, Neg_dist: 7.0172, Acc: 0.4950, PTFixPNLoss: 3.8696, NetFixLoss: 0.0000, ]
2022-11-05 15:05:14,439 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1919, Pos_dist: 4.5992, Neg_dist: 7.0945, Acc: 0.4950, PTFixPNLoss: 3.8627, NetFixLoss: 0.0170, ]
2022-11-05 15:05:17,840 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1773, Pos_dist: 4.5892, Neg_dist: 7.1508, Acc: 0.4850, PTFixPNLoss: 3.8716, NetFixLoss: 0.0378, ]
2022-11-05 15:05:21,367 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1774, Pos_dist: 4.6275, Neg_dist: 7.1173, Acc: 0.4650, PTFixPNLoss: 3.8688, NetFixLoss: 0.0620, ]
2022-11-05 15:05:24,672 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2905, Pos_dist: 4.6792, Neg_dist: 7.1543, Acc: 0.4600, PTFixPNLoss: 3.8707, NetFixLoss: 0.0885, ]
2022-11-05 15:05:28,153 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2908, Pos_dist: 4.5282, Neg_dist: 6.4801, Acc: 0.5650, PTFixPNLoss: 3.8653, NetFixLoss: 0.1170, ]
2022-11-05 15:05:31,779 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2565, Pos_dist: 4.6178, Neg_dist: 7.2787, Acc: 0.5050, PTFixPNLoss: 3.8704, NetFixLoss: 0.1485, ]
2022-11-05 15:05:34,938 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0923, Pos_dist: 4.6524, Neg_dist: 8.5087, Acc: 0.4700, PTFixPNLoss: 3.8733, NetFixLoss: 0.1846, ]
2022-11-05 15:05:38,731 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2160, Pos_dist: 4.6027, Neg_dist: 6.7642, Acc: 0.4800, PTFixPNLoss: 3.8682, NetFixLoss: 0.2207, ]
2022-11-05 15:05:42,718 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1044, Pos_dist: 4.6627, Neg_dist: 8.4257, Acc: 0.4500, PTFixPNLoss: 3.8677, NetFixLoss: 0.2577, ]
2022-11-05 15:05:46,654 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2462, Pos_dist: 4.6164, Neg_dist: 6.8549, Acc: 0.4700, PTFixPNLoss: 3.8681, NetFixLoss: 0.2939, ]
2022-11-05 15:05:50,529 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2558, Pos_dist: 4.5752, Neg_dist: 6.7514, Acc: 0.5050, PTFixPNLoss: 3.8698, NetFixLoss: 0.3300, ]
2022-11-05 15:05:53,474 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3316, Pos_dist: 4.6482, Neg_dist: 6.4313, Acc: 0.4000, PTFixPNLoss: 3.8662, NetFixLoss: 0.3664, ]
2022-11-05 15:05:56,941 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2114, Pos_dist: 4.6027, Neg_dist: 7.3496, Acc: 0.4750, PTFixPNLoss: 3.8680, NetFixLoss: 0.4048, ]
2022-11-05 15:06:00,591 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2887, Pos_dist: 4.5443, Neg_dist: 6.4044, Acc: 0.4950, PTFixPNLoss: 3.8646, NetFixLoss: 0.4427, ]
2022-11-05 15:06:00,806 INFO: fine-tune procedure is finished!
2022-11-05 15:06:46,018 INFO: [Test_acc of task 4 on test 2: 0.30167][acc of former classes: 0.74900][acc of former samples in all classes: 0.55200]
[acc of novel samples in all classes: 0.17650]
2022-11-05 15:06:46,075 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:06:46,084 WARNING: Current net - loaded net:
2022-11-05 15:06:46,084 WARNING: Loaded net - current net:
2022-11-05 15:06:46,084 WARNING:   func.fc.bias
2022-11-05 15:06:46,084 WARNING:   func.fc.weight
2022-11-05 15:06:46,090 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_4.pth.
2022-11-05 15:06:46,110 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:06:46,128 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:06:46,129 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:06:46,129 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:06:46,129 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:06:46,129 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:06:46,129 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:06:46,129 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:06:46,130 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:06:46,131 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:06:46,132 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:06:46,132 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:06:46,132 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:06:46,132 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:06:46,132 INFO: Model [FSLLModel] is created.
2022-11-05 15:06:46,151 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:06:46,166 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:06:46,179 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:06:46,190 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:06:46,201 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:06:50,409 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1842, Pos_dist: 4.5595, Neg_dist: 6.8734, Acc: 0.4480, PTFixPNLoss: 4.0270, NetFixLoss: 0.0000, ]
2022-11-05 15:06:54,335 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2322, Pos_dist: 4.5592, Neg_dist: 6.5365, Acc: 0.4280, PTFixPNLoss: 4.0271, NetFixLoss: 0.0159, ]
2022-11-05 15:06:58,270 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1427, Pos_dist: 4.5222, Neg_dist: 7.7464, Acc: 0.5040, PTFixPNLoss: 4.0249, NetFixLoss: 0.0365, ]
2022-11-05 15:07:01,514 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3022, Pos_dist: 4.5090, Neg_dist: 6.0901, Acc: 0.4560, PTFixPNLoss: 4.0252, NetFixLoss: 0.0595, ]
2022-11-05 15:07:05,728 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3139, Pos_dist: 4.5474, Neg_dist: 6.4266, Acc: 0.4360, PTFixPNLoss: 4.0278, NetFixLoss: 0.0871, ]
2022-11-05 15:07:08,804 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3471, Pos_dist: 4.5216, Neg_dist: 6.1243, Acc: 0.5040, PTFixPNLoss: 4.0245, NetFixLoss: 0.1184, ]
2022-11-05 15:07:12,979 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3383, Pos_dist: 4.4824, Neg_dist: 6.3006, Acc: 0.4720, PTFixPNLoss: 4.0225, NetFixLoss: 0.1551, ]
2022-11-05 15:07:17,505 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1436, Pos_dist: 4.5338, Neg_dist: 7.2263, Acc: 0.4640, PTFixPNLoss: 4.0255, NetFixLoss: 0.1944, ]
2022-11-05 15:07:21,611 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2998, Pos_dist: 4.5823, Neg_dist: 6.5683, Acc: 0.4360, PTFixPNLoss: 4.0250, NetFixLoss: 0.2345, ]
2022-11-05 15:07:25,897 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1623, Pos_dist: 4.5637, Neg_dist: 6.9641, Acc: 0.4560, PTFixPNLoss: 4.0254, NetFixLoss: 0.2746, ]
2022-11-05 15:07:29,480 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1734, Pos_dist: 4.4848, Neg_dist: 6.8205, Acc: 0.5080, PTFixPNLoss: 4.0254, NetFixLoss: 0.3147, ]
2022-11-05 15:07:33,419 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3634, Pos_dist: 4.5433, Neg_dist: 6.0422, Acc: 0.4560, PTFixPNLoss: 4.0228, NetFixLoss: 0.3542, ]
2022-11-05 15:07:37,330 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3106, Pos_dist: 4.5285, Neg_dist: 6.3169, Acc: 0.5000, PTFixPNLoss: 4.0256, NetFixLoss: 0.3944, ]
2022-11-05 15:07:41,347 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2856, Pos_dist: 4.5153, Neg_dist: 6.3627, Acc: 0.5040, PTFixPNLoss: 4.0229, NetFixLoss: 0.4352, ]
2022-11-05 15:07:45,775 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2783, Pos_dist: 4.6259, Neg_dist: 6.4775, Acc: 0.4800, PTFixPNLoss: 4.0264, NetFixLoss: 0.4771, ]
2022-11-05 15:07:45,870 INFO: fine-tune procedure is finished!
2022-11-05 15:08:37,149 INFO: [Test_acc of task 5 on test 2: 0.27043][acc of former classes: 0.75100][acc of former samples in all classes: 0.53150]
[acc of novel samples in all classes: 0.16600]
2022-11-05 15:08:37,230 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:08:37,241 WARNING: Current net - loaded net:
2022-11-05 15:08:37,241 WARNING: Loaded net - current net:
2022-11-05 15:08:37,241 WARNING:   func.fc.bias
2022-11-05 15:08:37,241 WARNING:   func.fc.weight
2022-11-05 15:08:37,295 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_5.pth.
2022-11-05 15:08:37,360 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:08:37,404 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:08:37,405 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:08:37,405 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:08:37,405 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:08:37,406 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:08:37,407 INFO: Model [FSLLModel] is created.
2022-11-05 15:08:37,418 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:08:37,428 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:08:37,438 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:08:37,449 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:08:37,459 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:08:37,472 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:08:41,714 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2418, Pos_dist: 4.6090, Neg_dist: 6.6918, Acc: 0.4567, PTFixPNLoss: 4.1627, NetFixLoss: 0.0000, ]
2022-11-05 15:08:47,371 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1265, Pos_dist: 4.5716, Neg_dist: 7.4624, Acc: 0.4800, PTFixPNLoss: 4.1639, NetFixLoss: 0.0168, ]
2022-11-05 15:08:53,183 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1971, Pos_dist: 4.5047, Neg_dist: 6.8431, Acc: 0.4800, PTFixPNLoss: 4.1594, NetFixLoss: 0.0351, ]
2022-11-05 15:08:57,804 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1878, Pos_dist: 4.5967, Neg_dist: 6.8586, Acc: 0.4500, PTFixPNLoss: 4.1656, NetFixLoss: 0.0561, ]
2022-11-05 15:09:02,965 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0776, Pos_dist: 4.5472, Neg_dist: 8.3366, Acc: 0.4333, PTFixPNLoss: 4.1647, NetFixLoss: 0.0799, ]
2022-11-05 15:09:08,402 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1343, Pos_dist: 4.5727, Neg_dist: 7.1940, Acc: 0.4500, PTFixPNLoss: 4.1612, NetFixLoss: 0.1051, ]
2022-11-05 15:09:14,212 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2219, Pos_dist: 4.5939, Neg_dist: 6.6742, Acc: 0.4400, PTFixPNLoss: 4.1668, NetFixLoss: 0.1327, ]
2022-11-05 15:09:18,824 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3031, Pos_dist: 4.5378, Neg_dist: 6.2759, Acc: 0.4700, PTFixPNLoss: 4.1640, NetFixLoss: 0.1622, ]
2022-11-05 15:09:23,692 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3407, Pos_dist: 4.6607, Neg_dist: 6.3075, Acc: 0.4200, PTFixPNLoss: 4.1673, NetFixLoss: 0.1934, ]
2022-11-05 15:09:28,874 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2443, Pos_dist: 4.5818, Neg_dist: 6.6973, Acc: 0.4567, PTFixPNLoss: 4.1600, NetFixLoss: 0.2261, ]
2022-11-05 15:09:34,129 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0938, Pos_dist: 4.5203, Neg_dist: 8.1783, Acc: 0.4533, PTFixPNLoss: 4.1624, NetFixLoss: 0.2612, ]
2022-11-05 15:09:39,255 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2323, Pos_dist: 4.6148, Neg_dist: 7.1599, Acc: 0.4533, PTFixPNLoss: 4.1603, NetFixLoss: 0.2970, ]
2022-11-05 15:09:44,704 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3607, Pos_dist: 4.5417, Neg_dist: 6.0471, Acc: 0.4800, PTFixPNLoss: 4.1633, NetFixLoss: 0.3333, ]
2022-11-05 15:09:50,455 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2994, Pos_dist: 4.5837, Neg_dist: 6.5171, Acc: 0.4133, PTFixPNLoss: 4.1608, NetFixLoss: 0.3708, ]
2022-11-05 15:09:56,369 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2620, Pos_dist: 4.5461, Neg_dist: 6.6558, Acc: 0.4700, PTFixPNLoss: 4.1577, NetFixLoss: 0.4095, ]
2022-11-05 15:09:56,517 INFO: fine-tune procedure is finished!
2022-11-05 15:11:00,814 INFO: [Test_acc of task 6 on test 2: 0.24675][acc of former classes: 0.75500][acc of former samples in all classes: 0.52250]
[acc of novel samples in all classes: 0.15483]
2022-11-05 15:11:00,897 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:11:00,904 WARNING: Current net - loaded net:
2022-11-05 15:11:00,904 WARNING: Loaded net - current net:
2022-11-05 15:11:00,904 WARNING:   func.fc.bias
2022-11-05 15:11:00,904 WARNING:   func.fc.weight
2022-11-05 15:11:00,960 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_6.pth.
2022-11-05 15:11:01,023 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:11:01,077 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:11:01,078 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:11:01,079 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:11:01,079 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:11:01,080 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:11:01,081 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:11:01,082 INFO: Model [FSLLModel] is created.
2022-11-05 15:11:01,098 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:01,109 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:01,121 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:01,137 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:01,150 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:01,165 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:01,180 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:11:06,599 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1448, Pos_dist: 4.5609, Neg_dist: 8.2955, Acc: 0.4371, PTFixPNLoss: 4.2727, NetFixLoss: 0.0000, ]
2022-11-05 15:11:13,566 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2292, Pos_dist: 4.6300, Neg_dist: 6.9242, Acc: 0.4000, PTFixPNLoss: 4.2773, NetFixLoss: 0.0140, ]
2022-11-05 15:11:20,246 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2874, Pos_dist: 4.6507, Neg_dist: 6.4386, Acc: 0.4000, PTFixPNLoss: 4.2806, NetFixLoss: 0.0324, ]
2022-11-05 15:11:25,847 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3514, Pos_dist: 4.6435, Neg_dist: 6.6613, Acc: 0.4171, PTFixPNLoss: 4.2757, NetFixLoss: 0.0562, ]
2022-11-05 15:11:32,777 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1151, Pos_dist: 4.5831, Neg_dist: 7.5128, Acc: 0.4457, PTFixPNLoss: 4.2781, NetFixLoss: 0.0837, ]
2022-11-05 15:11:38,432 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3099, Pos_dist: 4.5410, Neg_dist: 6.4864, Acc: 0.4657, PTFixPNLoss: 4.2726, NetFixLoss: 0.1123, ]
2022-11-05 15:11:45,512 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2512, Pos_dist: 4.6155, Neg_dist: 6.8089, Acc: 0.4343, PTFixPNLoss: 4.2795, NetFixLoss: 0.1429, ]
2022-11-05 15:11:51,940 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0744, Pos_dist: 4.5029, Neg_dist: 8.1807, Acc: 0.4800, PTFixPNLoss: 4.2740, NetFixLoss: 0.1753, ]
2022-11-05 15:11:58,463 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3161, Pos_dist: 4.5777, Neg_dist: 6.5420, Acc: 0.4514, PTFixPNLoss: 4.2740, NetFixLoss: 0.2082, ]
2022-11-05 15:12:04,675 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1773, Pos_dist: 4.5951, Neg_dist: 7.1249, Acc: 0.4400, PTFixPNLoss: 4.2763, NetFixLoss: 0.2418, ]
2022-11-05 15:12:10,962 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1577, Pos_dist: 4.5399, Neg_dist: 7.0664, Acc: 0.4457, PTFixPNLoss: 4.2710, NetFixLoss: 0.2754, ]
2022-11-05 15:12:17,426 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2446, Pos_dist: 4.5670, Neg_dist: 6.5765, Acc: 0.4257, PTFixPNLoss: 4.2766, NetFixLoss: 0.3094, ]
2022-11-05 15:12:23,199 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1102, Pos_dist: 4.5942, Neg_dist: 8.0709, Acc: 0.4629, PTFixPNLoss: 4.2733, NetFixLoss: 0.3437, ]
2022-11-05 15:12:29,668 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1815, Pos_dist: 4.5804, Neg_dist: 7.1524, Acc: 0.4057, PTFixPNLoss: 4.2763, NetFixLoss: 0.3780, ]
2022-11-05 15:12:36,129 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1764, Pos_dist: 4.6072, Neg_dist: 7.0934, Acc: 0.4571, PTFixPNLoss: 4.2775, NetFixLoss: 0.4123, ]
2022-11-05 15:12:36,470 INFO: fine-tune procedure is finished!
2022-11-05 15:13:46,899 INFO: [Test_acc of task 7 on test 2: 0.22311][acc of former classes: 0.75350][acc of former samples in all classes: 0.48750]
[acc of novel samples in all classes: 0.14757]
2022-11-05 15:13:46,966 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:13:46,974 WARNING: Current net - loaded net:
2022-11-05 15:13:46,974 WARNING: Loaded net - current net:
2022-11-05 15:13:46,974 WARNING:   func.fc.bias
2022-11-05 15:13:46,974 WARNING:   func.fc.weight
2022-11-05 15:13:47,013 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_7.pth.
2022-11-05 15:13:47,057 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:13:47,073 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:13:47,074 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:13:47,075 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:13:47,075 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:13:47,076 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:13:47,077 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:13:47,077 INFO: Model [FSLLModel] is created.
2022-11-05 15:13:47,096 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:47,113 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:47,131 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:47,149 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:47,167 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:47,183 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:47,193 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:47,204 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:13:52,487 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0514, Pos_dist: 4.5826, Neg_dist: 8.7372, Acc: 0.4100, PTFixPNLoss: 4.3794, NetFixLoss: 0.0000, ]
2022-11-05 15:13:59,627 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2315, Pos_dist: 4.5175, Neg_dist: 7.0848, Acc: 0.4325, PTFixPNLoss: 4.3779, NetFixLoss: 0.0061, ]
2022-11-05 15:14:06,584 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3538, Pos_dist: 4.5838, Neg_dist: 6.3259, Acc: 0.4225, PTFixPNLoss: 4.3839, NetFixLoss: 0.0206, ]
2022-11-05 15:14:13,861 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2665, Pos_dist: 4.5726, Neg_dist: 6.6432, Acc: 0.4575, PTFixPNLoss: 4.3764, NetFixLoss: 0.0422, ]
2022-11-05 15:14:20,338 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0713, Pos_dist: 4.6173, Neg_dist: 9.2284, Acc: 0.4275, PTFixPNLoss: 4.3828, NetFixLoss: 0.0675, ]
2022-11-05 15:14:27,065 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3159, Pos_dist: 4.6215, Neg_dist: 6.4404, Acc: 0.4275, PTFixPNLoss: 4.3798, NetFixLoss: 0.0945, ]
2022-11-05 15:14:34,124 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1771, Pos_dist: 4.5344, Neg_dist: 6.9956, Acc: 0.4200, PTFixPNLoss: 4.3834, NetFixLoss: 0.1223, ]
2022-11-05 15:14:40,343 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2145, Pos_dist: 4.5621, Neg_dist: 6.9712, Acc: 0.4300, PTFixPNLoss: 4.3791, NetFixLoss: 0.1512, ]
2022-11-05 15:14:46,995 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2670, Pos_dist: 4.5788, Neg_dist: 6.4737, Acc: 0.4175, PTFixPNLoss: 4.3795, NetFixLoss: 0.1808, ]
2022-11-05 15:14:54,295 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2871, Pos_dist: 4.5524, Neg_dist: 7.0650, Acc: 0.4175, PTFixPNLoss: 4.3803, NetFixLoss: 0.2116, ]
2022-11-05 15:15:01,057 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2923, Pos_dist: 4.6041, Neg_dist: 6.8974, Acc: 0.4375, PTFixPNLoss: 4.3840, NetFixLoss: 0.2438, ]
2022-11-05 15:15:08,733 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1730, Pos_dist: 4.5641, Neg_dist: 7.3333, Acc: 0.4250, PTFixPNLoss: 4.3778, NetFixLoss: 0.2765, ]
2022-11-05 15:15:15,406 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1467, Pos_dist: 4.6153, Neg_dist: 7.8498, Acc: 0.4075, PTFixPNLoss: 4.3819, NetFixLoss: 0.3084, ]
2022-11-05 15:15:21,797 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3053, Pos_dist: 4.5466, Neg_dist: 6.3115, Acc: 0.4325, PTFixPNLoss: 4.3791, NetFixLoss: 0.3402, ]
2022-11-05 15:15:29,306 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2651, Pos_dist: 4.5689, Neg_dist: 7.1263, Acc: 0.4225, PTFixPNLoss: 4.3777, NetFixLoss: 0.3728, ]
2022-11-05 15:15:29,412 INFO: fine-tune procedure is finished!
2022-11-05 15:16:46,175 INFO: [Test_acc of task 8 on test 2: 0.20560][acc of former classes: 0.75100][acc of former samples in all classes: 0.47050]
[acc of novel samples in all classes: 0.13937]
2022-11-05 15:16:46,258 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:16:46,267 WARNING: Current net - loaded net:
2022-11-05 15:16:46,267 WARNING: Loaded net - current net:
2022-11-05 15:16:46,267 WARNING:   func.fc.bias
2022-11-05 15:16:46,267 WARNING:   func.fc.weight
2022-11-05 15:16:46,322 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth.
2022-11-05 15:16:46,388 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:16:46,416 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:16:46,417 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:16:46,418 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:16:46,418 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:16:46,419 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:16:46,420 INFO: Model [FSLLModel] is created.
2022-11-05 15:16:46,432 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-05 15:16:48,019 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3550, Pos_dist: 4.6540, Neg_dist: 6.0557, Acc: 0.5200, PTFixPNLoss: 3.1732, NetFixLoss: 0.0000, ]
2022-11-05 15:16:49,884 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2759, Pos_dist: 4.7621, Neg_dist: 6.7666, Acc: 0.5400, PTFixPNLoss: 3.1750, NetFixLoss: 0.0273, ]
2022-11-05 15:16:51,975 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2754, Pos_dist: 4.7606, Neg_dist: 6.3322, Acc: 0.4600, PTFixPNLoss: 3.1753, NetFixLoss: 0.0608, ]
2022-11-05 15:16:53,554 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3056, Pos_dist: 4.7450, Neg_dist: 6.5611, Acc: 0.5400, PTFixPNLoss: 3.1737, NetFixLoss: 0.1038, ]
2022-11-05 15:16:55,267 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2623, Pos_dist: 4.6054, Neg_dist: 6.7382, Acc: 0.5800, PTFixPNLoss: 3.1682, NetFixLoss: 0.1560, ]
2022-11-05 15:16:56,753 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3599, Pos_dist: 4.7826, Neg_dist: 6.5880, Acc: 0.5000, PTFixPNLoss: 3.1713, NetFixLoss: 0.2112, ]
2022-11-05 15:16:58,375 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3810, Pos_dist: 4.6890, Neg_dist: 6.3348, Acc: 0.5000, PTFixPNLoss: 3.1725, NetFixLoss: 0.2752, ]
2022-11-05 15:16:59,774 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2924, Pos_dist: 4.6583, Neg_dist: 6.6529, Acc: 0.6400, PTFixPNLoss: 3.1636, NetFixLoss: 0.3390, ]
2022-11-05 15:17:01,188 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1637, Pos_dist: 4.7777, Neg_dist: 7.6744, Acc: 0.5600, PTFixPNLoss: 3.1694, NetFixLoss: 0.4067, ]
2022-11-05 15:17:02,485 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2743, Pos_dist: 4.7794, Neg_dist: 6.7001, Acc: 0.5000, PTFixPNLoss: 3.1700, NetFixLoss: 0.4730, ]
2022-11-05 15:17:03,965 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3506, Pos_dist: 4.6817, Neg_dist: 6.4035, Acc: 0.5800, PTFixPNLoss: 3.1659, NetFixLoss: 0.5435, ]
2022-11-05 15:17:05,529 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2091, Pos_dist: 4.6928, Neg_dist: 7.2005, Acc: 0.5600, PTFixPNLoss: 3.1702, NetFixLoss: 0.6160, ]
2022-11-05 15:17:06,881 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4357, Pos_dist: 4.8114, Neg_dist: 6.2301, Acc: 0.6200, PTFixPNLoss: 3.1694, NetFixLoss: 0.6899, ]
2022-11-05 15:17:08,882 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2693, Pos_dist: 4.6370, Neg_dist: 6.8046, Acc: 0.6200, PTFixPNLoss: 3.1665, NetFixLoss: 0.7690, ]
2022-11-05 15:17:10,464 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2728, Pos_dist: 4.7477, Neg_dist: 6.7401, Acc: 0.6200, PTFixPNLoss: 3.1676, NetFixLoss: 0.8496, ]
2022-11-05 15:17:10,881 INFO: fine-tune procedure is finished!
2022-11-05 15:17:35,304 INFO: [Test_acc of task 1 on test 3: 0.53200][acc of former classes: 0.73750][acc of former samples in all classes: 0.68950]
[acc of novel samples in all classes: 0.21700]
2022-11-05 15:17:35,360 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:17:35,369 WARNING: Current net - loaded net:
2022-11-05 15:17:35,369 WARNING: Loaded net - current net:
2022-11-05 15:17:35,369 WARNING:   func.fc.bias
2022-11-05 15:17:35,370 WARNING:   func.fc.weight
2022-11-05 15:17:35,376 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_1.pth.
2022-11-05 15:17:35,392 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:17:35,408 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:17:35,409 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:17:35,409 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:17:35,409 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:17:35,409 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:17:35,409 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:17:35,409 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:17:35,410 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:17:35,411 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:17:35,412 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:17:35,412 INFO: Model [FSLLModel] is created.
2022-11-05 15:17:35,430 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:35,447 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-05 15:17:37,591 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1063, Pos_dist: 4.6972, Neg_dist: 8.0334, Acc: 0.5100, PTFixPNLoss: 3.4591, NetFixLoss: 0.0000, ]
2022-11-05 15:17:40,028 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1309, Pos_dist: 4.7607, Neg_dist: 7.5683, Acc: 0.5400, PTFixPNLoss: 3.4622, NetFixLoss: 0.0110, ]
2022-11-05 15:17:42,433 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2191, Pos_dist: 4.7700, Neg_dist: 7.1963, Acc: 0.5000, PTFixPNLoss: 3.4641, NetFixLoss: 0.0280, ]
2022-11-05 15:17:44,633 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2651, Pos_dist: 4.6195, Neg_dist: 6.6676, Acc: 0.5100, PTFixPNLoss: 3.4644, NetFixLoss: 0.0521, ]
2022-11-05 15:17:47,297 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2125, Pos_dist: 4.6841, Neg_dist: 6.8330, Acc: 0.5200, PTFixPNLoss: 3.4628, NetFixLoss: 0.0822, ]
2022-11-05 15:17:49,162 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2834, Pos_dist: 4.6245, Neg_dist: 6.4738, Acc: 0.5300, PTFixPNLoss: 3.4488, NetFixLoss: 0.1164, ]
2022-11-05 15:17:51,327 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3120, Pos_dist: 4.6940, Neg_dist: 6.6584, Acc: 0.4800, PTFixPNLoss: 3.4670, NetFixLoss: 0.1548, ]
2022-11-05 15:17:53,887 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2236, Pos_dist: 4.7301, Neg_dist: 7.1748, Acc: 0.5400, PTFixPNLoss: 3.4657, NetFixLoss: 0.1986, ]
2022-11-05 15:17:56,908 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2858, Pos_dist: 4.6787, Neg_dist: 6.7981, Acc: 0.5800, PTFixPNLoss: 3.4629, NetFixLoss: 0.2434, ]
2022-11-05 15:17:59,063 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2620, Pos_dist: 4.5559, Neg_dist: 6.5942, Acc: 0.5700, PTFixPNLoss: 3.4578, NetFixLoss: 0.2903, ]
2022-11-05 15:18:01,333 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1880, Pos_dist: 4.7002, Neg_dist: 7.5634, Acc: 0.5200, PTFixPNLoss: 3.4578, NetFixLoss: 0.3401, ]
2022-11-05 15:18:03,781 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2629, Pos_dist: 4.6649, Neg_dist: 6.7786, Acc: 0.5500, PTFixPNLoss: 3.4561, NetFixLoss: 0.3901, ]
2022-11-05 15:18:06,424 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2443, Pos_dist: 4.6425, Neg_dist: 6.7959, Acc: 0.5400, PTFixPNLoss: 3.4632, NetFixLoss: 0.4395, ]
2022-11-05 15:18:09,087 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2171, Pos_dist: 4.6648, Neg_dist: 7.0461, Acc: 0.5700, PTFixPNLoss: 3.4652, NetFixLoss: 0.4902, ]
2022-11-05 15:18:11,599 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2339, Pos_dist: 4.7213, Neg_dist: 6.7277, Acc: 0.5300, PTFixPNLoss: 3.4601, NetFixLoss: 0.5430, ]
2022-11-05 15:18:11,731 INFO: fine-tune procedure is finished!
2022-11-05 15:18:44,140 INFO: [Test_acc of task 2 on test 3: 0.40425][acc of former classes: 0.72700][acc of former samples in all classes: 0.60850]
[acc of novel samples in all classes: 0.20000]
2022-11-05 15:18:44,275 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:18:44,282 WARNING: Current net - loaded net:
2022-11-05 15:18:44,283 WARNING: Loaded net - current net:
2022-11-05 15:18:44,283 WARNING:   func.fc.bias
2022-11-05 15:18:44,283 WARNING:   func.fc.weight
2022-11-05 15:18:44,486 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_2.pth.
2022-11-05 15:18:44,546 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:18:44,578 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:18:44,579 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:18:44,579 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:18:44,579 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:18:44,579 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:18:44,579 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:18:44,580 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:18:44,581 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:18:44,582 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:18:44,582 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:18:44,582 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:18:44,582 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:18:44,582 INFO: Model [FSLLModel] is created.
2022-11-05 15:18:44,600 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:18:44,617 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:18:44,629 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-05 15:18:46,977 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1979, Pos_dist: 4.5941, Neg_dist: 7.1153, Acc: 0.5200, PTFixPNLoss: 3.6915, NetFixLoss: 0.0000, ]
2022-11-05 15:18:50,056 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1546, Pos_dist: 4.6144, Neg_dist: 7.9733, Acc: 0.4867, PTFixPNLoss: 3.6825, NetFixLoss: 0.0162, ]
2022-11-05 15:18:53,062 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3609, Pos_dist: 4.6167, Neg_dist: 6.3653, Acc: 0.4933, PTFixPNLoss: 3.6880, NetFixLoss: 0.0352, ]
2022-11-05 15:18:55,032 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2724, Pos_dist: 4.6433, Neg_dist: 6.5700, Acc: 0.5000, PTFixPNLoss: 3.6946, NetFixLoss: 0.0601, ]
2022-11-05 15:18:58,046 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2877, Pos_dist: 4.7004, Neg_dist: 6.6828, Acc: 0.4667, PTFixPNLoss: 3.6909, NetFixLoss: 0.0915, ]
2022-11-05 15:19:01,706 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2837, Pos_dist: 4.6063, Neg_dist: 6.7429, Acc: 0.5533, PTFixPNLoss: 3.6877, NetFixLoss: 0.1272, ]
2022-11-05 15:19:04,316 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2475, Pos_dist: 4.6429, Neg_dist: 6.7677, Acc: 0.4800, PTFixPNLoss: 3.6951, NetFixLoss: 0.1664, ]
2022-11-05 15:19:07,601 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1678, Pos_dist: 4.5846, Neg_dist: 7.9607, Acc: 0.5067, PTFixPNLoss: 3.6878, NetFixLoss: 0.2095, ]
2022-11-05 15:19:10,165 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1709, Pos_dist: 4.6326, Neg_dist: 9.2409, Acc: 0.4867, PTFixPNLoss: 3.6908, NetFixLoss: 0.2528, ]
2022-11-05 15:19:13,179 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2651, Pos_dist: 4.6890, Neg_dist: 6.4928, Acc: 0.5067, PTFixPNLoss: 3.6895, NetFixLoss: 0.2956, ]
2022-11-05 15:19:16,831 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1336, Pos_dist: 4.6135, Neg_dist: 8.3553, Acc: 0.5067, PTFixPNLoss: 3.6830, NetFixLoss: 0.3413, ]
2022-11-05 15:19:19,810 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0681, Pos_dist: 4.6643, Neg_dist: 8.7490, Acc: 0.5400, PTFixPNLoss: 3.6900, NetFixLoss: 0.3869, ]
2022-11-05 15:19:22,995 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3242, Pos_dist: 4.6067, Neg_dist: 6.5800, Acc: 0.4733, PTFixPNLoss: 3.6865, NetFixLoss: 0.4311, ]
2022-11-05 15:19:26,413 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2901, Pos_dist: 4.6227, Neg_dist: 6.4921, Acc: 0.5067, PTFixPNLoss: 3.6903, NetFixLoss: 0.4767, ]
2022-11-05 15:19:29,078 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2058, Pos_dist: 4.6224, Neg_dist: 7.3359, Acc: 0.5200, PTFixPNLoss: 3.6855, NetFixLoss: 0.5226, ]
2022-11-05 15:19:29,178 INFO: fine-tune procedure is finished!
2022-11-05 15:20:08,393 INFO: [Test_acc of task 3 on test 3: 0.33540][acc of former classes: 0.72750][acc of former samples in all classes: 0.57650]
[acc of novel samples in all classes: 0.17467]
2022-11-05 15:20:08,452 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:20:08,459 WARNING: Current net - loaded net:
2022-11-05 15:20:08,459 WARNING: Loaded net - current net:
2022-11-05 15:20:08,459 WARNING:   func.fc.bias
2022-11-05 15:20:08,459 WARNING:   func.fc.weight
2022-11-05 15:20:08,502 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_3.pth.
2022-11-05 15:20:08,560 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:20:08,584 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:20:08,585 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:20:08,586 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:20:08,586 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:20:08,586 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:20:08,586 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:20:08,587 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:20:08,588 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:20:08,589 INFO: Model [FSLLModel] is created.
2022-11-05 15:20:08,607 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:20:08,624 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:20:08,640 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:20:08,652 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-05 15:20:12,602 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2453, Pos_dist: 4.6116, Neg_dist: 6.6921, Acc: 0.4800, PTFixPNLoss: 3.8658, NetFixLoss: 0.0000, ]
2022-11-05 15:20:16,250 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3949, Pos_dist: 4.6413, Neg_dist: 6.0730, Acc: 0.4950, PTFixPNLoss: 3.8695, NetFixLoss: 0.0177, ]
2022-11-05 15:20:19,867 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2252, Pos_dist: 4.6640, Neg_dist: 6.8664, Acc: 0.4950, PTFixPNLoss: 3.8712, NetFixLoss: 0.0430, ]
2022-11-05 15:20:23,929 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2179, Pos_dist: 4.5980, Neg_dist: 6.6367, Acc: 0.4350, PTFixPNLoss: 3.8700, NetFixLoss: 0.0721, ]
2022-11-05 15:20:27,571 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1379, Pos_dist: 4.6883, Neg_dist: 7.7041, Acc: 0.4400, PTFixPNLoss: 3.8741, NetFixLoss: 0.1046, ]
2022-11-05 15:20:32,876 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2648, Pos_dist: 4.6018, Neg_dist: 6.5610, Acc: 0.5000, PTFixPNLoss: 3.8684, NetFixLoss: 0.1391, ]
2022-11-05 15:20:36,950 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2335, Pos_dist: 4.7045, Neg_dist: 6.8324, Acc: 0.4250, PTFixPNLoss: 3.8698, NetFixLoss: 0.1757, ]
2022-11-05 15:20:40,712 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1971, Pos_dist: 4.6498, Neg_dist: 7.3530, Acc: 0.4700, PTFixPNLoss: 3.8700, NetFixLoss: 0.2152, ]
2022-11-05 15:20:44,579 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1002, Pos_dist: 4.6128, Neg_dist: 7.9428, Acc: 0.4150, PTFixPNLoss: 3.8716, NetFixLoss: 0.2580, ]
2022-11-05 15:20:48,333 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3114, Pos_dist: 4.5992, Neg_dist: 6.4261, Acc: 0.4850, PTFixPNLoss: 3.8642, NetFixLoss: 0.3008, ]
2022-11-05 15:20:52,140 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3338, Pos_dist: 4.6403, Neg_dist: 6.8124, Acc: 0.4750, PTFixPNLoss: 3.8692, NetFixLoss: 0.3453, ]
2022-11-05 15:20:56,083 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3004, Pos_dist: 4.5990, Neg_dist: 6.8124, Acc: 0.4450, PTFixPNLoss: 3.8649, NetFixLoss: 0.3934, ]
2022-11-05 15:20:59,842 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1608, Pos_dist: 4.6134, Neg_dist: 7.3734, Acc: 0.4700, PTFixPNLoss: 3.8667, NetFixLoss: 0.4417, ]
2022-11-05 15:21:04,370 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2890, Pos_dist: 4.5934, Neg_dist: 7.1625, Acc: 0.4700, PTFixPNLoss: 3.8678, NetFixLoss: 0.4894, ]
2022-11-05 15:21:08,756 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2954, Pos_dist: 4.6597, Neg_dist: 6.8373, Acc: 0.4750, PTFixPNLoss: 3.8623, NetFixLoss: 0.5372, ]
2022-11-05 15:21:08,966 INFO: fine-tune procedure is finished!
2022-11-05 15:21:56,422 INFO: [Test_acc of task 4 on test 3: 0.29483][acc of former classes: 0.74700][acc of former samples in all classes: 0.56200]
[acc of novel samples in all classes: 0.16125]
2022-11-05 15:21:56,480 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:21:56,487 WARNING: Current net - loaded net:
2022-11-05 15:21:56,487 WARNING: Loaded net - current net:
2022-11-05 15:21:56,487 WARNING:   func.fc.bias
2022-11-05 15:21:56,487 WARNING:   func.fc.weight
2022-11-05 15:21:56,523 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_4.pth.
2022-11-05 15:21:56,566 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:21:56,596 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:21:56,597 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:21:56,597 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:21:56,597 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:21:56,597 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:21:56,597 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:21:56,597 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:21:56,597 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:21:56,597 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:21:56,597 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:21:56,598 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:21:56,599 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:21:56,599 INFO: Model [FSLLModel] is created.
2022-11-05 15:21:56,611 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:21:56,623 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:21:56,634 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:21:56,646 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:21:56,657 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:22:01,087 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3724, Pos_dist: 4.5412, Neg_dist: 5.9998, Acc: 0.4680, PTFixPNLoss: 4.0202, NetFixLoss: 0.0000, ]
2022-11-05 15:22:05,896 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3007, Pos_dist: 4.5584, Neg_dist: 6.3557, Acc: 0.5160, PTFixPNLoss: 4.0171, NetFixLoss: 0.0208, ]
2022-11-05 15:22:09,895 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2875, Pos_dist: 4.5573, Neg_dist: 6.4123, Acc: 0.4880, PTFixPNLoss: 4.0222, NetFixLoss: 0.0456, ]
2022-11-05 15:22:14,025 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1470, Pos_dist: 4.5933, Neg_dist: 7.6655, Acc: 0.4760, PTFixPNLoss: 4.0196, NetFixLoss: 0.0742, ]
2022-11-05 15:22:18,950 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1449, Pos_dist: 4.5935, Neg_dist: 8.0013, Acc: 0.4840, PTFixPNLoss: 4.0205, NetFixLoss: 0.1036, ]
2022-11-05 15:22:23,068 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1847, Pos_dist: 4.5375, Neg_dist: 6.9426, Acc: 0.4800, PTFixPNLoss: 4.0255, NetFixLoss: 0.1342, ]
2022-11-05 15:22:27,355 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2982, Pos_dist: 4.5596, Neg_dist: 6.4480, Acc: 0.4640, PTFixPNLoss: 4.0286, NetFixLoss: 0.1653, ]
2022-11-05 15:22:32,293 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2211, Pos_dist: 4.5972, Neg_dist: 6.6894, Acc: 0.5000, PTFixPNLoss: 4.0236, NetFixLoss: 0.1980, ]
2022-11-05 15:22:36,913 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2722, Pos_dist: 4.6437, Neg_dist: 6.6310, Acc: 0.4680, PTFixPNLoss: 4.0215, NetFixLoss: 0.2322, ]
2022-11-05 15:22:41,556 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3268, Pos_dist: 4.5857, Neg_dist: 6.4081, Acc: 0.4600, PTFixPNLoss: 4.0219, NetFixLoss: 0.2688, ]
2022-11-05 15:22:47,017 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2751, Pos_dist: 4.5682, Neg_dist: 6.9615, Acc: 0.4920, PTFixPNLoss: 4.0231, NetFixLoss: 0.3095, ]
2022-11-05 15:22:48,843 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1774, Pos_dist: 4.5435, Neg_dist: 8.2295, Acc: 0.5320, PTFixPNLoss: 4.0166, NetFixLoss: 0.3513, ]
2022-11-05 15:22:53,851 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1023, Pos_dist: 4.5821, Neg_dist: 8.1453, Acc: 0.4840, PTFixPNLoss: 4.0193, NetFixLoss: 0.3943, ]
2022-11-05 15:22:57,909 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3601, Pos_dist: 4.5638, Neg_dist: 6.2467, Acc: 0.4280, PTFixPNLoss: 4.0184, NetFixLoss: 0.4364, ]
2022-11-05 15:23:01,735 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3388, Pos_dist: 4.6186, Neg_dist: 6.5989, Acc: 0.4760, PTFixPNLoss: 4.0202, NetFixLoss: 0.4813, ]
2022-11-05 15:23:01,998 INFO: fine-tune procedure is finished!
2022-11-05 15:23:56,735 INFO: [Test_acc of task 5 on test 3: 0.26529][acc of former classes: 0.74950][acc of former samples in all classes: 0.53300]
[acc of novel samples in all classes: 0.15820]
2022-11-05 15:23:56,812 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:23:56,821 WARNING: Current net - loaded net:
2022-11-05 15:23:56,821 WARNING: Loaded net - current net:
2022-11-05 15:23:56,821 WARNING:   func.fc.bias
2022-11-05 15:23:56,821 WARNING:   func.fc.weight
2022-11-05 15:23:56,867 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_5.pth.
2022-11-05 15:23:56,919 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:23:56,956 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:23:56,957 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:23:56,957 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:23:56,957 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:23:56,957 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:23:56,957 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:23:56,957 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:23:56,957 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:23:56,957 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:23:56,957 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:23:56,957 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:23:56,957 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:23:56,957 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:23:56,958 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:23:56,959 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:23:56,960 INFO: Model [FSLLModel] is created.
2022-11-05 15:23:56,978 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:56,995 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:57,011 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:57,028 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:57,040 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:57,051 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:24:01,420 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3615, Pos_dist: 4.5087, Neg_dist: 6.0865, Acc: 0.4900, PTFixPNLoss: 4.1549, NetFixLoss: 0.0000, ]
2022-11-05 15:24:07,407 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2031, Pos_dist: 4.5784, Neg_dist: 6.8929, Acc: 0.4433, PTFixPNLoss: 4.1563, NetFixLoss: 0.0226, ]
2022-11-05 15:24:12,774 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1467, Pos_dist: 4.5672, Neg_dist: 7.7171, Acc: 0.4600, PTFixPNLoss: 4.1583, NetFixLoss: 0.0479, ]
2022-11-05 15:24:19,132 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3384, Pos_dist: 4.5044, Neg_dist: 6.1469, Acc: 0.4533, PTFixPNLoss: 4.1568, NetFixLoss: 0.0753, ]
2022-11-05 15:24:24,271 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3363, Pos_dist: 4.5652, Neg_dist: 6.2177, Acc: 0.4867, PTFixPNLoss: 4.1566, NetFixLoss: 0.1040, ]
2022-11-05 15:24:28,420 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2760, Pos_dist: 4.5517, Neg_dist: 6.7055, Acc: 0.4800, PTFixPNLoss: 4.1559, NetFixLoss: 0.1353, ]
2022-11-05 15:24:33,952 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0852, Pos_dist: 4.5625, Neg_dist: 7.9567, Acc: 0.4467, PTFixPNLoss: 4.1584, NetFixLoss: 0.1675, ]
2022-11-05 15:24:39,400 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0503, Pos_dist: 4.5521, Neg_dist: 8.5306, Acc: 0.4700, PTFixPNLoss: 4.1590, NetFixLoss: 0.1995, ]
2022-11-05 15:24:41,926 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4641, Pos_dist: 4.6356, Neg_dist: 6.1350, Acc: 0.4667, PTFixPNLoss: 4.1552, NetFixLoss: 0.2307, ]
2022-11-05 15:24:46,948 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1814, Pos_dist: 4.5255, Neg_dist: 6.5124, Acc: 0.4633, PTFixPNLoss: 4.1600, NetFixLoss: 0.2630, ]
2022-11-05 15:24:52,435 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2613, Pos_dist: 4.5838, Neg_dist: 6.8235, Acc: 0.4167, PTFixPNLoss: 4.1595, NetFixLoss: 0.2958, ]
2022-11-05 15:24:58,158 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0599, Pos_dist: 4.5609, Neg_dist: 8.2188, Acc: 0.4367, PTFixPNLoss: 4.1579, NetFixLoss: 0.3291, ]
2022-11-05 15:25:03,450 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0840, Pos_dist: 4.5745, Neg_dist: 8.3288, Acc: 0.4533, PTFixPNLoss: 4.1592, NetFixLoss: 0.3625, ]
2022-11-05 15:25:09,740 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2275, Pos_dist: 4.5416, Neg_dist: 6.8170, Acc: 0.4600, PTFixPNLoss: 4.1568, NetFixLoss: 0.3949, ]
2022-11-05 15:25:15,884 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2233, Pos_dist: 4.5603, Neg_dist: 7.4525, Acc: 0.4333, PTFixPNLoss: 4.1584, NetFixLoss: 0.4272, ]
2022-11-05 15:25:16,039 INFO: fine-tune procedure is finished!
2022-11-05 15:26:15,604 INFO: [Test_acc of task 6 on test 3: 0.23675][acc of former classes: 0.75450][acc of former samples in all classes: 0.52600]
[acc of novel samples in all classes: 0.14033]
2022-11-05 15:26:15,678 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:26:15,684 WARNING: Current net - loaded net:
2022-11-05 15:26:15,684 WARNING: Loaded net - current net:
2022-11-05 15:26:15,684 WARNING:   func.fc.bias
2022-11-05 15:26:15,684 WARNING:   func.fc.weight
2022-11-05 15:26:15,730 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_6.pth.
2022-11-05 15:26:15,774 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:26:15,808 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:26:15,808 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:26:15,808 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:26:15,808 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:26:15,808 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:26:15,808 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:26:15,808 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:26:15,809 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:26:15,809 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:26:15,809 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:26:15,809 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:26:15,809 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:26:15,810 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:26:15,811 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:26:15,811 INFO: Model [FSLLModel] is created.
2022-11-05 15:26:15,825 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:26:15,837 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:26:15,848 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:26:15,860 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:26:15,871 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:26:15,883 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:26:15,908 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:26:21,960 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1870, Pos_dist: 4.5418, Neg_dist: 6.9560, Acc: 0.4429, PTFixPNLoss: 4.2725, NetFixLoss: 0.0000, ]
2022-11-05 15:26:27,476 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1685, Pos_dist: 4.5215, Neg_dist: 7.3330, Acc: 0.4914, PTFixPNLoss: 4.2708, NetFixLoss: 0.0159, ]
2022-11-05 15:26:33,092 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3202, Pos_dist: 4.5574, Neg_dist: 6.4124, Acc: 0.4371, PTFixPNLoss: 4.2747, NetFixLoss: 0.0341, ]
2022-11-05 15:26:37,094 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1662, Pos_dist: 4.5272, Neg_dist: 7.6952, Acc: 0.4486, PTFixPNLoss: 4.2705, NetFixLoss: 0.0564, ]
2022-11-05 15:26:42,985 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1112, Pos_dist: 4.5408, Neg_dist: 7.4075, Acc: 0.4171, PTFixPNLoss: 4.2749, NetFixLoss: 0.0811, ]
2022-11-05 15:26:49,394 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1782, Pos_dist: 4.5024, Neg_dist: 7.0969, Acc: 0.4657, PTFixPNLoss: 4.2710, NetFixLoss: 0.1074, ]
2022-11-05 15:26:54,964 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3625, Pos_dist: 4.4746, Neg_dist: 6.0680, Acc: 0.4143, PTFixPNLoss: 4.2740, NetFixLoss: 0.1351, ]
2022-11-05 15:27:02,081 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2836, Pos_dist: 4.4902, Neg_dist: 6.3473, Acc: 0.4571, PTFixPNLoss: 4.2720, NetFixLoss: 0.1651, ]
2022-11-05 15:27:08,200 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2897, Pos_dist: 4.5505, Neg_dist: 6.5162, Acc: 0.4400, PTFixPNLoss: 4.2731, NetFixLoss: 0.1966, ]
2022-11-05 15:27:13,951 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0811, Pos_dist: 4.5546, Neg_dist: 8.4776, Acc: 0.4686, PTFixPNLoss: 4.2745, NetFixLoss: 0.2308, ]
2022-11-05 15:27:19,813 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1301, Pos_dist: 4.5597, Neg_dist: 7.0641, Acc: 0.4629, PTFixPNLoss: 4.2757, NetFixLoss: 0.2652, ]
2022-11-05 15:27:25,824 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0726, Pos_dist: 4.5444, Neg_dist: 8.9385, Acc: 0.4600, PTFixPNLoss: 4.2733, NetFixLoss: 0.3007, ]
2022-11-05 15:27:31,844 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2324, Pos_dist: 4.5523, Neg_dist: 6.7523, Acc: 0.4343, PTFixPNLoss: 4.2749, NetFixLoss: 0.3363, ]
2022-11-05 15:27:36,806 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2400, Pos_dist: 4.5378, Neg_dist: 6.6294, Acc: 0.4343, PTFixPNLoss: 4.2741, NetFixLoss: 0.3711, ]
2022-11-05 15:27:43,318 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2332, Pos_dist: 4.5271, Neg_dist: 7.0413, Acc: 0.4514, PTFixPNLoss: 4.2691, NetFixLoss: 0.4056, ]
2022-11-05 15:27:43,535 INFO: fine-tune procedure is finished!
2022-11-05 15:28:51,489 INFO: [Test_acc of task 7 on test 3: 0.21867][acc of former classes: 0.75150][acc of former samples in all classes: 0.50600]
[acc of novel samples in all classes: 0.13657]
2022-11-05 15:28:51,570 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:28:51,579 WARNING: Current net - loaded net:
2022-11-05 15:28:51,579 WARNING: Loaded net - current net:
2022-11-05 15:28:51,579 WARNING:   func.fc.bias
2022-11-05 15:28:51,579 WARNING:   func.fc.weight
2022-11-05 15:28:51,651 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_7.pth.
2022-11-05 15:28:51,713 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:28:51,755 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:28:51,756 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:28:51,756 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:28:51,757 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:28:51,758 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:28:51,759 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:28:51,759 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:28:51,759 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:28:51,759 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:28:51,759 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:28:51,759 INFO: Model [FSLLModel] is created.
2022-11-05 15:28:51,777 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:51,794 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:51,809 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:51,820 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:51,831 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:51,841 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:51,853 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:51,865 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:28:57,897 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2122, Pos_dist: 4.4973, Neg_dist: 6.8091, Acc: 0.4450, PTFixPNLoss: 4.3744, NetFixLoss: 0.0000, ]
2022-11-05 15:29:04,482 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2554, Pos_dist: 4.5416, Neg_dist: 6.7430, Acc: 0.4575, PTFixPNLoss: 4.3781, NetFixLoss: 0.0169, ]
2022-11-05 15:29:08,347 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1886, Pos_dist: 4.5091, Neg_dist: 7.1097, Acc: 0.4650, PTFixPNLoss: 4.3777, NetFixLoss: 0.0370, ]
2022-11-05 15:29:15,227 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1022, Pos_dist: 4.4865, Neg_dist: 7.2440, Acc: 0.4600, PTFixPNLoss: 4.3763, NetFixLoss: 0.0616, ]
2022-11-05 15:29:22,103 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2153, Pos_dist: 4.5302, Neg_dist: 6.6001, Acc: 0.4450, PTFixPNLoss: 4.3793, NetFixLoss: 0.0879, ]
2022-11-05 15:29:29,501 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2788, Pos_dist: 4.5648, Neg_dist: 6.6339, Acc: 0.4350, PTFixPNLoss: 4.3821, NetFixLoss: 0.1152, ]
2022-11-05 15:29:36,171 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3820, Pos_dist: 4.5136, Neg_dist: 5.9869, Acc: 0.4650, PTFixPNLoss: 4.3794, NetFixLoss: 0.1444, ]
2022-11-05 15:29:42,941 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3825, Pos_dist: 4.5088, Neg_dist: 6.0653, Acc: 0.4650, PTFixPNLoss: 4.3750, NetFixLoss: 0.1759, ]
2022-11-05 15:29:50,344 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1834, Pos_dist: 4.4809, Neg_dist: 6.7389, Acc: 0.4375, PTFixPNLoss: 4.3763, NetFixLoss: 0.2114, ]
2022-11-05 15:29:56,828 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2540, Pos_dist: 4.5639, Neg_dist: 6.4382, Acc: 0.4500, PTFixPNLoss: 4.3753, NetFixLoss: 0.2490, ]
2022-11-05 15:30:03,957 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2919, Pos_dist: 4.5057, Neg_dist: 6.2819, Acc: 0.4450, PTFixPNLoss: 4.3743, NetFixLoss: 0.2880, ]
2022-11-05 15:30:11,748 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1901, Pos_dist: 4.5177, Neg_dist: 7.2996, Acc: 0.4650, PTFixPNLoss: 4.3761, NetFixLoss: 0.3272, ]
2022-11-05 15:30:18,907 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2739, Pos_dist: 4.5211, Neg_dist: 6.3761, Acc: 0.4575, PTFixPNLoss: 4.3747, NetFixLoss: 0.3662, ]
2022-11-05 15:30:26,616 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2082, Pos_dist: 4.5334, Neg_dist: 6.8361, Acc: 0.4000, PTFixPNLoss: 4.3789, NetFixLoss: 0.4054, ]
2022-11-05 15:30:33,190 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1581, Pos_dist: 4.5280, Neg_dist: 6.9862, Acc: 0.4325, PTFixPNLoss: 4.3773, NetFixLoss: 0.4441, ]
2022-11-05 15:30:33,305 INFO: fine-tune procedure is finished!
2022-11-05 15:31:53,548 INFO: [Test_acc of task 8 on test 3: 0.20060][acc of former classes: 0.74850][acc of former samples in all classes: 0.48050]
[acc of novel samples in all classes: 0.13062]
2022-11-05 15:31:53,626 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:31:53,634 WARNING: Current net - loaded net:
2022-11-05 15:31:53,635 WARNING: Loaded net - current net:
2022-11-05 15:31:53,635 WARNING:   func.fc.bias
2022-11-05 15:31:53,635 WARNING:   func.fc.weight
2022-11-05 15:31:53,693 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth.
2022-11-05 15:31:53,771 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:31:54,200 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:31:54,201 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:31:54,201 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:31:54,201 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:31:54,201 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:31:54,201 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:31:54,202 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:31:54,202 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:31:54,202 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:31:54,202 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:31:54,202 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:31:54,202 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:31:54,202 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:31:54,202 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:31:54,202 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:31:54,202 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:31:54,203 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:31:54,204 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:31:54,205 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:31:54,205 INFO: Model [FSLLModel] is created.
2022-11-05 15:31:54,224 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-11-05 15:31:55,780 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1319, Pos_dist: 4.7387, Neg_dist: 7.7406, Acc: 0.6200, PTFixPNLoss: 3.1594, NetFixLoss: 0.0000, ]
2022-11-05 15:31:57,048 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1572, Pos_dist: 4.6480, Neg_dist: 7.3393, Acc: 0.6200, PTFixPNLoss: 3.1645, NetFixLoss: 0.0198, ]
2022-11-05 15:31:59,041 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2133, Pos_dist: 4.7371, Neg_dist: 7.4825, Acc: 0.6200, PTFixPNLoss: 3.1725, NetFixLoss: 0.0429, ]
2022-11-05 15:32:00,687 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1132, Pos_dist: 4.7763, Neg_dist: 7.6307, Acc: 0.5400, PTFixPNLoss: 3.1712, NetFixLoss: 0.0737, ]
2022-11-05 15:32:02,318 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2824, Pos_dist: 4.7565, Neg_dist: 7.2007, Acc: 0.5000, PTFixPNLoss: 3.1654, NetFixLoss: 0.1105, ]
2022-11-05 15:32:03,823 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3268, Pos_dist: 4.9084, Neg_dist: 6.7476, Acc: 0.5800, PTFixPNLoss: 3.1744, NetFixLoss: 0.1549, ]
2022-11-05 15:32:05,329 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2350, Pos_dist: 4.8042, Neg_dist: 7.0040, Acc: 0.5200, PTFixPNLoss: 3.1709, NetFixLoss: 0.2029, ]
2022-11-05 15:32:07,377 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3398, Pos_dist: 4.7242, Neg_dist: 6.6924, Acc: 0.5800, PTFixPNLoss: 3.1680, NetFixLoss: 0.2577, ]
2022-11-05 15:32:09,008 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2416, Pos_dist: 4.7815, Neg_dist: 6.8130, Acc: 0.5400, PTFixPNLoss: 3.1704, NetFixLoss: 0.3172, ]
2022-11-05 15:32:10,839 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2049, Pos_dist: 4.6626, Neg_dist: 6.8328, Acc: 0.6600, PTFixPNLoss: 3.1647, NetFixLoss: 0.3834, ]
2022-11-05 15:32:12,909 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3267, Pos_dist: 4.7741, Neg_dist: 6.7493, Acc: 0.6400, PTFixPNLoss: 3.1633, NetFixLoss: 0.4519, ]
2022-11-05 15:32:14,584 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2515, Pos_dist: 4.6760, Neg_dist: 6.5124, Acc: 0.6200, PTFixPNLoss: 3.1641, NetFixLoss: 0.5204, ]
2022-11-05 15:32:16,292 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1132, Pos_dist: 4.7608, Neg_dist: 7.7351, Acc: 0.6000, PTFixPNLoss: 3.1680, NetFixLoss: 0.5901, ]
2022-11-05 15:32:17,730 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1367, Pos_dist: 4.8056, Neg_dist: 7.0190, Acc: 0.5600, PTFixPNLoss: 3.1676, NetFixLoss: 0.6603, ]
2022-11-05 15:32:19,732 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3254, Pos_dist: 4.6778, Neg_dist: 6.8624, Acc: 0.5600, PTFixPNLoss: 3.1630, NetFixLoss: 0.7307, ]
2022-11-05 15:32:19,952 INFO: fine-tune procedure is finished!
2022-11-05 15:32:46,586 INFO: [Test_acc of task 1 on test 4: 0.52700][acc of former classes: 0.73850][acc of former samples in all classes: 0.68050]
[acc of novel samples in all classes: 0.22000]
2022-11-05 15:32:46,667 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:32:46,675 WARNING: Current net - loaded net:
2022-11-05 15:32:46,675 WARNING: Loaded net - current net:
2022-11-05 15:32:46,675 WARNING:   func.fc.bias
2022-11-05 15:32:46,675 WARNING:   func.fc.weight
2022-11-05 15:32:46,730 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_1.pth.
2022-11-05 15:32:46,795 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:32:46,891 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:32:46,892 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:32:46,892 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:32:46,892 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:32:46,893 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:32:46,894 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:32:46,895 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:32:46,895 INFO: Model [FSLLModel] is created.
2022-11-05 15:32:46,908 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:32:46,920 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-11-05 15:32:48,749 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3014, Pos_dist: 4.6842, Neg_dist: 6.4872, Acc: 0.5500, PTFixPNLoss: 3.4635, NetFixLoss: 0.0000, ]
2022-11-05 15:32:51,206 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2437, Pos_dist: 4.7363, Neg_dist: 7.1293, Acc: 0.5600, PTFixPNLoss: 3.4649, NetFixLoss: 0.0260, ]
2022-11-05 15:32:53,320 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3126, Pos_dist: 4.8120, Neg_dist: 6.6814, Acc: 0.4800, PTFixPNLoss: 3.4692, NetFixLoss: 0.0573, ]
2022-11-05 15:32:55,771 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2547, Pos_dist: 4.7075, Neg_dist: 6.6094, Acc: 0.5600, PTFixPNLoss: 3.4627, NetFixLoss: 0.0934, ]
2022-11-05 15:32:58,381 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4147, Pos_dist: 4.8250, Neg_dist: 6.3356, Acc: 0.5000, PTFixPNLoss: 3.4685, NetFixLoss: 0.1336, ]
2022-11-05 15:33:00,704 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1946, Pos_dist: 4.7416, Neg_dist: 8.5756, Acc: 0.5600, PTFixPNLoss: 3.4618, NetFixLoss: 0.1776, ]
2022-11-05 15:33:03,279 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2087, Pos_dist: 4.7867, Neg_dist: 6.9868, Acc: 0.4800, PTFixPNLoss: 3.4645, NetFixLoss: 0.2230, ]
2022-11-05 15:33:06,066 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4516, Pos_dist: 4.8480, Neg_dist: 6.0680, Acc: 0.4800, PTFixPNLoss: 3.4641, NetFixLoss: 0.2746, ]
2022-11-05 15:33:08,528 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2903, Pos_dist: 4.7807, Neg_dist: 6.8936, Acc: 0.5100, PTFixPNLoss: 3.4654, NetFixLoss: 0.3312, ]
2022-11-05 15:33:10,919 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2855, Pos_dist: 4.7753, Neg_dist: 6.8521, Acc: 0.5100, PTFixPNLoss: 3.4681, NetFixLoss: 0.3875, ]
2022-11-05 15:33:13,588 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0980, Pos_dist: 4.6754, Neg_dist: 7.6018, Acc: 0.5300, PTFixPNLoss: 3.4636, NetFixLoss: 0.4444, ]
2022-11-05 15:33:16,063 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2288, Pos_dist: 4.7188, Neg_dist: 7.0363, Acc: 0.5600, PTFixPNLoss: 3.4587, NetFixLoss: 0.5014, ]
2022-11-05 15:33:18,303 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3262, Pos_dist: 4.8024, Neg_dist: 6.6265, Acc: 0.5200, PTFixPNLoss: 3.4636, NetFixLoss: 0.5579, ]
2022-11-05 15:33:20,466 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1969, Pos_dist: 4.6248, Neg_dist: 7.0306, Acc: 0.5100, PTFixPNLoss: 3.4618, NetFixLoss: 0.6154, ]
2022-11-05 15:33:22,856 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2161, Pos_dist: 4.7631, Neg_dist: 7.0853, Acc: 0.5300, PTFixPNLoss: 3.4634, NetFixLoss: 0.6721, ]
2022-11-05 15:33:22,967 INFO: fine-tune procedure is finished!
2022-11-05 15:33:57,090 INFO: [Test_acc of task 2 on test 4: 0.40675][acc of former classes: 0.73350][acc of former samples in all classes: 0.60850]
[acc of novel samples in all classes: 0.20500]
2022-11-05 15:33:57,251 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:33:57,260 WARNING: Current net - loaded net:
2022-11-05 15:33:57,260 WARNING: Loaded net - current net:
2022-11-05 15:33:57,260 WARNING:   func.fc.bias
2022-11-05 15:33:57,260 WARNING:   func.fc.weight
2022-11-05 15:33:57,317 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_2.pth.
2022-11-05 15:33:57,379 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:33:57,435 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:33:57,436 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:33:57,437 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:33:57,437 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:33:57,437 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:33:57,437 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:33:57,438 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:33:57,439 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:33:57,440 INFO: Model [FSLLModel] is created.
2022-11-05 15:33:57,462 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:33:57,477 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:33:57,492 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-11-05 15:33:59,705 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0871, Pos_dist: 4.6940, Neg_dist: 8.2062, Acc: 0.5133, PTFixPNLoss: 3.6906, NetFixLoss: 0.0000, ]
2022-11-05 15:34:03,135 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2381, Pos_dist: 4.7688, Neg_dist: 7.0671, Acc: 0.4533, PTFixPNLoss: 3.6971, NetFixLoss: 0.0114, ]
2022-11-05 15:34:06,568 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3222, Pos_dist: 4.7962, Neg_dist: 6.8069, Acc: 0.4333, PTFixPNLoss: 3.6944, NetFixLoss: 0.0300, ]
2022-11-05 15:34:09,512 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3278, Pos_dist: 4.7150, Neg_dist: 6.3811, Acc: 0.5000, PTFixPNLoss: 3.6918, NetFixLoss: 0.0584, ]
2022-11-05 15:34:12,747 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3100, Pos_dist: 4.8014, Neg_dist: 6.7871, Acc: 0.4933, PTFixPNLoss: 3.6918, NetFixLoss: 0.0923, ]
2022-11-05 15:34:16,625 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3084, Pos_dist: 4.7529, Neg_dist: 6.3829, Acc: 0.4800, PTFixPNLoss: 3.6969, NetFixLoss: 0.1302, ]
2022-11-05 15:34:19,435 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1745, Pos_dist: 4.7203, Neg_dist: 7.1962, Acc: 0.4733, PTFixPNLoss: 3.6966, NetFixLoss: 0.1733, ]
2022-11-05 15:34:21,744 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3913, Pos_dist: 4.6610, Neg_dist: 6.1301, Acc: 0.5467, PTFixPNLoss: 3.6924, NetFixLoss: 0.2169, ]
2022-11-05 15:34:25,332 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4422, Pos_dist: 4.7665, Neg_dist: 6.2224, Acc: 0.5133, PTFixPNLoss: 3.6908, NetFixLoss: 0.2625, ]
2022-11-05 15:34:28,284 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2042, Pos_dist: 4.7142, Neg_dist: 7.1641, Acc: 0.5333, PTFixPNLoss: 3.6931, NetFixLoss: 0.3111, ]
2022-11-05 15:34:31,623 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2901, Pos_dist: 4.6507, Neg_dist: 6.6804, Acc: 0.5333, PTFixPNLoss: 3.6895, NetFixLoss: 0.3603, ]
2022-11-05 15:34:34,374 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1949, Pos_dist: 4.7255, Neg_dist: 7.3865, Acc: 0.5067, PTFixPNLoss: 3.6954, NetFixLoss: 0.4103, ]
2022-11-05 15:34:37,129 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2525, Pos_dist: 4.7312, Neg_dist: 6.8030, Acc: 0.4667, PTFixPNLoss: 3.6936, NetFixLoss: 0.4588, ]
2022-11-05 15:34:40,340 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1238, Pos_dist: 4.7658, Neg_dist: 7.4997, Acc: 0.4533, PTFixPNLoss: 3.6966, NetFixLoss: 0.5067, ]
2022-11-05 15:34:43,380 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1213, Pos_dist: 4.7017, Neg_dist: 8.3828, Acc: 0.5133, PTFixPNLoss: 3.6930, NetFixLoss: 0.5529, ]
2022-11-05 15:34:43,545 INFO: fine-tune procedure is finished!
2022-11-05 15:35:25,447 INFO: [Test_acc of task 3 on test 4: 0.34080][acc of former classes: 0.73850][acc of former samples in all classes: 0.57100]
[acc of novel samples in all classes: 0.18733]
2022-11-05 15:35:25,586 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:35:25,638 WARNING: Current net - loaded net:
2022-11-05 15:35:25,638 WARNING: Loaded net - current net:
2022-11-05 15:35:25,638 WARNING:   func.fc.bias
2022-11-05 15:35:25,638 WARNING:   func.fc.weight
2022-11-05 15:35:25,702 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_3.pth.
2022-11-05 15:35:25,760 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:35:25,798 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:35:25,799 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:35:25,799 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:35:25,800 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:35:25,800 INFO: Model [FSLLModel] is created.
2022-11-05 15:35:25,812 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:35:25,823 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:35:25,833 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:35:25,844 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-11-05 15:35:29,473 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2769, Pos_dist: 4.6885, Neg_dist: 6.8243, Acc: 0.5050, PTFixPNLoss: 3.8726, NetFixLoss: 0.0000, ]
2022-11-05 15:35:33,531 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1998, Pos_dist: 4.6686, Neg_dist: 7.3629, Acc: 0.5250, PTFixPNLoss: 3.8780, NetFixLoss: 0.0191, ]
2022-11-05 15:35:37,603 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2553, Pos_dist: 4.7052, Neg_dist: 7.2441, Acc: 0.4700, PTFixPNLoss: 3.8701, NetFixLoss: 0.0418, ]
2022-11-05 15:35:41,639 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3124, Pos_dist: 4.7180, Neg_dist: 6.8312, Acc: 0.4900, PTFixPNLoss: 3.8750, NetFixLoss: 0.0681, ]
2022-11-05 15:35:45,250 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3299, Pos_dist: 4.6605, Neg_dist: 6.4735, Acc: 0.4450, PTFixPNLoss: 3.8739, NetFixLoss: 0.0985, ]
2022-11-05 15:35:49,039 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1311, Pos_dist: 4.6697, Neg_dist: 8.0175, Acc: 0.4750, PTFixPNLoss: 3.8704, NetFixLoss: 0.1357, ]
2022-11-05 15:35:53,273 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3383, Pos_dist: 4.6117, Neg_dist: 6.3567, Acc: 0.4700, PTFixPNLoss: 3.8712, NetFixLoss: 0.1754, ]
2022-11-05 15:35:57,119 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1454, Pos_dist: 4.6231, Neg_dist: 7.2906, Acc: 0.5000, PTFixPNLoss: 3.8714, NetFixLoss: 0.2163, ]
2022-11-05 15:36:01,438 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1529, Pos_dist: 4.6242, Neg_dist: 7.9388, Acc: 0.5200, PTFixPNLoss: 3.8715, NetFixLoss: 0.2604, ]
2022-11-05 15:36:05,699 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0996, Pos_dist: 4.6752, Neg_dist: 7.8323, Acc: 0.4800, PTFixPNLoss: 3.8755, NetFixLoss: 0.3037, ]
2022-11-05 15:36:10,007 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3628, Pos_dist: 4.7007, Neg_dist: 6.2964, Acc: 0.4700, PTFixPNLoss: 3.8742, NetFixLoss: 0.3465, ]
2022-11-05 15:36:13,764 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3036, Pos_dist: 4.6562, Neg_dist: 6.5153, Acc: 0.4650, PTFixPNLoss: 3.8728, NetFixLoss: 0.3890, ]
2022-11-05 15:36:18,234 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3718, Pos_dist: 4.6162, Neg_dist: 6.0985, Acc: 0.5000, PTFixPNLoss: 3.8707, NetFixLoss: 0.4370, ]
2022-11-05 15:36:22,521 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2439, Pos_dist: 4.6331, Neg_dist: 7.0555, Acc: 0.4850, PTFixPNLoss: 3.8714, NetFixLoss: 0.4858, ]
2022-11-05 15:36:27,282 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3489, Pos_dist: 4.6719, Neg_dist: 6.2655, Acc: 0.4900, PTFixPNLoss: 3.8718, NetFixLoss: 0.5333, ]
2022-11-05 15:36:27,365 INFO: fine-tune procedure is finished!
2022-11-05 15:37:14,984 INFO: [Test_acc of task 4 on test 4: 0.30317][acc of former classes: 0.74900][acc of former samples in all classes: 0.57100]
[acc of novel samples in all classes: 0.16925]
2022-11-05 15:37:15,059 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:37:15,065 WARNING: Current net - loaded net:
2022-11-05 15:37:15,065 WARNING: Loaded net - current net:
2022-11-05 15:37:15,065 WARNING:   func.fc.bias
2022-11-05 15:37:15,065 WARNING:   func.fc.weight
2022-11-05 15:37:15,121 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_4.pth.
2022-11-05 15:37:15,185 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:37:15,224 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:37:15,225 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:37:15,225 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:37:15,226 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:37:15,227 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:37:15,227 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:37:15,227 INFO: Model [FSLLModel] is created.
2022-11-05 15:37:15,239 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:15,250 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:15,263 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:15,275 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:15,286 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:37:19,716 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2414, Pos_dist: 4.6750, Neg_dist: 6.7430, Acc: 0.4560, PTFixPNLoss: 4.0330, NetFixLoss: 0.0000, ]
2022-11-05 15:37:24,541 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2057, Pos_dist: 4.6433, Neg_dist: 6.8582, Acc: 0.4280, PTFixPNLoss: 4.0284, NetFixLoss: 0.0202, ]
2022-11-05 15:37:29,752 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3620, Pos_dist: 4.6906, Neg_dist: 6.4264, Acc: 0.4360, PTFixPNLoss: 4.0299, NetFixLoss: 0.0426, ]
2022-11-05 15:37:34,454 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2548, Pos_dist: 4.5928, Neg_dist: 6.5122, Acc: 0.4440, PTFixPNLoss: 4.0212, NetFixLoss: 0.0688, ]
2022-11-05 15:37:38,159 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3443, Pos_dist: 4.6276, Neg_dist: 6.7158, Acc: 0.4720, PTFixPNLoss: 4.0318, NetFixLoss: 0.0983, ]
2022-11-05 15:37:42,987 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1827, Pos_dist: 4.6911, Neg_dist: 7.2550, Acc: 0.4080, PTFixPNLoss: 4.0335, NetFixLoss: 0.1321, ]
2022-11-05 15:37:48,154 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4232, Pos_dist: 4.6265, Neg_dist: 6.5492, Acc: 0.4200, PTFixPNLoss: 4.0265, NetFixLoss: 0.1693, ]
2022-11-05 15:37:53,005 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2979, Pos_dist: 4.6831, Neg_dist: 7.2201, Acc: 0.4240, PTFixPNLoss: 4.0291, NetFixLoss: 0.2082, ]
2022-11-05 15:37:57,820 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1955, Pos_dist: 4.6585, Neg_dist: 7.3882, Acc: 0.4600, PTFixPNLoss: 4.0282, NetFixLoss: 0.2482, ]
2022-11-05 15:38:02,362 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1547, Pos_dist: 4.6019, Neg_dist: 7.3808, Acc: 0.4440, PTFixPNLoss: 4.0320, NetFixLoss: 0.2880, ]
2022-11-05 15:38:06,801 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1864, Pos_dist: 4.6594, Neg_dist: 7.5135, Acc: 0.4760, PTFixPNLoss: 4.0348, NetFixLoss: 0.3271, ]
2022-11-05 15:38:11,573 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3862, Pos_dist: 4.6339, Neg_dist: 6.1488, Acc: 0.4360, PTFixPNLoss: 4.0303, NetFixLoss: 0.3662, ]
2022-11-05 15:38:16,142 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3564, Pos_dist: 4.6014, Neg_dist: 6.3151, Acc: 0.4520, PTFixPNLoss: 4.0285, NetFixLoss: 0.4072, ]
2022-11-05 15:38:20,521 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4373, Pos_dist: 4.6436, Neg_dist: 5.8891, Acc: 0.4600, PTFixPNLoss: 4.0320, NetFixLoss: 0.4494, ]
2022-11-05 15:38:25,512 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1778, Pos_dist: 4.5916, Neg_dist: 6.9050, Acc: 0.4560, PTFixPNLoss: 4.0260, NetFixLoss: 0.4934, ]
2022-11-05 15:38:25,602 INFO: fine-tune procedure is finished!
2022-11-05 15:39:16,931 INFO: [Test_acc of task 5 on test 4: 0.26814][acc of former classes: 0.74600][acc of former samples in all classes: 0.53950]
[acc of novel samples in all classes: 0.15960]
2022-11-05 15:39:17,009 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:39:17,018 WARNING: Current net - loaded net:
2022-11-05 15:39:17,019 WARNING: Loaded net - current net:
2022-11-05 15:39:17,019 WARNING:   func.fc.bias
2022-11-05 15:39:17,019 WARNING:   func.fc.weight
2022-11-05 15:39:17,062 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_5.pth.
2022-11-05 15:39:17,125 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:39:17,165 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:39:17,165 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:39:17,166 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:39:17,167 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:39:17,167 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:39:17,168 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:39:17,169 INFO: Model [FSLLModel] is created.
2022-11-05 15:39:17,181 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:17,192 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:17,202 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:17,212 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:17,225 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:17,237 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:39:22,391 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3704, Pos_dist: 4.6150, Neg_dist: 6.1893, Acc: 0.4567, PTFixPNLoss: 4.1660, NetFixLoss: 0.0000, ]
2022-11-05 15:39:27,916 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2232, Pos_dist: 4.5570, Neg_dist: 6.6225, Acc: 0.4400, PTFixPNLoss: 4.1670, NetFixLoss: 0.0190, ]
2022-11-05 15:39:33,188 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2026, Pos_dist: 4.6860, Neg_dist: 7.1132, Acc: 0.4433, PTFixPNLoss: 4.1685, NetFixLoss: 0.0402, ]
2022-11-05 15:39:38,002 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0993, Pos_dist: 4.6464, Neg_dist: 7.6897, Acc: 0.4467, PTFixPNLoss: 4.1700, NetFixLoss: 0.0638, ]
2022-11-05 15:39:42,679 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3147, Pos_dist: 4.6109, Neg_dist: 6.2800, Acc: 0.4233, PTFixPNLoss: 4.1705, NetFixLoss: 0.0893, ]
2022-11-05 15:39:48,205 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2768, Pos_dist: 4.5808, Neg_dist: 6.4275, Acc: 0.4500, PTFixPNLoss: 4.1633, NetFixLoss: 0.1184, ]
2022-11-05 15:39:53,208 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1620, Pos_dist: 4.6328, Neg_dist: 7.0812, Acc: 0.4700, PTFixPNLoss: 4.1691, NetFixLoss: 0.1495, ]
2022-11-05 15:39:58,827 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1340, Pos_dist: 4.6750, Neg_dist: 7.6093, Acc: 0.4367, PTFixPNLoss: 4.1721, NetFixLoss: 0.1818, ]
2022-11-05 15:40:03,306 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2768, Pos_dist: 4.6011, Neg_dist: 6.7466, Acc: 0.4433, PTFixPNLoss: 4.1632, NetFixLoss: 0.2151, ]
2022-11-05 15:40:08,583 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4019, Pos_dist: 4.6387, Neg_dist: 6.0925, Acc: 0.4667, PTFixPNLoss: 4.1675, NetFixLoss: 0.2487, ]
2022-11-05 15:40:13,948 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2328, Pos_dist: 4.6114, Neg_dist: 6.7547, Acc: 0.4633, PTFixPNLoss: 4.1672, NetFixLoss: 0.2839, ]
2022-11-05 15:40:19,073 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2452, Pos_dist: 4.5989, Neg_dist: 6.5654, Acc: 0.4500, PTFixPNLoss: 4.1640, NetFixLoss: 0.3207, ]
2022-11-05 15:40:24,414 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2902, Pos_dist: 4.6276, Neg_dist: 6.3875, Acc: 0.4567, PTFixPNLoss: 4.1666, NetFixLoss: 0.3601, ]
2022-11-05 15:40:29,783 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2018, Pos_dist: 4.5842, Neg_dist: 7.0850, Acc: 0.4467, PTFixPNLoss: 4.1661, NetFixLoss: 0.4003, ]
2022-11-05 15:40:35,010 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3114, Pos_dist: 4.6178, Neg_dist: 6.4485, Acc: 0.4267, PTFixPNLoss: 4.1646, NetFixLoss: 0.4433, ]
2022-11-05 15:40:35,099 INFO: fine-tune procedure is finished!
2022-11-05 15:41:34,527 INFO: [Test_acc of task 6 on test 4: 0.23863][acc of former classes: 0.74850][acc of former samples in all classes: 0.53000]
[acc of novel samples in all classes: 0.14150]
2022-11-05 15:41:34,612 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:41:34,622 WARNING: Current net - loaded net:
2022-11-05 15:41:34,622 WARNING: Loaded net - current net:
2022-11-05 15:41:34,622 WARNING:   func.fc.bias
2022-11-05 15:41:34,622 WARNING:   func.fc.weight
2022-11-05 15:41:34,676 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_6.pth.
2022-11-05 15:41:34,739 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:41:34,776 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:41:34,776 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:41:34,777 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:41:34,777 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:41:34,777 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:41:34,777 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:41:34,778 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:41:34,779 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:41:34,779 INFO: Model [FSLLModel] is created.
2022-11-05 15:41:34,790 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:41:34,800 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:41:34,811 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:41:34,822 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:41:34,832 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:41:34,842 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:41:34,852 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:41:40,861 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2741, Pos_dist: 4.6527, Neg_dist: 6.7425, Acc: 0.4457, PTFixPNLoss: 4.2848, NetFixLoss: 0.0000, ]
2022-11-05 15:41:47,471 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4020, Pos_dist: 4.6096, Neg_dist: 6.1126, Acc: 0.4286, PTFixPNLoss: 4.2810, NetFixLoss: 0.0185, ]
2022-11-05 15:41:53,870 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4173, Pos_dist: 4.6300, Neg_dist: 6.1431, Acc: 0.4029, PTFixPNLoss: 4.2843, NetFixLoss: 0.0430, ]
2022-11-05 15:42:00,428 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2569, Pos_dist: 4.5723, Neg_dist: 6.7636, Acc: 0.4514, PTFixPNLoss: 4.2761, NetFixLoss: 0.0717, ]
2022-11-05 15:42:07,148 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1185, Pos_dist: 4.6060, Neg_dist: 7.9769, Acc: 0.4086, PTFixPNLoss: 4.2799, NetFixLoss: 0.1024, ]
2022-11-05 15:42:13,922 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1965, Pos_dist: 4.5750, Neg_dist: 6.9584, Acc: 0.4400, PTFixPNLoss: 4.2754, NetFixLoss: 0.1337, ]
2022-11-05 15:42:20,282 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3754, Pos_dist: 4.6137, Neg_dist: 6.1895, Acc: 0.4086, PTFixPNLoss: 4.2800, NetFixLoss: 0.1650, ]
2022-11-05 15:42:27,265 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4196, Pos_dist: 4.5795, Neg_dist: 6.0318, Acc: 0.4486, PTFixPNLoss: 4.2843, NetFixLoss: 0.2013, ]
2022-11-05 15:42:34,141 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4534, Pos_dist: 4.6298, Neg_dist: 5.9750, Acc: 0.4057, PTFixPNLoss: 4.2794, NetFixLoss: 0.2387, ]
2022-11-05 15:42:40,946 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4517, Pos_dist: 4.5588, Neg_dist: 5.7690, Acc: 0.4343, PTFixPNLoss: 4.2787, NetFixLoss: 0.2776, ]
2022-11-05 15:42:47,547 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3269, Pos_dist: 4.6353, Neg_dist: 6.3974, Acc: 0.4029, PTFixPNLoss: 4.2827, NetFixLoss: 0.3180, ]
2022-11-05 15:42:53,572 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3007, Pos_dist: 4.5798, Neg_dist: 6.3427, Acc: 0.4314, PTFixPNLoss: 4.2804, NetFixLoss: 0.3594, ]
2022-11-05 15:43:00,115 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3728, Pos_dist: 4.5787, Neg_dist: 6.1116, Acc: 0.4571, PTFixPNLoss: 4.2800, NetFixLoss: 0.4016, ]
2022-11-05 15:43:06,788 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1428, Pos_dist: 4.6434, Neg_dist: 7.6837, Acc: 0.4400, PTFixPNLoss: 4.2782, NetFixLoss: 0.4444, ]
2022-11-05 15:43:12,099 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2813, Pos_dist: 4.6141, Neg_dist: 6.7812, Acc: 0.4000, PTFixPNLoss: 4.2797, NetFixLoss: 0.4868, ]
2022-11-05 15:43:12,186 INFO: fine-tune procedure is finished!
2022-11-05 15:44:19,015 INFO: [Test_acc of task 7 on test 4: 0.21800][acc of former classes: 0.75000][acc of former samples in all classes: 0.50850]
[acc of novel samples in all classes: 0.13500]
2022-11-05 15:44:19,089 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:44:19,098 WARNING: Current net - loaded net:
2022-11-05 15:44:19,098 WARNING: Loaded net - current net:
2022-11-05 15:44:19,099 WARNING:   func.fc.bias
2022-11-05 15:44:19,099 WARNING:   func.fc.weight
2022-11-05 15:44:19,152 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_7.pth.
2022-11-05 15:44:19,214 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/prototypes/test0_session0.pt
2022-11-05 15:44:19,255 INFO: Optimize parameters: func.layer1.0.bn1.bias.
2022-11-05 15:44:19,255 INFO: Optimize parameters: func.layer1.0.conv2.weight.
2022-11-05 15:44:19,255 INFO: Optimize parameters: func.layer1.0.bn2.bias.
2022-11-05 15:44:19,255 INFO: Optimize parameters: func.layer1.1.conv2.weight.
2022-11-05 15:44:19,255 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer1.2.conv2.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer1.2.bn2.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.1.conv1.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.1.bn1.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.2.conv1.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.0.conv1.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.0.conv2.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.0.bn2.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.0.downsample.1.bias.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.2.conv2.weight.
2022-11-05 15:44:19,256 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:44:19,257 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:44:19,257 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:44:19,258 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:44:19,259 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:44:19,259 INFO: Model [FSLLModel] is created.
2022-11-05 15:44:19,277 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:44:19,293 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:44:19,305 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:44:19,315 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:44:19,326 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:44:19,337 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:44:19,347 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:44:19,364 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases20/FSIL_CFRPModel_res18_small_cifar_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:44:25,251 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1661, Pos_dist: 4.6088, Neg_dist: 7.3325, Acc: 0.4275, PTFixPNLoss: 4.3835, NetFixLoss: 0.0000, ]
2022-11-05 15:44:32,679 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2313, Pos_dist: 4.6397, Neg_dist: 6.8462, Acc: 0.4050, PTFixPNLoss: 4.3874, NetFixLoss: 0.0152, ]
2022-11-05 15:44:39,683 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3528, Pos_dist: 4.6383, Neg_dist: 6.2939, Acc: 0.3900, PTFixPNLoss: 4.3869, NetFixLoss: 0.0349, ]
2022-11-05 15:44:46,577 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2199, Pos_dist: 4.6019, Neg_dist: 6.8762, Acc: 0.4200, PTFixPNLoss: 4.3842, NetFixLoss: 0.0598, ]
2022-11-05 15:44:53,548 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2983, Pos_dist: 4.6148, Neg_dist: 6.4623, Acc: 0.4150, PTFixPNLoss: 4.3874, NetFixLoss: 0.0871, ]
2022-11-05 15:45:00,042 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3475, Pos_dist: 4.5971, Neg_dist: 6.1707, Acc: 0.4075, PTFixPNLoss: 4.3874, NetFixLoss: 0.1163, ]
2022-11-05 15:45:06,684 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3295, Pos_dist: 4.6312, Neg_dist: 6.4386, Acc: 0.4150, PTFixPNLoss: 4.3859, NetFixLoss: 0.1480, ]
2022-11-05 15:45:13,631 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2462, Pos_dist: 4.6124, Neg_dist: 6.5778, Acc: 0.4125, PTFixPNLoss: 4.3882, NetFixLoss: 0.1819, ]
2022-11-05 15:45:20,267 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2203, Pos_dist: 4.5690, Neg_dist: 6.8353, Acc: 0.4400, PTFixPNLoss: 4.3870, NetFixLoss: 0.2173, ]
2022-11-05 15:45:27,078 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3454, Pos_dist: 4.6614, Neg_dist: 6.3534, Acc: 0.3950, PTFixPNLoss: 4.3860, NetFixLoss: 0.2536, ]
2022-11-05 15:45:34,723 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4177, Pos_dist: 4.6061, Neg_dist: 6.0270, Acc: 0.3875, PTFixPNLoss: 4.3836, NetFixLoss: 0.2919, ]
2022-11-05 15:45:41,919 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1904, Pos_dist: 4.5802, Neg_dist: 7.7476, Acc: 0.4325, PTFixPNLoss: 4.3827, NetFixLoss: 0.3308, ]
2022-11-05 15:45:48,561 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2946, Pos_dist: 4.5920, Neg_dist: 6.7382, Acc: 0.4100, PTFixPNLoss: 4.3837, NetFixLoss: 0.3693, ]
2022-11-05 15:45:55,304 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2262, Pos_dist: 4.6148, Neg_dist: 6.7355, Acc: 0.4300, PTFixPNLoss: 4.3806, NetFixLoss: 0.4083, ]
2022-11-05 15:46:02,667 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1083, Pos_dist: 4.5952, Neg_dist: 8.5558, Acc: 0.4150, PTFixPNLoss: 4.3838, NetFixLoss: 0.4469, ]
2022-11-05 15:46:02,778 INFO: fine-tune procedure is finished!
2022-11-05 15:47:15,637 INFO: [Test_acc of task 8 on test 4: 0.20070][acc of former classes: 0.74800][acc of former samples in all classes: 0.49450]
[acc of novel samples in all classes: 0.12725]
2022-11-05 15:47:15,654 INFO: --------------------------Final Avg Acc-------------------------
2022-11-05 15:47:15,654 INFO: Session 1: 75.00+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7500]
2022-11-05 15:47:15,655 INFO: Session 2: 52.76+-0.34[acc of former classes: 0.7341][acc of former samples in all classes: 0.6760]
[acc of novel samples in all classes: 0.2308]
2022-11-05 15:47:15,655 INFO: Session 3: 39.87+-0.62[acc of former classes: 0.7260][acc of former samples in all classes: 0.5984]
[acc of novel samples in all classes: 0.1990]
2022-11-05 15:47:15,655 INFO: Session 4: 33.29+-0.86[acc of former classes: 0.7318][acc of former samples in all classes: 0.5666]
[acc of novel samples in all classes: 0.1771]
2022-11-05 15:47:15,655 INFO: Session 5: 29.74+-0.62[acc of former classes: 0.7460][acc of former samples in all classes: 0.5505]
[acc of novel samples in all classes: 0.1709]
2022-11-05 15:47:15,655 INFO: Session 6: 26.73+-0.55[acc of former classes: 0.7466][acc of former samples in all classes: 0.5250]
[acc of novel samples in all classes: 0.1642]
2022-11-05 15:47:15,655 INFO: Session 7: 24.12+-0.50[acc of former classes: 0.7517][acc of former samples in all classes: 0.5189]
[acc of novel samples in all classes: 0.1486]
2022-11-05 15:47:15,655 INFO: Session 8: 22.22+-0.45[acc of former classes: 0.7517][acc of former samples in all classes: 0.4954]
[acc of novel samples in all classes: 0.1441]
2022-11-05 15:47:15,655 INFO: Session 9: 20.28+-0.35[acc of former classes: 0.7496][acc of former samples in all classes: 0.4760]
[acc of novel samples in all classes: 0.1345]
2022-11-05 15:47:15,656 INFO: random seed: 1997
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases20/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_20base/models/test4_session_8.pth
finish!!
