Path already exists. Rename it to /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug_archived_20221105_143518
/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-05 14:35:18,939 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-05 14:35:18,939 INFO: 
  name: FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug
  model_type: FSLLModel
  gpu: 1
  manual_seed: 1997
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  datasets:[
    train:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: 25
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    val:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    test:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: True
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
  ]
  network_g:[
    type: Resnet20_cifar_small
    num_classes: 60
    adopt_classifier: False
    flatten: True
  ]
  path:[
    pretrain_model_g: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
    base_model: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug
    training_states: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/training_states
    log: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug
    models: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.001
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [160]
      gamma: 0.1
    ]
    fine_tune: True
    fine_tune_epoch: 15
    threshold: 0.4
    warmup_iter: -1
    bases: 60
    tasks: 9
    shots: 5
    novel_exemplars: 5
    num_test: 5
    metric_opt:[
      type: TripletLossNoHardMining
      margin: 0.0
      num_instances: 5
    ]
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
    regularization:[
      type: IncrementalNetworkFixLoss
      w: 5.0
    ]
  ]
  val:[
    val_freq: 1000
    test_type: NCM
    p_norm: None
  ]
  logger:[
    print_freq: 2
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-05 14:35:18,939 INFO: Random seed: 1997
2022-11-05 14:35:22,185 INFO: Network: Resnet20_cifar_small, with parameters: 271,824
2022-11-05 14:35:22,185 INFO: Resnet20_cifar_small(
  (func): ResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (avg_pool): AdaptiveAvgPool2d(output_size=(1, 1))
  )
)
2022-11-05 14:35:22,185 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:35:22,228 WARNING: Current net - loaded net:
2022-11-05 14:35:22,228 WARNING: Loaded net - current net:
2022-11-05 14:35:22,228 WARNING:   func.fc.bias
2022-11-05 14:35:22,228 WARNING:   func.fc.weight
2022-11-05 14:35:22,255 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:35:22,262 WARNING: Current net - loaded net:
2022-11-05 14:35:22,262 WARNING: Loaded net - current net:
2022-11-05 14:35:22,262 WARNING:   func.fc.bias
2022-11-05 14:35:22,262 WARNING:   func.fc.weight
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:35:22,286 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:35:22,287 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:35:22,287 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:35:22,287 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:35:22,287 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:35:22,288 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:35:22,289 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:35:22,290 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:35:22,291 INFO: Model [FSLLModel] is created.
2022-11-05 14:36:12,944 INFO: [Test_acc of task 0 on test 0: 0.72517][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.72517]
2022-11-05 14:36:12,990 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:36:12,999 WARNING: Current net - loaded net:
2022-11-05 14:36:12,999 WARNING: Loaded net - current net:
2022-11-05 14:36:12,999 WARNING:   func.fc.bias
2022-11-05 14:36:12,999 WARNING:   func.fc.weight
2022-11-05 14:36:13,019 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-11-05 14:36:13,056 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:36:13,085 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:36:13,085 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:36:13,085 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:36:13,085 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:36:13,085 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:36:13,085 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:36:13,086 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:36:13,087 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:36:13,088 INFO: Model [FSLLModel] is created.
2022-11-05 14:36:13,094 INFO: Dataset NormalDataset - cifar-100 is created.
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
/workspace/FLOWER/f2m/methods/losses/losses.py:736: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1005.)
  dist.addmm_(1, -2, inputs, inputs.t())
2022-11-05 14:36:15,787 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0764, Pos_dist: 6.5639, Neg_dist: 10.8682, Acc: 0.7600, PTFixPNLoss: 3.9019, NetFixLoss: 0.0000, ]
2022-11-05 14:36:17,501 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1163, Pos_dist: 6.8084, Neg_dist: 11.4994, Acc: 0.6400, PTFixPNLoss: 3.9004, NetFixLoss: 0.0116, ]
2022-11-05 14:36:18,673 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1085, Pos_dist: 6.6992, Neg_dist: 10.4707, Acc: 0.7600, PTFixPNLoss: 3.9013, NetFixLoss: 0.0309, ]
2022-11-05 14:36:19,801 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3055, Pos_dist: 6.5634, Neg_dist: 9.3785, Acc: 0.6800, PTFixPNLoss: 3.9039, NetFixLoss: 0.0580, ]
2022-11-05 14:36:20,989 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1458, Pos_dist: 6.5800, Neg_dist: 10.5880, Acc: 0.8000, PTFixPNLoss: 3.9001, NetFixLoss: 0.0972, ]
2022-11-05 14:36:22,205 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.0725, Pos_dist: 6.5268, Neg_dist: 10.8195, Acc: 0.6800, PTFixPNLoss: 3.9022, NetFixLoss: 0.1447, ]
2022-11-05 14:36:23,261 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0745, Pos_dist: 6.5555, Neg_dist: 11.2618, Acc: 0.7200, PTFixPNLoss: 3.9034, NetFixLoss: 0.1980, ]
2022-11-05 14:36:24,557 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0872, Pos_dist: 6.6233, Neg_dist: 9.8852, Acc: 0.6800, PTFixPNLoss: 3.9051, NetFixLoss: 0.2525, ]
2022-11-05 14:36:25,437 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1144, Pos_dist: 6.5758, Neg_dist: 10.3089, Acc: 0.8000, PTFixPNLoss: 3.9030, NetFixLoss: 0.3113, ]
2022-11-05 14:36:26,606 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0315, Pos_dist: 6.4901, Neg_dist: 10.4184, Acc: 0.7600, PTFixPNLoss: 3.8992, NetFixLoss: 0.3743, ]
2022-11-05 14:36:27,848 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2313, Pos_dist: 6.5630, Neg_dist: 9.7003, Acc: 0.6800, PTFixPNLoss: 3.9019, NetFixLoss: 0.4368, ]
2022-11-05 14:36:29,000 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0676, Pos_dist: 6.5126, Neg_dist: 10.8796, Acc: 0.8000, PTFixPNLoss: 3.8985, NetFixLoss: 0.5078, ]
2022-11-05 14:36:30,151 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0949, Pos_dist: 6.5425, Neg_dist: 10.3754, Acc: 0.7200, PTFixPNLoss: 3.8982, NetFixLoss: 0.5817, ]
2022-11-05 14:36:31,281 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1235, Pos_dist: 6.4154, Neg_dist: 10.0282, Acc: 0.6400, PTFixPNLoss: 3.8975, NetFixLoss: 0.6595, ]
2022-11-05 14:36:32,504 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0522, Pos_dist: 6.5475, Neg_dist: 9.7658, Acc: 0.7200, PTFixPNLoss: 3.8999, NetFixLoss: 0.7420, ]
2022-11-05 14:36:32,672 INFO: fine-tune procedure is finished!
2022-11-05 14:37:34,910 INFO: [Test_acc of task 1 on test 0: 0.63323][acc of former classes: 0.68017][acc of former samples in all classes: 0.66883]
[acc of novel samples in all classes: 0.20600]
2022-11-05 14:37:34,950 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:37:34,959 WARNING: Current net - loaded net:
2022-11-05 14:37:34,959 WARNING: Loaded net - current net:
2022-11-05 14:37:34,959 WARNING:   func.fc.bias
2022-11-05 14:37:34,959 WARNING:   func.fc.weight
2022-11-05 14:37:34,988 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_1.pth.
2022-11-05 14:37:35,023 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:37:35,084 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:37:35,084 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:37:35,084 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:37:35,084 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:37:35,084 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:37:35,084 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:37:35,085 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:37:35,085 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:37:35,085 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:37:35,085 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:37:35,085 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:37:35,085 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:37:35,085 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:37:35,085 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:37:35,085 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:37:35,085 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:37:35,085 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:37:35,085 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:37:35,086 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:37:35,087 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:37:35,088 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:37:35,089 INFO: Model [FSLLModel] is created.
2022-11-05 14:37:35,099 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:37:35,108 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:37:36,266 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2113, Pos_dist: 6.3656, Neg_dist: 9.1698, Acc: 0.7800, PTFixPNLoss: 3.9829, NetFixLoss: 0.0000, ]
2022-11-05 14:37:37,640 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3212, Pos_dist: 6.4429, Neg_dist: 8.8618, Acc: 0.6800, PTFixPNLoss: 3.9849, NetFixLoss: 0.0226, ]
2022-11-05 14:37:39,097 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2915, Pos_dist: 6.2285, Neg_dist: 8.6654, Acc: 0.7400, PTFixPNLoss: 3.9779, NetFixLoss: 0.0539, ]
2022-11-05 14:37:40,725 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0570, Pos_dist: 6.5309, Neg_dist: 11.0102, Acc: 0.7200, PTFixPNLoss: 3.9809, NetFixLoss: 0.0951, ]
2022-11-05 14:37:42,136 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3157, Pos_dist: 6.5061, Neg_dist: 9.0378, Acc: 0.7000, PTFixPNLoss: 3.9823, NetFixLoss: 0.1382, ]
2022-11-05 14:37:43,559 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2110, Pos_dist: 6.3143, Neg_dist: 9.2994, Acc: 0.7800, PTFixPNLoss: 3.9811, NetFixLoss: 0.1842, ]
2022-11-05 14:37:45,187 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3455, Pos_dist: 6.4450, Neg_dist: 8.7653, Acc: 0.7600, PTFixPNLoss: 3.9839, NetFixLoss: 0.2334, ]
2022-11-05 14:37:46,415 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0200, Pos_dist: 6.2882, Neg_dist: 10.7523, Acc: 0.7600, PTFixPNLoss: 3.9810, NetFixLoss: 0.2932, ]
2022-11-05 14:37:47,843 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1048, Pos_dist: 6.4907, Neg_dist: 11.4596, Acc: 0.7600, PTFixPNLoss: 3.9809, NetFixLoss: 0.3508, ]
2022-11-05 14:37:48,986 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1562, Pos_dist: 6.3824, Neg_dist: 9.7921, Acc: 0.7400, PTFixPNLoss: 3.9805, NetFixLoss: 0.4075, ]
2022-11-05 14:37:50,151 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0914, Pos_dist: 6.4739, Neg_dist: 10.2741, Acc: 0.7800, PTFixPNLoss: 3.9794, NetFixLoss: 0.4643, ]
2022-11-05 14:37:51,727 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1900, Pos_dist: 6.4462, Neg_dist: 9.5036, Acc: 0.7600, PTFixPNLoss: 3.9814, NetFixLoss: 0.5207, ]
2022-11-05 14:37:52,963 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0614, Pos_dist: 6.4789, Neg_dist: 12.2238, Acc: 0.7800, PTFixPNLoss: 3.9819, NetFixLoss: 0.5790, ]
2022-11-05 14:37:54,637 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2490, Pos_dist: 6.3512, Neg_dist: 9.0410, Acc: 0.7400, PTFixPNLoss: 3.9763, NetFixLoss: 0.6361, ]
2022-11-05 14:37:55,875 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2809, Pos_dist: 6.4884, Neg_dist: 8.9989, Acc: 0.7600, PTFixPNLoss: 3.9828, NetFixLoss: 0.6975, ]
2022-11-05 14:37:56,143 INFO: fine-tune procedure is finished!
2022-11-05 14:38:59,597 INFO: [Test_acc of task 2 on test 0: 0.59900][acc of former classes: 0.68050][acc of former samples in all classes: 0.66117]
[acc of novel samples in all classes: 0.22600]
2022-11-05 14:38:59,641 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:38:59,647 WARNING: Current net - loaded net:
2022-11-05 14:38:59,647 WARNING: Loaded net - current net:
2022-11-05 14:38:59,647 WARNING:   func.fc.bias
2022-11-05 14:38:59,647 WARNING:   func.fc.weight
2022-11-05 14:38:59,678 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_2.pth.
2022-11-05 14:38:59,715 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:38:59,742 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:38:59,742 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:38:59,742 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:38:59,742 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:38:59,742 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:38:59,742 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:38:59,743 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:38:59,744 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:38:59,745 INFO: Model [FSLLModel] is created.
2022-11-05 14:38:59,751 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:38:59,756 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:38:59,761 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:39:01,437 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1507, Pos_dist: 6.3222, Neg_dist: 9.8120, Acc: 0.7333, PTFixPNLoss: 4.0433, NetFixLoss: 0.0000, ]
2022-11-05 14:39:03,217 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1494, Pos_dist: 6.3304, Neg_dist: 9.4592, Acc: 0.6800, PTFixPNLoss: 4.0453, NetFixLoss: 0.0143, ]
2022-11-05 14:39:05,134 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0897, Pos_dist: 6.2915, Neg_dist: 9.7815, Acc: 0.7067, PTFixPNLoss: 4.0463, NetFixLoss: 0.0352, ]
2022-11-05 14:39:06,833 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0116, Pos_dist: 6.3680, Neg_dist: 12.3389, Acc: 0.7333, PTFixPNLoss: 4.0445, NetFixLoss: 0.0613, ]
2022-11-05 14:39:08,825 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1674, Pos_dist: 6.3506, Neg_dist: 10.3645, Acc: 0.7200, PTFixPNLoss: 4.0442, NetFixLoss: 0.0879, ]
2022-11-05 14:39:10,422 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3122, Pos_dist: 6.3633, Neg_dist: 8.8593, Acc: 0.7067, PTFixPNLoss: 4.0420, NetFixLoss: 0.1167, ]
2022-11-05 14:39:11,860 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0283, Pos_dist: 6.1842, Neg_dist: 11.6012, Acc: 0.7067, PTFixPNLoss: 4.0406, NetFixLoss: 0.1525, ]
2022-11-05 14:39:13,446 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2421, Pos_dist: 6.3588, Neg_dist: 9.3714, Acc: 0.7200, PTFixPNLoss: 4.0442, NetFixLoss: 0.1881, ]
2022-11-05 14:39:15,234 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1445, Pos_dist: 6.2621, Neg_dist: 9.3400, Acc: 0.7467, PTFixPNLoss: 4.0462, NetFixLoss: 0.2294, ]
2022-11-05 14:39:16,951 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2863, Pos_dist: 6.2866, Neg_dist: 9.2232, Acc: 0.6800, PTFixPNLoss: 4.0456, NetFixLoss: 0.2734, ]
2022-11-05 14:39:19,348 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1761, Pos_dist: 6.4148, Neg_dist: 10.4177, Acc: 0.7200, PTFixPNLoss: 4.0424, NetFixLoss: 0.3227, ]
2022-11-05 14:39:20,931 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1800, Pos_dist: 6.3188, Neg_dist: 9.4175, Acc: 0.7067, PTFixPNLoss: 4.0434, NetFixLoss: 0.3755, ]
2022-11-05 14:39:22,508 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1789, Pos_dist: 6.4146, Neg_dist: 9.6490, Acc: 0.7467, PTFixPNLoss: 4.0468, NetFixLoss: 0.4292, ]
2022-11-05 14:39:24,049 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1206, Pos_dist: 6.3449, Neg_dist: 9.9610, Acc: 0.7600, PTFixPNLoss: 4.0433, NetFixLoss: 0.4864, ]
2022-11-05 14:39:26,101 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2040, Pos_dist: 6.3150, Neg_dist: 9.1172, Acc: 0.7467, PTFixPNLoss: 4.0434, NetFixLoss: 0.5456, ]
2022-11-05 14:39:26,416 INFO: fine-tune procedure is finished!
2022-11-05 14:40:34,986 INFO: [Test_acc of task 3 on test 0: 0.56027][acc of former classes: 0.67383][acc of former samples in all classes: 0.64283]
[acc of novel samples in all classes: 0.23000]
2022-11-05 14:40:35,033 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:40:35,147 WARNING: Current net - loaded net:
2022-11-05 14:40:35,147 WARNING: Loaded net - current net:
2022-11-05 14:40:35,147 WARNING:   func.fc.bias
2022-11-05 14:40:35,147 WARNING:   func.fc.weight
2022-11-05 14:40:35,181 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_3.pth.
2022-11-05 14:40:35,223 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:40:35,249 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:40:35,249 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:40:35,249 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:40:35,250 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:40:35,250 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:40:35,250 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:40:35,250 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:40:35,250 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:40:35,250 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:40:35,251 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:40:35,252 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:40:35,253 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:40:35,254 INFO: Model [FSLLModel] is created.
2022-11-05 14:40:35,263 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:40:35,272 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:40:35,280 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:40:35,289 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:40:37,076 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1874, Pos_dist: 6.4313, Neg_dist: 9.6038, Acc: 0.7300, PTFixPNLoss: 4.1173, NetFixLoss: 0.0000, ]
2022-11-05 14:40:38,809 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2122, Pos_dist: 6.2971, Neg_dist: 9.1994, Acc: 0.7600, PTFixPNLoss: 4.1173, NetFixLoss: 0.0200, ]
2022-11-05 14:40:40,927 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1624, Pos_dist: 6.4557, Neg_dist: 9.5370, Acc: 0.6400, PTFixPNLoss: 4.1202, NetFixLoss: 0.0467, ]
2022-11-05 14:40:42,475 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2688, Pos_dist: 6.4062, Neg_dist: 8.9427, Acc: 0.6500, PTFixPNLoss: 4.1185, NetFixLoss: 0.0777, ]
2022-11-05 14:40:44,443 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1203, Pos_dist: 6.3536, Neg_dist: 9.9704, Acc: 0.6900, PTFixPNLoss: 4.1165, NetFixLoss: 0.1142, ]
2022-11-05 14:40:46,155 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.0214, Pos_dist: 6.3173, Neg_dist: 10.8837, Acc: 0.7000, PTFixPNLoss: 4.1171, NetFixLoss: 0.1563, ]
2022-11-05 14:40:48,282 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1781, Pos_dist: 6.3535, Neg_dist: 9.6244, Acc: 0.7500, PTFixPNLoss: 4.1156, NetFixLoss: 0.1978, ]
2022-11-05 14:40:50,254 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0854, Pos_dist: 6.3783, Neg_dist: 9.7846, Acc: 0.6700, PTFixPNLoss: 4.1145, NetFixLoss: 0.2402, ]
2022-11-05 14:40:52,641 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0767, Pos_dist: 6.3410, Neg_dist: 10.3360, Acc: 0.6900, PTFixPNLoss: 4.1170, NetFixLoss: 0.2846, ]
2022-11-05 14:40:54,583 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0635, Pos_dist: 6.5192, Neg_dist: 11.1051, Acc: 0.6500, PTFixPNLoss: 4.1196, NetFixLoss: 0.3304, ]
2022-11-05 14:40:56,486 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3198, Pos_dist: 6.4339, Neg_dist: 9.3492, Acc: 0.7100, PTFixPNLoss: 4.1155, NetFixLoss: 0.3753, ]
2022-11-05 14:40:58,632 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0817, Pos_dist: 6.3594, Neg_dist: 10.8293, Acc: 0.7500, PTFixPNLoss: 4.1167, NetFixLoss: 0.4232, ]
2022-11-05 14:41:00,226 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0088, Pos_dist: 6.3470, Neg_dist: 12.1025, Acc: 0.6900, PTFixPNLoss: 4.1163, NetFixLoss: 0.4710, ]
2022-11-05 14:41:02,466 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0567, Pos_dist: 6.4591, Neg_dist: 11.3408, Acc: 0.6700, PTFixPNLoss: 4.1144, NetFixLoss: 0.5165, ]
2022-11-05 14:41:04,728 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1993, Pos_dist: 6.3917, Neg_dist: 9.6626, Acc: 0.7400, PTFixPNLoss: 4.1155, NetFixLoss: 0.5616, ]
2022-11-05 14:41:04,870 INFO: fine-tune procedure is finished!
2022-11-05 14:42:17,924 INFO: [Test_acc of task 4 on test 0: 0.53438][acc of former classes: 0.67717][acc of former samples in all classes: 0.64150]
[acc of novel samples in all classes: 0.21300]
2022-11-05 14:42:17,978 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:42:18,024 WARNING: Current net - loaded net:
2022-11-05 14:42:18,024 WARNING: Loaded net - current net:
2022-11-05 14:42:18,024 WARNING:   func.fc.bias
2022-11-05 14:42:18,024 WARNING:   func.fc.weight
2022-11-05 14:42:18,059 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_4.pth.
2022-11-05 14:42:18,075 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:42:18,092 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:42:18,093 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:42:18,093 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:42:18,094 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:42:18,095 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:42:18,096 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:42:18,096 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:42:18,096 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:42:18,096 INFO: Model [FSLLModel] is created.
2022-11-05 14:42:18,106 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:18,115 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:18,124 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:18,134 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:18,143 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:42:20,379 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1112, Pos_dist: 6.4119, Neg_dist: 10.4902, Acc: 0.6800, PTFixPNLoss: 4.1753, NetFixLoss: 0.0000, ]
2022-11-05 14:42:22,918 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2670, Pos_dist: 6.3289, Neg_dist: 9.1108, Acc: 0.7120, PTFixPNLoss: 4.1745, NetFixLoss: 0.0139, ]
2022-11-05 14:42:24,787 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1186, Pos_dist: 6.3447, Neg_dist: 9.9481, Acc: 0.6800, PTFixPNLoss: 4.1697, NetFixLoss: 0.0371, ]
2022-11-05 14:42:26,818 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2206, Pos_dist: 6.3600, Neg_dist: 9.5374, Acc: 0.6880, PTFixPNLoss: 4.1741, NetFixLoss: 0.0654, ]
2022-11-05 14:42:29,183 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1015, Pos_dist: 6.3333, Neg_dist: 9.6488, Acc: 0.7200, PTFixPNLoss: 4.1753, NetFixLoss: 0.0965, ]
2022-11-05 14:42:31,277 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1730, Pos_dist: 6.4574, Neg_dist: 10.2937, Acc: 0.6160, PTFixPNLoss: 4.1787, NetFixLoss: 0.1296, ]
2022-11-05 14:42:33,559 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2124, Pos_dist: 6.3475, Neg_dist: 9.1722, Acc: 0.6640, PTFixPNLoss: 4.1735, NetFixLoss: 0.1649, ]
2022-11-05 14:42:35,491 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0661, Pos_dist: 6.3815, Neg_dist: 10.6769, Acc: 0.7360, PTFixPNLoss: 4.1727, NetFixLoss: 0.2033, ]
2022-11-05 14:42:38,018 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0385, Pos_dist: 6.4105, Neg_dist: 10.7578, Acc: 0.6400, PTFixPNLoss: 4.1784, NetFixLoss: 0.2424, ]
2022-11-05 14:42:40,019 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0801, Pos_dist: 6.3598, Neg_dist: 10.4748, Acc: 0.7040, PTFixPNLoss: 4.1753, NetFixLoss: 0.2804, ]
2022-11-05 14:42:42,251 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2398, Pos_dist: 6.3680, Neg_dist: 9.4788, Acc: 0.6640, PTFixPNLoss: 4.1726, NetFixLoss: 0.3198, ]
2022-11-05 14:42:44,521 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1842, Pos_dist: 6.3610, Neg_dist: 10.1485, Acc: 0.6960, PTFixPNLoss: 4.1730, NetFixLoss: 0.3599, ]
2022-11-05 14:42:46,861 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1888, Pos_dist: 6.3236, Neg_dist: 9.8760, Acc: 0.6800, PTFixPNLoss: 4.1746, NetFixLoss: 0.4006, ]
2022-11-05 14:42:49,032 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3427, Pos_dist: 6.4226, Neg_dist: 8.9121, Acc: 0.6560, PTFixPNLoss: 4.1756, NetFixLoss: 0.4415, ]
2022-11-05 14:42:51,356 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1629, Pos_dist: 6.3722, Neg_dist: 9.6928, Acc: 0.7280, PTFixPNLoss: 4.1750, NetFixLoss: 0.4844, ]
2022-11-05 14:42:51,494 INFO: fine-tune procedure is finished!
2022-11-05 14:44:08,318 INFO: [Test_acc of task 5 on test 0: 0.51541][acc of former classes: 0.69000][acc of former samples in all classes: 0.64533]
[acc of novel samples in all classes: 0.20360]
2022-11-05 14:44:08,365 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:44:08,374 WARNING: Current net - loaded net:
2022-11-05 14:44:08,374 WARNING: Loaded net - current net:
2022-11-05 14:44:08,374 WARNING:   func.fc.bias
2022-11-05 14:44:08,374 WARNING:   func.fc.weight
2022-11-05 14:44:08,428 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_5.pth.
2022-11-05 14:44:08,481 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:44:08,528 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:44:08,528 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:44:08,529 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:44:08,530 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:44:08,531 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:44:08,532 INFO: Model [FSLLModel] is created.
2022-11-05 14:44:08,540 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:08,577 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:08,586 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:08,593 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:08,600 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:08,607 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:44:10,857 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1407, Pos_dist: 6.3349, Neg_dist: 10.0079, Acc: 0.7000, PTFixPNLoss: 4.2270, NetFixLoss: 0.0000, ]
2022-11-05 14:44:13,493 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2178, Pos_dist: 6.3446, Neg_dist: 9.3249, Acc: 0.7067, PTFixPNLoss: 4.2256, NetFixLoss: 0.0170, ]
2022-11-05 14:44:15,812 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1653, Pos_dist: 6.2697, Neg_dist: 9.7011, Acc: 0.7133, PTFixPNLoss: 4.2271, NetFixLoss: 0.0396, ]
2022-11-05 14:44:17,615 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1230, Pos_dist: 6.3211, Neg_dist: 10.0331, Acc: 0.7133, PTFixPNLoss: 4.2240, NetFixLoss: 0.0662, ]
2022-11-05 14:44:21,472 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2634, Pos_dist: 6.2634, Neg_dist: 8.9527, Acc: 0.7067, PTFixPNLoss: 4.2237, NetFixLoss: 0.0949, ]
2022-11-05 14:44:24,164 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.0561, Pos_dist: 6.3066, Neg_dist: 10.4402, Acc: 0.7200, PTFixPNLoss: 4.2239, NetFixLoss: 0.1275, ]
2022-11-05 14:44:25,832 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0451, Pos_dist: 6.3133, Neg_dist: 10.5393, Acc: 0.6533, PTFixPNLoss: 4.2232, NetFixLoss: 0.1620, ]
2022-11-05 14:44:27,362 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2356, Pos_dist: 6.3112, Neg_dist: 9.1897, Acc: 0.7000, PTFixPNLoss: 4.2255, NetFixLoss: 0.1969, ]
2022-11-05 14:44:28,621 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1201, Pos_dist: 6.2639, Neg_dist: 10.0002, Acc: 0.7067, PTFixPNLoss: 4.2226, NetFixLoss: 0.2337, ]
2022-11-05 14:44:31,359 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0972, Pos_dist: 6.2575, Neg_dist: 10.2193, Acc: 0.7133, PTFixPNLoss: 4.2229, NetFixLoss: 0.2718, ]
2022-11-05 14:44:33,651 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1603, Pos_dist: 6.3512, Neg_dist: 9.8692, Acc: 0.6933, PTFixPNLoss: 4.2273, NetFixLoss: 0.3090, ]
2022-11-05 14:44:35,886 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1207, Pos_dist: 6.2639, Neg_dist: 9.6999, Acc: 0.6933, PTFixPNLoss: 4.2249, NetFixLoss: 0.3481, ]
2022-11-05 14:44:38,175 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1455, Pos_dist: 6.2907, Neg_dist: 9.8222, Acc: 0.6533, PTFixPNLoss: 4.2260, NetFixLoss: 0.3870, ]
2022-11-05 14:44:40,284 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0363, Pos_dist: 6.2993, Neg_dist: 11.5402, Acc: 0.7133, PTFixPNLoss: 4.2227, NetFixLoss: 0.4262, ]
2022-11-05 14:44:42,436 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1495, Pos_dist: 6.2915, Neg_dist: 9.8142, Acc: 0.6600, PTFixPNLoss: 4.2239, NetFixLoss: 0.4643, ]
2022-11-05 14:44:42,540 INFO: fine-tune procedure is finished!
2022-11-05 14:46:06,452 INFO: [Test_acc of task 6 on test 0: 0.51322][acc of former classes: 0.70067][acc of former samples in all classes: 0.65733]
[acc of novel samples in all classes: 0.22500]
2022-11-05 14:46:06,534 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:46:06,544 WARNING: Current net - loaded net:
2022-11-05 14:46:06,544 WARNING: Loaded net - current net:
2022-11-05 14:46:06,544 WARNING:   func.fc.bias
2022-11-05 14:46:06,544 WARNING:   func.fc.weight
2022-11-05 14:46:06,572 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_6.pth.
2022-11-05 14:46:06,606 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:46:06,636 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:46:06,637 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:46:06,637 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:46:06,638 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:46:06,639 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:46:06,640 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:46:06,640 INFO: Model [FSLLModel] is created.
2022-11-05 14:46:06,651 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:06,661 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:06,734 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:06,744 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:06,760 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:06,771 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:06,782 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 14:46:09,393 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1569, Pos_dist: 6.2853, Neg_dist: 9.6766, Acc: 0.7314, PTFixPNLoss: 4.2821, NetFixLoss: 0.0000, ]
2022-11-05 14:46:12,310 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1469, Pos_dist: 6.2294, Neg_dist: 9.5172, Acc: 0.7314, PTFixPNLoss: 4.2816, NetFixLoss: 0.0159, ]
2022-11-05 14:46:15,462 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0248, Pos_dist: 6.2687, Neg_dist: 11.6853, Acc: 0.6971, PTFixPNLoss: 4.2817, NetFixLoss: 0.0395, ]
2022-11-05 14:46:18,182 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0262, Pos_dist: 6.2578, Neg_dist: 11.9240, Acc: 0.7257, PTFixPNLoss: 4.2812, NetFixLoss: 0.0629, ]
2022-11-05 14:46:20,414 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0820, Pos_dist: 6.3272, Neg_dist: 10.3577, Acc: 0.6857, PTFixPNLoss: 4.2805, NetFixLoss: 0.0857, ]
2022-11-05 14:46:23,620 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1936, Pos_dist: 6.2751, Neg_dist: 9.3384, Acc: 0.6971, PTFixPNLoss: 4.2808, NetFixLoss: 0.1089, ]
2022-11-05 14:46:26,637 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1335, Pos_dist: 6.2834, Neg_dist: 9.7029, Acc: 0.7086, PTFixPNLoss: 4.2818, NetFixLoss: 0.1330, ]
2022-11-05 14:46:30,551 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0462, Pos_dist: 6.3076, Neg_dist: 10.4147, Acc: 0.7143, PTFixPNLoss: 4.2802, NetFixLoss: 0.1593, ]
2022-11-05 14:46:33,633 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0631, Pos_dist: 6.3391, Neg_dist: 11.4869, Acc: 0.6971, PTFixPNLoss: 4.2816, NetFixLoss: 0.1871, ]
2022-11-05 14:46:36,709 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1630, Pos_dist: 6.2871, Neg_dist: 9.6393, Acc: 0.7200, PTFixPNLoss: 4.2800, NetFixLoss: 0.2153, ]
2022-11-05 14:46:39,750 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2762, Pos_dist: 6.3502, Neg_dist: 9.0742, Acc: 0.6971, PTFixPNLoss: 4.2802, NetFixLoss: 0.2457, ]
2022-11-05 14:46:42,532 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1591, Pos_dist: 6.2823, Neg_dist: 9.5880, Acc: 0.6971, PTFixPNLoss: 4.2792, NetFixLoss: 0.2785, ]
2022-11-05 14:46:45,434 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1412, Pos_dist: 6.2950, Neg_dist: 9.9924, Acc: 0.7257, PTFixPNLoss: 4.2793, NetFixLoss: 0.3127, ]
2022-11-05 14:46:47,766 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2104, Pos_dist: 6.3639, Neg_dist: 9.8595, Acc: 0.6629, PTFixPNLoss: 4.2807, NetFixLoss: 0.3490, ]
2022-11-05 14:46:50,201 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1669, Pos_dist: 6.3121, Neg_dist: 9.4029, Acc: 0.7029, PTFixPNLoss: 4.2809, NetFixLoss: 0.3865, ]
2022-11-05 14:46:50,323 INFO: fine-tune procedure is finished!
2022-11-05 14:48:18,644 INFO: [Test_acc of task 7 on test 0: 0.49853][acc of former classes: 0.70567][acc of former samples in all classes: 0.65600]
[acc of novel samples in all classes: 0.22857]
2022-11-05 14:48:18,689 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:48:18,697 WARNING: Current net - loaded net:
2022-11-05 14:48:18,697 WARNING: Loaded net - current net:
2022-11-05 14:48:18,697 WARNING:   func.fc.bias
2022-11-05 14:48:18,697 WARNING:   func.fc.weight
2022-11-05 14:48:18,727 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_7.pth.
2022-11-05 14:48:18,767 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:48:18,794 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:48:18,794 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:48:18,794 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:48:18,794 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:48:18,794 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:48:18,794 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:48:18,795 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:48:18,795 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:48:18,795 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:48:18,795 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:48:18,795 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:48:18,795 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:48:18,795 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:48:18,796 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:48:18,797 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:48:18,797 INFO: Model [FSLLModel] is created.
2022-11-05 14:48:18,805 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:18,811 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:18,817 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:18,974 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:18,983 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:18,990 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:18,996 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:48:19,041 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:48:21,325 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2702, Pos_dist: 6.2428, Neg_dist: 9.1350, Acc: 0.6750, PTFixPNLoss: 4.3259, NetFixLoss: 0.0000, ]
2022-11-05 14:48:25,052 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1390, Pos_dist: 6.2344, Neg_dist: 11.1214, Acc: 0.7150, PTFixPNLoss: 4.3277, NetFixLoss: 0.0194, ]
2022-11-05 14:48:28,815 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0717, Pos_dist: 6.2175, Neg_dist: 11.3549, Acc: 0.6650, PTFixPNLoss: 4.3243, NetFixLoss: 0.0405, ]
2022-11-05 14:48:31,915 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1629, Pos_dist: 6.2518, Neg_dist: 9.6121, Acc: 0.7050, PTFixPNLoss: 4.3263, NetFixLoss: 0.0627, ]
2022-11-05 14:48:34,819 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0482, Pos_dist: 6.2322, Neg_dist: 11.4818, Acc: 0.6900, PTFixPNLoss: 4.3270, NetFixLoss: 0.0864, ]
2022-11-05 14:48:38,472 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1158, Pos_dist: 6.3348, Neg_dist: 10.2503, Acc: 0.6700, PTFixPNLoss: 4.3284, NetFixLoss: 0.1102, ]
2022-11-05 14:48:41,884 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1962, Pos_dist: 6.2510, Neg_dist: 9.4688, Acc: 0.6400, PTFixPNLoss: 4.3280, NetFixLoss: 0.1353, ]
2022-11-05 14:48:45,128 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2111, Pos_dist: 6.2770, Neg_dist: 9.2766, Acc: 0.6700, PTFixPNLoss: 4.3304, NetFixLoss: 0.1635, ]
2022-11-05 14:48:48,444 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1296, Pos_dist: 6.2359, Neg_dist: 9.6127, Acc: 0.7050, PTFixPNLoss: 4.3253, NetFixLoss: 0.1941, ]
2022-11-05 14:48:52,528 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1620, Pos_dist: 6.2519, Neg_dist: 9.7325, Acc: 0.7100, PTFixPNLoss: 4.3243, NetFixLoss: 0.2263, ]
2022-11-05 14:48:55,897 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3417, Pos_dist: 6.2951, Neg_dist: 8.8699, Acc: 0.6500, PTFixPNLoss: 4.3291, NetFixLoss: 0.2595, ]
2022-11-05 14:48:59,313 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0179, Pos_dist: 6.2954, Neg_dist: 11.0786, Acc: 0.6550, PTFixPNLoss: 4.3263, NetFixLoss: 0.2948, ]
2022-11-05 14:49:02,476 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0878, Pos_dist: 6.2895, Neg_dist: 10.4584, Acc: 0.6950, PTFixPNLoss: 4.3264, NetFixLoss: 0.3298, ]
2022-11-05 14:49:05,502 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1892, Pos_dist: 6.2536, Neg_dist: 9.6135, Acc: 0.7200, PTFixPNLoss: 4.3252, NetFixLoss: 0.3638, ]
2022-11-05 14:49:08,557 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1934, Pos_dist: 6.2207, Neg_dist: 9.4274, Acc: 0.7050, PTFixPNLoss: 4.3281, NetFixLoss: 0.3981, ]
2022-11-05 14:49:08,747 INFO: fine-tune procedure is finished!
2022-11-05 14:50:41,442 INFO: [Test_acc of task 8 on test 0: 0.48200][acc of former classes: 0.71150][acc of former samples in all classes: 0.65467]
[acc of novel samples in all classes: 0.22300]
2022-11-05 14:50:41,492 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:50:41,500 WARNING: Current net - loaded net:
2022-11-05 14:50:41,500 WARNING: Loaded net - current net:
2022-11-05 14:50:41,500 WARNING:   func.fc.bias
2022-11-05 14:50:41,500 WARNING:   func.fc.weight
2022-11-05 14:50:41,528 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-11-05 14:50:41,566 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:50:41,593 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:50:41,594 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:50:41,594 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:50:41,595 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:50:41,596 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:50:41,596 INFO: Model [FSLLModel] is created.
2022-11-05 14:50:41,603 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 14:50:42,674 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2070, Pos_dist: 6.4832, Neg_dist: 9.9483, Acc: 0.6000, PTFixPNLoss: 3.9115, NetFixLoss: 0.0000, ]
2022-11-05 14:50:44,183 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4328, Pos_dist: 6.6723, Neg_dist: 9.3376, Acc: 0.8400, PTFixPNLoss: 3.9168, NetFixLoss: 0.0350, ]
2022-11-05 14:50:45,417 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0985, Pos_dist: 6.4617, Neg_dist: 10.1583, Acc: 0.5600, PTFixPNLoss: 3.9070, NetFixLoss: 0.0798, ]
2022-11-05 14:50:46,432 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1600, Pos_dist: 6.5557, Neg_dist: 10.2069, Acc: 0.7600, PTFixPNLoss: 3.9083, NetFixLoss: 0.1363, ]
2022-11-05 14:50:47,858 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0194, Pos_dist: 6.2729, Neg_dist: 10.1512, Acc: 0.8000, PTFixPNLoss: 3.9119, NetFixLoss: 0.1981, ]
2022-11-05 14:50:50,157 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1971, Pos_dist: 6.5778, Neg_dist: 9.8648, Acc: 0.6400, PTFixPNLoss: 3.9111, NetFixLoss: 0.2583, ]
2022-11-05 14:50:51,356 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2534, Pos_dist: 6.6054, Neg_dist: 9.3918, Acc: 0.5600, PTFixPNLoss: 3.9129, NetFixLoss: 0.3247, ]
2022-11-05 14:50:52,596 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1999, Pos_dist: 6.3952, Neg_dist: 9.6873, Acc: 0.6400, PTFixPNLoss: 3.9070, NetFixLoss: 0.3953, ]
2022-11-05 14:50:53,989 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1680, Pos_dist: 6.5220, Neg_dist: 9.9966, Acc: 0.6000, PTFixPNLoss: 3.9117, NetFixLoss: 0.4704, ]
2022-11-05 14:50:55,004 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2580, Pos_dist: 6.4424, Neg_dist: 9.5700, Acc: 0.5600, PTFixPNLoss: 3.9076, NetFixLoss: 0.5544, ]
2022-11-05 14:50:56,295 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1669, Pos_dist: 6.5922, Neg_dist: 10.0494, Acc: 0.6800, PTFixPNLoss: 3.9087, NetFixLoss: 0.6428, ]
2022-11-05 14:50:57,626 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1857, Pos_dist: 6.5979, Neg_dist: 9.7708, Acc: 0.5600, PTFixPNLoss: 3.9123, NetFixLoss: 0.7325, ]
2022-11-05 14:50:58,784 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0722, Pos_dist: 6.6401, Neg_dist: 9.8926, Acc: 0.5600, PTFixPNLoss: 3.9079, NetFixLoss: 0.8287, ]
2022-11-05 14:51:00,786 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1703, Pos_dist: 6.5105, Neg_dist: 9.5675, Acc: 0.6400, PTFixPNLoss: 3.9119, NetFixLoss: 0.9231, ]
2022-11-05 14:51:02,124 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1574, Pos_dist: 6.4587, Neg_dist: 9.4071, Acc: 0.7200, PTFixPNLoss: 3.9071, NetFixLoss: 1.0213, ]
2022-11-05 14:51:02,345 INFO: fine-tune procedure is finished!
2022-11-05 14:52:12,033 INFO: [Test_acc of task 1 on test 1: 0.64169][acc of former classes: 0.68483][acc of former samples in all classes: 0.67567]
[acc of novel samples in all classes: 0.23400]
2022-11-05 14:52:12,075 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:52:12,084 WARNING: Current net - loaded net:
2022-11-05 14:52:12,084 WARNING: Loaded net - current net:
2022-11-05 14:52:12,084 WARNING:   func.fc.bias
2022-11-05 14:52:12,084 WARNING:   func.fc.weight
2022-11-05 14:52:12,117 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_1.pth.
2022-11-05 14:52:12,155 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:52:12,185 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:52:12,185 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:52:12,185 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:52:12,185 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:52:12,186 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:52:12,186 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:52:12,186 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:52:12,186 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:52:12,186 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:52:12,186 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:52:12,186 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:52:12,186 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:52:12,186 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:52:12,186 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:52:12,186 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:52:12,186 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:52:12,186 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:52:12,186 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:52:12,187 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:52:12,188 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:52:12,189 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:52:12,189 INFO: Model [FSLLModel] is created.
2022-11-05 14:52:12,200 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:12,209 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:52:13,463 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3016, Pos_dist: 6.5374, Neg_dist: 9.0837, Acc: 0.6200, PTFixPNLoss: 3.9893, NetFixLoss: 0.0000, ]
2022-11-05 14:52:15,129 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2135, Pos_dist: 6.6334, Neg_dist: 9.7484, Acc: 0.6200, PTFixPNLoss: 3.9910, NetFixLoss: 0.0238, ]
2022-11-05 14:52:16,592 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1877, Pos_dist: 6.6077, Neg_dist: 10.1861, Acc: 0.6200, PTFixPNLoss: 3.9911, NetFixLoss: 0.0558, ]
2022-11-05 14:52:18,236 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1693, Pos_dist: 6.6433, Neg_dist: 10.2945, Acc: 0.6000, PTFixPNLoss: 3.9933, NetFixLoss: 0.0944, ]
2022-11-05 14:52:20,236 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2580, Pos_dist: 6.5550, Neg_dist: 9.2982, Acc: 0.6000, PTFixPNLoss: 3.9907, NetFixLoss: 0.1389, ]
2022-11-05 14:52:21,755 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1569, Pos_dist: 6.7409, Neg_dist: 10.0533, Acc: 0.5400, PTFixPNLoss: 3.9974, NetFixLoss: 0.1899, ]
2022-11-05 14:52:23,422 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0920, Pos_dist: 6.4497, Neg_dist: 9.8180, Acc: 0.6000, PTFixPNLoss: 3.9904, NetFixLoss: 0.2419, ]
2022-11-05 14:52:24,904 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1556, Pos_dist: 6.6407, Neg_dist: 9.8730, Acc: 0.5800, PTFixPNLoss: 3.9872, NetFixLoss: 0.2964, ]
2022-11-05 14:52:26,372 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3587, Pos_dist: 6.5131, Neg_dist: 9.0752, Acc: 0.6600, PTFixPNLoss: 3.9939, NetFixLoss: 0.3550, ]
2022-11-05 14:52:27,794 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2332, Pos_dist: 6.6094, Neg_dist: 9.5103, Acc: 0.6600, PTFixPNLoss: 3.9922, NetFixLoss: 0.4187, ]
2022-11-05 14:52:28,857 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3894, Pos_dist: 6.5732, Neg_dist: 8.7619, Acc: 0.6000, PTFixPNLoss: 3.9904, NetFixLoss: 0.4899, ]
2022-11-05 14:52:30,143 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1305, Pos_dist: 6.6251, Neg_dist: 10.0307, Acc: 0.6200, PTFixPNLoss: 3.9918, NetFixLoss: 0.5649, ]
2022-11-05 14:52:32,165 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4217, Pos_dist: 6.4877, Neg_dist: 8.6960, Acc: 0.6000, PTFixPNLoss: 3.9899, NetFixLoss: 0.6445, ]
2022-11-05 14:52:33,977 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2674, Pos_dist: 6.5704, Neg_dist: 9.5831, Acc: 0.6600, PTFixPNLoss: 3.9868, NetFixLoss: 0.7291, ]
2022-11-05 14:52:35,006 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1798, Pos_dist: 6.7611, Neg_dist: 10.3318, Acc: 0.5800, PTFixPNLoss: 3.9913, NetFixLoss: 0.8161, ]
2022-11-05 14:52:35,239 INFO: fine-tune procedure is finished!
2022-11-05 14:53:46,686 INFO: [Test_acc of task 2 on test 1: 0.58071][acc of former classes: 0.66383][acc of former samples in all classes: 0.64183]
[acc of novel samples in all classes: 0.21400]
2022-11-05 14:53:46,731 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:53:46,739 WARNING: Current net - loaded net:
2022-11-05 14:53:46,739 WARNING: Loaded net - current net:
2022-11-05 14:53:46,739 WARNING:   func.fc.bias
2022-11-05 14:53:46,739 WARNING:   func.fc.weight
2022-11-05 14:53:46,768 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_2.pth.
2022-11-05 14:53:46,802 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:53:46,832 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:53:46,832 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:53:46,832 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:53:46,832 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:53:46,832 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:53:46,832 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:53:46,833 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:53:46,833 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:53:46,833 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:53:46,833 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:53:46,833 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:53:46,833 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:53:46,833 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:53:46,833 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:53:46,833 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:53:46,833 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:53:46,833 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:53:46,833 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:53:46,834 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:53:46,835 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:53:46,836 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:53:46,837 INFO: Model [FSLLModel] is created.
2022-11-05 14:53:46,846 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:53:46,855 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:53:46,864 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:53:48,760 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2017, Pos_dist: 6.6455, Neg_dist: 9.6566, Acc: 0.5467, PTFixPNLoss: 4.0662, NetFixLoss: 0.0000, ]
2022-11-05 14:53:50,114 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2213, Pos_dist: 6.6379, Neg_dist: 9.1962, Acc: 0.6000, PTFixPNLoss: 4.0643, NetFixLoss: 0.0229, ]
2022-11-05 14:53:51,711 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1281, Pos_dist: 6.4924, Neg_dist: 10.1824, Acc: 0.6133, PTFixPNLoss: 4.0631, NetFixLoss: 0.0534, ]
2022-11-05 14:53:53,027 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1311, Pos_dist: 6.6748, Neg_dist: 10.1786, Acc: 0.5600, PTFixPNLoss: 4.0651, NetFixLoss: 0.0863, ]
2022-11-05 14:53:54,802 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1630, Pos_dist: 6.5758, Neg_dist: 9.1963, Acc: 0.5867, PTFixPNLoss: 4.0675, NetFixLoss: 0.1201, ]
2022-11-05 14:53:56,443 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1955, Pos_dist: 6.5473, Neg_dist: 9.9126, Acc: 0.6533, PTFixPNLoss: 4.0632, NetFixLoss: 0.1619, ]
2022-11-05 14:53:57,799 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2527, Pos_dist: 6.6221, Neg_dist: 9.5307, Acc: 0.6000, PTFixPNLoss: 4.0641, NetFixLoss: 0.2047, ]
2022-11-05 14:53:59,315 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2024, Pos_dist: 6.6169, Neg_dist: 9.7730, Acc: 0.5867, PTFixPNLoss: 4.0667, NetFixLoss: 0.2504, ]
2022-11-05 14:54:00,929 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2422, Pos_dist: 6.6446, Neg_dist: 9.1495, Acc: 0.5733, PTFixPNLoss: 4.0643, NetFixLoss: 0.2978, ]
2022-11-05 14:54:02,980 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2543, Pos_dist: 6.6054, Neg_dist: 9.3814, Acc: 0.6133, PTFixPNLoss: 4.0639, NetFixLoss: 0.3543, ]
2022-11-05 14:54:04,158 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1815, Pos_dist: 6.5652, Neg_dist: 9.5874, Acc: 0.6000, PTFixPNLoss: 4.0607, NetFixLoss: 0.4139, ]
2022-11-05 14:54:06,021 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2348, Pos_dist: 6.5137, Neg_dist: 9.3614, Acc: 0.6133, PTFixPNLoss: 4.0654, NetFixLoss: 0.4748, ]
2022-11-05 14:54:08,265 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1789, Pos_dist: 6.5670, Neg_dist: 9.5708, Acc: 0.6267, PTFixPNLoss: 4.0675, NetFixLoss: 0.5372, ]
2022-11-05 14:54:10,888 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1295, Pos_dist: 6.6156, Neg_dist: 9.5113, Acc: 0.5867, PTFixPNLoss: 4.0640, NetFixLoss: 0.6007, ]
2022-11-05 14:54:12,888 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1431, Pos_dist: 6.5763, Neg_dist: 9.5483, Acc: 0.4933, PTFixPNLoss: 4.0650, NetFixLoss: 0.6657, ]
2022-11-05 14:54:13,101 INFO: fine-tune procedure is finished!
2022-11-05 14:55:28,047 INFO: [Test_acc of task 3 on test 1: 0.54373][acc of former classes: 0.65983][acc of former samples in all classes: 0.62883]
[acc of novel samples in all classes: 0.20333]
2022-11-05 14:55:28,194 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:55:28,202 WARNING: Current net - loaded net:
2022-11-05 14:55:28,202 WARNING: Loaded net - current net:
2022-11-05 14:55:28,202 WARNING:   func.fc.bias
2022-11-05 14:55:28,202 WARNING:   func.fc.weight
2022-11-05 14:55:28,210 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_3.pth.
2022-11-05 14:55:28,243 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:55:28,268 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:55:28,268 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:55:28,268 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:55:28,269 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:55:28,269 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:55:28,269 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:55:28,270 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:55:28,271 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:55:28,272 INFO: Model [FSLLModel] is created.
2022-11-05 14:55:28,279 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:28,286 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:28,293 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:28,300 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:55:30,184 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2719, Pos_dist: 6.4732, Neg_dist: 8.9355, Acc: 0.6400, PTFixPNLoss: 4.1310, NetFixLoss: 0.0000, ]
2022-11-05 14:55:31,448 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2631, Pos_dist: 6.5103, Neg_dist: 9.1418, Acc: 0.6000, PTFixPNLoss: 4.1304, NetFixLoss: 0.0200, ]
2022-11-05 14:55:32,877 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1526, Pos_dist: 6.5896, Neg_dist: 9.4835, Acc: 0.6200, PTFixPNLoss: 4.1296, NetFixLoss: 0.0478, ]
2022-11-05 14:55:34,737 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0923, Pos_dist: 6.5467, Neg_dist: 10.4653, Acc: 0.6800, PTFixPNLoss: 4.1348, NetFixLoss: 0.0810, ]
2022-11-05 14:55:36,165 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2005, Pos_dist: 6.5616, Neg_dist: 9.7598, Acc: 0.6300, PTFixPNLoss: 4.1317, NetFixLoss: 0.1154, ]
2022-11-05 14:55:38,456 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2902, Pos_dist: 6.5118, Neg_dist: 9.5103, Acc: 0.6300, PTFixPNLoss: 4.1331, NetFixLoss: 0.1513, ]
2022-11-05 14:55:40,340 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2123, Pos_dist: 6.5178, Neg_dist: 9.6097, Acc: 0.6200, PTFixPNLoss: 4.1310, NetFixLoss: 0.1903, ]
2022-11-05 14:55:41,876 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4487, Pos_dist: 6.5459, Neg_dist: 8.5150, Acc: 0.5600, PTFixPNLoss: 4.1331, NetFixLoss: 0.2341, ]
2022-11-05 14:55:44,176 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2561, Pos_dist: 6.6717, Neg_dist: 9.4614, Acc: 0.5900, PTFixPNLoss: 4.1309, NetFixLoss: 0.2835, ]
2022-11-05 14:55:47,586 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1534, Pos_dist: 6.5142, Neg_dist: 9.8039, Acc: 0.6100, PTFixPNLoss: 4.1305, NetFixLoss: 0.3383, ]
2022-11-05 14:55:49,519 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0830, Pos_dist: 6.4504, Neg_dist: 9.7505, Acc: 0.5900, PTFixPNLoss: 4.1297, NetFixLoss: 0.3926, ]
2022-11-05 14:55:51,309 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2352, Pos_dist: 6.5474, Neg_dist: 9.4954, Acc: 0.6400, PTFixPNLoss: 4.1279, NetFixLoss: 0.4462, ]
2022-11-05 14:55:53,335 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0971, Pos_dist: 6.4626, Neg_dist: 9.9476, Acc: 0.6700, PTFixPNLoss: 4.1295, NetFixLoss: 0.5015, ]
2022-11-05 14:55:55,304 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3418, Pos_dist: 6.5599, Neg_dist: 8.7219, Acc: 0.5700, PTFixPNLoss: 4.1295, NetFixLoss: 0.5569, ]
2022-11-05 14:55:57,445 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2527, Pos_dist: 6.4794, Neg_dist: 8.8553, Acc: 0.6700, PTFixPNLoss: 4.1351, NetFixLoss: 0.6181, ]
2022-11-05 14:55:57,648 INFO: fine-tune procedure is finished!
2022-11-05 14:57:13,021 INFO: [Test_acc of task 4 on test 1: 0.52400][acc of former classes: 0.67500][acc of former samples in all classes: 0.63650]
[acc of novel samples in all classes: 0.18650]
2022-11-05 14:57:13,070 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:57:13,076 WARNING: Current net - loaded net:
2022-11-05 14:57:13,077 WARNING: Loaded net - current net:
2022-11-05 14:57:13,077 WARNING:   func.fc.bias
2022-11-05 14:57:13,077 WARNING:   func.fc.weight
2022-11-05 14:57:13,107 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_4.pth.
2022-11-05 14:57:13,143 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:57:13,174 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:57:13,174 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:57:13,174 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:57:13,175 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:57:13,176 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:57:13,177 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:57:13,178 INFO: Model [FSLLModel] is created.
2022-11-05 14:57:13,188 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:57:13,197 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:57:13,206 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:57:13,215 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:57:13,224 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:57:15,041 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2072, Pos_dist: 6.3964, Neg_dist: 9.5986, Acc: 0.5840, PTFixPNLoss: 4.1795, NetFixLoss: 0.0000, ]
2022-11-05 14:57:17,453 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1557, Pos_dist: 6.4786, Neg_dist: 9.7390, Acc: 0.6640, PTFixPNLoss: 4.1774, NetFixLoss: 0.0180, ]
2022-11-05 14:57:19,534 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2300, Pos_dist: 6.3986, Neg_dist: 9.7334, Acc: 0.6160, PTFixPNLoss: 4.1823, NetFixLoss: 0.0429, ]
2022-11-05 14:57:21,644 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3525, Pos_dist: 6.3831, Neg_dist: 8.8766, Acc: 0.5920, PTFixPNLoss: 4.1784, NetFixLoss: 0.0734, ]
2022-11-05 14:57:23,646 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0988, Pos_dist: 6.3619, Neg_dist: 9.8276, Acc: 0.6400, PTFixPNLoss: 4.1797, NetFixLoss: 0.1092, ]
2022-11-05 14:57:26,062 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2041, Pos_dist: 6.4524, Neg_dist: 9.3222, Acc: 0.6320, PTFixPNLoss: 4.1838, NetFixLoss: 0.1467, ]
2022-11-05 14:57:28,218 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1965, Pos_dist: 6.4201, Neg_dist: 9.7676, Acc: 0.6880, PTFixPNLoss: 4.1804, NetFixLoss: 0.1852, ]
2022-11-05 14:57:30,558 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1606, Pos_dist: 6.3854, Neg_dist: 9.4050, Acc: 0.6400, PTFixPNLoss: 4.1789, NetFixLoss: 0.2266, ]
2022-11-05 14:57:32,878 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1619, Pos_dist: 6.3638, Neg_dist: 9.3687, Acc: 0.6160, PTFixPNLoss: 4.1775, NetFixLoss: 0.2694, ]
2022-11-05 14:57:35,182 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1027, Pos_dist: 6.3489, Neg_dist: 9.7219, Acc: 0.6320, PTFixPNLoss: 4.1794, NetFixLoss: 0.3149, ]
2022-11-05 14:57:37,751 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1058, Pos_dist: 6.3512, Neg_dist: 9.9386, Acc: 0.6400, PTFixPNLoss: 4.1816, NetFixLoss: 0.3629, ]
2022-11-05 14:57:39,555 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2015, Pos_dist: 6.3370, Neg_dist: 9.3854, Acc: 0.6720, PTFixPNLoss: 4.1808, NetFixLoss: 0.4111, ]
2022-11-05 14:57:42,556 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1804, Pos_dist: 6.4612, Neg_dist: 9.7977, Acc: 0.6240, PTFixPNLoss: 4.1796, NetFixLoss: 0.4605, ]
2022-11-05 14:57:44,886 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2142, Pos_dist: 6.4259, Neg_dist: 9.4461, Acc: 0.6080, PTFixPNLoss: 4.1825, NetFixLoss: 0.5079, ]
2022-11-05 14:57:47,128 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1887, Pos_dist: 6.4603, Neg_dist: 9.7393, Acc: 0.6400, PTFixPNLoss: 4.1815, NetFixLoss: 0.5581, ]
2022-11-05 14:57:47,354 INFO: fine-tune procedure is finished!
2022-11-05 14:59:02,818 INFO: [Test_acc of task 5 on test 1: 0.51565][acc of former classes: 0.69117][acc of former samples in all classes: 0.64800]
[acc of novel samples in all classes: 0.19800]
2022-11-05 14:59:02,901 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 14:59:02,911 WARNING: Current net - loaded net:
2022-11-05 14:59:02,911 WARNING: Loaded net - current net:
2022-11-05 14:59:02,911 WARNING:   func.fc.bias
2022-11-05 14:59:02,911 WARNING:   func.fc.weight
2022-11-05 14:59:02,939 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_5.pth.
2022-11-05 14:59:02,979 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 14:59:03,009 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 14:59:03,010 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:59:03,010 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:59:03,011 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:59:03,012 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:59:03,013 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:59:03,013 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:59:03,013 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:59:03,013 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 14:59:03,013 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:59:03,013 INFO: Model [FSLLModel] is created.
2022-11-05 14:59:03,024 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:03,033 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:03,042 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:03,051 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:03,061 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:59:03,070 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:59:05,268 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2501, Pos_dist: 6.4020, Neg_dist: 9.2922, Acc: 0.6133, PTFixPNLoss: 4.2364, NetFixLoss: 0.0000, ]
2022-11-05 14:59:07,452 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1921, Pos_dist: 6.3929, Neg_dist: 9.6426, Acc: 0.6333, PTFixPNLoss: 4.2359, NetFixLoss: 0.0230, ]
2022-11-05 14:59:10,057 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1718, Pos_dist: 6.2830, Neg_dist: 9.3451, Acc: 0.6400, PTFixPNLoss: 4.2329, NetFixLoss: 0.0489, ]
2022-11-05 14:59:12,302 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1489, Pos_dist: 6.3757, Neg_dist: 9.8894, Acc: 0.6533, PTFixPNLoss: 4.2351, NetFixLoss: 0.0788, ]
2022-11-05 14:59:14,767 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1569, Pos_dist: 6.3479, Neg_dist: 9.7599, Acc: 0.6267, PTFixPNLoss: 4.2369, NetFixLoss: 0.1093, ]
2022-11-05 14:59:17,710 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3248, Pos_dist: 6.3472, Neg_dist: 8.8514, Acc: 0.6333, PTFixPNLoss: 4.2344, NetFixLoss: 0.1418, ]
2022-11-05 14:59:19,792 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0165, Pos_dist: 6.2754, Neg_dist: 10.8626, Acc: 0.6533, PTFixPNLoss: 4.2351, NetFixLoss: 0.1820, ]
2022-11-05 14:59:22,824 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2225, Pos_dist: 6.3160, Neg_dist: 8.9618, Acc: 0.6467, PTFixPNLoss: 4.2349, NetFixLoss: 0.2214, ]
2022-11-05 14:59:25,426 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1811, Pos_dist: 6.2826, Neg_dist: 9.4331, Acc: 0.6333, PTFixPNLoss: 4.2366, NetFixLoss: 0.2621, ]
2022-11-05 14:59:28,152 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1332, Pos_dist: 6.3536, Neg_dist: 9.5958, Acc: 0.6667, PTFixPNLoss: 4.2373, NetFixLoss: 0.3030, ]
2022-11-05 14:59:30,257 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2360, Pos_dist: 6.3962, Neg_dist: 9.1785, Acc: 0.6533, PTFixPNLoss: 4.2379, NetFixLoss: 0.3442, ]
2022-11-05 14:59:31,979 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1685, Pos_dist: 6.3790, Neg_dist: 9.5269, Acc: 0.6400, PTFixPNLoss: 4.2354, NetFixLoss: 0.3918, ]
2022-11-05 14:59:34,903 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1391, Pos_dist: 6.3108, Neg_dist: 9.2637, Acc: 0.6400, PTFixPNLoss: 4.2357, NetFixLoss: 0.4446, ]
2022-11-05 14:59:37,381 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0823, Pos_dist: 6.3433, Neg_dist: 10.3709, Acc: 0.6600, PTFixPNLoss: 4.2345, NetFixLoss: 0.4973, ]
2022-11-05 14:59:40,575 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1863, Pos_dist: 6.3134, Neg_dist: 9.6354, Acc: 0.6533, PTFixPNLoss: 4.2363, NetFixLoss: 0.5484, ]
2022-11-05 14:59:40,788 INFO: fine-tune procedure is finished!
2022-11-05 15:00:56,872 INFO: [Test_acc of task 6 on test 1: 0.50811][acc of former classes: 0.70400][acc of former samples in all classes: 0.65883]
[acc of novel samples in all classes: 0.20667]
2022-11-05 15:00:56,912 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:00:56,921 WARNING: Current net - loaded net:
2022-11-05 15:00:56,921 WARNING: Loaded net - current net:
2022-11-05 15:00:56,921 WARNING:   func.fc.bias
2022-11-05 15:00:56,921 WARNING:   func.fc.weight
2022-11-05 15:00:56,952 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_6.pth.
2022-11-05 15:00:57,023 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:00:57,052 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:00:57,052 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:00:57,053 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:00:57,053 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:00:57,053 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:00:57,053 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:00:57,053 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:00:57,053 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:00:57,054 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:00:57,055 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:00:57,056 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:00:57,057 INFO: Model [FSLLModel] is created.
2022-11-05 15:00:57,066 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:00:57,074 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:00:57,083 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:00:57,092 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:00:57,101 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:00:57,110 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:00:57,119 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 15:00:59,810 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2974, Pos_dist: 6.4428, Neg_dist: 8.9427, Acc: 0.6000, PTFixPNLoss: 4.2903, NetFixLoss: 0.0000, ]
2022-11-05 15:01:02,414 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2282, Pos_dist: 6.3601, Neg_dist: 9.1574, Acc: 0.6171, PTFixPNLoss: 4.2908, NetFixLoss: 0.0230, ]
2022-11-05 15:01:05,284 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2544, Pos_dist: 6.3623, Neg_dist: 9.4171, Acc: 0.6286, PTFixPNLoss: 4.2904, NetFixLoss: 0.0511, ]
2022-11-05 15:01:08,020 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2027, Pos_dist: 6.3425, Neg_dist: 9.5102, Acc: 0.6000, PTFixPNLoss: 4.2916, NetFixLoss: 0.0831, ]
2022-11-05 15:01:10,504 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1878, Pos_dist: 6.3638, Neg_dist: 9.2409, Acc: 0.6343, PTFixPNLoss: 4.2921, NetFixLoss: 0.1210, ]
2022-11-05 15:01:12,848 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1742, Pos_dist: 6.3729, Neg_dist: 9.2388, Acc: 0.6286, PTFixPNLoss: 4.2894, NetFixLoss: 0.1627, ]
2022-11-05 15:01:15,820 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2769, Pos_dist: 6.4704, Neg_dist: 9.5087, Acc: 0.6057, PTFixPNLoss: 4.2919, NetFixLoss: 0.2059, ]
2022-11-05 15:01:18,857 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2665, Pos_dist: 6.3418, Neg_dist: 8.9375, Acc: 0.6400, PTFixPNLoss: 4.2898, NetFixLoss: 0.2507, ]
2022-11-05 15:01:21,915 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1028, Pos_dist: 6.2958, Neg_dist: 9.9858, Acc: 0.6343, PTFixPNLoss: 4.2884, NetFixLoss: 0.2966, ]
2022-11-05 15:01:24,740 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1895, Pos_dist: 6.3530, Neg_dist: 9.1925, Acc: 0.6629, PTFixPNLoss: 4.2867, NetFixLoss: 0.3421, ]
2022-11-05 15:01:27,872 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0716, Pos_dist: 6.3511, Neg_dist: 10.3651, Acc: 0.6571, PTFixPNLoss: 4.2899, NetFixLoss: 0.3906, ]
2022-11-05 15:01:30,991 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1268, Pos_dist: 6.3170, Neg_dist: 9.5622, Acc: 0.6400, PTFixPNLoss: 4.2898, NetFixLoss: 0.4372, ]
2022-11-05 15:01:33,483 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1272, Pos_dist: 6.3444, Neg_dist: 9.9702, Acc: 0.6686, PTFixPNLoss: 4.2906, NetFixLoss: 0.4825, ]
2022-11-05 15:01:35,771 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1526, Pos_dist: 6.3341, Neg_dist: 10.0286, Acc: 0.6514, PTFixPNLoss: 4.2882, NetFixLoss: 0.5283, ]
2022-11-05 15:01:38,526 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1552, Pos_dist: 6.2827, Neg_dist: 9.2503, Acc: 0.6514, PTFixPNLoss: 4.2889, NetFixLoss: 0.5724, ]
2022-11-05 15:01:38,661 INFO: fine-tune procedure is finished!
2022-11-05 15:02:59,224 INFO: [Test_acc of task 7 on test 1: 0.49463][acc of former classes: 0.70433][acc of former samples in all classes: 0.65783]
[acc of novel samples in all classes: 0.21486]
2022-11-05 15:02:59,277 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:02:59,283 WARNING: Current net - loaded net:
2022-11-05 15:02:59,283 WARNING: Loaded net - current net:
2022-11-05 15:02:59,283 WARNING:   func.fc.bias
2022-11-05 15:02:59,283 WARNING:   func.fc.weight
2022-11-05 15:02:59,314 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_7.pth.
2022-11-05 15:02:59,354 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:02:59,381 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:02:59,381 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:02:59,381 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:02:59,382 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:02:59,383 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:02:59,384 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:02:59,384 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:02:59,384 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:02:59,384 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:02:59,384 INFO: Model [FSLLModel] is created.
2022-11-05 15:02:59,392 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:59,398 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:59,404 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:59,411 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:59,418 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:59,426 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:59,434 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:59,443 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:03:02,035 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0226, Pos_dist: 6.3451, Neg_dist: 11.8505, Acc: 0.6200, PTFixPNLoss: 4.3330, NetFixLoss: 0.0000, ]
2022-11-05 15:03:04,847 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2719, Pos_dist: 6.3210, Neg_dist: 9.0581, Acc: 0.6450, PTFixPNLoss: 4.3350, NetFixLoss: 0.0044, ]
2022-11-05 15:03:07,523 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1904, Pos_dist: 6.2869, Neg_dist: 9.3057, Acc: 0.6350, PTFixPNLoss: 4.3321, NetFixLoss: 0.0202, ]
2022-11-05 15:03:10,647 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1650, Pos_dist: 6.3491, Neg_dist: 9.4924, Acc: 0.6550, PTFixPNLoss: 4.3308, NetFixLoss: 0.0410, ]
2022-11-05 15:03:13,345 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2004, Pos_dist: 6.2828, Neg_dist: 9.0854, Acc: 0.6800, PTFixPNLoss: 4.3312, NetFixLoss: 0.0664, ]
2022-11-05 15:03:16,534 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1679, Pos_dist: 6.2863, Neg_dist: 9.5800, Acc: 0.6350, PTFixPNLoss: 4.3294, NetFixLoss: 0.0958, ]
2022-11-05 15:03:18,723 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1172, Pos_dist: 6.2663, Neg_dist: 9.9746, Acc: 0.6600, PTFixPNLoss: 4.3309, NetFixLoss: 0.1275, ]
2022-11-05 15:03:21,211 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1265, Pos_dist: 6.2862, Neg_dist: 10.0598, Acc: 0.6650, PTFixPNLoss: 4.3320, NetFixLoss: 0.1604, ]
2022-11-05 15:03:24,064 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0999, Pos_dist: 6.2806, Neg_dist: 10.2067, Acc: 0.6900, PTFixPNLoss: 4.3352, NetFixLoss: 0.1943, ]
2022-11-05 15:03:27,300 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2293, Pos_dist: 6.2355, Neg_dist: 9.2722, Acc: 0.6200, PTFixPNLoss: 4.3330, NetFixLoss: 0.2295, ]
2022-11-05 15:03:30,410 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1572, Pos_dist: 6.2700, Neg_dist: 9.3836, Acc: 0.6300, PTFixPNLoss: 4.3352, NetFixLoss: 0.2665, ]
2022-11-05 15:03:33,409 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1123, Pos_dist: 6.3286, Neg_dist: 10.0148, Acc: 0.6550, PTFixPNLoss: 4.3320, NetFixLoss: 0.3038, ]
2022-11-05 15:03:36,257 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1123, Pos_dist: 6.2931, Neg_dist: 9.9555, Acc: 0.6450, PTFixPNLoss: 4.3340, NetFixLoss: 0.3409, ]
2022-11-05 15:03:38,985 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1686, Pos_dist: 6.2937, Neg_dist: 9.4257, Acc: 0.6600, PTFixPNLoss: 4.3324, NetFixLoss: 0.3777, ]
2022-11-05 15:03:42,070 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1976, Pos_dist: 6.3720, Neg_dist: 9.3931, Acc: 0.6300, PTFixPNLoss: 4.3344, NetFixLoss: 0.4149, ]
2022-11-05 15:03:42,362 INFO: fine-tune procedure is finished!
2022-11-05 15:05:06,796 INFO: [Test_acc of task 8 on test 1: 0.47780][acc of former classes: 0.70867][acc of former samples in all classes: 0.65617]
[acc of novel samples in all classes: 0.21025]
2022-11-05 15:05:06,849 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:05:06,855 WARNING: Current net - loaded net:
2022-11-05 15:05:06,855 WARNING: Loaded net - current net:
2022-11-05 15:05:06,855 WARNING:   func.fc.bias
2022-11-05 15:05:06,855 WARNING:   func.fc.weight
2022-11-05 15:05:06,886 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-11-05 15:05:06,922 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:05:06,949 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:05:06,950 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:05:06,950 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:05:06,950 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:05:06,950 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:05:06,950 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:05:06,951 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:05:06,952 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:05:06,952 INFO: Model [FSLLModel] is created.
2022-11-05 15:05:06,960 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 15:05:07,832 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0735, Pos_dist: 6.3917, Neg_dist: 9.9493, Acc: 0.6800, PTFixPNLoss: 3.9000, NetFixLoss: 0.0000, ]
2022-11-05 15:05:09,137 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0606, Pos_dist: 6.2507, Neg_dist: 10.3744, Acc: 0.7600, PTFixPNLoss: 3.8929, NetFixLoss: 0.0180, ]
2022-11-05 15:05:10,179 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1391, Pos_dist: 6.1610, Neg_dist: 9.8078, Acc: 0.7200, PTFixPNLoss: 3.8929, NetFixLoss: 0.0410, ]
2022-11-05 15:05:11,634 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0618, Pos_dist: 6.2028, Neg_dist: 10.1339, Acc: 0.7600, PTFixPNLoss: 3.8956, NetFixLoss: 0.0725, ]
2022-11-05 15:05:13,158 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1285, Pos_dist: 6.0660, Neg_dist: 9.7710, Acc: 0.8400, PTFixPNLoss: 3.8903, NetFixLoss: 0.1100, ]
2022-11-05 15:05:14,216 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.0741, Pos_dist: 6.1046, Neg_dist: 10.1407, Acc: 0.7200, PTFixPNLoss: 3.8988, NetFixLoss: 0.1536, ]
2022-11-05 15:05:15,276 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0888, Pos_dist: 6.2298, Neg_dist: 9.8683, Acc: 0.6800, PTFixPNLoss: 3.9023, NetFixLoss: 0.1998, ]
2022-11-05 15:05:16,270 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0805, Pos_dist: 6.1961, Neg_dist: 9.6698, Acc: 0.6800, PTFixPNLoss: 3.9015, NetFixLoss: 0.2525, ]
2022-11-05 15:05:17,371 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2179, Pos_dist: 6.2379, Neg_dist: 10.0126, Acc: 0.7200, PTFixPNLoss: 3.8950, NetFixLoss: 0.3079, ]
2022-11-05 15:05:18,386 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1787, Pos_dist: 6.0932, Neg_dist: 9.7309, Acc: 0.6800, PTFixPNLoss: 3.8954, NetFixLoss: 0.3744, ]
2022-11-05 15:05:19,576 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1264, Pos_dist: 6.2465, Neg_dist: 9.4124, Acc: 0.8400, PTFixPNLoss: 3.9020, NetFixLoss: 0.4488, ]
2022-11-05 15:05:20,742 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0523, Pos_dist: 6.3640, Neg_dist: 10.2906, Acc: 0.7600, PTFixPNLoss: 3.8943, NetFixLoss: 0.5235, ]
2022-11-05 15:05:22,106 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0559, Pos_dist: 6.0940, Neg_dist: 9.7545, Acc: 0.7200, PTFixPNLoss: 3.8950, NetFixLoss: 0.5985, ]
2022-11-05 15:05:23,263 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0279, Pos_dist: 6.0207, Neg_dist: 9.8516, Acc: 0.7200, PTFixPNLoss: 3.8900, NetFixLoss: 0.6734, ]
2022-11-05 15:05:24,569 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0206, Pos_dist: 6.1178, Neg_dist: 10.4645, Acc: 0.7200, PTFixPNLoss: 3.8951, NetFixLoss: 0.7463, ]
2022-11-05 15:05:24,749 INFO: fine-tune procedure is finished!
2022-11-05 15:06:25,730 INFO: [Test_acc of task 1 on test 2: 0.65600][acc of former classes: 0.69550][acc of former samples in all classes: 0.68850]
[acc of novel samples in all classes: 0.26600]
2022-11-05 15:06:25,775 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:06:25,780 WARNING: Current net - loaded net:
2022-11-05 15:06:25,780 WARNING: Loaded net - current net:
2022-11-05 15:06:25,780 WARNING:   func.fc.bias
2022-11-05 15:06:25,781 WARNING:   func.fc.weight
2022-11-05 15:06:25,812 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_1.pth.
2022-11-05 15:06:25,839 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:06:25,855 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:06:25,856 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:06:25,856 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:06:25,857 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:06:25,858 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:06:25,858 INFO: Model [FSLLModel] is created.
2022-11-05 15:06:25,866 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:06:25,872 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:06:27,092 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2037, Pos_dist: 6.2304, Neg_dist: 9.0063, Acc: 0.7000, PTFixPNLoss: 3.9799, NetFixLoss: 0.0000, ]
2022-11-05 15:06:28,861 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1839, Pos_dist: 6.3649, Neg_dist: 9.9357, Acc: 0.6800, PTFixPNLoss: 3.9843, NetFixLoss: 0.0219, ]
2022-11-05 15:06:30,878 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1185, Pos_dist: 6.2305, Neg_dist: 9.3413, Acc: 0.7400, PTFixPNLoss: 3.9784, NetFixLoss: 0.0478, ]
2022-11-05 15:06:32,317 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1775, Pos_dist: 6.3115, Neg_dist: 9.9767, Acc: 0.6800, PTFixPNLoss: 3.9785, NetFixLoss: 0.0764, ]
2022-11-05 15:06:33,607 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1909, Pos_dist: 6.4187, Neg_dist: 9.3450, Acc: 0.7800, PTFixPNLoss: 3.9832, NetFixLoss: 0.1100, ]
2022-11-05 15:06:34,759 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1249, Pos_dist: 6.2848, Neg_dist: 10.0354, Acc: 0.6400, PTFixPNLoss: 3.9819, NetFixLoss: 0.1488, ]
2022-11-05 15:06:36,330 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1484, Pos_dist: 6.2061, Neg_dist: 9.8820, Acc: 0.7000, PTFixPNLoss: 3.9758, NetFixLoss: 0.1929, ]
2022-11-05 15:06:38,086 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1873, Pos_dist: 6.2551, Neg_dist: 9.8242, Acc: 0.7800, PTFixPNLoss: 3.9758, NetFixLoss: 0.2406, ]
2022-11-05 15:06:40,154 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1113, Pos_dist: 6.1859, Neg_dist: 9.6767, Acc: 0.7000, PTFixPNLoss: 3.9819, NetFixLoss: 0.2958, ]
2022-11-05 15:06:41,484 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1404, Pos_dist: 6.2442, Neg_dist: 9.6641, Acc: 0.7800, PTFixPNLoss: 3.9828, NetFixLoss: 0.3540, ]
2022-11-05 15:06:43,035 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0557, Pos_dist: 6.3052, Neg_dist: 10.5003, Acc: 0.6600, PTFixPNLoss: 3.9820, NetFixLoss: 0.4134, ]
2022-11-05 15:06:44,679 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1488, Pos_dist: 6.2391, Neg_dist: 9.1188, Acc: 0.7200, PTFixPNLoss: 3.9826, NetFixLoss: 0.4746, ]
2022-11-05 15:06:46,284 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1555, Pos_dist: 6.2970, Neg_dist: 10.7976, Acc: 0.7800, PTFixPNLoss: 3.9778, NetFixLoss: 0.5372, ]
2022-11-05 15:06:47,625 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1499, Pos_dist: 6.0295, Neg_dist: 9.3843, Acc: 0.7800, PTFixPNLoss: 3.9743, NetFixLoss: 0.6022, ]
2022-11-05 15:06:49,118 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0389, Pos_dist: 6.3413, Neg_dist: 10.7585, Acc: 0.6400, PTFixPNLoss: 3.9835, NetFixLoss: 0.6680, ]
2022-11-05 15:06:49,254 INFO: fine-tune procedure is finished!
2022-11-05 15:07:54,143 INFO: [Test_acc of task 2 on test 2: 0.60543][acc of former classes: 0.68517][acc of former samples in all classes: 0.66567]
[acc of novel samples in all classes: 0.24400]
2022-11-05 15:07:54,202 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:07:54,210 WARNING: Current net - loaded net:
2022-11-05 15:07:54,210 WARNING: Loaded net - current net:
2022-11-05 15:07:54,210 WARNING:   func.fc.bias
2022-11-05 15:07:54,210 WARNING:   func.fc.weight
2022-11-05 15:07:54,261 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_2.pth.
2022-11-05 15:07:54,299 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:07:54,330 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:07:54,331 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:07:54,331 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:07:54,332 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:07:54,333 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:07:54,334 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:07:54,334 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:07:54,334 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:07:54,334 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:07:54,334 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:07:54,334 INFO: Model [FSLLModel] is created.
2022-11-05 15:07:54,342 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:07:54,349 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:07:54,355 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 15:07:55,543 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2426, Pos_dist: 6.4996, Neg_dist: 9.3583, Acc: 0.6267, PTFixPNLoss: 4.0563, NetFixLoss: 0.0000, ]
2022-11-05 15:07:57,822 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0936, Pos_dist: 6.4439, Neg_dist: 11.0106, Acc: 0.6800, PTFixPNLoss: 4.0546, NetFixLoss: 0.0209, ]
2022-11-05 15:07:59,461 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2304, Pos_dist: 6.5584, Neg_dist: 9.5465, Acc: 0.6667, PTFixPNLoss: 4.0551, NetFixLoss: 0.0440, ]
2022-11-05 15:08:01,160 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2405, Pos_dist: 6.4306, Neg_dist: 9.4324, Acc: 0.6667, PTFixPNLoss: 4.0529, NetFixLoss: 0.0764, ]
2022-11-05 15:08:02,877 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2225, Pos_dist: 6.5218, Neg_dist: 9.1404, Acc: 0.5867, PTFixPNLoss: 4.0583, NetFixLoss: 0.1151, ]
2022-11-05 15:08:04,396 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1792, Pos_dist: 6.3190, Neg_dist: 9.3701, Acc: 0.5467, PTFixPNLoss: 4.0574, NetFixLoss: 0.1586, ]
2022-11-05 15:08:05,730 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1326, Pos_dist: 6.5184, Neg_dist: 10.3022, Acc: 0.5467, PTFixPNLoss: 4.0583, NetFixLoss: 0.2051, ]
2022-11-05 15:08:07,680 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0484, Pos_dist: 6.3877, Neg_dist: 10.2626, Acc: 0.6267, PTFixPNLoss: 4.0565, NetFixLoss: 0.2529, ]
2022-11-05 15:08:09,479 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3677, Pos_dist: 6.5197, Neg_dist: 8.9881, Acc: 0.5600, PTFixPNLoss: 4.0587, NetFixLoss: 0.3003, ]
2022-11-05 15:08:11,382 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3359, Pos_dist: 6.4372, Neg_dist: 8.9582, Acc: 0.6667, PTFixPNLoss: 4.0567, NetFixLoss: 0.3503, ]
2022-11-05 15:08:13,052 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2580, Pos_dist: 6.4858, Neg_dist: 9.2314, Acc: 0.5733, PTFixPNLoss: 4.0614, NetFixLoss: 0.4030, ]
2022-11-05 15:08:14,538 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1768, Pos_dist: 6.3955, Neg_dist: 9.4658, Acc: 0.6133, PTFixPNLoss: 4.0541, NetFixLoss: 0.4598, ]
2022-11-05 15:08:16,067 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3159, Pos_dist: 6.3977, Neg_dist: 9.0369, Acc: 0.6400, PTFixPNLoss: 4.0546, NetFixLoss: 0.5184, ]
2022-11-05 15:08:17,592 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1948, Pos_dist: 6.3634, Neg_dist: 9.2722, Acc: 0.5867, PTFixPNLoss: 4.0567, NetFixLoss: 0.5794, ]
2022-11-05 15:08:19,066 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1094, Pos_dist: 6.4454, Neg_dist: 11.4056, Acc: 0.5600, PTFixPNLoss: 4.0537, NetFixLoss: 0.6443, ]
2022-11-05 15:08:19,180 INFO: fine-tune procedure is finished!
2022-11-05 15:09:26,685 INFO: [Test_acc of task 3 on test 2: 0.55400][acc of former classes: 0.66800][acc of former samples in all classes: 0.63750]
[acc of novel samples in all classes: 0.22000]
2022-11-05 15:09:26,734 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:09:26,740 WARNING: Current net - loaded net:
2022-11-05 15:09:26,740 WARNING: Loaded net - current net:
2022-11-05 15:09:26,740 WARNING:   func.fc.bias
2022-11-05 15:09:26,740 WARNING:   func.fc.weight
2022-11-05 15:09:26,772 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_3.pth.
2022-11-05 15:09:26,799 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:09:26,829 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:09:26,830 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:09:26,831 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:09:26,831 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:09:26,832 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:09:26,833 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:09:26,834 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:09:26,834 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:09:26,834 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:09:26,834 INFO: Model [FSLLModel] is created.
2022-11-05 15:09:26,850 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:26,860 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:26,870 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:26,879 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:09:28,836 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2818, Pos_dist: 6.4712, Neg_dist: 9.5603, Acc: 0.6100, PTFixPNLoss: 4.1207, NetFixLoss: 0.0000, ]
2022-11-05 15:09:30,711 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3262, Pos_dist: 6.3576, Neg_dist: 9.0222, Acc: 0.6500, PTFixPNLoss: 4.1230, NetFixLoss: 0.0250, ]
2022-11-05 15:09:32,227 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2724, Pos_dist: 6.3789, Neg_dist: 9.2199, Acc: 0.5900, PTFixPNLoss: 4.1269, NetFixLoss: 0.0551, ]
2022-11-05 15:09:34,033 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2399, Pos_dist: 6.3663, Neg_dist: 9.1336, Acc: 0.6000, PTFixPNLoss: 4.1274, NetFixLoss: 0.0891, ]
2022-11-05 15:09:35,867 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1802, Pos_dist: 6.3488, Neg_dist: 9.9380, Acc: 0.7000, PTFixPNLoss: 4.1224, NetFixLoss: 0.1278, ]
2022-11-05 15:09:37,821 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1319, Pos_dist: 6.2721, Neg_dist: 9.8673, Acc: 0.6900, PTFixPNLoss: 4.1190, NetFixLoss: 0.1701, ]
2022-11-05 15:09:39,872 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2082, Pos_dist: 6.3861, Neg_dist: 9.0853, Acc: 0.6300, PTFixPNLoss: 4.1263, NetFixLoss: 0.2163, ]
2022-11-05 15:09:41,577 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2855, Pos_dist: 6.5037, Neg_dist: 8.9065, Acc: 0.6200, PTFixPNLoss: 4.1260, NetFixLoss: 0.2668, ]
2022-11-05 15:09:43,297 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2305, Pos_dist: 6.3583, Neg_dist: 9.3397, Acc: 0.6600, PTFixPNLoss: 4.1262, NetFixLoss: 0.3200, ]
2022-11-05 15:09:45,351 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1880, Pos_dist: 6.3970, Neg_dist: 9.2576, Acc: 0.6200, PTFixPNLoss: 4.1263, NetFixLoss: 0.3758, ]
2022-11-05 15:09:47,120 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3064, Pos_dist: 6.3617, Neg_dist: 8.9909, Acc: 0.6500, PTFixPNLoss: 4.1250, NetFixLoss: 0.4350, ]
2022-11-05 15:09:48,600 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1148, Pos_dist: 6.4396, Neg_dist: 9.8206, Acc: 0.6700, PTFixPNLoss: 4.1229, NetFixLoss: 0.4999, ]
2022-11-05 15:09:50,052 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2159, Pos_dist: 6.3042, Neg_dist: 9.1288, Acc: 0.6300, PTFixPNLoss: 4.1263, NetFixLoss: 0.5643, ]
2022-11-05 15:09:51,770 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3203, Pos_dist: 6.4177, Neg_dist: 8.9895, Acc: 0.6700, PTFixPNLoss: 4.1222, NetFixLoss: 0.6285, ]
2022-11-05 15:09:53,601 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2033, Pos_dist: 6.3735, Neg_dist: 9.6132, Acc: 0.6400, PTFixPNLoss: 4.1217, NetFixLoss: 0.6973, ]
2022-11-05 15:09:53,725 INFO: fine-tune procedure is finished!
2022-11-05 15:11:09,401 INFO: [Test_acc of task 4 on test 2: 0.52825][acc of former classes: 0.67283][acc of former samples in all classes: 0.63417]
[acc of novel samples in all classes: 0.21050]
2022-11-05 15:11:09,454 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:11:09,466 WARNING: Current net - loaded net:
2022-11-05 15:11:09,466 WARNING: Loaded net - current net:
2022-11-05 15:11:09,467 WARNING:   func.fc.bias
2022-11-05 15:11:09,467 WARNING:   func.fc.weight
2022-11-05 15:11:09,496 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_4.pth.
2022-11-05 15:11:09,536 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:11:09,569 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:11:09,569 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:11:09,569 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:11:09,569 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:11:09,569 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:11:09,569 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:11:09,570 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:11:09,570 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:11:09,570 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:11:09,570 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:11:09,570 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:11:09,570 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:11:09,570 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:11:09,570 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:11:09,570 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:11:09,570 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:11:09,570 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:11:09,570 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:11:09,571 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:11:09,572 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:11:09,573 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:11:09,574 INFO: Model [FSLLModel] is created.
2022-11-05 15:11:09,583 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:09,591 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:09,598 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:09,604 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:11:09,609 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 15:11:11,587 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1494, Pos_dist: 6.3334, Neg_dist: 9.6357, Acc: 0.5840, PTFixPNLoss: 4.1773, NetFixLoss: 0.0000, ]
2022-11-05 15:11:13,898 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2895, Pos_dist: 6.3958, Neg_dist: 9.2087, Acc: 0.6320, PTFixPNLoss: 4.1778, NetFixLoss: 0.0134, ]
2022-11-05 15:11:16,212 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1395, Pos_dist: 6.2773, Neg_dist: 10.3746, Acc: 0.6720, PTFixPNLoss: 4.1740, NetFixLoss: 0.0343, ]
2022-11-05 15:11:18,616 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3202, Pos_dist: 6.4162, Neg_dist: 9.0517, Acc: 0.6000, PTFixPNLoss: 4.1760, NetFixLoss: 0.0603, ]
2022-11-05 15:11:20,951 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0463, Pos_dist: 6.3428, Neg_dist: 11.4002, Acc: 0.6320, PTFixPNLoss: 4.1771, NetFixLoss: 0.0917, ]
2022-11-05 15:11:23,096 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3046, Pos_dist: 6.4236, Neg_dist: 8.8969, Acc: 0.6160, PTFixPNLoss: 4.1799, NetFixLoss: 0.1239, ]
2022-11-05 15:11:25,173 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0663, Pos_dist: 6.3499, Neg_dist: 11.1656, Acc: 0.5840, PTFixPNLoss: 4.1777, NetFixLoss: 0.1587, ]
2022-11-05 15:11:27,198 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1742, Pos_dist: 6.3618, Neg_dist: 10.0485, Acc: 0.6240, PTFixPNLoss: 4.1725, NetFixLoss: 0.1945, ]
2022-11-05 15:11:30,691 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2921, Pos_dist: 6.4745, Neg_dist: 9.6655, Acc: 0.6240, PTFixPNLoss: 4.1807, NetFixLoss: 0.2330, ]
2022-11-05 15:11:32,798 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2164, Pos_dist: 6.3410, Neg_dist: 9.1991, Acc: 0.6320, PTFixPNLoss: 4.1778, NetFixLoss: 0.2732, ]
2022-11-05 15:11:35,784 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1810, Pos_dist: 6.2796, Neg_dist: 9.3055, Acc: 0.6560, PTFixPNLoss: 4.1745, NetFixLoss: 0.3154, ]
2022-11-05 15:11:38,050 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2346, Pos_dist: 6.3489, Neg_dist: 9.1691, Acc: 0.6400, PTFixPNLoss: 4.1766, NetFixLoss: 0.3591, ]
2022-11-05 15:11:40,210 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0733, Pos_dist: 6.3844, Neg_dist: 10.5716, Acc: 0.5840, PTFixPNLoss: 4.1771, NetFixLoss: 0.4066, ]
2022-11-05 15:11:42,622 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3430, Pos_dist: 6.4265, Neg_dist: 8.9598, Acc: 0.6160, PTFixPNLoss: 4.1775, NetFixLoss: 0.4543, ]
2022-11-05 15:11:45,393 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2247, Pos_dist: 6.3559, Neg_dist: 9.3618, Acc: 0.6480, PTFixPNLoss: 4.1798, NetFixLoss: 0.5035, ]
2022-11-05 15:11:45,730 INFO: fine-tune procedure is finished!
2022-11-05 15:13:12,133 INFO: [Test_acc of task 5 on test 2: 0.51659][acc of former classes: 0.69250][acc of former samples in all classes: 0.64550]
[acc of novel samples in all classes: 0.20720]
2022-11-05 15:13:12,179 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:13:12,190 WARNING: Current net - loaded net:
2022-11-05 15:13:12,190 WARNING: Loaded net - current net:
2022-11-05 15:13:12,190 WARNING:   func.fc.bias
2022-11-05 15:13:12,190 WARNING:   func.fc.weight
2022-11-05 15:13:12,219 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_5.pth.
2022-11-05 15:13:12,252 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:13:12,280 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:13:12,280 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:13:12,280 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:13:12,280 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:13:12,280 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:13:12,280 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:13:12,281 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:13:12,281 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:13:12,281 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:13:12,281 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:13:12,281 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:13:12,281 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:13:12,281 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:13:12,282 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:13:12,283 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:13:12,284 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:13:12,284 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:13:12,284 INFO: Model [FSLLModel] is created.
2022-11-05 15:13:12,292 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:12,299 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:12,306 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:12,312 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:12,320 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:13:12,327 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:13:14,203 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2390, Pos_dist: 6.3011, Neg_dist: 9.4299, Acc: 0.6200, PTFixPNLoss: 4.2274, NetFixLoss: 0.0000, ]
2022-11-05 15:13:16,858 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1452, Pos_dist: 6.2817, Neg_dist: 10.3117, Acc: 0.6400, PTFixPNLoss: 4.2267, NetFixLoss: 0.0187, ]
2022-11-05 15:13:19,147 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4269, Pos_dist: 6.4095, Neg_dist: 8.6768, Acc: 0.6000, PTFixPNLoss: 4.2305, NetFixLoss: 0.0399, ]
2022-11-05 15:13:21,919 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3287, Pos_dist: 6.3468, Neg_dist: 8.9125, Acc: 0.6133, PTFixPNLoss: 4.2274, NetFixLoss: 0.0680, ]
2022-11-05 15:13:24,079 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2279, Pos_dist: 6.2936, Neg_dist: 9.3873, Acc: 0.5933, PTFixPNLoss: 4.2257, NetFixLoss: 0.1054, ]
2022-11-05 15:13:26,906 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2363, Pos_dist: 6.3673, Neg_dist: 9.3882, Acc: 0.6133, PTFixPNLoss: 4.2282, NetFixLoss: 0.1454, ]
2022-11-05 15:13:29,384 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4310, Pos_dist: 6.2874, Neg_dist: 8.3982, Acc: 0.6000, PTFixPNLoss: 4.2258, NetFixLoss: 0.1883, ]
2022-11-05 15:13:32,561 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0745, Pos_dist: 6.2811, Neg_dist: 10.7559, Acc: 0.6067, PTFixPNLoss: 4.2290, NetFixLoss: 0.2329, ]
2022-11-05 15:13:35,849 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1555, Pos_dist: 6.2871, Neg_dist: 9.5803, Acc: 0.6000, PTFixPNLoss: 4.2280, NetFixLoss: 0.2782, ]
2022-11-05 15:13:38,791 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1317, Pos_dist: 6.3184, Neg_dist: 9.8138, Acc: 0.6200, PTFixPNLoss: 4.2279, NetFixLoss: 0.3229, ]
2022-11-05 15:13:41,424 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1793, Pos_dist: 6.3188, Neg_dist: 10.1036, Acc: 0.6467, PTFixPNLoss: 4.2250, NetFixLoss: 0.3676, ]
2022-11-05 15:13:43,781 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2821, Pos_dist: 6.4259, Neg_dist: 9.6656, Acc: 0.5667, PTFixPNLoss: 4.2310, NetFixLoss: 0.4135, ]
2022-11-05 15:13:45,946 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2442, Pos_dist: 6.3071, Neg_dist: 9.3788, Acc: 0.5867, PTFixPNLoss: 4.2245, NetFixLoss: 0.4592, ]
2022-11-05 15:13:48,963 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1606, Pos_dist: 6.2490, Neg_dist: 9.4842, Acc: 0.6000, PTFixPNLoss: 4.2278, NetFixLoss: 0.5046, ]
2022-11-05 15:13:51,891 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1173, Pos_dist: 6.3475, Neg_dist: 10.5785, Acc: 0.6200, PTFixPNLoss: 4.2263, NetFixLoss: 0.5508, ]
2022-11-05 15:13:52,441 INFO: fine-tune procedure is finished!
2022-11-05 15:15:23,083 INFO: [Test_acc of task 6 on test 2: 0.51656][acc of former classes: 0.70767][acc of former samples in all classes: 0.66100]
[acc of novel samples in all classes: 0.22767]
2022-11-05 15:15:23,136 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:15:23,145 WARNING: Current net - loaded net:
2022-11-05 15:15:23,145 WARNING: Loaded net - current net:
2022-11-05 15:15:23,145 WARNING:   func.fc.bias
2022-11-05 15:15:23,145 WARNING:   func.fc.weight
2022-11-05 15:15:23,171 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_6.pth.
2022-11-05 15:15:23,199 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:15:23,216 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:15:23,217 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:15:23,217 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:15:23,217 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:15:23,218 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:15:23,219 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:15:23,220 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:15:23,220 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:15:23,220 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:15:23,220 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:15:23,220 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:15:23,220 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:15:23,220 INFO: Model [FSLLModel] is created.
2022-11-05 15:15:23,234 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:23,243 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:23,252 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:23,260 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:23,269 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:23,278 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:23,287 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 15:15:25,338 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1264, Pos_dist: 6.2924, Neg_dist: 10.7044, Acc: 0.6000, PTFixPNLoss: 4.2806, NetFixLoss: 0.0000, ]
2022-11-05 15:15:28,072 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2102, Pos_dist: 6.3489, Neg_dist: 9.4449, Acc: 0.5943, PTFixPNLoss: 4.2813, NetFixLoss: 0.0138, ]
2022-11-05 15:15:30,785 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2690, Pos_dist: 6.3051, Neg_dist: 9.0736, Acc: 0.5886, PTFixPNLoss: 4.2817, NetFixLoss: 0.0335, ]
2022-11-05 15:15:33,876 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2717, Pos_dist: 6.3641, Neg_dist: 9.2488, Acc: 0.6229, PTFixPNLoss: 4.2798, NetFixLoss: 0.0585, ]
2022-11-05 15:15:36,813 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0702, Pos_dist: 6.3292, Neg_dist: 11.0339, Acc: 0.5943, PTFixPNLoss: 4.2801, NetFixLoss: 0.0891, ]
2022-11-05 15:15:40,333 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1185, Pos_dist: 6.3749, Neg_dist: 10.2779, Acc: 0.5714, PTFixPNLoss: 4.2851, NetFixLoss: 0.1211, ]
2022-11-05 15:15:43,202 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2380, Pos_dist: 6.3637, Neg_dist: 9.2681, Acc: 0.5829, PTFixPNLoss: 4.2817, NetFixLoss: 0.1536, ]
2022-11-05 15:15:45,605 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2866, Pos_dist: 6.3820, Neg_dist: 9.3477, Acc: 0.5657, PTFixPNLoss: 4.2842, NetFixLoss: 0.1883, ]
2022-11-05 15:15:47,935 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2887, Pos_dist: 6.2725, Neg_dist: 9.2972, Acc: 0.6286, PTFixPNLoss: 4.2792, NetFixLoss: 0.2253, ]
2022-11-05 15:15:50,757 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1674, Pos_dist: 6.3464, Neg_dist: 9.8629, Acc: 0.5943, PTFixPNLoss: 4.2809, NetFixLoss: 0.2666, ]
2022-11-05 15:15:53,796 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1085, Pos_dist: 6.3465, Neg_dist: 9.9691, Acc: 0.6000, PTFixPNLoss: 4.2815, NetFixLoss: 0.3086, ]
2022-11-05 15:15:56,859 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1287, Pos_dist: 6.2422, Neg_dist: 9.7294, Acc: 0.5771, PTFixPNLoss: 4.2814, NetFixLoss: 0.3512, ]
2022-11-05 15:15:59,257 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0624, Pos_dist: 6.2715, Neg_dist: 10.8578, Acc: 0.6229, PTFixPNLoss: 4.2804, NetFixLoss: 0.3935, ]
2022-11-05 15:16:02,122 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1505, Pos_dist: 6.3428, Neg_dist: 10.0305, Acc: 0.6000, PTFixPNLoss: 4.2775, NetFixLoss: 0.4343, ]
2022-11-05 15:16:04,316 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3317, Pos_dist: 6.3003, Neg_dist: 8.9203, Acc: 0.6114, PTFixPNLoss: 4.2823, NetFixLoss: 0.4752, ]
2022-11-05 15:16:04,620 INFO: fine-tune procedure is finished!
2022-11-05 15:17:26,267 INFO: [Test_acc of task 7 on test 2: 0.50116][acc of former classes: 0.70883][acc of former samples in all classes: 0.66233]
[acc of novel samples in all classes: 0.22486]
2022-11-05 15:17:26,319 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:17:26,328 WARNING: Current net - loaded net:
2022-11-05 15:17:26,328 WARNING: Loaded net - current net:
2022-11-05 15:17:26,328 WARNING:   func.fc.bias
2022-11-05 15:17:26,328 WARNING:   func.fc.weight
2022-11-05 15:17:26,354 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_7.pth.
2022-11-05 15:17:26,390 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:17:26,417 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:17:26,418 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:17:26,418 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:17:26,419 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:17:26,420 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:17:26,420 INFO: Model [FSLLModel] is created.
2022-11-05 15:17:26,427 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:26,433 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:26,439 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:26,446 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:26,453 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:26,459 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:26,465 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:17:26,471 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:17:29,052 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1135, Pos_dist: 6.3170, Neg_dist: 10.3980, Acc: 0.5800, PTFixPNLoss: 4.3305, NetFixLoss: 0.0000, ]
2022-11-05 15:17:31,659 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3041, Pos_dist: 6.2464, Neg_dist: 8.8775, Acc: 0.6100, PTFixPNLoss: 4.3251, NetFixLoss: 0.0135, ]
2022-11-05 15:17:34,660 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1394, Pos_dist: 6.3393, Neg_dist: 9.7659, Acc: 0.5650, PTFixPNLoss: 4.3279, NetFixLoss: 0.0338, ]
2022-11-05 15:17:37,749 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2514, Pos_dist: 6.3387, Neg_dist: 9.7696, Acc: 0.5850, PTFixPNLoss: 4.3263, NetFixLoss: 0.0585, ]
2022-11-05 15:17:40,679 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3456, Pos_dist: 6.3148, Neg_dist: 8.8542, Acc: 0.5600, PTFixPNLoss: 4.3279, NetFixLoss: 0.0865, ]
2022-11-05 15:17:44,340 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.0759, Pos_dist: 6.2840, Neg_dist: 10.4933, Acc: 0.5950, PTFixPNLoss: 4.3283, NetFixLoss: 0.1184, ]
2022-11-05 15:17:47,043 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0758, Pos_dist: 6.2862, Neg_dist: 11.2250, Acc: 0.5700, PTFixPNLoss: 4.3291, NetFixLoss: 0.1518, ]
2022-11-05 15:17:50,027 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3803, Pos_dist: 6.3158, Neg_dist: 9.0127, Acc: 0.5900, PTFixPNLoss: 4.3293, NetFixLoss: 0.1856, ]
2022-11-05 15:17:53,134 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2547, Pos_dist: 6.3027, Neg_dist: 9.3535, Acc: 0.5550, PTFixPNLoss: 4.3289, NetFixLoss: 0.2245, ]
2022-11-05 15:17:56,833 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0981, Pos_dist: 6.2806, Neg_dist: 10.4972, Acc: 0.6050, PTFixPNLoss: 4.3263, NetFixLoss: 0.2641, ]
2022-11-05 15:17:59,800 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0598, Pos_dist: 6.2193, Neg_dist: 10.9758, Acc: 0.6000, PTFixPNLoss: 4.3279, NetFixLoss: 0.3042, ]
2022-11-05 15:18:02,410 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1658, Pos_dist: 6.2624, Neg_dist: 10.4258, Acc: 0.6050, PTFixPNLoss: 4.3290, NetFixLoss: 0.3434, ]
2022-11-05 15:18:05,499 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1234, Pos_dist: 6.2964, Neg_dist: 9.8139, Acc: 0.6350, PTFixPNLoss: 4.3262, NetFixLoss: 0.3823, ]
2022-11-05 15:18:08,730 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1785, Pos_dist: 6.3204, Neg_dist: 9.5824, Acc: 0.5800, PTFixPNLoss: 4.3272, NetFixLoss: 0.4202, ]
2022-11-05 15:18:11,909 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2672, Pos_dist: 6.2995, Neg_dist: 9.1150, Acc: 0.5350, PTFixPNLoss: 4.3288, NetFixLoss: 0.4593, ]
2022-11-05 15:18:12,152 INFO: fine-tune procedure is finished!
2022-11-05 15:19:33,267 INFO: [Test_acc of task 8 on test 2: 0.48020][acc of former classes: 0.71033][acc of former samples in all classes: 0.65533]
[acc of novel samples in all classes: 0.21750]
2022-11-05 15:19:33,318 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:19:33,326 WARNING: Current net - loaded net:
2022-11-05 15:19:33,326 WARNING: Loaded net - current net:
2022-11-05 15:19:33,326 WARNING:   func.fc.bias
2022-11-05 15:19:33,326 WARNING:   func.fc.weight
2022-11-05 15:19:33,332 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-11-05 15:19:33,345 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:19:33,361 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:19:33,362 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:19:33,362 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:19:33,362 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:19:33,362 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:19:33,363 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:19:33,364 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:19:33,365 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:19:33,365 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:19:33,365 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:19:33,365 INFO: Model [FSLLModel] is created.
2022-11-05 15:19:33,373 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 15:19:34,070 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0477, Pos_dist: 5.8637, Neg_dist: 9.9665, Acc: 0.7600, PTFixPNLoss: 3.8959, NetFixLoss: 0.0000, ]
2022-11-05 15:19:35,176 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0581, Pos_dist: 6.1882, Neg_dist: 9.8834, Acc: 0.7200, PTFixPNLoss: 3.8963, NetFixLoss: 0.0157, ]
2022-11-05 15:19:36,513 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0658, Pos_dist: 6.2004, Neg_dist: 9.8014, Acc: 0.7600, PTFixPNLoss: 3.9053, NetFixLoss: 0.0366, ]
2022-11-05 15:19:37,704 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1538, Pos_dist: 6.1339, Neg_dist: 9.3058, Acc: 0.7200, PTFixPNLoss: 3.8987, NetFixLoss: 0.0672, ]
2022-11-05 15:19:38,812 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0290, Pos_dist: 6.1261, Neg_dist: 10.4631, Acc: 0.8000, PTFixPNLoss: 3.8995, NetFixLoss: 0.1077, ]
2022-11-05 15:19:39,854 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1827, Pos_dist: 6.2873, Neg_dist: 9.7844, Acc: 0.7600, PTFixPNLoss: 3.9007, NetFixLoss: 0.1519, ]
2022-11-05 15:19:40,775 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0310, Pos_dist: 6.1471, Neg_dist: 10.7666, Acc: 0.7600, PTFixPNLoss: 3.9012, NetFixLoss: 0.2059, ]
2022-11-05 15:19:41,789 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0940, Pos_dist: 5.9390, Neg_dist: 9.3108, Acc: 0.7600, PTFixPNLoss: 3.8987, NetFixLoss: 0.2612, ]
2022-11-05 15:19:42,920 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0350, Pos_dist: 6.0685, Neg_dist: 10.5274, Acc: 0.7600, PTFixPNLoss: 3.8913, NetFixLoss: 0.3222, ]
2022-11-05 15:19:43,876 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0328, Pos_dist: 6.3138, Neg_dist: 10.9278, Acc: 0.7200, PTFixPNLoss: 3.8982, NetFixLoss: 0.3833, ]
2022-11-05 15:19:44,856 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1379, Pos_dist: 6.0445, Neg_dist: 9.0315, Acc: 0.8400, PTFixPNLoss: 3.8992, NetFixLoss: 0.4434, ]
2022-11-05 15:19:45,671 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1456, Pos_dist: 6.2808, Neg_dist: 9.4123, Acc: 0.7200, PTFixPNLoss: 3.9016, NetFixLoss: 0.5066, ]
2022-11-05 15:19:46,691 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1159, Pos_dist: 6.1462, Neg_dist: 9.5071, Acc: 0.7600, PTFixPNLoss: 3.9015, NetFixLoss: 0.5770, ]
2022-11-05 15:19:47,934 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0527, Pos_dist: 6.1004, Neg_dist: 9.8578, Acc: 0.7200, PTFixPNLoss: 3.8973, NetFixLoss: 0.6508, ]
2022-11-05 15:19:49,321 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0287, Pos_dist: 6.0929, Neg_dist: 9.7584, Acc: 0.8000, PTFixPNLoss: 3.8981, NetFixLoss: 0.7245, ]
2022-11-05 15:19:49,461 INFO: fine-tune procedure is finished!
2022-11-05 15:20:42,657 INFO: [Test_acc of task 1 on test 3: 0.63800][acc of former classes: 0.67467][acc of former samples in all classes: 0.66800]
[acc of novel samples in all classes: 0.27800]
2022-11-05 15:20:42,688 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:20:42,697 WARNING: Current net - loaded net:
2022-11-05 15:20:42,697 WARNING: Loaded net - current net:
2022-11-05 15:20:42,697 WARNING:   func.fc.bias
2022-11-05 15:20:42,697 WARNING:   func.fc.weight
2022-11-05 15:20:42,704 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_1.pth.
2022-11-05 15:20:42,718 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:20:42,734 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:20:42,734 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:20:42,734 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:20:42,734 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:20:42,735 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:20:42,735 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:20:42,735 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:20:42,735 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:20:42,735 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:20:42,735 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:20:42,735 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:20:42,735 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:20:42,735 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:20:42,735 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:20:42,735 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:20:42,735 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:20:42,735 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:20:42,735 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:20:42,736 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:20:42,737 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:20:42,738 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:20:42,738 INFO: Model [FSLLModel] is created.
2022-11-05 15:20:42,749 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:20:42,756 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:20:43,837 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1292, Pos_dist: 6.2089, Neg_dist: 9.6247, Acc: 0.7600, PTFixPNLoss: 3.9760, NetFixLoss: 0.0000, ]
2022-11-05 15:20:44,835 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0471, Pos_dist: 6.2428, Neg_dist: 9.9744, Acc: 0.7000, PTFixPNLoss: 3.9816, NetFixLoss: 0.0182, ]
2022-11-05 15:20:46,252 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0699, Pos_dist: 6.1439, Neg_dist: 10.2896, Acc: 0.6800, PTFixPNLoss: 3.9756, NetFixLoss: 0.0395, ]
2022-11-05 15:20:47,429 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0987, Pos_dist: 6.1124, Neg_dist: 9.0950, Acc: 0.7200, PTFixPNLoss: 3.9823, NetFixLoss: 0.0680, ]
2022-11-05 15:20:48,648 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1685, Pos_dist: 6.2774, Neg_dist: 10.1170, Acc: 0.6800, PTFixPNLoss: 3.9800, NetFixLoss: 0.1006, ]
2022-11-05 15:20:49,739 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1632, Pos_dist: 6.2265, Neg_dist: 9.6981, Acc: 0.7200, PTFixPNLoss: 3.9817, NetFixLoss: 0.1370, ]
2022-11-05 15:20:50,609 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0230, Pos_dist: 6.2267, Neg_dist: 10.3004, Acc: 0.7200, PTFixPNLoss: 3.9816, NetFixLoss: 0.1761, ]
2022-11-05 15:20:51,595 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1534, Pos_dist: 6.2975, Neg_dist: 9.5656, Acc: 0.7200, PTFixPNLoss: 3.9813, NetFixLoss: 0.2158, ]
2022-11-05 15:20:52,497 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1630, Pos_dist: 6.1281, Neg_dist: 9.3549, Acc: 0.8200, PTFixPNLoss: 3.9802, NetFixLoss: 0.2566, ]
2022-11-05 15:20:53,687 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2046, Pos_dist: 6.1352, Neg_dist: 9.3611, Acc: 0.7200, PTFixPNLoss: 3.9779, NetFixLoss: 0.2993, ]
2022-11-05 15:20:55,102 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0359, Pos_dist: 6.1688, Neg_dist: 10.0034, Acc: 0.7000, PTFixPNLoss: 3.9835, NetFixLoss: 0.3456, ]
2022-11-05 15:20:56,445 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1323, Pos_dist: 6.1848, Neg_dist: 9.5321, Acc: 0.7200, PTFixPNLoss: 3.9813, NetFixLoss: 0.3930, ]
2022-11-05 15:20:57,934 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1599, Pos_dist: 6.3124, Neg_dist: 9.2830, Acc: 0.7800, PTFixPNLoss: 3.9779, NetFixLoss: 0.4413, ]
2022-11-05 15:20:59,314 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1085, Pos_dist: 6.1461, Neg_dist: 9.5337, Acc: 0.7000, PTFixPNLoss: 3.9766, NetFixLoss: 0.4917, ]
2022-11-05 15:21:00,590 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1571, Pos_dist: 6.1852, Neg_dist: 9.1934, Acc: 0.7400, PTFixPNLoss: 3.9820, NetFixLoss: 0.5445, ]
2022-11-05 15:21:00,737 INFO: fine-tune procedure is finished!
2022-11-05 15:21:55,992 INFO: [Test_acc of task 2 on test 3: 0.59829][acc of former classes: 0.67517][acc of former samples in all classes: 0.65300]
[acc of novel samples in all classes: 0.27000]
2022-11-05 15:21:56,021 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:21:56,031 WARNING: Current net - loaded net:
2022-11-05 15:21:56,031 WARNING: Loaded net - current net:
2022-11-05 15:21:56,031 WARNING:   func.fc.bias
2022-11-05 15:21:56,031 WARNING:   func.fc.weight
2022-11-05 15:21:56,038 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_2.pth.
2022-11-05 15:21:56,053 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:21:56,071 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:21:56,072 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:21:56,073 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:21:56,073 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:21:56,074 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:21:56,075 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:21:56,076 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:21:56,076 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:21:56,076 INFO: Model [FSLLModel] is created.
2022-11-05 15:21:56,087 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:21:56,097 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:21:56,107 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 15:21:57,082 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2696, Pos_dist: 6.2448, Neg_dist: 8.9886, Acc: 0.6667, PTFixPNLoss: 4.0512, NetFixLoss: 0.0000, ]
2022-11-05 15:21:58,098 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1693, Pos_dist: 6.2493, Neg_dist: 9.0078, Acc: 0.6933, PTFixPNLoss: 4.0499, NetFixLoss: 0.0196, ]
2022-11-05 15:21:58,987 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1523, Pos_dist: 6.2689, Neg_dist: 9.3407, Acc: 0.7067, PTFixPNLoss: 4.0524, NetFixLoss: 0.0451, ]
2022-11-05 15:22:00,110 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2584, Pos_dist: 6.2090, Neg_dist: 8.9563, Acc: 0.7200, PTFixPNLoss: 4.0560, NetFixLoss: 0.0757, ]
2022-11-05 15:22:01,249 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0859, Pos_dist: 6.3174, Neg_dist: 9.6869, Acc: 0.6667, PTFixPNLoss: 4.0535, NetFixLoss: 0.1143, ]
2022-11-05 15:22:02,381 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1142, Pos_dist: 6.3000, Neg_dist: 10.2216, Acc: 0.6800, PTFixPNLoss: 4.0538, NetFixLoss: 0.1559, ]
2022-11-05 15:22:03,350 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3062, Pos_dist: 6.2769, Neg_dist: 8.6497, Acc: 0.7200, PTFixPNLoss: 4.0483, NetFixLoss: 0.1991, ]
2022-11-05 15:22:04,289 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0650, Pos_dist: 6.1879, Neg_dist: 9.7674, Acc: 0.7600, PTFixPNLoss: 4.0500, NetFixLoss: 0.2466, ]
2022-11-05 15:22:05,324 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1326, Pos_dist: 6.2023, Neg_dist: 9.3373, Acc: 0.6933, PTFixPNLoss: 4.0546, NetFixLoss: 0.2963, ]
2022-11-05 15:22:06,144 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1172, Pos_dist: 6.2093, Neg_dist: 9.4731, Acc: 0.7067, PTFixPNLoss: 4.0469, NetFixLoss: 0.3494, ]
2022-11-05 15:22:07,117 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.0864, Pos_dist: 6.3071, Neg_dist: 10.4479, Acc: 0.6933, PTFixPNLoss: 4.0511, NetFixLoss: 0.4032, ]
2022-11-05 15:22:08,163 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1689, Pos_dist: 6.3200, Neg_dist: 9.2937, Acc: 0.6933, PTFixPNLoss: 4.0510, NetFixLoss: 0.4586, ]
2022-11-05 15:22:09,264 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1881, Pos_dist: 6.3198, Neg_dist: 9.6357, Acc: 0.7200, PTFixPNLoss: 4.0546, NetFixLoss: 0.5136, ]
2022-11-05 15:22:10,555 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1675, Pos_dist: 6.2463, Neg_dist: 9.2042, Acc: 0.7200, PTFixPNLoss: 4.0553, NetFixLoss: 0.5703, ]
2022-11-05 15:22:12,031 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2147, Pos_dist: 6.2165, Neg_dist: 9.1435, Acc: 0.7733, PTFixPNLoss: 4.0533, NetFixLoss: 0.6289, ]
2022-11-05 15:22:12,205 INFO: fine-tune procedure is finished!
2022-11-05 15:23:11,472 INFO: [Test_acc of task 3 on test 3: 0.55133][acc of former classes: 0.66767][acc of former samples in all classes: 0.63300]
[acc of novel samples in all classes: 0.22467]
2022-11-05 15:23:11,493 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:23:11,499 WARNING: Current net - loaded net:
2022-11-05 15:23:11,499 WARNING: Loaded net - current net:
2022-11-05 15:23:11,499 WARNING:   func.fc.bias
2022-11-05 15:23:11,499 WARNING:   func.fc.weight
2022-11-05 15:23:11,503 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_3.pth.
2022-11-05 15:23:11,513 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:23:11,524 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:23:11,524 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:23:11,524 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:23:11,524 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:23:11,524 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:23:11,524 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:23:11,525 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:23:11,525 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:23:11,525 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:23:11,525 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:23:11,525 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:23:11,525 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:23:11,525 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:23:11,526 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:23:11,527 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:23:11,527 INFO: Model [FSLLModel] is created.
2022-11-05 15:23:11,533 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:11,539 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:11,546 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:23:11,552 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:23:12,466 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1506, Pos_dist: 6.3701, Neg_dist: 9.4632, Acc: 0.7200, PTFixPNLoss: 4.1232, NetFixLoss: 0.0000, ]
2022-11-05 15:23:13,493 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2238, Pos_dist: 6.2894, Neg_dist: 9.5378, Acc: 0.7000, PTFixPNLoss: 4.1262, NetFixLoss: 0.0213, ]
2022-11-05 15:23:14,665 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3891, Pos_dist: 6.4139, Neg_dist: 8.5628, Acc: 0.6600, PTFixPNLoss: 4.1244, NetFixLoss: 0.0470, ]
2022-11-05 15:23:15,770 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2213, Pos_dist: 6.3592, Neg_dist: 9.0241, Acc: 0.6900, PTFixPNLoss: 4.1221, NetFixLoss: 0.0803, ]
2022-11-05 15:23:16,704 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2690, Pos_dist: 6.4098, Neg_dist: 9.0495, Acc: 0.6600, PTFixPNLoss: 4.1254, NetFixLoss: 0.1189, ]
2022-11-05 15:23:17,915 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1275, Pos_dist: 6.4133, Neg_dist: 10.1462, Acc: 0.6700, PTFixPNLoss: 4.1218, NetFixLoss: 0.1644, ]
2022-11-05 15:23:19,104 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3133, Pos_dist: 6.3736, Neg_dist: 8.8574, Acc: 0.7400, PTFixPNLoss: 4.1232, NetFixLoss: 0.2125, ]
2022-11-05 15:23:20,120 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2278, Pos_dist: 6.3556, Neg_dist: 9.2716, Acc: 0.6500, PTFixPNLoss: 4.1253, NetFixLoss: 0.2636, ]
2022-11-05 15:23:21,114 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1849, Pos_dist: 6.3375, Neg_dist: 9.0891, Acc: 0.7400, PTFixPNLoss: 4.1224, NetFixLoss: 0.3184, ]
2022-11-05 15:23:22,156 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1465, Pos_dist: 6.4089, Neg_dist: 9.7651, Acc: 0.6600, PTFixPNLoss: 4.1207, NetFixLoss: 0.3751, ]
2022-11-05 15:23:24,672 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1847, Pos_dist: 6.2838, Neg_dist: 9.5760, Acc: 0.7200, PTFixPNLoss: 4.1217, NetFixLoss: 0.4303, ]
2022-11-05 15:23:25,750 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0529, Pos_dist: 6.4431, Neg_dist: 10.8340, Acc: 0.6300, PTFixPNLoss: 4.1253, NetFixLoss: 0.4856, ]
2022-11-05 15:23:27,048 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1954, Pos_dist: 6.3847, Neg_dist: 9.5381, Acc: 0.6800, PTFixPNLoss: 4.1204, NetFixLoss: 0.5400, ]
2022-11-05 15:23:28,688 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2379, Pos_dist: 6.2620, Neg_dist: 9.0980, Acc: 0.7200, PTFixPNLoss: 4.1262, NetFixLoss: 0.5940, ]
2022-11-05 15:23:30,481 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3092, Pos_dist: 6.4520, Neg_dist: 8.8606, Acc: 0.6600, PTFixPNLoss: 4.1213, NetFixLoss: 0.6477, ]
2022-11-05 15:23:30,740 INFO: fine-tune procedure is finished!
2022-11-05 15:24:32,744 INFO: [Test_acc of task 4 on test 3: 0.52900][acc of former classes: 0.67767][acc of former samples in all classes: 0.63383]
[acc of novel samples in all classes: 0.21450]
2022-11-05 15:24:32,774 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:24:32,782 WARNING: Current net - loaded net:
2022-11-05 15:24:32,782 WARNING: Loaded net - current net:
2022-11-05 15:24:32,783 WARNING:   func.fc.bias
2022-11-05 15:24:32,783 WARNING:   func.fc.weight
2022-11-05 15:24:32,789 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_4.pth.
2022-11-05 15:24:32,800 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:24:32,813 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:24:32,813 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:24:32,813 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:24:32,814 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:24:32,814 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:24:32,814 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:24:32,815 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:24:32,816 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:24:32,817 INFO: Model [FSLLModel] is created.
2022-11-05 15:24:32,823 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:24:32,829 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:24:32,835 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:24:32,841 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:24:32,847 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 15:24:33,749 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2339, Pos_dist: 6.2568, Neg_dist: 9.0469, Acc: 0.7200, PTFixPNLoss: 4.1761, NetFixLoss: 0.0000, ]
2022-11-05 15:24:34,766 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1485, Pos_dist: 6.3142, Neg_dist: 9.6611, Acc: 0.6720, PTFixPNLoss: 4.1742, NetFixLoss: 0.0166, ]
2022-11-05 15:24:35,853 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.0982, Pos_dist: 6.2682, Neg_dist: 9.2988, Acc: 0.6480, PTFixPNLoss: 4.1759, NetFixLoss: 0.0370, ]
2022-11-05 15:24:36,960 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1874, Pos_dist: 6.2663, Neg_dist: 9.0577, Acc: 0.6800, PTFixPNLoss: 4.1746, NetFixLoss: 0.0620, ]
2022-11-05 15:24:38,108 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0587, Pos_dist: 6.2363, Neg_dist: 10.6267, Acc: 0.6880, PTFixPNLoss: 4.1715, NetFixLoss: 0.0904, ]
2022-11-05 15:24:39,470 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1490, Pos_dist: 6.2689, Neg_dist: 9.4406, Acc: 0.6800, PTFixPNLoss: 4.1739, NetFixLoss: 0.1209, ]
2022-11-05 15:24:40,838 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1519, Pos_dist: 6.3096, Neg_dist: 9.5819, Acc: 0.7120, PTFixPNLoss: 4.1762, NetFixLoss: 0.1530, ]
2022-11-05 15:24:42,134 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0360, Pos_dist: 6.3326, Neg_dist: 10.6117, Acc: 0.6720, PTFixPNLoss: 4.1768, NetFixLoss: 0.1894, ]
2022-11-05 15:24:43,249 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1203, Pos_dist: 6.3643, Neg_dist: 10.1677, Acc: 0.6880, PTFixPNLoss: 4.1756, NetFixLoss: 0.2255, ]
2022-11-05 15:24:44,525 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1477, Pos_dist: 6.2331, Neg_dist: 9.5317, Acc: 0.7120, PTFixPNLoss: 4.1759, NetFixLoss: 0.2616, ]
2022-11-05 15:24:46,010 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1130, Pos_dist: 6.2708, Neg_dist: 9.4861, Acc: 0.7120, PTFixPNLoss: 4.1776, NetFixLoss: 0.2979, ]
2022-11-05 15:24:47,519 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1249, Pos_dist: 6.3056, Neg_dist: 9.9717, Acc: 0.7440, PTFixPNLoss: 4.1747, NetFixLoss: 0.3373, ]
2022-11-05 15:24:48,935 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2184, Pos_dist: 6.2951, Neg_dist: 8.9777, Acc: 0.7200, PTFixPNLoss: 4.1754, NetFixLoss: 0.3759, ]
2022-11-05 15:24:50,212 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1148, Pos_dist: 6.2654, Neg_dist: 9.6323, Acc: 0.6880, PTFixPNLoss: 4.1748, NetFixLoss: 0.4164, ]
2022-11-05 15:24:51,495 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2027, Pos_dist: 6.2638, Neg_dist: 9.2942, Acc: 0.6880, PTFixPNLoss: 4.1745, NetFixLoss: 0.4569, ]
2022-11-05 15:24:51,651 INFO: fine-tune procedure is finished!
2022-11-05 15:25:53,413 INFO: [Test_acc of task 5 on test 3: 0.51388][acc of former classes: 0.69000][acc of former samples in all classes: 0.64017]
[acc of novel samples in all classes: 0.21080]
2022-11-05 15:25:53,445 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:25:53,454 WARNING: Current net - loaded net:
2022-11-05 15:25:53,454 WARNING: Loaded net - current net:
2022-11-05 15:25:53,454 WARNING:   func.fc.bias
2022-11-05 15:25:53,454 WARNING:   func.fc.weight
2022-11-05 15:25:53,459 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_5.pth.
2022-11-05 15:25:53,469 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:25:53,483 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:25:53,483 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:25:53,483 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:25:53,483 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:25:53,483 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:25:53,484 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:25:53,485 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:25:53,486 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:25:53,486 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:25:53,486 INFO: Model [FSLLModel] is created.
2022-11-05 15:25:53,493 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:25:53,499 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:25:53,504 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:25:53,509 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:25:53,515 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:25:53,520 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:25:54,480 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1378, Pos_dist: 6.1645, Neg_dist: 9.5040, Acc: 0.6667, PTFixPNLoss: 4.2253, NetFixLoss: 0.0000, ]
2022-11-05 15:25:55,562 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0822, Pos_dist: 6.1723, Neg_dist: 10.2129, Acc: 0.6800, PTFixPNLoss: 4.2267, NetFixLoss: 0.0147, ]
2022-11-05 15:25:56,728 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2479, Pos_dist: 6.1732, Neg_dist: 8.9841, Acc: 0.6467, PTFixPNLoss: 4.2281, NetFixLoss: 0.0307, ]
2022-11-05 15:25:57,974 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0541, Pos_dist: 6.2011, Neg_dist: 11.0474, Acc: 0.6667, PTFixPNLoss: 4.2278, NetFixLoss: 0.0519, ]
2022-11-05 15:25:59,400 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1984, Pos_dist: 6.1864, Neg_dist: 9.0760, Acc: 0.7067, PTFixPNLoss: 4.2278, NetFixLoss: 0.0746, ]
2022-11-05 15:26:00,743 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1828, Pos_dist: 6.2371, Neg_dist: 9.3584, Acc: 0.7067, PTFixPNLoss: 4.2273, NetFixLoss: 0.1007, ]
2022-11-05 15:26:02,052 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1762, Pos_dist: 6.1352, Neg_dist: 9.4844, Acc: 0.7133, PTFixPNLoss: 4.2239, NetFixLoss: 0.1298, ]
2022-11-05 15:26:03,262 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1501, Pos_dist: 6.1473, Neg_dist: 9.5717, Acc: 0.7067, PTFixPNLoss: 4.2267, NetFixLoss: 0.1602, ]
2022-11-05 15:26:04,512 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1477, Pos_dist: 6.1782, Neg_dist: 9.5944, Acc: 0.6733, PTFixPNLoss: 4.2249, NetFixLoss: 0.1936, ]
2022-11-05 15:26:05,924 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2221, Pos_dist: 6.0993, Neg_dist: 8.9431, Acc: 0.7333, PTFixPNLoss: 4.2285, NetFixLoss: 0.2311, ]
2022-11-05 15:26:08,512 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1783, Pos_dist: 6.1946, Neg_dist: 9.3995, Acc: 0.6733, PTFixPNLoss: 4.2252, NetFixLoss: 0.2735, ]
2022-11-05 15:26:10,117 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1026, Pos_dist: 6.1819, Neg_dist: 9.9649, Acc: 0.7533, PTFixPNLoss: 4.2255, NetFixLoss: 0.3165, ]
2022-11-05 15:26:11,648 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1828, Pos_dist: 6.2075, Neg_dist: 9.3385, Acc: 0.7000, PTFixPNLoss: 4.2270, NetFixLoss: 0.3599, ]
2022-11-05 15:26:13,088 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2385, Pos_dist: 6.2120, Neg_dist: 9.2190, Acc: 0.6600, PTFixPNLoss: 4.2266, NetFixLoss: 0.4044, ]
2022-11-05 15:26:14,753 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1443, Pos_dist: 6.1536, Neg_dist: 9.6775, Acc: 0.6467, PTFixPNLoss: 4.2250, NetFixLoss: 0.4512, ]
2022-11-05 15:26:14,960 INFO: fine-tune procedure is finished!
2022-11-05 15:27:20,180 INFO: [Test_acc of task 6 on test 3: 0.51356][acc of former classes: 0.70250][acc of former samples in all classes: 0.65000]
[acc of novel samples in all classes: 0.24067]
2022-11-05 15:27:20,209 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:27:20,216 WARNING: Current net - loaded net:
2022-11-05 15:27:20,217 WARNING: Loaded net - current net:
2022-11-05 15:27:20,217 WARNING:   func.fc.bias
2022-11-05 15:27:20,217 WARNING:   func.fc.weight
2022-11-05 15:27:20,222 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_6.pth.
2022-11-05 15:27:20,235 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:27:20,251 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:27:20,251 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:27:20,251 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:27:20,251 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:27:20,252 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:27:20,253 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:27:20,254 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:27:20,254 INFO: Model [FSLLModel] is created.
2022-11-05 15:27:20,264 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:27:20,270 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:27:20,275 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:27:20,281 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:27:20,286 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:27:20,292 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:27:20,297 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 15:27:21,675 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2402, Pos_dist: 6.1576, Neg_dist: 9.2471, Acc: 0.6914, PTFixPNLoss: 4.2822, NetFixLoss: 0.0000, ]
2022-11-05 15:27:23,274 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1475, Pos_dist: 6.1626, Neg_dist: 9.2955, Acc: 0.7143, PTFixPNLoss: 4.2807, NetFixLoss: 0.0174, ]
2022-11-05 15:27:24,946 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1105, Pos_dist: 6.2317, Neg_dist: 9.9540, Acc: 0.6686, PTFixPNLoss: 4.2846, NetFixLoss: 0.0371, ]
2022-11-05 15:27:26,563 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0917, Pos_dist: 6.1367, Neg_dist: 9.7870, Acc: 0.7543, PTFixPNLoss: 4.2836, NetFixLoss: 0.0595, ]
2022-11-05 15:27:28,222 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1238, Pos_dist: 6.1802, Neg_dist: 9.4869, Acc: 0.6914, PTFixPNLoss: 4.2823, NetFixLoss: 0.0843, ]
2022-11-05 15:27:29,459 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1308, Pos_dist: 6.1714, Neg_dist: 9.3326, Acc: 0.7200, PTFixPNLoss: 4.2816, NetFixLoss: 0.1110, ]
2022-11-05 15:27:31,267 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1700, Pos_dist: 6.1970, Neg_dist: 9.3772, Acc: 0.6743, PTFixPNLoss: 4.2820, NetFixLoss: 0.1426, ]
2022-11-05 15:27:33,066 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1815, Pos_dist: 6.1486, Neg_dist: 9.4161, Acc: 0.7029, PTFixPNLoss: 4.2810, NetFixLoss: 0.1751, ]
2022-11-05 15:27:34,781 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1380, Pos_dist: 6.1654, Neg_dist: 9.5007, Acc: 0.7371, PTFixPNLoss: 4.2810, NetFixLoss: 0.2095, ]
2022-11-05 15:27:36,639 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2100, Pos_dist: 6.1618, Neg_dist: 8.9300, Acc: 0.7029, PTFixPNLoss: 4.2849, NetFixLoss: 0.2453, ]
2022-11-05 15:27:38,281 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1135, Pos_dist: 6.1644, Neg_dist: 10.1115, Acc: 0.7143, PTFixPNLoss: 4.2799, NetFixLoss: 0.2851, ]
2022-11-05 15:27:40,087 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.0914, Pos_dist: 6.1486, Neg_dist: 10.3947, Acc: 0.6914, PTFixPNLoss: 4.2839, NetFixLoss: 0.3248, ]
2022-11-05 15:27:41,744 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2748, Pos_dist: 6.2174, Neg_dist: 8.7971, Acc: 0.6971, PTFixPNLoss: 4.2804, NetFixLoss: 0.3639, ]
2022-11-05 15:27:43,196 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1174, Pos_dist: 6.1684, Neg_dist: 10.0215, Acc: 0.6743, PTFixPNLoss: 4.2841, NetFixLoss: 0.4053, ]
2022-11-05 15:27:44,773 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1882, Pos_dist: 6.1991, Neg_dist: 9.3260, Acc: 0.6857, PTFixPNLoss: 4.2816, NetFixLoss: 0.4470, ]
2022-11-05 15:27:45,026 INFO: fine-tune procedure is finished!
2022-11-05 15:28:53,937 INFO: [Test_acc of task 7 on test 3: 0.49726][acc of former classes: 0.70350][acc of former samples in all classes: 0.64950]
[acc of novel samples in all classes: 0.23629]
2022-11-05 15:28:53,964 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:28:53,971 WARNING: Current net - loaded net:
2022-11-05 15:28:53,971 WARNING: Loaded net - current net:
2022-11-05 15:28:53,971 WARNING:   func.fc.bias
2022-11-05 15:28:53,971 WARNING:   func.fc.weight
2022-11-05 15:28:53,976 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_7.pth.
2022-11-05 15:28:53,988 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:28:54,003 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:28:54,003 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:28:54,003 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:28:54,003 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:28:54,003 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:28:54,004 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:28:54,005 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:28:54,006 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:28:54,006 INFO: Model [FSLLModel] is created.
2022-11-05 15:28:54,014 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:54,021 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:54,028 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:54,034 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:54,041 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:54,053 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:54,062 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:28:54,070 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:28:55,413 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1414, Pos_dist: 6.2518, Neg_dist: 9.8026, Acc: 0.7200, PTFixPNLoss: 4.3337, NetFixLoss: 0.0000, ]
2022-11-05 15:28:57,085 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0395, Pos_dist: 6.1880, Neg_dist: 10.9703, Acc: 0.7250, PTFixPNLoss: 4.3348, NetFixLoss: 0.0129, ]
2022-11-05 15:28:58,678 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2862, Pos_dist: 6.2329, Neg_dist: 8.7890, Acc: 0.6700, PTFixPNLoss: 4.3350, NetFixLoss: 0.0268, ]
2022-11-05 15:29:00,175 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0789, Pos_dist: 6.1323, Neg_dist: 9.9207, Acc: 0.6900, PTFixPNLoss: 4.3330, NetFixLoss: 0.0466, ]
2022-11-05 15:29:01,805 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1351, Pos_dist: 6.2194, Neg_dist: 9.8504, Acc: 0.6350, PTFixPNLoss: 4.3345, NetFixLoss: 0.0700, ]
2022-11-05 15:29:03,449 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2647, Pos_dist: 6.2370, Neg_dist: 9.1587, Acc: 0.6850, PTFixPNLoss: 4.3345, NetFixLoss: 0.0956, ]
2022-11-05 15:29:04,983 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1318, Pos_dist: 6.1804, Neg_dist: 9.5945, Acc: 0.7250, PTFixPNLoss: 4.3327, NetFixLoss: 0.1248, ]
2022-11-05 15:29:06,637 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1793, Pos_dist: 6.2243, Neg_dist: 9.6598, Acc: 0.7000, PTFixPNLoss: 4.3334, NetFixLoss: 0.1559, ]
2022-11-05 15:29:08,426 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1068, Pos_dist: 6.1674, Neg_dist: 10.2416, Acc: 0.7000, PTFixPNLoss: 4.3326, NetFixLoss: 0.1887, ]
2022-11-05 15:29:10,078 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0887, Pos_dist: 6.1668, Neg_dist: 10.5356, Acc: 0.6700, PTFixPNLoss: 4.3333, NetFixLoss: 0.2221, ]
2022-11-05 15:29:11,760 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1369, Pos_dist: 6.1683, Neg_dist: 9.6729, Acc: 0.6550, PTFixPNLoss: 4.3333, NetFixLoss: 0.2553, ]
2022-11-05 15:29:13,475 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1812, Pos_dist: 6.1910, Neg_dist: 9.4449, Acc: 0.7150, PTFixPNLoss: 4.3320, NetFixLoss: 0.2899, ]
2022-11-05 15:29:15,349 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2553, Pos_dist: 6.2461, Neg_dist: 8.8337, Acc: 0.6800, PTFixPNLoss: 4.3323, NetFixLoss: 0.3255, ]
2022-11-05 15:29:17,079 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1686, Pos_dist: 6.1891, Neg_dist: 9.6299, Acc: 0.6850, PTFixPNLoss: 4.3335, NetFixLoss: 0.3636, ]
2022-11-05 15:29:18,813 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0829, Pos_dist: 6.2046, Neg_dist: 9.9581, Acc: 0.6700, PTFixPNLoss: 4.3353, NetFixLoss: 0.4039, ]
2022-11-05 15:29:18,964 INFO: fine-tune procedure is finished!
2022-11-05 15:30:34,035 INFO: [Test_acc of task 8 on test 3: 0.47840][acc of former classes: 0.71067][acc of former samples in all classes: 0.64850]
[acc of novel samples in all classes: 0.22325]
2022-11-05 15:30:34,061 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:30:34,068 WARNING: Current net - loaded net:
2022-11-05 15:30:34,069 WARNING: Loaded net - current net:
2022-11-05 15:30:34,069 WARNING:   func.fc.bias
2022-11-05 15:30:34,069 WARNING:   func.fc.weight
2022-11-05 15:30:34,074 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-11-05 15:30:34,085 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:30:34,099 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:30:34,099 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:30:34,099 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:30:34,099 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:30:34,100 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:30:34,100 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:30:34,100 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:30:34,100 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:30:34,100 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:30:34,100 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:30:34,100 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:30:34,100 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:30:34,100 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:30:34,101 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:30:34,102 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:30:34,103 INFO: Model [FSLLModel] is created.
2022-11-05 15:30:34,111 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 15:30:34,901 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0975, Pos_dist: 6.3099, Neg_dist: 9.8976, Acc: 0.8000, PTFixPNLoss: 3.9023, NetFixLoss: 0.0000, ]
2022-11-05 15:30:36,236 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0715, Pos_dist: 6.4471, Neg_dist: 10.4297, Acc: 0.6400, PTFixPNLoss: 3.9009, NetFixLoss: 0.0223, ]
2022-11-05 15:30:37,330 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1334, Pos_dist: 6.4400, Neg_dist: 9.7952, Acc: 0.6000, PTFixPNLoss: 3.9042, NetFixLoss: 0.0519, ]
2022-11-05 15:30:38,261 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0418, Pos_dist: 6.3086, Neg_dist: 10.2741, Acc: 0.6800, PTFixPNLoss: 3.8973, NetFixLoss: 0.0919, ]
2022-11-05 15:30:39,268 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1108, Pos_dist: 6.2828, Neg_dist: 9.6854, Acc: 0.6800, PTFixPNLoss: 3.8979, NetFixLoss: 0.1362, ]
2022-11-05 15:30:40,422 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1511, Pos_dist: 6.3219, Neg_dist: 10.3049, Acc: 0.6400, PTFixPNLoss: 3.9003, NetFixLoss: 0.1820, ]
2022-11-05 15:30:41,491 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1908, Pos_dist: 6.4860, Neg_dist: 10.0124, Acc: 0.6800, PTFixPNLoss: 3.9021, NetFixLoss: 0.2307, ]
2022-11-05 15:30:42,251 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0980, Pos_dist: 6.1912, Neg_dist: 9.8345, Acc: 0.6400, PTFixPNLoss: 3.8903, NetFixLoss: 0.2871, ]
2022-11-05 15:30:43,346 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0881, Pos_dist: 6.3601, Neg_dist: 10.1475, Acc: 0.6000, PTFixPNLoss: 3.9071, NetFixLoss: 0.3463, ]
2022-11-05 15:30:44,324 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0582, Pos_dist: 6.5836, Neg_dist: 10.0974, Acc: 0.7200, PTFixPNLoss: 3.9054, NetFixLoss: 0.4067, ]
2022-11-05 15:30:45,475 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1231, Pos_dist: 6.3514, Neg_dist: 9.5910, Acc: 0.6800, PTFixPNLoss: 3.8992, NetFixLoss: 0.4701, ]
2022-11-05 15:30:46,366 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1552, Pos_dist: 6.4307, Neg_dist: 9.6919, Acc: 0.6400, PTFixPNLoss: 3.9007, NetFixLoss: 0.5383, ]
2022-11-05 15:30:47,439 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0615, Pos_dist: 6.2906, Neg_dist: 9.8594, Acc: 0.6800, PTFixPNLoss: 3.8989, NetFixLoss: 0.6109, ]
2022-11-05 15:30:48,541 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0875, Pos_dist: 6.4715, Neg_dist: 10.0546, Acc: 0.6400, PTFixPNLoss: 3.8984, NetFixLoss: 0.6823, ]
2022-11-05 15:30:49,527 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.0933, Pos_dist: 6.3614, Neg_dist: 10.0316, Acc: 0.6800, PTFixPNLoss: 3.9026, NetFixLoss: 0.7579, ]
2022-11-05 15:30:49,858 INFO: fine-tune procedure is finished!
2022-11-05 15:31:46,495 INFO: [Test_acc of task 1 on test 4: 0.64123][acc of former classes: 0.68550][acc of former samples in all classes: 0.67633]
[acc of novel samples in all classes: 0.22000]
2022-11-05 15:31:46,526 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:31:46,541 WARNING: Current net - loaded net:
2022-11-05 15:31:46,541 WARNING: Loaded net - current net:
2022-11-05 15:31:46,541 WARNING:   func.fc.bias
2022-11-05 15:31:46,541 WARNING:   func.fc.weight
2022-11-05 15:31:46,548 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_1.pth.
2022-11-05 15:31:46,562 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:31:46,590 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:31:46,591 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:31:46,591 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:31:46,592 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:31:46,593 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:31:46,593 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:31:46,593 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:31:46,593 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:31:46,593 INFO: Model [FSLLModel] is created.
2022-11-05 15:31:46,621 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:31:46,630 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:31:47,865 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1519, Pos_dist: 6.4832, Neg_dist: 9.8003, Acc: 0.5800, PTFixPNLoss: 3.9856, NetFixLoss: 0.0000, ]
2022-11-05 15:31:49,263 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2334, Pos_dist: 6.5287, Neg_dist: 9.2690, Acc: 0.6600, PTFixPNLoss: 3.9840, NetFixLoss: 0.0188, ]
2022-11-05 15:31:50,395 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1527, Pos_dist: 6.4664, Neg_dist: 9.8076, Acc: 0.6800, PTFixPNLoss: 3.9860, NetFixLoss: 0.0468, ]
2022-11-05 15:31:52,056 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1863, Pos_dist: 6.4492, Neg_dist: 9.3258, Acc: 0.6000, PTFixPNLoss: 3.9845, NetFixLoss: 0.0816, ]
2022-11-05 15:31:53,351 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1451, Pos_dist: 6.6050, Neg_dist: 10.1567, Acc: 0.6200, PTFixPNLoss: 3.9864, NetFixLoss: 0.1238, ]
2022-11-05 15:31:54,706 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.0921, Pos_dist: 6.4568, Neg_dist: 10.4688, Acc: 0.5800, PTFixPNLoss: 3.9836, NetFixLoss: 0.1695, ]
2022-11-05 15:31:55,941 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1212, Pos_dist: 6.3847, Neg_dist: 9.6199, Acc: 0.6400, PTFixPNLoss: 3.9819, NetFixLoss: 0.2178, ]
2022-11-05 15:31:57,472 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2638, Pos_dist: 6.4639, Neg_dist: 9.1285, Acc: 0.6400, PTFixPNLoss: 3.9891, NetFixLoss: 0.2724, ]
2022-11-05 15:31:58,808 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1897, Pos_dist: 6.4327, Neg_dist: 9.3929, Acc: 0.6200, PTFixPNLoss: 3.9788, NetFixLoss: 0.3255, ]
2022-11-05 15:31:59,903 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2671, Pos_dist: 6.5331, Neg_dist: 9.1932, Acc: 0.6800, PTFixPNLoss: 3.9846, NetFixLoss: 0.3823, ]
2022-11-05 15:32:01,037 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1728, Pos_dist: 6.5149, Neg_dist: 9.5349, Acc: 0.7000, PTFixPNLoss: 3.9815, NetFixLoss: 0.4461, ]
2022-11-05 15:32:02,146 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2779, Pos_dist: 6.4041, Neg_dist: 9.6682, Acc: 0.6200, PTFixPNLoss: 3.9825, NetFixLoss: 0.5139, ]
2022-11-05 15:32:03,476 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1702, Pos_dist: 6.5043, Neg_dist: 9.3939, Acc: 0.6400, PTFixPNLoss: 3.9863, NetFixLoss: 0.5847, ]
2022-11-05 15:32:04,644 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1829, Pos_dist: 6.4070, Neg_dist: 9.5298, Acc: 0.6600, PTFixPNLoss: 3.9838, NetFixLoss: 0.6566, ]
2022-11-05 15:32:05,923 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2713, Pos_dist: 6.5408, Neg_dist: 9.0038, Acc: 0.6800, PTFixPNLoss: 3.9895, NetFixLoss: 0.7280, ]
2022-11-05 15:32:06,084 INFO: fine-tune procedure is finished!
2022-11-05 15:33:10,261 INFO: [Test_acc of task 2 on test 4: 0.59643][acc of former classes: 0.68050][acc of former samples in all classes: 0.66050]
[acc of novel samples in all classes: 0.21200]
2022-11-05 15:33:10,306 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:33:10,393 WARNING: Current net - loaded net:
2022-11-05 15:33:10,393 WARNING: Loaded net - current net:
2022-11-05 15:33:10,393 WARNING:   func.fc.bias
2022-11-05 15:33:10,393 WARNING:   func.fc.weight
2022-11-05 15:33:10,398 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_2.pth.
2022-11-05 15:33:10,410 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:33:10,424 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:33:10,425 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:33:10,425 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:33:10,426 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:33:10,427 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:33:10,427 INFO: Model [FSLLModel] is created.
2022-11-05 15:33:10,435 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:33:10,444 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:33:10,453 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 15:33:12,071 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1497, Pos_dist: 6.4946, Neg_dist: 10.8621, Acc: 0.6133, PTFixPNLoss: 4.0495, NetFixLoss: 0.0000, ]
2022-11-05 15:33:13,287 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2713, Pos_dist: 6.5134, Neg_dist: 9.5965, Acc: 0.6267, PTFixPNLoss: 4.0482, NetFixLoss: 0.0159, ]
2022-11-05 15:33:14,899 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4010, Pos_dist: 6.6146, Neg_dist: 8.8452, Acc: 0.6267, PTFixPNLoss: 4.0497, NetFixLoss: 0.0425, ]
2022-11-05 15:33:16,351 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1783, Pos_dist: 6.5052, Neg_dist: 9.5763, Acc: 0.7067, PTFixPNLoss: 4.0495, NetFixLoss: 0.0788, ]
2022-11-05 15:33:17,778 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1325, Pos_dist: 6.4732, Neg_dist: 9.8894, Acc: 0.6667, PTFixPNLoss: 4.0454, NetFixLoss: 0.1215, ]
2022-11-05 15:33:18,955 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2166, Pos_dist: 6.4953, Neg_dist: 9.4876, Acc: 0.6667, PTFixPNLoss: 4.0482, NetFixLoss: 0.1668, ]
2022-11-05 15:33:20,217 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2277, Pos_dist: 6.5611, Neg_dist: 9.2796, Acc: 0.6400, PTFixPNLoss: 4.0472, NetFixLoss: 0.2145, ]
2022-11-05 15:33:21,531 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2587, Pos_dist: 6.5404, Neg_dist: 10.3500, Acc: 0.5733, PTFixPNLoss: 4.0520, NetFixLoss: 0.2683, ]
2022-11-05 15:33:22,814 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1884, Pos_dist: 6.6020, Neg_dist: 9.7332, Acc: 0.5600, PTFixPNLoss: 4.0524, NetFixLoss: 0.3237, ]
2022-11-05 15:33:24,060 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1789, Pos_dist: 6.4806, Neg_dist: 9.5377, Acc: 0.6267, PTFixPNLoss: 4.0463, NetFixLoss: 0.3831, ]
2022-11-05 15:33:25,365 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2034, Pos_dist: 6.4535, Neg_dist: 9.6282, Acc: 0.6133, PTFixPNLoss: 4.0496, NetFixLoss: 0.4461, ]
2022-11-05 15:33:26,706 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2357, Pos_dist: 6.5302, Neg_dist: 9.5335, Acc: 0.6000, PTFixPNLoss: 4.0486, NetFixLoss: 0.5098, ]
2022-11-05 15:33:28,241 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2066, Pos_dist: 6.4789, Neg_dist: 9.8966, Acc: 0.6800, PTFixPNLoss: 4.0510, NetFixLoss: 0.5787, ]
2022-11-05 15:33:29,514 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1693, Pos_dist: 6.4762, Neg_dist: 9.7516, Acc: 0.6667, PTFixPNLoss: 4.0478, NetFixLoss: 0.6495, ]
2022-11-05 15:33:30,690 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2550, Pos_dist: 6.5407, Neg_dist: 9.7548, Acc: 0.6133, PTFixPNLoss: 4.0496, NetFixLoss: 0.7199, ]
2022-11-05 15:33:31,040 INFO: fine-tune procedure is finished!
2022-11-05 15:34:38,448 INFO: [Test_acc of task 3 on test 4: 0.54507][acc of former classes: 0.65933][acc of former samples in all classes: 0.62967]
[acc of novel samples in all classes: 0.20667]
2022-11-05 15:34:38,473 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:34:38,527 WARNING: Current net - loaded net:
2022-11-05 15:34:38,527 WARNING: Loaded net - current net:
2022-11-05 15:34:38,527 WARNING:   func.fc.bias
2022-11-05 15:34:38,527 WARNING:   func.fc.weight
2022-11-05 15:34:38,561 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_3.pth.
2022-11-05 15:34:38,574 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:34:38,599 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:34:38,599 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:34:38,599 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:34:38,599 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:34:38,599 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:34:38,600 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:34:38,600 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:34:38,600 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:34:38,600 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:34:38,600 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:34:38,600 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:34:38,600 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:34:38,600 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:34:38,600 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:34:38,600 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:34:38,600 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:34:38,600 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:34:38,600 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:34:38,600 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:34:38,601 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:34:38,602 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:34:38,603 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:34:38,603 INFO: Model [FSLLModel] is created.
2022-11-05 15:34:38,613 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:34:38,622 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:34:38,631 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:34:38,640 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:34:39,831 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.0887, Pos_dist: 6.3087, Neg_dist: 10.5268, Acc: 0.6900, PTFixPNLoss: 4.1138, NetFixLoss: 0.0000, ]
2022-11-05 15:34:41,260 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1746, Pos_dist: 6.3487, Neg_dist: 9.6458, Acc: 0.6500, PTFixPNLoss: 4.1153, NetFixLoss: 0.0120, ]
2022-11-05 15:34:42,528 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1365, Pos_dist: 6.5435, Neg_dist: 10.0881, Acc: 0.6300, PTFixPNLoss: 4.1194, NetFixLoss: 0.0290, ]
2022-11-05 15:34:44,000 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0890, Pos_dist: 6.4086, Neg_dist: 10.6721, Acc: 0.6400, PTFixPNLoss: 4.1174, NetFixLoss: 0.0542, ]
2022-11-05 15:34:45,590 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2493, Pos_dist: 6.4932, Neg_dist: 9.0477, Acc: 0.6600, PTFixPNLoss: 4.1177, NetFixLoss: 0.0849, ]
2022-11-05 15:34:47,011 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3053, Pos_dist: 6.3981, Neg_dist: 9.5474, Acc: 0.6300, PTFixPNLoss: 4.1186, NetFixLoss: 0.1197, ]
2022-11-05 15:34:48,641 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2868, Pos_dist: 6.3340, Neg_dist: 8.5906, Acc: 0.6100, PTFixPNLoss: 4.1152, NetFixLoss: 0.1580, ]
2022-11-05 15:34:49,938 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1121, Pos_dist: 6.3778, Neg_dist: 9.8780, Acc: 0.6400, PTFixPNLoss: 4.1166, NetFixLoss: 0.2011, ]
2022-11-05 15:34:51,374 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1398, Pos_dist: 6.2909, Neg_dist: 9.3656, Acc: 0.6700, PTFixPNLoss: 4.1127, NetFixLoss: 0.2460, ]
2022-11-05 15:34:52,930 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1626, Pos_dist: 6.3699, Neg_dist: 9.3137, Acc: 0.6100, PTFixPNLoss: 4.1139, NetFixLoss: 0.2927, ]
2022-11-05 15:34:54,494 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3621, Pos_dist: 6.4525, Neg_dist: 8.8872, Acc: 0.6500, PTFixPNLoss: 4.1154, NetFixLoss: 0.3418, ]
2022-11-05 15:34:55,743 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1752, Pos_dist: 6.4480, Neg_dist: 9.7408, Acc: 0.6800, PTFixPNLoss: 4.1181, NetFixLoss: 0.3934, ]
2022-11-05 15:34:56,989 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3677, Pos_dist: 6.4633, Neg_dist: 8.8653, Acc: 0.6700, PTFixPNLoss: 4.1176, NetFixLoss: 0.4456, ]
2022-11-05 15:34:58,746 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2022, Pos_dist: 6.3746, Neg_dist: 9.6589, Acc: 0.6900, PTFixPNLoss: 4.1174, NetFixLoss: 0.5015, ]
2022-11-05 15:34:59,979 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1292, Pos_dist: 6.3854, Neg_dist: 9.5272, Acc: 0.6700, PTFixPNLoss: 4.1176, NetFixLoss: 0.5600, ]
2022-11-05 15:35:00,157 INFO: fine-tune procedure is finished!
2022-11-05 15:36:06,179 INFO: [Test_acc of task 4 on test 4: 0.52663][acc of former classes: 0.67483][acc of former samples in all classes: 0.63617]
[acc of novel samples in all classes: 0.19800]
2022-11-05 15:36:06,202 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:36:06,208 WARNING: Current net - loaded net:
2022-11-05 15:36:06,208 WARNING: Loaded net - current net:
2022-11-05 15:36:06,208 WARNING:   func.fc.bias
2022-11-05 15:36:06,208 WARNING:   func.fc.weight
2022-11-05 15:36:06,213 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_4.pth.
2022-11-05 15:36:06,223 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:36:06,236 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:36:06,237 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:36:06,237 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:36:06,237 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:36:06,238 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:36:06,239 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:36:06,240 INFO: Model [FSLLModel] is created.
2022-11-05 15:36:06,246 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:36:06,252 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:36:06,257 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:36:06,263 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:36:06,268 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 15:36:07,323 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1851, Pos_dist: 6.2721, Neg_dist: 9.1916, Acc: 0.6880, PTFixPNLoss: 4.1697, NetFixLoss: 0.0000, ]
2022-11-05 15:36:09,014 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.0397, Pos_dist: 6.2861, Neg_dist: 11.7029, Acc: 0.6320, PTFixPNLoss: 4.1652, NetFixLoss: 0.0149, ]
2022-11-05 15:36:10,593 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2298, Pos_dist: 6.3083, Neg_dist: 9.3845, Acc: 0.6560, PTFixPNLoss: 4.1710, NetFixLoss: 0.0301, ]
2022-11-05 15:36:11,802 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1493, Pos_dist: 6.3795, Neg_dist: 10.4746, Acc: 0.6560, PTFixPNLoss: 4.1702, NetFixLoss: 0.0507, ]
2022-11-05 15:36:13,261 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1503, Pos_dist: 6.4035, Neg_dist: 9.5132, Acc: 0.6240, PTFixPNLoss: 4.1707, NetFixLoss: 0.0764, ]
2022-11-05 15:36:14,705 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2222, Pos_dist: 6.3231, Neg_dist: 9.5577, Acc: 0.6800, PTFixPNLoss: 4.1703, NetFixLoss: 0.1101, ]
2022-11-05 15:36:16,044 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2570, Pos_dist: 6.3964, Neg_dist: 9.3984, Acc: 0.6320, PTFixPNLoss: 4.1714, NetFixLoss: 0.1455, ]
2022-11-05 15:36:17,721 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1679, Pos_dist: 6.4088, Neg_dist: 9.6004, Acc: 0.6000, PTFixPNLoss: 4.1717, NetFixLoss: 0.1846, ]
2022-11-05 15:36:19,003 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2229, Pos_dist: 6.3770, Neg_dist: 10.0223, Acc: 0.6640, PTFixPNLoss: 4.1711, NetFixLoss: 0.2309, ]
2022-11-05 15:36:20,501 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1511, Pos_dist: 6.4134, Neg_dist: 10.3914, Acc: 0.6640, PTFixPNLoss: 4.1707, NetFixLoss: 0.2770, ]
2022-11-05 15:36:21,814 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1295, Pos_dist: 6.3295, Neg_dist: 9.6538, Acc: 0.6160, PTFixPNLoss: 4.1696, NetFixLoss: 0.3249, ]
2022-11-05 15:36:23,285 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1245, Pos_dist: 6.4332, Neg_dist: 10.0251, Acc: 0.5920, PTFixPNLoss: 4.1751, NetFixLoss: 0.3733, ]
2022-11-05 15:36:25,382 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1338, Pos_dist: 6.3302, Neg_dist: 9.8413, Acc: 0.6560, PTFixPNLoss: 4.1689, NetFixLoss: 0.4210, ]
2022-11-05 15:36:26,922 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1821, Pos_dist: 6.3338, Neg_dist: 9.4990, Acc: 0.6160, PTFixPNLoss: 4.1682, NetFixLoss: 0.4694, ]
2022-11-05 15:36:28,615 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1515, Pos_dist: 6.2972, Neg_dist: 9.5261, Acc: 0.6720, PTFixPNLoss: 4.1709, NetFixLoss: 0.5186, ]
2022-11-05 15:36:28,756 INFO: fine-tune procedure is finished!
2022-11-05 15:37:36,045 INFO: [Test_acc of task 5 on test 4: 0.51718][acc of former classes: 0.69167][acc of former samples in all classes: 0.64667]
[acc of novel samples in all classes: 0.20640]
2022-11-05 15:37:36,075 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:37:36,083 WARNING: Current net - loaded net:
2022-11-05 15:37:36,083 WARNING: Loaded net - current net:
2022-11-05 15:37:36,083 WARNING:   func.fc.bias
2022-11-05 15:37:36,083 WARNING:   func.fc.weight
2022-11-05 15:37:36,089 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_5.pth.
2022-11-05 15:37:36,119 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:37:36,136 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:37:36,136 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:37:36,136 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:37:36,136 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:37:36,136 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:37:36,137 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:37:36,137 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:37:36,137 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:37:36,137 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:37:36,137 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:37:36,137 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:37:36,137 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:37:36,137 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:37:36,137 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:37:36,137 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:37:36,137 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:37:36,137 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:37:36,137 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:37:36,138 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:37:36,139 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:37:36,140 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:37:36,140 INFO: Model [FSLLModel] is created.
2022-11-05 15:37:36,151 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:36,160 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:36,169 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:36,177 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:36,185 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:37:36,193 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:37:37,747 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3185, Pos_dist: 6.3879, Neg_dist: 8.8084, Acc: 0.6400, PTFixPNLoss: 4.2288, NetFixLoss: 0.0000, ]
2022-11-05 15:37:39,489 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1458, Pos_dist: 6.3750, Neg_dist: 9.6519, Acc: 0.6267, PTFixPNLoss: 4.2291, NetFixLoss: 0.0197, ]
2022-11-05 15:37:41,136 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1633, Pos_dist: 6.4161, Neg_dist: 9.8623, Acc: 0.6400, PTFixPNLoss: 4.2319, NetFixLoss: 0.0424, ]
2022-11-05 15:37:42,633 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1822, Pos_dist: 6.3762, Neg_dist: 9.6114, Acc: 0.6600, PTFixPNLoss: 4.2271, NetFixLoss: 0.0690, ]
2022-11-05 15:37:44,203 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2281, Pos_dist: 6.3256, Neg_dist: 9.2975, Acc: 0.6600, PTFixPNLoss: 4.2267, NetFixLoss: 0.0987, ]
2022-11-05 15:37:46,140 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1837, Pos_dist: 6.3733, Neg_dist: 9.5405, Acc: 0.5933, PTFixPNLoss: 4.2298, NetFixLoss: 0.1317, ]
2022-11-05 15:37:47,666 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1624, Pos_dist: 6.3476, Neg_dist: 10.2414, Acc: 0.6667, PTFixPNLoss: 4.2319, NetFixLoss: 0.1672, ]
2022-11-05 15:37:49,377 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.0606, Pos_dist: 6.3731, Neg_dist: 10.5663, Acc: 0.6133, PTFixPNLoss: 4.2314, NetFixLoss: 0.2042, ]
2022-11-05 15:37:51,050 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2309, Pos_dist: 6.3297, Neg_dist: 9.2302, Acc: 0.6400, PTFixPNLoss: 4.2307, NetFixLoss: 0.2420, ]
2022-11-05 15:37:52,448 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2130, Pos_dist: 6.3762, Neg_dist: 9.4586, Acc: 0.6200, PTFixPNLoss: 4.2314, NetFixLoss: 0.2808, ]
2022-11-05 15:37:54,369 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2809, Pos_dist: 6.2889, Neg_dist: 9.0861, Acc: 0.6600, PTFixPNLoss: 4.2295, NetFixLoss: 0.3211, ]
2022-11-05 15:37:55,999 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2054, Pos_dist: 6.3443, Neg_dist: 9.6032, Acc: 0.6067, PTFixPNLoss: 4.2291, NetFixLoss: 0.3642, ]
2022-11-05 15:37:57,635 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2354, Pos_dist: 6.3710, Neg_dist: 9.0783, Acc: 0.6333, PTFixPNLoss: 4.2306, NetFixLoss: 0.4122, ]
2022-11-05 15:37:59,029 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.0646, Pos_dist: 6.3611, Neg_dist: 10.4995, Acc: 0.6600, PTFixPNLoss: 4.2301, NetFixLoss: 0.4639, ]
2022-11-05 15:38:01,044 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2213, Pos_dist: 6.3617, Neg_dist: 9.5008, Acc: 0.6267, PTFixPNLoss: 4.2256, NetFixLoss: 0.5134, ]
2022-11-05 15:38:01,329 INFO: fine-tune procedure is finished!
2022-11-05 15:39:09,595 INFO: [Test_acc of task 6 on test 4: 0.50889][acc of former classes: 0.70233][acc of former samples in all classes: 0.65533]
[acc of novel samples in all classes: 0.21600]
2022-11-05 15:39:09,615 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:39:09,621 WARNING: Current net - loaded net:
2022-11-05 15:39:09,621 WARNING: Loaded net - current net:
2022-11-05 15:39:09,621 WARNING:   func.fc.bias
2022-11-05 15:39:09,621 WARNING:   func.fc.weight
2022-11-05 15:39:09,625 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_6.pth.
2022-11-05 15:39:09,634 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:39:09,646 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:39:09,646 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:39:09,647 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:39:09,648 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:39:09,649 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:39:09,649 INFO: Model [FSLLModel] is created.
2022-11-05 15:39:09,655 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:09,661 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:09,670 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:09,675 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:09,681 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:09,686 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:39:09,691 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 15:39:10,963 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1029, Pos_dist: 6.4015, Neg_dist: 10.9826, Acc: 0.5829, PTFixPNLoss: 4.2871, NetFixLoss: 0.0000, ]
2022-11-05 15:39:12,448 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1919, Pos_dist: 6.3630, Neg_dist: 9.6641, Acc: 0.6114, PTFixPNLoss: 4.2846, NetFixLoss: 0.0109, ]
2022-11-05 15:39:13,916 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1670, Pos_dist: 6.3481, Neg_dist: 9.6186, Acc: 0.6571, PTFixPNLoss: 4.2862, NetFixLoss: 0.0300, ]
2022-11-05 15:39:15,342 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2486, Pos_dist: 6.4414, Neg_dist: 9.5621, Acc: 0.6000, PTFixPNLoss: 4.2861, NetFixLoss: 0.0533, ]
2022-11-05 15:39:17,258 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0965, Pos_dist: 6.4591, Neg_dist: 10.7207, Acc: 0.6000, PTFixPNLoss: 4.2876, NetFixLoss: 0.0819, ]
2022-11-05 15:39:18,829 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2167, Pos_dist: 6.3902, Neg_dist: 9.8811, Acc: 0.6343, PTFixPNLoss: 4.2842, NetFixLoss: 0.1128, ]
2022-11-05 15:39:20,488 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2033, Pos_dist: 6.4219, Neg_dist: 9.6420, Acc: 0.6057, PTFixPNLoss: 4.2857, NetFixLoss: 0.1448, ]
2022-11-05 15:39:21,848 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1575, Pos_dist: 6.3329, Neg_dist: 10.0295, Acc: 0.6229, PTFixPNLoss: 4.2860, NetFixLoss: 0.1782, ]
2022-11-05 15:39:23,311 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1989, Pos_dist: 6.4233, Neg_dist: 9.7086, Acc: 0.6457, PTFixPNLoss: 4.2854, NetFixLoss: 0.2138, ]
2022-11-05 15:39:24,722 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2093, Pos_dist: 6.4061, Neg_dist: 9.4222, Acc: 0.6114, PTFixPNLoss: 4.2834, NetFixLoss: 0.2501, ]
2022-11-05 15:39:26,404 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2676, Pos_dist: 6.4504, Neg_dist: 9.6647, Acc: 0.5657, PTFixPNLoss: 4.2855, NetFixLoss: 0.2885, ]
2022-11-05 15:39:27,900 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1420, Pos_dist: 6.3650, Neg_dist: 9.8838, Acc: 0.6571, PTFixPNLoss: 4.2866, NetFixLoss: 0.3301, ]
2022-11-05 15:39:29,419 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2306, Pos_dist: 6.3901, Neg_dist: 10.0075, Acc: 0.6229, PTFixPNLoss: 4.2841, NetFixLoss: 0.3714, ]
2022-11-05 15:39:31,050 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2338, Pos_dist: 6.3676, Neg_dist: 9.6107, Acc: 0.6457, PTFixPNLoss: 4.2847, NetFixLoss: 0.4147, ]
2022-11-05 15:39:32,422 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1156, Pos_dist: 6.3503, Neg_dist: 10.1607, Acc: 0.6000, PTFixPNLoss: 4.2875, NetFixLoss: 0.4598, ]
2022-11-05 15:39:32,549 INFO: fine-tune procedure is finished!
2022-11-05 15:40:42,980 INFO: [Test_acc of task 7 on test 4: 0.49158][acc of former classes: 0.70550][acc of former samples in all classes: 0.65400]
[acc of novel samples in all classes: 0.21314]
2022-11-05 15:40:43,047 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-11-05 15:40:43,056 WARNING: Current net - loaded net:
2022-11-05 15:40:43,057 WARNING: Loaded net - current net:
2022-11-05 15:40:43,057 WARNING:   func.fc.bias
2022-11-05 15:40:43,057 WARNING:   func.fc.weight
2022-11-05 15:40:43,065 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_7.pth.
2022-11-05 15:40:43,078 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer1.1.bn2.bias.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer2.0.bn1.bias.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer2.0.bn2.bias.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer2.0.downsample.1.bias.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer2.1.conv2.weight.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer2.1.bn2.bias.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer2.2.conv2.weight.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer2.2.bn2.bias.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer3.1.conv2.weight.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer3.2.conv1.weight.
2022-11-05 15:40:43,092 INFO: Optimize parameters: func.layer3.2.bn2.bias.
2022-11-05 15:40:43,092 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:40:43,092 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:40:43,093 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:40:43,094 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.1.conv1.weight will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.2.conv2.weight will not be optimized.
2022-11-05 15:40:43,095 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:40:43,095 INFO: Model [FSLLModel] is created.
2022-11-05 15:40:43,103 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:40:43,109 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:40:43,116 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:40:43,122 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:40:43,128 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:40:43,134 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:40:43,140 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:40:43,147 INFO: Dataset NormalDataset - cifar-100 is created.
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/FSIL_CFRPModel_res18_small_cifar_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:40:44,270 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1297, Pos_dist: 6.3254, Neg_dist: 9.9652, Acc: 0.6500, PTFixPNLoss: 4.3328, NetFixLoss: 0.0000, ]
2022-11-05 15:40:45,887 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1649, Pos_dist: 6.4017, Neg_dist: 9.8542, Acc: 0.6200, PTFixPNLoss: 4.3296, NetFixLoss: 0.0138, ]
2022-11-05 15:40:47,652 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2539, Pos_dist: 6.3793, Neg_dist: 9.2483, Acc: 0.6300, PTFixPNLoss: 4.3317, NetFixLoss: 0.0316, ]
2022-11-05 15:40:49,648 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1856, Pos_dist: 6.4427, Neg_dist: 9.7789, Acc: 0.6150, PTFixPNLoss: 4.3354, NetFixLoss: 0.0559, ]
2022-11-05 15:40:51,454 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.0891, Pos_dist: 6.2935, Neg_dist: 10.1365, Acc: 0.6700, PTFixPNLoss: 4.3325, NetFixLoss: 0.0840, ]
2022-11-05 15:40:52,975 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2620, Pos_dist: 6.3543, Neg_dist: 9.1583, Acc: 0.6050, PTFixPNLoss: 4.3315, NetFixLoss: 0.1135, ]
2022-11-05 15:40:54,723 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1367, Pos_dist: 6.3773, Neg_dist: 10.2676, Acc: 0.6100, PTFixPNLoss: 4.3351, NetFixLoss: 0.1455, ]
2022-11-05 15:40:56,640 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2736, Pos_dist: 6.3615, Neg_dist: 9.6567, Acc: 0.6200, PTFixPNLoss: 4.3308, NetFixLoss: 0.1808, ]
2022-11-05 15:40:58,352 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3178, Pos_dist: 6.3011, Neg_dist: 8.8857, Acc: 0.6250, PTFixPNLoss: 4.3296, NetFixLoss: 0.2176, ]
2022-11-05 15:40:59,908 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2325, Pos_dist: 6.4122, Neg_dist: 9.5037, Acc: 0.6000, PTFixPNLoss: 4.3356, NetFixLoss: 0.2561, ]
2022-11-05 15:41:01,415 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1833, Pos_dist: 6.3548, Neg_dist: 9.6227, Acc: 0.6150, PTFixPNLoss: 4.3305, NetFixLoss: 0.2966, ]
2022-11-05 15:41:03,084 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2769, Pos_dist: 6.3447, Neg_dist: 8.9516, Acc: 0.6100, PTFixPNLoss: 4.3317, NetFixLoss: 0.3382, ]
2022-11-05 15:41:04,588 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.0918, Pos_dist: 6.3302, Neg_dist: 10.3244, Acc: 0.6050, PTFixPNLoss: 4.3330, NetFixLoss: 0.3830, ]
2022-11-05 15:41:06,086 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1564, Pos_dist: 6.4178, Neg_dist: 10.0556, Acc: 0.6500, PTFixPNLoss: 4.3334, NetFixLoss: 0.4273, ]
2022-11-05 15:41:07,626 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1472, Pos_dist: 6.3309, Neg_dist: 10.0332, Acc: 0.6200, PTFixPNLoss: 4.3336, NetFixLoss: 0.4713, ]
2022-11-05 15:41:07,881 INFO: fine-tune procedure is finished!
2022-11-05 15:42:20,806 INFO: [Test_acc of task 8 on test 4: 0.47460][acc of former classes: 0.71017][acc of former samples in all classes: 0.65350]
[acc of novel samples in all classes: 0.20625]
2022-11-05 15:42:20,818 INFO: --------------------------Final Avg Acc-------------------------
2022-11-05 15:42:20,818 INFO: Session 1: 72.52+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7252]
2022-11-05 15:42:20,818 INFO: Session 2: 64.20+-0.67[acc of former classes: 0.6841][acc of former samples in all classes: 0.6755]
[acc of novel samples in all classes: 0.2408]
2022-11-05 15:42:20,818 INFO: Session 3: 59.60+-0.72[acc of former classes: 0.6770][acc of former samples in all classes: 0.6564]
[acc of novel samples in all classes: 0.2332]
2022-11-05 15:42:20,818 INFO: Session 4: 55.09+-0.53[acc of former classes: 0.6657][acc of former samples in all classes: 0.6344]
[acc of novel samples in all classes: 0.2169]
2022-11-05 15:42:20,818 INFO: Session 5: 52.85+-0.30[acc of former classes: 0.6755][acc of former samples in all classes: 0.6364]
[acc of novel samples in all classes: 0.2045]
2022-11-05 15:42:20,818 INFO: Session 6: 51.57+-0.10[acc of former classes: 0.6911][acc of former samples in all classes: 0.6451]
[acc of novel samples in all classes: 0.2052]
2022-11-05 15:42:20,819 INFO: Session 7: 51.21+-0.28[acc of former classes: 0.7034][acc of former samples in all classes: 0.6565]
[acc of novel samples in all classes: 0.2232]
2022-11-05 15:42:20,819 INFO: Session 8: 49.66+-0.29[acc of former classes: 0.7056][acc of former samples in all classes: 0.6559]
[acc of novel samples in all classes: 0.2235]
2022-11-05 15:42:20,819 INFO: Session 9: 47.86+-0.22[acc of former classes: 0.7103][acc of former samples in all classes: 0.6536]
[acc of novel samples in all classes: 0.2161]
2022-11-05 15:42:20,819 INFO: random seed: 1997
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_8.pth
finish!!
