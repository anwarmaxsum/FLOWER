/opt/conda/lib/python3.8/site-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
2022-11-05 13:37:55,300 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-11-05 13:37:55,300 INFO: 
  name: F2M_res18_cifar_5shots_debug_02
  model_type: MTNBModel
  gpu: 1
  manual_seed: 1997
  use_cosine: False
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
  datasets:[
    train:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: None
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    val:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
    test:[
      name: cifar-100
      type: NormalDataset
      total_classes: 100
      dataroot: DataSet/cifar-100/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomCrop'), ('size', 32), ('padding', 4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
      transformer: [OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.5071, 0.4866, 0.4409)), ('std', (0.2009, 0.1984, 0.2023))])]
    ]
  ]
  network_g:[
    type: Resnet20_cifar_small
    num_classes: 60
    adopt_classifier: False
    flatten: True
  ]
  path:[
    pretrain_model_g: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
    base_model: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02
    training_states: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/training_states
    log: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02
    models: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models
    prototypes: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.02
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [1000]
      gamma: 1e-05
    ]
    fine_tune: True
    random_noise:[
      distribution:[
        type: DiscreteBeta
      ]
      type: suffix_conv_weight
      num_layers: 4
      low: 0.1
      high: 5.0
      reduction_factor: 4
      bound_value: 0.01
      random_times: 0
    ]
    clamping: True
    rounding: True
    fine_tune_epoch: 6
    max_steps: 1
    ratio: 1
    novel_exemplars: 5
    warmup_iter: -1
    bases: 60
    tasks: 9
    shots: 5
    num_test: 5
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: False
    ]
  ]
  val:[
    val_freq: 5
    test_type: NCM
  ]
  logger:[
    print_freq: 1
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental-Results
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-11-05 13:37:55,300 INFO: Random seed: 1997
2022-11-05 13:37:57,158 INFO: Network: Resnet20_cifar_small, with parameters: 271,824
2022-11-05 13:37:57,158 INFO: Resnet20_cifar_small(
  (func): ResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (avg_pool): AdaptiveAvgPool2d(output_size=(1, 1))
  )
)
2022-11-05 13:37:57,158 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:37:57,165 WARNING: Current net - loaded net:
2022-11-05 13:37:57,166 WARNING: Loaded net - current net:
2022-11-05 13:37:57,166 WARNING:   func.fc.bias
2022-11-05 13:37:57,166 WARNING:   func.fc.weight
2022-11-05 13:37:57,194 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:37:57,200 WARNING: Current net - loaded net:
2022-11-05 13:37:57,201 WARNING: Loaded net - current net:
2022-11-05 13:37:57,201 WARNING:   func.fc.bias
2022-11-05 13:37:57,201 WARNING:   func.fc.weight
2022-11-05 13:37:57,220 INFO: Obtain parameters for train
2022-11-05 13:37:57,229 INFO: Model [MTNBModel] is created.
2022-11-05 13:38:34,656 INFO: [Test_acc of task 0 on test 0: 0.71400][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.71400]
2022-11-05 13:38:34,677 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:38:34,682 WARNING: Current net - loaded net:
2022-11-05 13:38:34,682 WARNING: Loaded net - current net:
2022-11-05 13:38:34,682 WARNING:   func.fc.bias
2022-11-05 13:38:34,682 WARNING:   func.fc.weight
2022-11-05 13:38:34,695 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth.
2022-11-05 13:38:34,719 INFO: Obtain parameters for train
2022-11-05 13:38:34,722 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:38:34,722 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:38:34,723 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:38:34,724 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:38:34,725 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:38:34,725 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:38:34,725 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:38:34,725 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:38:34,725 INFO: Model [MTNBModel] is created.
2022-11-05 13:38:34,734 INFO: Dataset NormalDataset - cifar-100 is created.
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
>>> Test >>>
Former classes: []
Novel classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 13:38:35,426 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 101, n_lower: 25
2022-11-05 13:38:35,427 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 0, n_lower: 5
2022-11-05 13:38:35,428 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 1, n_lower: 43
2022-11-05 13:38:35,429 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.3989, Acc: 0.9200, ]
2022-11-05 13:38:36,042 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 209, n_lower: 67
2022-11-05 13:38:36,044 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 6, n_lower: 17
2022-11-05 13:38:36,044 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 85
2022-11-05 13:38:36,045 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 9
2022-11-05 13:38:36,046 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.2305, Acc: 0.9600, ]
2022-11-05 13:38:36,690 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 1707, n_lower: 1146
2022-11-05 13:38:36,691 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 317, n_lower: 545
2022-11-05 13:38:36,692 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 449, n_lower: 1121
2022-11-05 13:38:36,693 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 29, n_lower: 430
2022-11-05 13:38:36,694 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.1157, Acc: 0.9600, ]
2022-11-05 13:38:37,367 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 1732, n_lower: 1177
2022-11-05 13:38:37,368 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 318, n_lower: 558
2022-11-05 13:38:37,369 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 482, n_lower: 1174
2022-11-05 13:38:37,369 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 45, n_lower: 433
2022-11-05 13:38:37,370 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.1427, Acc: 0.9200, ]
2022-11-05 13:38:38,085 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 1752, n_lower: 1181
2022-11-05 13:38:38,086 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 318, n_lower: 568
2022-11-05 13:38:38,087 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 478, n_lower: 1179
2022-11-05 13:38:38,088 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 435
2022-11-05 13:38:38,088 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.2671, Acc: 0.9200, ]
2022-11-05 13:38:38,102 INFO: Epoch 4, Validation Step:

2022-11-05 13:39:22,993 INFO: [Test_acc of task 1 on test 0: 0.64262][acc of former classes: 0.68950][acc of former samples in all classes: 0.66567]
[acc of novel samples in all classes: 0.36600]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
2022-11-05 13:39:23,542 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 1752, n_lower: 1187
2022-11-05 13:39:23,543 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 318, n_lower: 570
2022-11-05 13:39:23,544 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 478, n_lower: 1183
2022-11-05 13:39:23,545 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 435
2022-11-05 13:39:23,546 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0111, Acc: 1.0000, ]
2022-11-05 13:39:23,654 INFO: fine-tune procedure is finished!
2022-11-05 13:40:15,273 INFO: [Test_acc of task 1 on test 0: 0.64138][acc of former classes: 0.68867][acc of former samples in all classes: 0.66433]
[acc of novel samples in all classes: 0.36600]
2022-11-05 13:40:15,319 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:40:15,326 WARNING: Current net - loaded net:
2022-11-05 13:40:15,326 WARNING: Loaded net - current net:
2022-11-05 13:40:15,326 WARNING:   func.fc.bias
2022-11-05 13:40:15,326 WARNING:   func.fc.weight
2022-11-05 13:40:15,361 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_1.pth.
2022-11-05 13:40:15,404 INFO: Obtain parameters for train
2022-11-05 13:40:15,409 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:40:15,409 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:40:15,409 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:40:15,409 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:40:15,409 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:40:15,409 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:40:15,410 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:40:15,411 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:40:15,412 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:40:15,413 INFO: Model [MTNBModel] is created.
2022-11-05 13:40:15,422 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:40:15,429 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 13:40:15,869 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 753, n_lower: 631
2022-11-05 13:40:15,874 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 280
2022-11-05 13:40:15,879 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 238, n_lower: 623
2022-11-05 13:40:15,884 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 236
2022-11-05 13:40:15,889 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.2260, Acc: 0.9400, ]
2022-11-05 13:40:16,403 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 758, n_lower: 631
2022-11-05 13:40:16,409 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 280
2022-11-05 13:40:16,412 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 238, n_lower: 632
2022-11-05 13:40:16,417 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 239
2022-11-05 13:40:16,422 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.2917, Acc: 0.9200, ]
2022-11-05 13:40:17,251 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 761, n_lower: 636
2022-11-05 13:40:17,255 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 285
2022-11-05 13:40:17,257 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 238, n_lower: 636
2022-11-05 13:40:17,263 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 270
2022-11-05 13:40:17,270 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.1290, Acc: 0.9600, ]
2022-11-05 13:40:17,924 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 772, n_lower: 648
2022-11-05 13:40:17,931 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 295
2022-11-05 13:40:17,938 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 238, n_lower: 657
2022-11-05 13:40:17,945 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 348
2022-11-05 13:40:17,953 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.1400, Acc: 0.9800, ]
2022-11-05 13:40:18,548 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 776, n_lower: 695
2022-11-05 13:40:18,555 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 99, n_lower: 304
2022-11-05 13:40:18,563 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 236, n_lower: 657
2022-11-05 13:40:18,569 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 350
2022-11-05 13:40:18,574 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.1772, Acc: 0.9400, ]
2022-11-05 13:40:18,599 INFO: Epoch 4, Validation Step:

2022-11-05 13:41:15,407 INFO: [Test_acc of task 2 on test 0: 0.60900][acc of former classes: 0.68717][acc of former samples in all classes: 0.65050]
[acc of novel samples in all classes: 0.36000]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 13:41:15,930 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 819, n_lower: 713
2022-11-05 13:41:15,935 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 309
2022-11-05 13:41:15,940 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 236, n_lower: 657
2022-11-05 13:41:15,943 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 21, n_lower: 350
2022-11-05 13:41:15,949 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.1524, Acc: 0.9400, ]
2022-11-05 13:41:16,057 INFO: fine-tune procedure is finished!
2022-11-05 13:42:12,190 INFO: [Test_acc of task 2 on test 0: 0.60943][acc of former classes: 0.68767][acc of former samples in all classes: 0.65100]
[acc of novel samples in all classes: 0.36000]
2022-11-05 13:42:12,238 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:42:12,246 WARNING: Current net - loaded net:
2022-11-05 13:42:12,246 WARNING: Loaded net - current net:
2022-11-05 13:42:12,246 WARNING:   func.fc.bias
2022-11-05 13:42:12,246 WARNING:   func.fc.weight
2022-11-05 13:42:12,281 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_2.pth.
2022-11-05 13:42:12,324 INFO: Obtain parameters for train
2022-11-05 13:42:12,328 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:42:12,328 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:42:12,328 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:42:12,328 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:42:12,328 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:42:12,328 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:42:12,328 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:42:12,328 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:42:12,329 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:42:12,330 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:42:12,331 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:42:12,331 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:42:12,331 INFO: Model [MTNBModel] is created.
2022-11-05 13:42:12,338 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:42:12,343 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:42:12,349 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 13:42:12,859 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 771, n_lower: 680
2022-11-05 13:42:12,866 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 309
2022-11-05 13:42:12,869 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 241, n_lower: 661
2022-11-05 13:42:12,876 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 17, n_lower: 314
2022-11-05 13:42:12,881 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4589, Acc: 0.8667, ]
2022-11-05 13:42:13,637 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 771, n_lower: 680
2022-11-05 13:42:13,640 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 315
2022-11-05 13:42:13,647 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 241, n_lower: 661
2022-11-05 13:42:13,649 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 17, n_lower: 315
2022-11-05 13:42:13,656 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4959, Acc: 0.8400, ]
2022-11-05 13:42:14,454 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 775, n_lower: 682
2022-11-05 13:42:14,462 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 321
2022-11-05 13:42:14,469 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 265, n_lower: 811
2022-11-05 13:42:14,474 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 19, n_lower: 361
2022-11-05 13:42:14,481 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4289, Acc: 0.8533, ]
2022-11-05 13:42:15,157 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 776, n_lower: 685
2022-11-05 13:42:15,166 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 102, n_lower: 329
2022-11-05 13:42:15,174 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 268, n_lower: 812
2022-11-05 13:42:15,181 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 19, n_lower: 369
2022-11-05 13:42:15,189 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3874, Acc: 0.8800, ]
2022-11-05 13:42:15,927 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 776, n_lower: 689
2022-11-05 13:42:15,934 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 102, n_lower: 331
2022-11-05 13:42:15,941 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 274, n_lower: 820
2022-11-05 13:42:15,946 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 37, n_lower: 388
2022-11-05 13:42:15,955 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3719, Acc: 0.9067, ]
2022-11-05 13:42:15,990 INFO: Epoch 4, Validation Step:

2022-11-05 13:43:16,479 INFO: [Test_acc of task 3 on test 0: 0.57813][acc of former classes: 0.68933][acc of former samples in all classes: 0.64483]
[acc of novel samples in all classes: 0.31133]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 13:43:17,150 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 778, n_lower: 690
2022-11-05 13:43:17,157 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 115, n_lower: 377
2022-11-05 13:43:17,162 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 315, n_lower: 872
2022-11-05 13:43:17,168 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 37, n_lower: 400
2022-11-05 13:43:17,174 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3236, Acc: 0.9067, ]
2022-11-05 13:43:17,284 INFO: fine-tune procedure is finished!
2022-11-05 13:44:19,903 INFO: [Test_acc of task 3 on test 0: 0.57827][acc of former classes: 0.68917][acc of former samples in all classes: 0.64533]
[acc of novel samples in all classes: 0.31000]
2022-11-05 13:44:19,932 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:44:19,941 WARNING: Current net - loaded net:
2022-11-05 13:44:19,941 WARNING: Loaded net - current net:
2022-11-05 13:44:19,941 WARNING:   func.fc.bias
2022-11-05 13:44:19,941 WARNING:   func.fc.weight
2022-11-05 13:44:19,959 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_3.pth.
2022-11-05 13:44:19,987 INFO: Obtain parameters for train
2022-11-05 13:44:19,989 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:44:19,989 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:44:19,989 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:44:19,989 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:44:19,989 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:44:19,989 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:44:19,989 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:44:19,989 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:44:19,990 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:44:19,991 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:44:19,992 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:44:19,992 INFO: Model [MTNBModel] is created.
2022-11-05 13:44:20,002 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:44:20,011 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:44:20,016 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:44:20,022 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 13:44:20,727 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 769, n_lower: 700
2022-11-05 13:44:20,729 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 103, n_lower: 358
2022-11-05 13:44:20,730 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 264, n_lower: 792
2022-11-05 13:44:20,731 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 380
2022-11-05 13:44:20,731 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.3472, Acc: 0.8900, ]
2022-11-05 13:44:21,577 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 784, n_lower: 702
2022-11-05 13:44:21,578 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 109, n_lower: 359
2022-11-05 13:44:21,579 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 269, n_lower: 796
2022-11-05 13:44:21,579 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 380
2022-11-05 13:44:21,580 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.3976, Acc: 0.9000, ]
2022-11-05 13:44:22,527 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 805, n_lower: 715
2022-11-05 13:44:22,529 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 109, n_lower: 361
2022-11-05 13:44:22,530 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 272, n_lower: 800
2022-11-05 13:44:22,530 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 380
2022-11-05 13:44:22,531 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.2297, Acc: 0.9200, ]
2022-11-05 13:44:23,415 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 858, n_lower: 723
2022-11-05 13:44:23,417 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 112, n_lower: 370
2022-11-05 13:44:23,418 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 278, n_lower: 835
2022-11-05 13:44:23,419 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 384
2022-11-05 13:44:23,419 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5096, Acc: 0.8600, ]
2022-11-05 13:44:24,437 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 879, n_lower: 768
2022-11-05 13:44:24,439 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 117, n_lower: 376
2022-11-05 13:44:24,439 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 279, n_lower: 845
2022-11-05 13:44:24,440 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 385
2022-11-05 13:44:24,441 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3949, Acc: 0.8900, ]
2022-11-05 13:44:24,490 INFO: Epoch 4, Validation Step:

2022-11-05 13:45:36,728 INFO: [Test_acc of task 4 on test 0: 0.55112][acc of former classes: 0.69117][acc of former samples in all classes: 0.64117]
[acc of novel samples in all classes: 0.28100]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 13:45:37,737 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 938, n_lower: 803
2022-11-05 13:45:37,741 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 124, n_lower: 429
2022-11-05 13:45:37,751 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 304, n_lower: 898
2022-11-05 13:45:37,758 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 404
2022-11-05 13:45:37,760 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3832, Acc: 0.8900, ]
2022-11-05 13:45:37,966 INFO: fine-tune procedure is finished!
2022-11-05 13:46:47,284 INFO: [Test_acc of task 4 on test 0: 0.55100][acc of former classes: 0.69083][acc of former samples in all classes: 0.64050]
[acc of novel samples in all classes: 0.28250]
2022-11-05 13:46:47,431 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:46:47,439 WARNING: Current net - loaded net:
2022-11-05 13:46:47,440 WARNING: Loaded net - current net:
2022-11-05 13:46:47,440 WARNING:   func.fc.bias
2022-11-05 13:46:47,440 WARNING:   func.fc.weight
2022-11-05 13:46:47,470 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_4.pth.
2022-11-05 13:46:47,516 INFO: Obtain parameters for train
2022-11-05 13:46:47,520 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:46:47,520 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:46:47,521 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:46:47,522 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:46:47,523 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:46:47,524 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:46:47,524 INFO: Model [MTNBModel] is created.
2022-11-05 13:46:47,532 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:46:47,538 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:46:47,545 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:46:47,551 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:46:47,557 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 13:46:48,309 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 806, n_lower: 756
2022-11-05 13:46:48,315 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 389
2022-11-05 13:46:48,320 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 273, n_lower: 842
2022-11-05 13:46:48,325 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 389
2022-11-05 13:46:48,329 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.3829, Acc: 0.9040, ]
2022-11-05 13:46:49,399 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 817, n_lower: 756
2022-11-05 13:46:49,482 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 392
2022-11-05 13:46:49,488 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 273, n_lower: 846
2022-11-05 13:46:49,495 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 391
2022-11-05 13:46:49,502 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.3955, Acc: 0.8720, ]
2022-11-05 13:46:50,425 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 822, n_lower: 773
2022-11-05 13:46:50,433 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 392
2022-11-05 13:46:50,437 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 273, n_lower: 847
2022-11-05 13:46:50,445 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 396
2022-11-05 13:46:50,451 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4051, Acc: 0.8560, ]
2022-11-05 13:46:51,321 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 830, n_lower: 782
2022-11-05 13:46:51,329 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 400
2022-11-05 13:46:51,335 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 274, n_lower: 859
2022-11-05 13:46:51,340 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 401
2022-11-05 13:46:51,372 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3725, Acc: 0.8720, ]
2022-11-05 13:46:52,421 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 842, n_lower: 800
2022-11-05 13:46:52,428 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 403
2022-11-05 13:46:52,435 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 287, n_lower: 860
2022-11-05 13:46:52,443 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 401
2022-11-05 13:46:52,451 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3680, Acc: 0.8720, ]
2022-11-05 13:46:52,509 INFO: Epoch 4, Validation Step:

2022-11-05 13:48:13,147 INFO: [Test_acc of task 5 on test 0: 0.52294][acc of former classes: 0.69133][acc of former samples in all classes: 0.62483]
[acc of novel samples in all classes: 0.27840]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 13:48:14,471 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 844, n_lower: 820
2022-11-05 13:48:14,477 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 405
2022-11-05 13:48:14,480 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 289, n_lower: 861
2022-11-05 13:48:14,485 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 402
2022-11-05 13:48:14,489 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3097, Acc: 0.8960, ]
2022-11-05 13:48:14,600 INFO: fine-tune procedure is finished!
2022-11-05 13:49:34,868 INFO: [Test_acc of task 5 on test 0: 0.52388][acc of former classes: 0.69183][acc of former samples in all classes: 0.62600]
[acc of novel samples in all classes: 0.27880]
2022-11-05 13:49:34,889 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:49:34,897 WARNING: Current net - loaded net:
2022-11-05 13:49:34,897 WARNING: Loaded net - current net:
2022-11-05 13:49:34,897 WARNING:   func.fc.bias
2022-11-05 13:49:34,897 WARNING:   func.fc.weight
2022-11-05 13:49:35,020 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_5.pth.
2022-11-05 13:49:35,038 INFO: Obtain parameters for train
2022-11-05 13:49:35,040 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:49:35,040 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:49:35,041 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:49:35,042 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:49:35,043 INFO: Model [MTNBModel] is created.
2022-11-05 13:49:35,049 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:49:35,054 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:49:35,059 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:49:35,065 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:49:35,070 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:49:35,075 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 13:49:36,090 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 801, n_lower: 793
2022-11-05 13:49:36,091 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 396
2022-11-05 13:49:36,092 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 274, n_lower: 854
2022-11-05 13:49:36,117 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 396
2022-11-05 13:49:36,118 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.3264, Acc: 0.9000, ]
2022-11-05 13:49:37,326 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 807, n_lower: 794
2022-11-05 13:49:37,335 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 396
2022-11-05 13:49:37,343 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 274, n_lower: 854
2022-11-05 13:49:37,352 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 396
2022-11-05 13:49:37,360 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4074, Acc: 0.8933, ]
2022-11-05 13:49:38,417 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 810, n_lower: 794
2022-11-05 13:49:38,418 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 396
2022-11-05 13:49:38,419 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 275, n_lower: 856
2022-11-05 13:49:38,420 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 396
2022-11-05 13:49:38,421 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.3870, Acc: 0.8867, ]
2022-11-05 13:49:39,652 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 816, n_lower: 796
2022-11-05 13:49:39,653 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 396
2022-11-05 13:49:39,654 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 275, n_lower: 856
2022-11-05 13:49:39,655 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 396
2022-11-05 13:49:39,655 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.2796, Acc: 0.9067, ]
2022-11-05 13:49:40,751 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 826, n_lower: 809
2022-11-05 13:49:40,760 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 396
2022-11-05 13:49:40,769 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 286, n_lower: 867
2022-11-05 13:49:40,778 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 399
2022-11-05 13:49:40,786 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3904, Acc: 0.8800, ]
2022-11-05 13:49:40,867 INFO: Epoch 4, Validation Step:

2022-11-05 13:51:06,273 INFO: [Test_acc of task 6 on test 0: 0.50722][acc of former classes: 0.69167][acc of former samples in all classes: 0.61933]
[acc of novel samples in all classes: 0.28300]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 13:51:07,253 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 829, n_lower: 810
2022-11-05 13:51:07,257 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 396
2022-11-05 13:51:07,261 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 286, n_lower: 867
2022-11-05 13:51:07,274 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 399
2022-11-05 13:51:07,277 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.2525, Acc: 0.9133, ]
2022-11-05 13:51:07,402 INFO: fine-tune procedure is finished!
2022-11-05 13:52:30,944 INFO: [Test_acc of task 6 on test 0: 0.50744][acc of former classes: 0.69167][acc of former samples in all classes: 0.61950]
[acc of novel samples in all classes: 0.28333]
2022-11-05 13:52:31,001 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:52:31,007 WARNING: Current net - loaded net:
2022-11-05 13:52:31,007 WARNING: Loaded net - current net:
2022-11-05 13:52:31,007 WARNING:   func.fc.bias
2022-11-05 13:52:31,008 WARNING:   func.fc.weight
2022-11-05 13:52:31,051 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_6.pth.
2022-11-05 13:52:31,095 INFO: Obtain parameters for train
2022-11-05 13:52:31,099 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:52:31,099 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:52:31,100 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:52:31,101 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:52:31,101 INFO: Model [MTNBModel] is created.
2022-11-05 13:52:31,108 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:52:31,113 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:52:31,119 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:52:31,124 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:52:31,129 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:52:31,134 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:52:31,141 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 13:52:31,763 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 808, n_lower: 808
2022-11-05 13:52:31,769 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 402
2022-11-05 13:52:31,775 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 861
2022-11-05 13:52:31,779 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 400
2022-11-05 13:52:31,784 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4913, Acc: 0.8457, ]
2022-11-05 13:52:32,507 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 810, n_lower: 809
2022-11-05 13:52:32,515 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 402
2022-11-05 13:52:32,521 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 870
2022-11-05 13:52:32,525 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 403
2022-11-05 13:52:32,530 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5842, Acc: 0.8171, ]
2022-11-05 13:52:33,684 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 825, n_lower: 812
2022-11-05 13:52:33,692 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 403
2022-11-05 13:52:33,699 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 880
2022-11-05 13:52:33,707 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 403
2022-11-05 13:52:33,712 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5239, Acc: 0.8571, ]
2022-11-05 13:52:34,627 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 831, n_lower: 812
2022-11-05 13:52:34,635 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 403
2022-11-05 13:52:34,642 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 881
2022-11-05 13:52:34,647 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 403
2022-11-05 13:52:34,654 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4113, Acc: 0.8514, ]
2022-11-05 13:52:35,495 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 831, n_lower: 813
2022-11-05 13:52:35,510 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 404
2022-11-05 13:52:35,514 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 883
2022-11-05 13:52:35,522 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 403
2022-11-05 13:52:35,529 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.4319, Acc: 0.8629, ]
2022-11-05 13:52:35,683 INFO: Epoch 4, Validation Step:

2022-11-05 13:54:00,301 INFO: [Test_acc of task 7 on test 0: 0.48811][acc of former classes: 0.69133][acc of former samples in all classes: 0.61167]
[acc of novel samples in all classes: 0.27629]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 13:54:01,112 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 833, n_lower: 821
2022-11-05 13:54:01,120 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 404
2022-11-05 13:54:01,122 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 884
2022-11-05 13:54:01,128 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 406
2022-11-05 13:54:01,131 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5538, Acc: 0.8229, ]
2022-11-05 13:54:01,247 INFO: fine-tune procedure is finished!
2022-11-05 13:55:19,618 INFO: [Test_acc of task 7 on test 0: 0.48811][acc of former classes: 0.69150][acc of former samples in all classes: 0.61183]
[acc of novel samples in all classes: 0.27600]
2022-11-05 13:55:19,655 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:55:19,664 WARNING: Current net - loaded net:
2022-11-05 13:55:19,664 WARNING: Loaded net - current net:
2022-11-05 13:55:19,664 WARNING:   func.fc.bias
2022-11-05 13:55:19,664 WARNING:   func.fc.weight
2022-11-05 13:55:19,681 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_7.pth.
2022-11-05 13:55:19,707 INFO: Obtain parameters for train
2022-11-05 13:55:19,727 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:55:19,727 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:55:19,727 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:55:19,728 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:55:19,729 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:55:19,730 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:55:19,731 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:55:19,731 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:55:19,731 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:55:19,731 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:55:19,731 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:55:19,731 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:55:19,731 INFO: Model [MTNBModel] is created.
2022-11-05 13:55:19,746 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:55:19,760 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:55:19,774 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:55:19,781 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:55:19,788 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:55:19,795 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:55:19,802 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 13:55:19,808 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 13:55:21,196 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 808, n_lower: 812
2022-11-05 13:55:21,205 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 403
2022-11-05 13:55:21,210 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 875
2022-11-05 13:55:21,216 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 396
2022-11-05 13:55:21,222 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5902, Acc: 0.8600, ]
2022-11-05 13:55:22,614 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 810, n_lower: 818
2022-11-05 13:55:22,622 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 403
2022-11-05 13:55:22,629 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 878
2022-11-05 13:55:22,637 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 399
2022-11-05 13:55:22,645 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4767, Acc: 0.8400, ]
2022-11-05 13:55:23,718 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 815, n_lower: 819
2022-11-05 13:55:23,724 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 403
2022-11-05 13:55:23,731 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 878
2022-11-05 13:55:23,737 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 399
2022-11-05 13:55:23,742 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4777, Acc: 0.8450, ]
2022-11-05 13:55:24,625 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 818, n_lower: 839
2022-11-05 13:55:24,628 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 403
2022-11-05 13:55:24,636 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 878
2022-11-05 13:55:24,643 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 401
2022-11-05 13:55:24,648 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5549, Acc: 0.8700, ]
2022-11-05 13:55:25,539 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 821, n_lower: 840
2022-11-05 13:55:25,540 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 403
2022-11-05 13:55:25,541 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 880
2022-11-05 13:55:25,542 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 402
2022-11-05 13:55:25,542 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5048, Acc: 0.8550, ]
2022-11-05 13:55:25,741 INFO: Epoch 4, Validation Step:

2022-11-05 13:56:47,367 INFO: [Test_acc of task 8 on test 0: 0.46970][acc of former classes: 0.69200][acc of former samples in all classes: 0.60050]
[acc of novel samples in all classes: 0.27350]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 13:56:48,236 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 824, n_lower: 850
2022-11-05 13:56:48,246 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 106, n_lower: 403
2022-11-05 13:56:48,253 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 276, n_lower: 882
2022-11-05 13:56:48,260 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 402
2022-11-05 13:56:48,265 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5261, Acc: 0.8450, ]
2022-11-05 13:56:48,382 INFO: fine-tune procedure is finished!
2022-11-05 13:58:05,915 INFO: [Test_acc of task 8 on test 0: 0.46960][acc of former classes: 0.69217][acc of former samples in all classes: 0.60050]
[acc of novel samples in all classes: 0.27325]
2022-11-05 13:58:05,959 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 13:58:05,968 WARNING: Current net - loaded net:
2022-11-05 13:58:05,968 WARNING: Loaded net - current net:
2022-11-05 13:58:05,968 WARNING:   func.fc.bias
2022-11-05 13:58:05,968 WARNING:   func.fc.weight
2022-11-05 13:58:06,105 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth.
2022-11-05 13:58:06,153 INFO: Obtain parameters for train
2022-11-05 13:58:06,157 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 13:58:06,157 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 13:58:06,158 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 13:58:06,159 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 13:58:06,160 INFO: Model [MTNBModel] is created.
2022-11-05 13:58:06,167 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 13:58:06,624 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.1811, Acc: 0.9600, ]
2022-11-05 13:58:07,514 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 35, n_lower: 16
2022-11-05 13:58:07,520 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 1, n_lower: 21
2022-11-05 13:58:07,527 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 1, n_lower: 23
2022-11-05 13:58:07,532 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 1
2022-11-05 13:58:07,535 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.1694, Acc: 0.9600, ]
2022-11-05 13:58:08,341 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 69, n_lower: 67
2022-11-05 13:58:08,348 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 99
2022-11-05 13:58:08,353 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 12, n_lower: 90
2022-11-05 13:58:08,360 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 10
2022-11-05 13:58:08,366 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.2207, Acc: 0.9200, ]
2022-11-05 13:58:09,194 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 258, n_lower: 187
2022-11-05 13:58:09,201 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 46, n_lower: 167
2022-11-05 13:58:09,208 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 26, n_lower: 126
2022-11-05 13:58:09,216 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 10
2022-11-05 13:58:09,222 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0478, Acc: 0.9600, ]
2022-11-05 13:58:09,913 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 280, n_lower: 223
2022-11-05 13:58:09,922 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 68, n_lower: 192
2022-11-05 13:58:09,930 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 35, n_lower: 192
2022-11-05 13:58:09,938 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 77, n_lower: 129
2022-11-05 13:58:09,946 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0645, Acc: 0.9600, ]
2022-11-05 13:58:09,964 INFO: Epoch 4, Validation Step:

2022-11-05 13:59:12,023 INFO: [Test_acc of task 1 on test 1: 0.67415][acc of former classes: 0.71450][acc of former samples in all classes: 0.70400]
[acc of novel samples in all classes: 0.31600]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
2022-11-05 13:59:13,083 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 301, n_lower: 233
2022-11-05 13:59:13,090 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 68, n_lower: 205
2022-11-05 13:59:13,097 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 45, n_lower: 198
2022-11-05 13:59:13,103 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 77, n_lower: 129
2022-11-05 13:59:13,109 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0759, Acc: 0.9600, ]
2022-11-05 13:59:13,200 INFO: fine-tune procedure is finished!
2022-11-05 14:00:11,777 INFO: [Test_acc of task 1 on test 1: 0.67431][acc of former classes: 0.71433][acc of former samples in all classes: 0.70400]
[acc of novel samples in all classes: 0.31800]
2022-11-05 14:00:11,815 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:00:11,821 WARNING: Current net - loaded net:
2022-11-05 14:00:11,822 WARNING: Loaded net - current net:
2022-11-05 14:00:11,822 WARNING:   func.fc.bias
2022-11-05 14:00:11,822 WARNING:   func.fc.weight
2022-11-05 14:00:11,835 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_1.pth.
2022-11-05 14:00:11,880 INFO: Obtain parameters for train
2022-11-05 14:00:11,882 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:00:11,882 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:00:11,883 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:00:11,884 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:00:11,884 INFO: Model [MTNBModel] is created.
2022-11-05 14:00:11,890 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:00:11,895 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:00:12,364 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 106, n_lower: 141
2022-11-05 14:00:12,368 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 121
2022-11-05 14:00:12,372 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 128
2022-11-05 14:00:12,378 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 85
2022-11-05 14:00:12,381 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4314, Acc: 0.8600, ]
2022-11-05 14:00:12,953 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 106, n_lower: 143
2022-11-05 14:00:12,957 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 121
2022-11-05 14:00:12,958 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 130
2022-11-05 14:00:12,959 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 100
2022-11-05 14:00:12,960 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.3643, Acc: 0.8800, ]
2022-11-05 14:00:13,981 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 162, n_lower: 217
2022-11-05 14:00:13,987 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 130
2022-11-05 14:00:13,995 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 187
2022-11-05 14:00:14,003 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 100
2022-11-05 14:00:14,011 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.2847, Acc: 0.9200, ]
2022-11-05 14:00:14,751 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 167, n_lower: 252
2022-11-05 14:00:14,757 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 132
2022-11-05 14:00:14,763 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 193
2022-11-05 14:00:14,770 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 63, n_lower: 247
2022-11-05 14:00:14,777 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3360, Acc: 0.8800, ]
2022-11-05 14:00:15,451 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 190, n_lower: 265
2022-11-05 14:00:15,456 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 22, n_lower: 157
2022-11-05 14:00:15,461 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 217
2022-11-05 14:00:15,467 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 65, n_lower: 247
2022-11-05 14:00:15,469 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.2613, Acc: 0.9000, ]
2022-11-05 14:00:15,504 INFO: Epoch 4, Validation Step:

2022-11-05 14:01:15,384 INFO: [Test_acc of task 2 on test 1: 0.64014][acc of former classes: 0.71417][acc of former samples in all classes: 0.69350]
[acc of novel samples in all classes: 0.32000]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:01:16,198 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 207, n_lower: 296
2022-11-05 14:01:16,199 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 24, n_lower: 160
2022-11-05 14:01:16,200 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 223
2022-11-05 14:01:16,200 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 66, n_lower: 247
2022-11-05 14:01:16,201 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.1812, Acc: 0.9400, ]
2022-11-05 14:01:16,289 INFO: fine-tune procedure is finished!
2022-11-05 14:02:18,516 INFO: [Test_acc of task 2 on test 1: 0.63886][acc of former classes: 0.71267][acc of former samples in all classes: 0.69200]
[acc of novel samples in all classes: 0.32000]
2022-11-05 14:02:18,577 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:02:18,584 WARNING: Current net - loaded net:
2022-11-05 14:02:18,585 WARNING: Loaded net - current net:
2022-11-05 14:02:18,585 WARNING:   func.fc.bias
2022-11-05 14:02:18,585 WARNING:   func.fc.weight
2022-11-05 14:02:18,620 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_2.pth.
2022-11-05 14:02:18,663 INFO: Obtain parameters for train
2022-11-05 14:02:18,667 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:02:18,667 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:02:18,668 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:02:18,669 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:02:18,669 INFO: Model [MTNBModel] is created.
2022-11-05 14:02:18,678 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:02:18,687 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:02:18,696 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:02:19,293 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 226
2022-11-05 14:02:19,296 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 14, n_lower: 157
2022-11-05 14:02:19,311 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 192
2022-11-05 14:02:19,323 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 53, n_lower: 194
2022-11-05 14:02:19,327 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5922, Acc: 0.8267, ]
2022-11-05 14:02:20,022 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 125, n_lower: 229
2022-11-05 14:02:20,026 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 14, n_lower: 158
2022-11-05 14:02:20,032 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 195
2022-11-05 14:02:20,038 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 53, n_lower: 195
2022-11-05 14:02:20,041 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.6806, Acc: 0.8533, ]
2022-11-05 14:02:21,235 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 127, n_lower: 237
2022-11-05 14:02:21,244 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 277
2022-11-05 14:02:21,250 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 10, n_lower: 198
2022-11-05 14:02:21,256 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 297
2022-11-05 14:02:21,264 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6012, Acc: 0.8800, ]
2022-11-05 14:02:22,158 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 127, n_lower: 251
2022-11-05 14:02:22,166 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 277
2022-11-05 14:02:22,174 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 207
2022-11-05 14:02:22,180 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 310
2022-11-05 14:02:22,183 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.6185, Acc: 0.8133, ]
2022-11-05 14:02:23,051 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 127, n_lower: 256
2022-11-05 14:02:23,060 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 278
2022-11-05 14:02:23,066 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 14, n_lower: 212
2022-11-05 14:02:23,072 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 317
2022-11-05 14:02:23,080 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.6549, Acc: 0.8000, ]
2022-11-05 14:02:23,169 INFO: Epoch 4, Validation Step:

2022-11-05 14:03:26,446 INFO: [Test_acc of task 3 on test 1: 0.59747][acc of former classes: 0.71267][acc of former samples in all classes: 0.68233]
[acc of novel samples in all classes: 0.25800]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:03:27,178 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 127, n_lower: 279
2022-11-05 14:03:27,180 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 418
2022-11-05 14:03:27,180 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 17, n_lower: 236
2022-11-05 14:03:27,181 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 406
2022-11-05 14:03:27,182 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5401, Acc: 0.8133, ]
2022-11-05 14:03:27,384 INFO: fine-tune procedure is finished!
2022-11-05 14:04:34,634 INFO: [Test_acc of task 3 on test 1: 0.59747][acc of former classes: 0.71250][acc of former samples in all classes: 0.68233]
[acc of novel samples in all classes: 0.25800]
2022-11-05 14:04:34,688 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:04:34,697 WARNING: Current net - loaded net:
2022-11-05 14:04:34,698 WARNING: Loaded net - current net:
2022-11-05 14:04:34,698 WARNING:   func.fc.bias
2022-11-05 14:04:34,698 WARNING:   func.fc.weight
2022-11-05 14:04:34,731 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_3.pth.
2022-11-05 14:04:34,777 INFO: Obtain parameters for train
2022-11-05 14:04:34,781 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:04:34,782 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:04:34,783 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:04:34,784 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:04:34,785 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:04:34,785 INFO: Model [MTNBModel] is created.
2022-11-05 14:04:34,807 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:04:34,820 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:04:34,830 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:04:34,839 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:04:35,439 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 131, n_lower: 281
2022-11-05 14:04:35,445 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 25, n_lower: 297
2022-11-05 14:04:35,450 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 18, n_lower: 233
2022-11-05 14:04:35,453 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 53, n_lower: 335
2022-11-05 14:04:35,459 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4950, Acc: 0.8700, ]
2022-11-05 14:04:36,127 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 132, n_lower: 281
2022-11-05 14:04:36,132 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 28, n_lower: 299
2022-11-05 14:04:36,137 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 22, n_lower: 241
2022-11-05 14:04:36,142 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 53, n_lower: 336
2022-11-05 14:04:36,147 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5211, Acc: 0.8600, ]
2022-11-05 14:04:36,932 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 167, n_lower: 362
2022-11-05 14:04:36,936 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 35, n_lower: 310
2022-11-05 14:04:36,942 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 42, n_lower: 272
2022-11-05 14:04:36,947 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 53, n_lower: 340
2022-11-05 14:04:36,952 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5276, Acc: 0.8100, ]
2022-11-05 14:04:37,672 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 173, n_lower: 362
2022-11-05 14:04:37,677 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 35, n_lower: 326
2022-11-05 14:04:37,682 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 71, n_lower: 347
2022-11-05 14:04:37,689 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 53, n_lower: 351
2022-11-05 14:04:37,696 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.6029, Acc: 0.8400, ]
2022-11-05 14:04:38,389 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 174, n_lower: 371
2022-11-05 14:04:38,391 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 42, n_lower: 329
2022-11-05 14:04:38,392 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 86, n_lower: 369
2022-11-05 14:04:38,392 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 369
2022-11-05 14:04:38,393 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.4869, Acc: 0.8700, ]
2022-11-05 14:04:38,490 INFO: Epoch 4, Validation Step:

2022-11-05 14:05:46,710 INFO: [Test_acc of task 4 on test 1: 0.56788][acc of former classes: 0.71100][acc of former samples in all classes: 0.67783]
[acc of novel samples in all classes: 0.23800]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:05:47,606 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 176, n_lower: 391
2022-11-05 14:05:47,613 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 47, n_lower: 345
2022-11-05 14:05:47,616 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 147, n_lower: 431
2022-11-05 14:05:47,623 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 371
2022-11-05 14:05:47,628 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3937, Acc: 0.8600, ]
2022-11-05 14:05:47,752 INFO: fine-tune procedure is finished!
2022-11-05 14:06:57,798 INFO: [Test_acc of task 4 on test 1: 0.56712][acc of former classes: 0.71100][acc of former samples in all classes: 0.67750]
[acc of novel samples in all classes: 0.23600]
2022-11-05 14:06:57,879 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:06:57,924 WARNING: Current net - loaded net:
2022-11-05 14:06:57,924 WARNING: Loaded net - current net:
2022-11-05 14:06:57,924 WARNING:   func.fc.bias
2022-11-05 14:06:57,924 WARNING:   func.fc.weight
2022-11-05 14:06:57,959 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_4.pth.
2022-11-05 14:06:58,004 INFO: Obtain parameters for train
2022-11-05 14:06:58,009 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:06:58,009 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:06:58,010 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:06:58,011 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:06:58,012 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:06:58,012 INFO: Model [MTNBModel] is created.
2022-11-05 14:06:58,023 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:06:58,032 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:06:58,042 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:06:58,050 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:06:58,055 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:06:58,606 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 168, n_lower: 333
2022-11-05 14:06:58,611 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 41, n_lower: 319
2022-11-05 14:06:58,616 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 47, n_lower: 376
2022-11-05 14:06:58,619 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 350
2022-11-05 14:06:58,624 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5594, Acc: 0.8160, ]
2022-11-05 14:07:00,380 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 200, n_lower: 368
2022-11-05 14:07:00,387 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 42, n_lower: 331
2022-11-05 14:07:00,391 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 399
2022-11-05 14:07:00,395 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 356
2022-11-05 14:07:00,401 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4527, Acc: 0.8640, ]
2022-11-05 14:07:01,327 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 404, n_lower: 464
2022-11-05 14:07:01,335 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 69, n_lower: 397
2022-11-05 14:07:01,340 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 72, n_lower: 447
2022-11-05 14:07:01,347 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 381
2022-11-05 14:07:01,352 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5360, Acc: 0.8320, ]
2022-11-05 14:07:02,262 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 470, n_lower: 524
2022-11-05 14:07:02,263 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 74, n_lower: 426
2022-11-05 14:07:02,264 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 77, n_lower: 488
2022-11-05 14:07:02,265 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 52, n_lower: 381
2022-11-05 14:07:02,265 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4018, Acc: 0.8720, ]
2022-11-05 14:07:03,060 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 471, n_lower: 542
2022-11-05 14:07:03,061 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 451
2022-11-05 14:07:03,062 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 91, n_lower: 567
2022-11-05 14:07:03,065 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 65, n_lower: 390
2022-11-05 14:07:03,066 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3859, Acc: 0.8480, ]
2022-11-05 14:07:03,119 INFO: Epoch 4, Validation Step:

2022-11-05 14:08:15,083 INFO: [Test_acc of task 5 on test 1: 0.54459][acc of former classes: 0.71183][acc of former samples in all classes: 0.66783]
[acc of novel samples in all classes: 0.24880]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:08:15,897 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 532, n_lower: 564
2022-11-05 14:08:15,901 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 89, n_lower: 456
2022-11-05 14:08:15,907 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 99, n_lower: 588
2022-11-05 14:08:15,909 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 65, n_lower: 391
2022-11-05 14:08:15,916 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3073, Acc: 0.8880, ]
2022-11-05 14:08:16,021 INFO: fine-tune procedure is finished!
2022-11-05 14:09:23,939 INFO: [Test_acc of task 5 on test 1: 0.54388][acc of former classes: 0.71133][acc of former samples in all classes: 0.66700]
[acc of novel samples in all classes: 0.24840]
2022-11-05 14:09:23,992 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:09:24,000 WARNING: Current net - loaded net:
2022-11-05 14:09:24,000 WARNING: Loaded net - current net:
2022-11-05 14:09:24,000 WARNING:   func.fc.bias
2022-11-05 14:09:24,000 WARNING:   func.fc.weight
2022-11-05 14:09:24,040 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_5.pth.
2022-11-05 14:09:24,084 INFO: Obtain parameters for train
2022-11-05 14:09:24,087 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:09:24,087 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:09:24,088 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:09:24,089 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:09:24,089 INFO: Model [MTNBModel] is created.
2022-11-05 14:09:24,095 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:09:24,101 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:09:24,106 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:09:24,112 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:09:24,118 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:09:24,123 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:09:24,812 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 247, n_lower: 470
2022-11-05 14:09:24,817 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 36, n_lower: 382
2022-11-05 14:09:24,822 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 61, n_lower: 517
2022-11-05 14:09:24,827 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 368
2022-11-05 14:09:24,831 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4618, Acc: 0.8600, ]
2022-11-05 14:09:25,644 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 249, n_lower: 474
2022-11-05 14:09:25,650 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 36, n_lower: 383
2022-11-05 14:09:25,654 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 61, n_lower: 519
2022-11-05 14:09:25,661 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 368
2022-11-05 14:09:25,663 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4736, Acc: 0.8467, ]
2022-11-05 14:09:26,541 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 273, n_lower: 492
2022-11-05 14:09:26,549 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 385
2022-11-05 14:09:26,557 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 63, n_lower: 538
2022-11-05 14:09:26,566 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 368
2022-11-05 14:09:26,574 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.3282, Acc: 0.9000, ]
2022-11-05 14:09:27,467 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 287, n_lower: 499
2022-11-05 14:09:27,474 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 385
2022-11-05 14:09:27,481 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 63, n_lower: 540
2022-11-05 14:09:27,487 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 368
2022-11-05 14:09:27,495 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3896, Acc: 0.8600, ]
2022-11-05 14:09:28,118 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 321, n_lower: 513
2022-11-05 14:09:28,125 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 387
2022-11-05 14:09:28,131 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 69, n_lower: 551
2022-11-05 14:09:28,137 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 55, n_lower: 373
2022-11-05 14:09:28,145 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.4769, Acc: 0.8333, ]
2022-11-05 14:09:28,294 INFO: Epoch 4, Validation Step:

2022-11-05 14:10:44,887 INFO: [Test_acc of task 6 on test 1: 0.52678][acc of former classes: 0.71183][acc of former samples in all classes: 0.66133]
[acc of novel samples in all classes: 0.25767]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:10:45,964 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 323, n_lower: 514
2022-11-05 14:10:45,969 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 387
2022-11-05 14:10:45,972 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 69, n_lower: 551
2022-11-05 14:10:45,978 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 57, n_lower: 373
2022-11-05 14:10:45,983 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3975, Acc: 0.8600, ]
2022-11-05 14:10:46,094 INFO: fine-tune procedure is finished!
2022-11-05 14:12:05,661 INFO: [Test_acc of task 6 on test 1: 0.52678][acc of former classes: 0.71133][acc of former samples in all classes: 0.66050]
[acc of novel samples in all classes: 0.25933]
2022-11-05 14:12:05,684 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:12:05,693 WARNING: Current net - loaded net:
2022-11-05 14:12:05,693 WARNING: Loaded net - current net:
2022-11-05 14:12:05,693 WARNING:   func.fc.bias
2022-11-05 14:12:05,693 WARNING:   func.fc.weight
2022-11-05 14:12:05,710 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_6.pth.
2022-11-05 14:12:05,735 INFO: Obtain parameters for train
2022-11-05 14:12:05,738 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:12:05,738 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:12:05,738 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:12:05,738 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:12:05,738 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:12:05,738 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:12:05,739 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:12:05,740 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:12:05,741 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:12:05,742 INFO: Model [MTNBModel] is created.
2022-11-05 14:12:05,751 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:12:05,759 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:12:05,767 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:12:05,776 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:12:05,784 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:12:05,792 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:12:05,801 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 14:12:06,502 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 231, n_lower: 482
2022-11-05 14:12:06,509 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 386
2022-11-05 14:12:06,517 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 69, n_lower: 548
2022-11-05 14:12:06,524 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 57, n_lower: 370
2022-11-05 14:12:06,530 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5663, Acc: 0.8171, ]
2022-11-05 14:12:07,283 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 231, n_lower: 482
2022-11-05 14:12:07,284 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 41, n_lower: 387
2022-11-05 14:12:07,289 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 75, n_lower: 557
2022-11-05 14:12:07,294 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 57, n_lower: 370
2022-11-05 14:12:07,295 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.6259, Acc: 0.8171, ]
2022-11-05 14:12:08,261 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 255, n_lower: 483
2022-11-05 14:12:08,270 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 54, n_lower: 389
2022-11-05 14:12:08,278 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 97, n_lower: 577
2022-11-05 14:12:08,286 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 61, n_lower: 374
2022-11-05 14:12:08,289 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5589, Acc: 0.8514, ]
2022-11-05 14:12:09,048 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 256, n_lower: 483
2022-11-05 14:12:09,054 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 397
2022-11-05 14:12:09,062 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 123, n_lower: 599
2022-11-05 14:12:09,064 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 62, n_lower: 381
2022-11-05 14:12:09,070 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5880, Acc: 0.8400, ]
2022-11-05 14:12:10,115 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 328, n_lower: 489
2022-11-05 14:12:10,124 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 397
2022-11-05 14:12:10,133 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 127, n_lower: 600
2022-11-05 14:12:10,141 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 64, n_lower: 381
2022-11-05 14:12:10,150 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5965, Acc: 0.8286, ]
2022-11-05 14:12:10,246 INFO: Epoch 4, Validation Step:

2022-11-05 14:13:28,121 INFO: [Test_acc of task 7 on test 1: 0.51084][acc of former classes: 0.71183][acc of former samples in all classes: 0.65750]
[acc of novel samples in all classes: 0.25943]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 14:13:29,038 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 328, n_lower: 489
2022-11-05 14:13:29,043 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 401
2022-11-05 14:13:29,048 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 132, n_lower: 614
2022-11-05 14:13:29,055 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 65, n_lower: 385
2022-11-05 14:13:29,061 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4592, Acc: 0.8686, ]
2022-11-05 14:13:29,166 INFO: fine-tune procedure is finished!
2022-11-05 14:14:51,788 INFO: [Test_acc of task 7 on test 1: 0.51063][acc of former classes: 0.71150][acc of former samples in all classes: 0.65733]
[acc of novel samples in all classes: 0.25914]
2022-11-05 14:14:51,853 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:14:51,860 WARNING: Current net - loaded net:
2022-11-05 14:14:51,860 WARNING: Loaded net - current net:
2022-11-05 14:14:51,860 WARNING:   func.fc.bias
2022-11-05 14:14:51,860 WARNING:   func.fc.weight
2022-11-05 14:14:51,908 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_7.pth.
2022-11-05 14:14:51,957 INFO: Obtain parameters for train
2022-11-05 14:14:51,961 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:14:51,961 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:14:51,962 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:14:51,963 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:14:51,963 INFO: Model [MTNBModel] is created.
2022-11-05 14:14:51,970 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:14:51,978 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:14:51,984 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:14:51,989 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:14:51,994 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:14:51,999 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:14:52,005 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:14:52,010 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:14:52,954 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 254, n_lower: 488
2022-11-05 14:14:52,955 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 43, n_lower: 393
2022-11-05 14:14:52,956 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 81, n_lower: 582
2022-11-05 14:14:52,964 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 375
2022-11-05 14:14:52,970 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.6113, Acc: 0.8300, ]
2022-11-05 14:14:53,854 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 274, n_lower: 505
2022-11-05 14:14:53,855 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 43, n_lower: 393
2022-11-05 14:14:53,856 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 87, n_lower: 582
2022-11-05 14:14:53,857 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 376
2022-11-05 14:14:53,858 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.7725, Acc: 0.7900, ]
2022-11-05 14:14:54,936 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 277, n_lower: 507
2022-11-05 14:14:54,937 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 43, n_lower: 393
2022-11-05 14:14:54,938 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 87, n_lower: 583
2022-11-05 14:14:54,939 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 376
2022-11-05 14:14:54,940 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4890, Acc: 0.8400, ]
2022-11-05 14:14:55,961 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 295, n_lower: 513
2022-11-05 14:14:55,970 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 45, n_lower: 395
2022-11-05 14:14:55,978 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 98, n_lower: 585
2022-11-05 14:14:55,986 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 376
2022-11-05 14:14:55,994 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5751, Acc: 0.8200, ]
2022-11-05 14:14:56,814 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 306, n_lower: 513
2022-11-05 14:14:56,815 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 47, n_lower: 397
2022-11-05 14:14:56,816 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 101, n_lower: 589
2022-11-05 14:14:56,816 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 376
2022-11-05 14:14:56,817 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5516, Acc: 0.8250, ]
2022-11-05 14:14:56,880 INFO: Epoch 4, Validation Step:

2022-11-05 14:16:18,779 INFO: [Test_acc of task 8 on test 1: 0.48780][acc of former classes: 0.71100][acc of former samples in all classes: 0.64700]
[acc of novel samples in all classes: 0.24900]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:16:19,690 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 307, n_lower: 514
2022-11-05 14:16:19,695 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 49, n_lower: 398
2022-11-05 14:16:19,700 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 120, n_lower: 596
2022-11-05 14:16:19,705 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 59, n_lower: 376
2022-11-05 14:16:19,710 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4759, Acc: 0.8700, ]
2022-11-05 14:16:19,813 INFO: fine-tune procedure is finished!
2022-11-05 14:17:40,160 INFO: [Test_acc of task 8 on test 1: 0.48790][acc of former classes: 0.71117][acc of former samples in all classes: 0.64700]
[acc of novel samples in all classes: 0.24925]
2022-11-05 14:17:40,243 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:17:40,253 WARNING: Current net - loaded net:
2022-11-05 14:17:40,253 WARNING: Loaded net - current net:
2022-11-05 14:17:40,253 WARNING:   func.fc.bias
2022-11-05 14:17:40,253 WARNING:   func.fc.weight
2022-11-05 14:17:40,293 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth.
2022-11-05 14:17:40,340 INFO: Obtain parameters for train
2022-11-05 14:17:40,345 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:17:40,345 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:17:40,346 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:17:40,347 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:17:40,348 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:17:40,349 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:17:40,349 INFO: Model [MTNBModel] is created.
2022-11-05 14:17:40,359 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 14:17:40,990 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4032, Acc: 0.8800, ]
2022-11-05 14:17:41,685 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 5, n_lower: 0
2022-11-05 14:17:41,693 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0366, Acc: 1.0000, ]
2022-11-05 14:17:42,366 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 403, n_lower: 69
2022-11-05 14:17:42,373 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 31, n_lower: 151
2022-11-05 14:17:42,380 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 102, n_lower: 324
2022-11-05 14:17:42,386 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 128
2022-11-05 14:17:42,391 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0463, Acc: 1.0000, ]
2022-11-05 14:17:42,959 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 403, n_lower: 80
2022-11-05 14:17:42,966 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 31, n_lower: 152
2022-11-05 14:17:42,972 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 102, n_lower: 328
2022-11-05 14:17:42,977 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 128
2022-11-05 14:17:42,983 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0531, Acc: 1.0000, ]
2022-11-05 14:17:43,697 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 413, n_lower: 88
2022-11-05 14:17:43,704 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 36, n_lower: 196
2022-11-05 14:17:43,710 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 102, n_lower: 339
2022-11-05 14:17:43,715 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 142
2022-11-05 14:17:43,720 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0306, Acc: 1.0000, ]
2022-11-05 14:17:43,737 INFO: Epoch 4, Validation Step:

2022-11-05 14:18:42,587 INFO: [Test_acc of task 1 on test 2: 0.67415][acc of former classes: 0.71150][acc of former samples in all classes: 0.70150]
[acc of novel samples in all classes: 0.34600]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
2022-11-05 14:18:43,272 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 421, n_lower: 129
2022-11-05 14:18:43,273 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 41, n_lower: 269
2022-11-05 14:18:43,273 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 106, n_lower: 417
2022-11-05 14:18:43,274 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 162
2022-11-05 14:18:43,275 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0123, Acc: 1.0000, ]
2022-11-05 14:18:43,375 INFO: fine-tune procedure is finished!
2022-11-05 14:19:39,828 INFO: [Test_acc of task 1 on test 2: 0.67400][acc of former classes: 0.71133][acc of former samples in all classes: 0.70133]
[acc of novel samples in all classes: 0.34600]
2022-11-05 14:19:39,880 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:19:39,889 WARNING: Current net - loaded net:
2022-11-05 14:19:39,890 WARNING: Loaded net - current net:
2022-11-05 14:19:39,890 WARNING:   func.fc.bias
2022-11-05 14:19:39,890 WARNING:   func.fc.weight
2022-11-05 14:19:39,927 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_1.pth.
2022-11-05 14:19:39,972 INFO: Obtain parameters for train
2022-11-05 14:19:39,977 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:19:39,977 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:19:39,978 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:19:39,979 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:19:39,979 INFO: Model [MTNBModel] is created.
2022-11-05 14:19:39,985 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:19:39,991 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:19:40,471 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 135, n_lower: 85
2022-11-05 14:19:40,477 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 8, n_lower: 159
2022-11-05 14:19:40,479 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 32, n_lower: 231
2022-11-05 14:19:40,482 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 84
2022-11-05 14:19:40,487 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.2297, Acc: 0.9200, ]
2022-11-05 14:19:41,259 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 146, n_lower: 85
2022-11-05 14:19:41,264 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 8, n_lower: 162
2022-11-05 14:19:41,270 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 32, n_lower: 246
2022-11-05 14:19:41,274 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 92
2022-11-05 14:19:41,278 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.2987, Acc: 0.9000, ]
2022-11-05 14:19:41,961 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 210, n_lower: 99
2022-11-05 14:19:41,968 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 17, n_lower: 199
2022-11-05 14:19:41,976 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 48, n_lower: 293
2022-11-05 14:19:41,982 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 1, n_lower: 119
2022-11-05 14:19:41,986 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.3541, Acc: 0.9200, ]
2022-11-05 14:19:42,757 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 270, n_lower: 134
2022-11-05 14:19:42,765 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 17, n_lower: 204
2022-11-05 14:19:42,771 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 48, n_lower: 305
2022-11-05 14:19:42,777 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 129
2022-11-05 14:19:42,783 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3574, Acc: 0.9400, ]
2022-11-05 14:19:43,474 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 274, n_lower: 134
2022-11-05 14:19:43,482 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 33, n_lower: 232
2022-11-05 14:19:43,490 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 53, n_lower: 349
2022-11-05 14:19:43,498 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 158
2022-11-05 14:19:43,506 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.2196, Acc: 0.8800, ]
2022-11-05 14:19:43,551 INFO: Epoch 4, Validation Step:

2022-11-05 14:20:47,434 INFO: [Test_acc of task 2 on test 2: 0.63829][acc of former classes: 0.71033][acc of former samples in all classes: 0.69317]
[acc of novel samples in all classes: 0.30900]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:20:48,180 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 275, n_lower: 135
2022-11-05 14:20:48,182 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 34, n_lower: 234
2022-11-05 14:20:48,183 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 53, n_lower: 349
2022-11-05 14:20:48,183 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 159
2022-11-05 14:20:48,184 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.1306, Acc: 0.9600, ]
2022-11-05 14:20:48,339 INFO: fine-tune procedure is finished!
2022-11-05 14:21:53,384 INFO: [Test_acc of task 2 on test 2: 0.63914][acc of former classes: 0.71133][acc of former samples in all classes: 0.69400]
[acc of novel samples in all classes: 0.31000]
2022-11-05 14:21:53,416 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:21:53,424 WARNING: Current net - loaded net:
2022-11-05 14:21:53,424 WARNING: Loaded net - current net:
2022-11-05 14:21:53,424 WARNING:   func.fc.bias
2022-11-05 14:21:53,424 WARNING:   func.fc.weight
2022-11-05 14:21:53,505 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_2.pth.
2022-11-05 14:21:53,552 INFO: Obtain parameters for train
2022-11-05 14:21:53,555 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:21:53,555 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:21:53,556 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:21:53,557 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:21:53,558 INFO: Model [MTNBModel] is created.
2022-11-05 14:21:53,565 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:21:53,570 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:21:53,578 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:21:54,172 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 161, n_lower: 124
2022-11-05 14:21:54,179 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 16, n_lower: 210
2022-11-05 14:21:54,183 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 324
2022-11-05 14:21:54,188 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 144
2022-11-05 14:21:54,193 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5472, Acc: 0.8133, ]
2022-11-05 14:21:54,937 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 173, n_lower: 124
2022-11-05 14:21:54,942 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 16, n_lower: 210
2022-11-05 14:21:54,946 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 41, n_lower: 325
2022-11-05 14:21:54,950 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 149
2022-11-05 14:21:54,954 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5994, Acc: 0.8267, ]
2022-11-05 14:21:55,907 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 178, n_lower: 128
2022-11-05 14:21:55,908 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 25, n_lower: 228
2022-11-05 14:21:55,909 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 83, n_lower: 383
2022-11-05 14:21:55,910 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 157
2022-11-05 14:21:55,911 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6250, Acc: 0.7867, ]
2022-11-05 14:21:56,782 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 181, n_lower: 148
2022-11-05 14:21:56,791 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 25, n_lower: 238
2022-11-05 14:21:56,797 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 87, n_lower: 387
2022-11-05 14:21:56,802 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 12, n_lower: 213
2022-11-05 14:21:56,809 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5646, Acc: 0.8667, ]
2022-11-05 14:21:57,666 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 193, n_lower: 149
2022-11-05 14:21:57,668 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 25, n_lower: 238
2022-11-05 14:21:57,712 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 87, n_lower: 400
2022-11-05 14:21:57,713 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 12, n_lower: 224
2022-11-05 14:21:57,714 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.6592, Acc: 0.8133, ]
2022-11-05 14:21:57,760 INFO: Epoch 4, Validation Step:

2022-11-05 14:23:04,902 INFO: [Test_acc of task 3 on test 2: 0.60120][acc of former classes: 0.71100][acc of former samples in all classes: 0.68433]
[acc of novel samples in all classes: 0.26867]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:23:07,185 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 193, n_lower: 154
2022-11-05 14:23:07,187 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 48, n_lower: 266
2022-11-05 14:23:07,188 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 105, n_lower: 456
2022-11-05 14:23:07,188 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 14, n_lower: 230
2022-11-05 14:23:07,189 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4065, Acc: 0.8800, ]
2022-11-05 14:23:07,350 INFO: fine-tune procedure is finished!
2022-11-05 14:24:16,311 INFO: [Test_acc of task 3 on test 2: 0.60160][acc of former classes: 0.71083][acc of former samples in all classes: 0.68433]
[acc of novel samples in all classes: 0.27067]
2022-11-05 14:24:16,367 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:24:16,374 WARNING: Current net - loaded net:
2022-11-05 14:24:16,374 WARNING: Loaded net - current net:
2022-11-05 14:24:16,374 WARNING:   func.fc.bias
2022-11-05 14:24:16,374 WARNING:   func.fc.weight
2022-11-05 14:24:16,413 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_3.pth.
2022-11-05 14:24:16,456 INFO: Obtain parameters for train
2022-11-05 14:24:16,460 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:24:16,460 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:24:16,461 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:24:16,462 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:24:16,462 INFO: Model [MTNBModel] is created.
2022-11-05 14:24:16,469 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:24:16,474 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:24:16,480 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:24:16,485 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:24:17,392 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 180, n_lower: 144
2022-11-05 14:24:17,399 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 27, n_lower: 258
2022-11-05 14:24:17,401 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 50, n_lower: 410
2022-11-05 14:24:17,408 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 6, n_lower: 219
2022-11-05 14:24:17,411 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5329, Acc: 0.8300, ]
2022-11-05 14:24:18,121 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 197, n_lower: 144
2022-11-05 14:24:18,128 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 81, n_lower: 290
2022-11-05 14:24:18,133 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 50, n_lower: 411
2022-11-05 14:24:18,137 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 269
2022-11-05 14:24:18,143 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4879, Acc: 0.8100, ]
2022-11-05 14:24:18,919 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 210, n_lower: 144
2022-11-05 14:24:18,926 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 120, n_lower: 385
2022-11-05 14:24:18,935 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 431
2022-11-05 14:24:19,010 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 20, n_lower: 321
2022-11-05 14:24:19,014 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4464, Acc: 0.8600, ]
2022-11-05 14:24:20,275 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 218, n_lower: 145
2022-11-05 14:24:20,341 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 181, n_lower: 419
2022-11-05 14:24:20,342 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 64, n_lower: 450
2022-11-05 14:24:20,343 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 30, n_lower: 368
2022-11-05 14:24:20,343 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4122, Acc: 0.8700, ]
2022-11-05 14:24:21,122 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 231, n_lower: 145
2022-11-05 14:24:21,123 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 213, n_lower: 436
2022-11-05 14:24:21,124 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 79, n_lower: 543
2022-11-05 14:24:21,125 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 49, n_lower: 379
2022-11-05 14:24:21,127 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.4390, Acc: 0.8700, ]
2022-11-05 14:24:21,277 INFO: Epoch 4, Validation Step:

2022-11-05 14:25:37,327 INFO: [Test_acc of task 4 on test 2: 0.57012][acc of former classes: 0.71083][acc of former samples in all classes: 0.67733]
[acc of novel samples in all classes: 0.24850]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:25:38,919 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 233, n_lower: 145
2022-11-05 14:25:38,921 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 227, n_lower: 471
2022-11-05 14:25:38,922 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 79, n_lower: 571
2022-11-05 14:25:38,923 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 49, n_lower: 383
2022-11-05 14:25:38,923 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.2977, Acc: 0.9200, ]
2022-11-05 14:25:39,123 INFO: fine-tune procedure is finished!
2022-11-05 14:26:54,072 INFO: [Test_acc of task 4 on test 2: 0.57000][acc of former classes: 0.71117][acc of former samples in all classes: 0.67733]
[acc of novel samples in all classes: 0.24800]
2022-11-05 14:26:54,120 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:26:54,130 WARNING: Current net - loaded net:
2022-11-05 14:26:54,130 WARNING: Loaded net - current net:
2022-11-05 14:26:54,130 WARNING:   func.fc.bias
2022-11-05 14:26:54,130 WARNING:   func.fc.weight
2022-11-05 14:26:54,148 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_4.pth.
2022-11-05 14:26:54,222 INFO: Obtain parameters for train
2022-11-05 14:26:54,226 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:26:54,226 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:26:54,227 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:26:54,228 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:26:54,229 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:26:54,229 INFO: Model [MTNBModel] is created.
2022-11-05 14:26:54,248 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:26:54,262 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:26:54,269 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:26:54,373 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:26:54,380 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:26:55,008 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 181, n_lower: 145
2022-11-05 14:26:55,013 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 69, n_lower: 368
2022-11-05 14:26:55,017 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 522
2022-11-05 14:26:55,020 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 299
2022-11-05 14:26:55,026 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4117, Acc: 0.8560, ]
2022-11-05 14:26:56,042 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 195, n_lower: 145
2022-11-05 14:26:56,049 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 69, n_lower: 371
2022-11-05 14:26:56,055 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 62, n_lower: 530
2022-11-05 14:26:56,063 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 299
2022-11-05 14:26:56,069 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4314, Acc: 0.8640, ]
2022-11-05 14:26:57,209 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 231, n_lower: 144
2022-11-05 14:26:57,215 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 87, n_lower: 373
2022-11-05 14:26:57,221 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 109, n_lower: 549
2022-11-05 14:26:57,224 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 19, n_lower: 299
2022-11-05 14:26:57,228 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4647, Acc: 0.8320, ]
2022-11-05 14:26:58,114 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 263, n_lower: 163
2022-11-05 14:26:58,119 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 87, n_lower: 375
2022-11-05 14:26:58,131 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 116, n_lower: 582
2022-11-05 14:26:58,133 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 19, n_lower: 301
2022-11-05 14:26:58,139 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4127, Acc: 0.8480, ]
2022-11-05 14:26:59,032 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 322, n_lower: 185
2022-11-05 14:26:59,038 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 111, n_lower: 375
2022-11-05 14:26:59,042 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 124, n_lower: 593
2022-11-05 14:26:59,043 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 19, n_lower: 301
2022-11-05 14:26:59,044 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3351, Acc: 0.8880, ]
2022-11-05 14:26:59,097 INFO: Epoch 4, Validation Step:

2022-11-05 14:28:14,827 INFO: [Test_acc of task 5 on test 2: 0.54671][acc of former classes: 0.71067][acc of former samples in all classes: 0.66783]
[acc of novel samples in all classes: 0.25600]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:28:15,961 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 410, n_lower: 263
2022-11-05 14:28:15,969 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 114, n_lower: 385
2022-11-05 14:28:15,975 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 146, n_lower: 610
2022-11-05 14:28:15,979 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 19, n_lower: 307
2022-11-05 14:28:15,983 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.2984, Acc: 0.8480, ]
2022-11-05 14:28:16,087 INFO: fine-tune procedure is finished!
2022-11-05 14:29:32,433 INFO: [Test_acc of task 5 on test 2: 0.54706][acc of former classes: 0.71133][acc of former samples in all classes: 0.66833]
[acc of novel samples in all classes: 0.25600]
2022-11-05 14:29:32,476 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:29:32,482 WARNING: Current net - loaded net:
2022-11-05 14:29:32,482 WARNING: Loaded net - current net:
2022-11-05 14:29:32,482 WARNING:   func.fc.bias
2022-11-05 14:29:32,482 WARNING:   func.fc.weight
2022-11-05 14:29:32,518 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_5.pth.
2022-11-05 14:29:32,584 INFO: Obtain parameters for train
2022-11-05 14:29:32,588 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:29:32,588 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:29:32,589 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:29:32,590 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:29:32,591 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:29:32,591 INFO: Model [MTNBModel] is created.
2022-11-05 14:29:32,602 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:29:32,611 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:29:32,619 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:29:32,628 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:29:32,636 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:29:32,644 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:29:33,155 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 229, n_lower: 229
2022-11-05 14:29:33,160 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 378
2022-11-05 14:29:33,167 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 80, n_lower: 583
2022-11-05 14:29:33,169 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 297
2022-11-05 14:29:33,174 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5278, Acc: 0.8133, ]
2022-11-05 14:29:34,234 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 263, n_lower: 230
2022-11-05 14:29:34,237 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 71, n_lower: 378
2022-11-05 14:29:34,244 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 80, n_lower: 585
2022-11-05 14:29:34,246 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 297
2022-11-05 14:29:34,252 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4584, Acc: 0.8667, ]
2022-11-05 14:29:35,083 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 282, n_lower: 240
2022-11-05 14:29:35,092 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 72, n_lower: 381
2022-11-05 14:29:35,097 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 80, n_lower: 641
2022-11-05 14:29:35,098 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 297
2022-11-05 14:29:35,099 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5038, Acc: 0.8667, ]
2022-11-05 14:29:36,049 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 316, n_lower: 243
2022-11-05 14:29:36,057 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 383
2022-11-05 14:29:36,062 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 82, n_lower: 654
2022-11-05 14:29:36,071 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 17, n_lower: 297
2022-11-05 14:29:36,077 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4685, Acc: 0.8667, ]
2022-11-05 14:29:37,054 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 330, n_lower: 297
2022-11-05 14:29:37,060 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 391
2022-11-05 14:29:37,065 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 93, n_lower: 665
2022-11-05 14:29:37,072 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 17, n_lower: 297
2022-11-05 14:29:37,078 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.4735, Acc: 0.8800, ]
2022-11-05 14:29:37,151 INFO: Epoch 4, Validation Step:

2022-11-05 14:30:58,831 INFO: [Test_acc of task 6 on test 2: 0.52733][acc of former classes: 0.71067][acc of former samples in all classes: 0.65850]
[acc of novel samples in all classes: 0.26500]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:30:59,919 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 337, n_lower: 304
2022-11-05 14:30:59,936 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 89, n_lower: 394
2022-11-05 14:30:59,937 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 94, n_lower: 683
2022-11-05 14:30:59,938 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 17, n_lower: 297
2022-11-05 14:30:59,939 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4349, Acc: 0.8733, ]
2022-11-05 14:31:00,247 INFO: fine-tune procedure is finished!
2022-11-05 14:32:22,961 INFO: [Test_acc of task 6 on test 2: 0.52756][acc of former classes: 0.71083][acc of former samples in all classes: 0.65900]
[acc of novel samples in all classes: 0.26467]
2022-11-05 14:32:23,002 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:32:23,009 WARNING: Current net - loaded net:
2022-11-05 14:32:23,009 WARNING: Loaded net - current net:
2022-11-05 14:32:23,009 WARNING:   func.fc.bias
2022-11-05 14:32:23,009 WARNING:   func.fc.weight
2022-11-05 14:32:23,034 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_6.pth.
2022-11-05 14:32:23,072 INFO: Obtain parameters for train
2022-11-05 14:32:23,075 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:32:23,076 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:32:23,077 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:32:23,078 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:32:23,078 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:32:23,078 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:32:23,078 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:32:23,078 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:32:23,078 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:32:23,078 INFO: Model [MTNBModel] is created.
2022-11-05 14:32:23,085 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:32:23,090 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:32:23,096 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:32:23,101 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:32:23,107 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:32:23,112 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:32:23,118 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 14:32:24,067 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 249, n_lower: 282
2022-11-05 14:32:24,078 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 74, n_lower: 391
2022-11-05 14:32:24,082 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 80, n_lower: 638
2022-11-05 14:32:24,087 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 300
2022-11-05 14:32:24,093 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.7428, Acc: 0.8171, ]
2022-11-05 14:32:25,053 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 250, n_lower: 282
2022-11-05 14:32:25,055 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 75, n_lower: 400
2022-11-05 14:32:25,056 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 80, n_lower: 639
2022-11-05 14:32:25,062 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 300
2022-11-05 14:32:25,067 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.7358, Acc: 0.8286, ]
2022-11-05 14:32:26,034 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 259, n_lower: 290
2022-11-05 14:32:26,036 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 77, n_lower: 421
2022-11-05 14:32:26,036 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 80, n_lower: 639
2022-11-05 14:32:26,037 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 303
2022-11-05 14:32:26,038 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6428, Acc: 0.8400, ]
2022-11-05 14:32:27,149 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 260, n_lower: 291
2022-11-05 14:32:27,154 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 88, n_lower: 432
2022-11-05 14:32:27,157 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 101, n_lower: 645
2022-11-05 14:32:27,162 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 315
2022-11-05 14:32:27,168 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.7286, Acc: 0.8057, ]
2022-11-05 14:32:27,987 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 284, n_lower: 329
2022-11-05 14:32:27,993 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 435
2022-11-05 14:32:27,999 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 101, n_lower: 647
2022-11-05 14:32:28,005 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 22, n_lower: 320
2022-11-05 14:32:28,010 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.7429, Acc: 0.8000, ]
2022-11-05 14:32:28,098 INFO: Epoch 4, Validation Step:

2022-11-05 14:33:47,823 INFO: [Test_acc of task 7 on test 2: 0.50916][acc of former classes: 0.71083][acc of former samples in all classes: 0.65283]
[acc of novel samples in all classes: 0.26286]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 14:33:49,812 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 287, n_lower: 329
2022-11-05 14:33:49,821 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 100, n_lower: 456
2022-11-05 14:33:49,828 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 143, n_lower: 681
2022-11-05 14:33:49,833 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 22, n_lower: 326
2022-11-05 14:33:49,842 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5741, Acc: 0.8514, ]
2022-11-05 14:33:49,998 INFO: fine-tune procedure is finished!
2022-11-05 14:35:03,959 INFO: [Test_acc of task 7 on test 2: 0.50937][acc of former classes: 0.71100][acc of former samples in all classes: 0.65317]
[acc of novel samples in all classes: 0.26286]
2022-11-05 14:35:03,987 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:35:03,995 WARNING: Current net - loaded net:
2022-11-05 14:35:03,995 WARNING: Loaded net - current net:
2022-11-05 14:35:03,995 WARNING:   func.fc.bias
2022-11-05 14:35:03,995 WARNING:   func.fc.weight
2022-11-05 14:35:04,009 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_7.pth.
2022-11-05 14:35:04,030 INFO: Obtain parameters for train
2022-11-05 14:35:04,032 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:35:04,032 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:35:04,032 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:35:04,032 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:35:04,032 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:35:04,032 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:35:04,032 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:35:04,032 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:35:04,033 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:35:04,034 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:35:04,035 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:35:04,035 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:35:04,035 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:35:04,035 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:35:04,035 INFO: Model [MTNBModel] is created.
2022-11-05 14:35:04,043 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:35:04,049 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:35:04,056 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:35:04,062 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:35:04,068 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:35:04,074 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:35:04,080 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:35:04,085 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:35:04,838 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 246, n_lower: 310
2022-11-05 14:35:04,840 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 434
2022-11-05 14:35:04,840 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 126, n_lower: 670
2022-11-05 14:35:04,841 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 318
2022-11-05 14:35:04,842 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.6067, Acc: 0.8100, ]
2022-11-05 14:35:05,603 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 246, n_lower: 311
2022-11-05 14:35:05,605 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 435
2022-11-05 14:35:05,605 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 126, n_lower: 673
2022-11-05 14:35:05,606 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 318
2022-11-05 14:35:05,607 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5535, Acc: 0.8550, ]
2022-11-05 14:35:06,570 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 265, n_lower: 333
2022-11-05 14:35:06,572 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 437
2022-11-05 14:35:06,572 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 159, n_lower: 685
2022-11-05 14:35:06,573 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 16, n_lower: 318
2022-11-05 14:35:06,574 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6263, Acc: 0.8400, ]
2022-11-05 14:35:07,584 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 274, n_lower: 344
2022-11-05 14:35:07,585 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 80, n_lower: 440
2022-11-05 14:35:07,586 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 159, n_lower: 693
2022-11-05 14:35:07,587 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 319
2022-11-05 14:35:07,587 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.8124, Acc: 0.7800, ]
2022-11-05 14:35:08,625 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 302, n_lower: 360
2022-11-05 14:35:08,626 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 80, n_lower: 441
2022-11-05 14:35:08,627 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 159, n_lower: 709
2022-11-05 14:35:08,628 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 319
2022-11-05 14:35:08,629 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.7299, Acc: 0.8150, ]
2022-11-05 14:35:08,708 INFO: Epoch 4, Validation Step:

2022-11-05 14:36:24,608 INFO: [Test_acc of task 8 on test 2: 0.48760][acc of former classes: 0.71000][acc of former samples in all classes: 0.64650]
[acc of novel samples in all classes: 0.24925]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:36:25,383 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 315, n_lower: 382
2022-11-05 14:36:25,390 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 83, n_lower: 451
2022-11-05 14:36:25,396 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 159, n_lower: 711
2022-11-05 14:36:25,403 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 323
2022-11-05 14:36:25,410 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4760, Acc: 0.8700, ]
2022-11-05 14:36:25,660 INFO: fine-tune procedure is finished!
2022-11-05 14:37:46,196 INFO: [Test_acc of task 8 on test 2: 0.48750][acc of former classes: 0.70967][acc of former samples in all classes: 0.64667]
[acc of novel samples in all classes: 0.24875]
2022-11-05 14:37:46,255 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:37:46,261 WARNING: Current net - loaded net:
2022-11-05 14:37:46,261 WARNING: Loaded net - current net:
2022-11-05 14:37:46,261 WARNING:   func.fc.bias
2022-11-05 14:37:46,261 WARNING:   func.fc.weight
2022-11-05 14:37:46,285 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth.
2022-11-05 14:37:46,336 INFO: Obtain parameters for train
2022-11-05 14:37:46,340 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:37:46,340 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:37:46,341 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:37:46,342 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:37:46,342 INFO: Model [MTNBModel] is created.
2022-11-05 14:37:46,349 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 14:37:46,965 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 0, n_lower: 9
2022-11-05 14:37:46,967 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.3567, Acc: 0.8800, ]
2022-11-05 14:37:47,653 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 10, n_lower: 2
2022-11-05 14:37:47,655 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 0, n_lower: 17
2022-11-05 14:37:47,655 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 0, n_lower: 1
2022-11-05 14:37:47,656 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.0643, Acc: 1.0000, ]
2022-11-05 14:37:48,541 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 350, n_lower: 261
2022-11-05 14:37:48,542 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 37, n_lower: 181
2022-11-05 14:37:48,543 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 111, n_lower: 372
2022-11-05 14:37:48,544 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 129
2022-11-05 14:37:48,544 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0442, Acc: 1.0000, ]
2022-11-05 14:37:49,411 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 366, n_lower: 280
2022-11-05 14:37:49,412 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 38, n_lower: 209
2022-11-05 14:37:49,413 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 112, n_lower: 402
2022-11-05 14:37:49,414 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 136
2022-11-05 14:37:49,415 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0759, Acc: 0.9600, ]
2022-11-05 14:37:50,205 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 376, n_lower: 282
2022-11-05 14:37:50,206 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 38, n_lower: 209
2022-11-05 14:37:50,207 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 118, n_lower: 434
2022-11-05 14:37:50,207 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 136
2022-11-05 14:37:50,208 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0105, Acc: 1.0000, ]
2022-11-05 14:37:50,222 INFO: Epoch 4, Validation Step:

2022-11-05 14:38:49,565 INFO: [Test_acc of task 1 on test 3: 0.67754][acc of former classes: 0.71467][acc of former samples in all classes: 0.70167]
[acc of novel samples in all classes: 0.38800]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
2022-11-05 14:38:50,496 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 383, n_lower: 282
2022-11-05 14:38:50,504 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 38, n_lower: 211
2022-11-05 14:38:50,506 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 118, n_lower: 437
2022-11-05 14:38:50,513 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 194
2022-11-05 14:38:50,516 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0025, Acc: 1.0000, ]
2022-11-05 14:38:50,688 INFO: fine-tune procedure is finished!
2022-11-05 14:39:49,334 INFO: [Test_acc of task 1 on test 3: 0.67754][acc of former classes: 0.71467][acc of former samples in all classes: 0.70167]
[acc of novel samples in all classes: 0.38800]
2022-11-05 14:39:49,385 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:39:49,398 WARNING: Current net - loaded net:
2022-11-05 14:39:49,398 WARNING: Loaded net - current net:
2022-11-05 14:39:49,399 WARNING:   func.fc.bias
2022-11-05 14:39:49,399 WARNING:   func.fc.weight
2022-11-05 14:39:49,440 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_1.pth.
2022-11-05 14:39:49,495 INFO: Obtain parameters for train
2022-11-05 14:39:49,499 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:39:49,499 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:39:49,500 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:39:49,501 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:39:49,502 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:39:49,502 INFO: Model [MTNBModel] is created.
2022-11-05 14:39:49,510 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:39:49,518 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:39:50,049 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 129, n_lower: 162
2022-11-05 14:39:50,052 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 104
2022-11-05 14:39:50,057 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 36, n_lower: 259
2022-11-05 14:39:50,061 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 117
2022-11-05 14:39:50,065 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.1471, Acc: 0.9200, ]
2022-11-05 14:39:50,742 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 137, n_lower: 164
2022-11-05 14:39:50,769 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 104
2022-11-05 14:39:50,801 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 36, n_lower: 259
2022-11-05 14:39:50,802 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 2, n_lower: 118
2022-11-05 14:39:50,803 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.2845, Acc: 0.9400, ]
2022-11-05 14:39:52,943 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 137, n_lower: 167
2022-11-05 14:39:52,949 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 106
2022-11-05 14:39:52,956 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 91, n_lower: 328
2022-11-05 14:39:52,965 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 134
2022-11-05 14:39:52,972 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.1095, Acc: 0.9600, ]
2022-11-05 14:39:53,825 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 143, n_lower: 171
2022-11-05 14:39:53,830 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 108
2022-11-05 14:39:53,839 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 91, n_lower: 329
2022-11-05 14:39:53,845 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 237
2022-11-05 14:39:53,851 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.2047, Acc: 0.9200, ]
2022-11-05 14:39:54,907 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 143, n_lower: 171
2022-11-05 14:39:54,914 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 109
2022-11-05 14:39:54,921 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 93, n_lower: 368
2022-11-05 14:39:54,929 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 13, n_lower: 237
2022-11-05 14:39:54,937 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.1285, Acc: 0.9800, ]
2022-11-05 14:39:54,965 INFO: Epoch 4, Validation Step:

2022-11-05 14:41:00,086 INFO: [Test_acc of task 2 on test 3: 0.64171][acc of former classes: 0.71400][acc of former samples in all classes: 0.69267]
[acc of novel samples in all classes: 0.33600]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 14:41:00,866 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 144, n_lower: 186
2022-11-05 14:41:00,868 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 113
2022-11-05 14:41:00,869 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 93, n_lower: 368
2022-11-05 14:41:00,870 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 24, n_lower: 474
2022-11-05 14:41:00,871 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.1006, Acc: 0.9600, ]
2022-11-05 14:41:01,071 INFO: fine-tune procedure is finished!
2022-11-05 14:42:06,487 INFO: [Test_acc of task 2 on test 3: 0.64157][acc of former classes: 0.71417][acc of former samples in all classes: 0.69233]
[acc of novel samples in all classes: 0.33700]
2022-11-05 14:42:06,527 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:42:06,534 WARNING: Current net - loaded net:
2022-11-05 14:42:06,534 WARNING: Loaded net - current net:
2022-11-05 14:42:06,534 WARNING:   func.fc.bias
2022-11-05 14:42:06,534 WARNING:   func.fc.weight
2022-11-05 14:42:06,566 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_2.pth.
2022-11-05 14:42:06,715 INFO: Obtain parameters for train
2022-11-05 14:42:06,719 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:42:06,719 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:42:06,719 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:42:06,719 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:42:06,720 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:42:06,721 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:42:06,722 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:42:06,723 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:42:06,723 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:42:06,723 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:42:06,723 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:42:06,723 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:42:06,723 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:42:06,723 INFO: Model [MTNBModel] is created.
2022-11-05 14:42:06,732 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:06,739 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:42:06,745 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:42:07,411 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 135, n_lower: 179
2022-11-05 14:42:07,415 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 117
2022-11-05 14:42:07,419 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 51, n_lower: 339
2022-11-05 14:42:07,423 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 325
2022-11-05 14:42:07,426 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.3708, Acc: 0.8800, ]
2022-11-05 14:42:08,289 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 139, n_lower: 184
2022-11-05 14:42:08,293 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 13, n_lower: 128
2022-11-05 14:42:08,298 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 51, n_lower: 345
2022-11-05 14:42:08,300 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 325
2022-11-05 14:42:08,304 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5398, Acc: 0.8000, ]
2022-11-05 14:42:09,029 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 246, n_lower: 322
2022-11-05 14:42:09,033 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 21, n_lower: 158
2022-11-05 14:42:09,040 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 52, n_lower: 353
2022-11-05 14:42:09,046 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 334
2022-11-05 14:42:09,048 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.3974, Acc: 0.8800, ]
2022-11-05 14:42:09,753 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 247, n_lower: 348
2022-11-05 14:42:09,759 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 64, n_lower: 342
2022-11-05 14:42:09,766 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 52, n_lower: 355
2022-11-05 14:42:09,771 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 336
2022-11-05 14:42:09,775 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3883, Acc: 0.8800, ]
2022-11-05 14:42:10,625 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 249, n_lower: 349
2022-11-05 14:42:10,632 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 376
2022-11-05 14:42:10,638 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 59, n_lower: 401
2022-11-05 14:42:10,641 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 345
2022-11-05 14:42:10,646 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3817, Acc: 0.8667, ]
2022-11-05 14:42:10,694 INFO: Epoch 4, Validation Step:

2022-11-05 14:43:15,652 INFO: [Test_acc of task 3 on test 3: 0.60400][acc of former classes: 0.71150][acc of former samples in all classes: 0.68450]
[acc of novel samples in all classes: 0.28200]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 14:43:16,365 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 251, n_lower: 350
2022-11-05 14:43:16,370 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 96, n_lower: 408
2022-11-05 14:43:16,375 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 64, n_lower: 401
2022-11-05 14:43:16,380 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 370
2022-11-05 14:43:16,384 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.1986, Acc: 0.9467, ]
2022-11-05 14:43:16,559 INFO: fine-tune procedure is finished!
2022-11-05 14:44:25,475 INFO: [Test_acc of task 3 on test 3: 0.60413][acc of former classes: 0.71167][acc of former samples in all classes: 0.68467]
[acc of novel samples in all classes: 0.28200]
2022-11-05 14:44:25,530 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:44:25,536 WARNING: Current net - loaded net:
2022-11-05 14:44:25,536 WARNING: Loaded net - current net:
2022-11-05 14:44:25,536 WARNING:   func.fc.bias
2022-11-05 14:44:25,536 WARNING:   func.fc.weight
2022-11-05 14:44:25,593 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_3.pth.
2022-11-05 14:44:25,652 INFO: Obtain parameters for train
2022-11-05 14:44:25,656 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:44:25,656 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:44:25,656 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:44:25,657 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:44:25,658 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:44:25,659 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:44:25,660 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:44:25,660 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:44:25,660 INFO: Model [MTNBModel] is created.
2022-11-05 14:44:25,670 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:25,679 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:25,687 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:44:25,693 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:44:26,264 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 172, n_lower: 309
2022-11-05 14:44:26,266 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 36, n_lower: 309
2022-11-05 14:44:26,266 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 60, n_lower: 388
2022-11-05 14:44:26,267 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 355
2022-11-05 14:44:26,267 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4139, Acc: 0.8700, ]
2022-11-05 14:44:27,111 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 181, n_lower: 309
2022-11-05 14:44:27,118 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 37, n_lower: 309
2022-11-05 14:44:27,125 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 60, n_lower: 388
2022-11-05 14:44:27,131 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 355
2022-11-05 14:44:27,138 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.3392, Acc: 0.9000, ]
2022-11-05 14:44:27,803 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 356
2022-11-05 14:44:27,804 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 45, n_lower: 318
2022-11-05 14:44:27,805 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 85, n_lower: 406
2022-11-05 14:44:27,806 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 358
2022-11-05 14:44:27,807 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.3943, Acc: 0.8800, ]
2022-11-05 14:44:28,777 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 225, n_lower: 358
2022-11-05 14:44:28,778 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 45, n_lower: 320
2022-11-05 14:44:28,779 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 87, n_lower: 407
2022-11-05 14:44:28,779 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 358
2022-11-05 14:44:28,780 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4375, Acc: 0.8400, ]
2022-11-05 14:44:29,661 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 241, n_lower: 360
2022-11-05 14:44:29,662 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 324
2022-11-05 14:44:29,663 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 106, n_lower: 416
2022-11-05 14:44:29,664 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 358
2022-11-05 14:44:29,665 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.3857, Acc: 0.8500, ]
2022-11-05 14:44:29,704 INFO: Epoch 4, Validation Step:

2022-11-05 14:45:43,527 INFO: [Test_acc of task 4 on test 3: 0.57700][acc of former classes: 0.71117][acc of former samples in all classes: 0.67933]
[acc of novel samples in all classes: 0.27000]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 14:45:44,416 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 286, n_lower: 399
2022-11-05 14:45:44,422 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 58, n_lower: 329
2022-11-05 14:45:44,428 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 120, n_lower: 442
2022-11-05 14:45:44,430 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 359
2022-11-05 14:45:44,437 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3702, Acc: 0.8500, ]
2022-11-05 14:45:44,549 INFO: fine-tune procedure is finished!
2022-11-05 14:46:54,445 INFO: [Test_acc of task 4 on test 3: 0.57650][acc of former classes: 0.71050][acc of former samples in all classes: 0.67867]
[acc of novel samples in all classes: 0.27000]
2022-11-05 14:46:54,496 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:46:54,505 WARNING: Current net - loaded net:
2022-11-05 14:46:54,505 WARNING: Loaded net - current net:
2022-11-05 14:46:54,505 WARNING:   func.fc.bias
2022-11-05 14:46:54,505 WARNING:   func.fc.weight
2022-11-05 14:46:54,548 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_4.pth.
2022-11-05 14:46:54,602 INFO: Obtain parameters for train
2022-11-05 14:46:54,606 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:46:54,606 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:46:54,607 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:46:54,608 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:46:54,609 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:46:54,610 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:46:54,610 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:46:54,610 INFO: Model [MTNBModel] is created.
2022-11-05 14:46:54,622 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:54,631 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:54,641 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:54,650 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:46:54,660 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:46:55,166 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 184, n_lower: 363
2022-11-05 14:46:55,170 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 39, n_lower: 323
2022-11-05 14:46:55,177 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 425
2022-11-05 14:46:55,183 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 352
2022-11-05 14:46:55,185 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5940, Acc: 0.8160, ]
2022-11-05 14:46:56,318 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 184, n_lower: 366
2022-11-05 14:46:56,325 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 40, n_lower: 328
2022-11-05 14:46:56,331 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 430
2022-11-05 14:46:56,335 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 8, n_lower: 357
2022-11-05 14:46:56,341 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5283, Acc: 0.8320, ]
2022-11-05 14:46:57,154 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 184, n_lower: 370
2022-11-05 14:46:57,161 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 68, n_lower: 392
2022-11-05 14:46:57,168 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 430
2022-11-05 14:46:57,176 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 9, n_lower: 385
2022-11-05 14:46:57,181 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4557, Acc: 0.8560, ]
2022-11-05 14:46:58,001 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 184, n_lower: 370
2022-11-05 14:46:58,008 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 69, n_lower: 415
2022-11-05 14:46:58,015 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 431
2022-11-05 14:46:58,037 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 385
2022-11-05 14:46:58,042 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3862, Acc: 0.8800, ]
2022-11-05 14:46:59,124 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 184, n_lower: 370
2022-11-05 14:46:59,178 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 76, n_lower: 415
2022-11-05 14:46:59,184 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 431
2022-11-05 14:46:59,192 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 11, n_lower: 385
2022-11-05 14:46:59,198 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5053, Acc: 0.8560, ]
2022-11-05 14:46:59,271 INFO: Epoch 4, Validation Step:

2022-11-05 14:48:20,541 INFO: [Test_acc of task 5 on test 3: 0.54741][acc of former classes: 0.71017][acc of former samples in all classes: 0.66817]
[acc of novel samples in all classes: 0.25760]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 14:48:21,824 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 184, n_lower: 372
2022-11-05 14:48:21,826 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 77, n_lower: 418
2022-11-05 14:48:21,827 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 431
2022-11-05 14:48:21,829 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 12, n_lower: 385
2022-11-05 14:48:21,830 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4854, Acc: 0.8720, ]
2022-11-05 14:48:22,027 INFO: fine-tune procedure is finished!
2022-11-05 14:49:40,823 INFO: [Test_acc of task 5 on test 3: 0.54741][acc of former classes: 0.71033][acc of former samples in all classes: 0.66817]
[acc of novel samples in all classes: 0.25760]
2022-11-05 14:49:40,876 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:49:40,886 WARNING: Current net - loaded net:
2022-11-05 14:49:40,886 WARNING: Loaded net - current net:
2022-11-05 14:49:40,886 WARNING:   func.fc.bias
2022-11-05 14:49:40,886 WARNING:   func.fc.weight
2022-11-05 14:49:40,919 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_5.pth.
2022-11-05 14:49:40,965 INFO: Obtain parameters for train
2022-11-05 14:49:40,969 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:49:40,969 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:49:40,970 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:49:40,971 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:49:40,972 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:49:40,972 INFO: Model [MTNBModel] is created.
2022-11-05 14:49:40,979 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:49:40,985 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:49:40,991 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:49:40,997 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:49:41,003 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:49:41,009 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:49:41,702 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 185, n_lower: 374
2022-11-05 14:49:41,707 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 378
2022-11-05 14:49:41,712 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 431
2022-11-05 14:49:41,715 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 374
2022-11-05 14:49:41,720 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5269, Acc: 0.8667, ]
2022-11-05 14:49:42,851 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 213, n_lower: 400
2022-11-05 14:49:42,859 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 57, n_lower: 378
2022-11-05 14:49:42,866 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 432
2022-11-05 14:49:42,873 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 374
2022-11-05 14:49:42,880 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5266, Acc: 0.8467, ]
2022-11-05 14:49:44,234 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 260, n_lower: 451
2022-11-05 14:49:44,239 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 381
2022-11-05 14:49:44,247 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 432
2022-11-05 14:49:44,254 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:49:44,259 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4480, Acc: 0.8533, ]
2022-11-05 14:49:45,708 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 346, n_lower: 510
2022-11-05 14:49:45,715 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 67, n_lower: 382
2022-11-05 14:49:45,723 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 66, n_lower: 445
2022-11-05 14:49:45,732 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:49:45,733 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.3377, Acc: 0.8600, ]
2022-11-05 14:49:46,960 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 348, n_lower: 511
2022-11-05 14:49:46,961 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 67, n_lower: 382
2022-11-05 14:49:46,962 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 66, n_lower: 445
2022-11-05 14:49:46,965 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:49:46,974 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5886, Acc: 0.8333, ]
2022-11-05 14:49:47,082 INFO: Epoch 4, Validation Step:

2022-11-05 14:51:06,508 INFO: [Test_acc of task 6 on test 3: 0.52644][acc of former classes: 0.71133][acc of former samples in all classes: 0.65600]
[acc of novel samples in all classes: 0.26733]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 14:51:07,375 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 351, n_lower: 514
2022-11-05 14:51:07,382 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 67, n_lower: 382
2022-11-05 14:51:07,386 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 66, n_lower: 446
2022-11-05 14:51:07,391 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:51:07,397 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5301, Acc: 0.8600, ]
2022-11-05 14:51:07,542 INFO: fine-tune procedure is finished!
2022-11-05 14:52:34,029 INFO: [Test_acc of task 6 on test 3: 0.52600][acc of former classes: 0.71100][acc of former samples in all classes: 0.65567]
[acc of novel samples in all classes: 0.26667]
2022-11-05 14:52:34,051 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:52:34,057 WARNING: Current net - loaded net:
2022-11-05 14:52:34,057 WARNING: Loaded net - current net:
2022-11-05 14:52:34,057 WARNING:   func.fc.bias
2022-11-05 14:52:34,057 WARNING:   func.fc.weight
2022-11-05 14:52:34,069 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_6.pth.
2022-11-05 14:52:34,092 INFO: Obtain parameters for train
2022-11-05 14:52:34,094 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:52:34,095 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:52:34,096 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:52:34,097 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:52:34,098 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:52:34,098 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:52:34,098 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:52:34,098 INFO: Model [MTNBModel] is created.
2022-11-05 14:52:34,108 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:34,116 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:34,125 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:34,134 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:34,143 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:34,153 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:52:34,162 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 14:52:34,839 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 208, n_lower: 467
2022-11-05 14:52:34,846 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 49, n_lower: 378
2022-11-05 14:52:34,853 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 446
2022-11-05 14:52:34,859 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:52:34,866 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.6331, Acc: 0.8400, ]
2022-11-05 14:52:35,584 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 210, n_lower: 468
2022-11-05 14:52:35,606 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 49, n_lower: 378
2022-11-05 14:52:35,613 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 446
2022-11-05 14:52:35,618 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:52:35,622 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5609, Acc: 0.8514, ]
2022-11-05 14:52:36,547 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 227, n_lower: 493
2022-11-05 14:52:36,549 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 50, n_lower: 380
2022-11-05 14:52:36,550 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 446
2022-11-05 14:52:36,550 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:52:36,551 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5356, Acc: 0.8457, ]
2022-11-05 14:52:37,823 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 233, n_lower: 502
2022-11-05 14:52:37,831 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 380
2022-11-05 14:52:37,836 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 446
2022-11-05 14:52:37,843 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:52:37,846 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5672, Acc: 0.8457, ]
2022-11-05 14:52:38,758 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 249, n_lower: 509
2022-11-05 14:52:38,765 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 380
2022-11-05 14:52:38,772 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 449
2022-11-05 14:52:38,780 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:52:38,788 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5642, Acc: 0.8457, ]
2022-11-05 14:52:38,879 INFO: Epoch 4, Validation Step:

2022-11-05 14:54:03,978 INFO: [Test_acc of task 7 on test 3: 0.51011][acc of former classes: 0.71133][acc of former samples in all classes: 0.65233]
[acc of novel samples in all classes: 0.26629]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 14:54:05,088 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 262, n_lower: 514
2022-11-05 14:54:05,090 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 380
2022-11-05 14:54:05,090 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 450
2022-11-05 14:54:05,091 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:54:05,092 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4629, Acc: 0.8629, ]
2022-11-05 14:54:05,300 INFO: fine-tune procedure is finished!
2022-11-05 14:55:30,969 INFO: [Test_acc of task 7 on test 3: 0.51011][acc of former classes: 0.71083][acc of former samples in all classes: 0.65233]
[acc of novel samples in all classes: 0.26629]
2022-11-05 14:55:31,002 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:55:31,011 WARNING: Current net - loaded net:
2022-11-05 14:55:31,011 WARNING: Loaded net - current net:
2022-11-05 14:55:31,011 WARNING:   func.fc.bias
2022-11-05 14:55:31,011 WARNING:   func.fc.weight
2022-11-05 14:55:31,030 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_7.pth.
2022-11-05 14:55:31,057 INFO: Obtain parameters for train
2022-11-05 14:55:31,060 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:55:31,060 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:55:31,061 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:55:31,062 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:55:31,063 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:55:31,064 INFO: Model [MTNBModel] is created.
2022-11-05 14:55:31,074 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:31,083 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:31,088 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:31,094 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:31,100 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:31,110 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:31,133 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 14:55:31,442 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:55:32,475 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 506
2022-11-05 14:55:32,476 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 50, n_lower: 379
2022-11-05 14:55:32,478 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 65, n_lower: 450
2022-11-05 14:55:32,478 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:55:32,479 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.6175, Acc: 0.8150, ]
2022-11-05 14:55:33,770 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 512
2022-11-05 14:55:33,771 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 52, n_lower: 386
2022-11-05 14:55:33,772 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 74, n_lower: 460
2022-11-05 14:55:33,772 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:55:33,773 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5884, Acc: 0.8350, ]
2022-11-05 14:55:34,938 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 215, n_lower: 529
2022-11-05 14:55:34,939 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 52, n_lower: 388
2022-11-05 14:55:34,940 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 74, n_lower: 461
2022-11-05 14:55:34,941 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:55:34,941 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6301, Acc: 0.8300, ]
2022-11-05 14:55:35,958 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 217, n_lower: 530
2022-11-05 14:55:35,966 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 391
2022-11-05 14:55:35,975 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 91, n_lower: 532
2022-11-05 14:55:35,983 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 376
2022-11-05 14:55:35,987 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4815, Acc: 0.8500, ]
2022-11-05 14:55:37,182 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 232, n_lower: 555
2022-11-05 14:55:37,183 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 393
2022-11-05 14:55:37,184 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 91, n_lower: 532
2022-11-05 14:55:37,185 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 377
2022-11-05 14:55:37,186 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.6624, Acc: 0.8350, ]
2022-11-05 14:55:37,343 INFO: Epoch 4, Validation Step:

2022-11-05 14:57:04,593 INFO: [Test_acc of task 8 on test 3: 0.49030][acc of former classes: 0.71117][acc of former samples in all classes: 0.64650]
[acc of novel samples in all classes: 0.25600]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 14:57:05,473 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 233, n_lower: 556
2022-11-05 14:57:05,477 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 54, n_lower: 393
2022-11-05 14:57:05,482 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 97, n_lower: 534
2022-11-05 14:57:05,487 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 10, n_lower: 377
2022-11-05 14:57:05,491 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.4880, Acc: 0.8400, ]
2022-11-05 14:57:05,594 INFO: fine-tune procedure is finished!
2022-11-05 14:58:27,656 INFO: [Test_acc of task 8 on test 3: 0.48990][acc of former classes: 0.71117][acc of former samples in all classes: 0.64633]
[acc of novel samples in all classes: 0.25525]
2022-11-05 14:58:27,696 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 14:58:27,703 WARNING: Current net - loaded net:
2022-11-05 14:58:27,703 WARNING: Loaded net - current net:
2022-11-05 14:58:27,703 WARNING:   func.fc.bias
2022-11-05 14:58:27,703 WARNING:   func.fc.weight
2022-11-05 14:58:27,748 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth.
2022-11-05 14:58:27,884 INFO: Obtain parameters for train
2022-11-05 14:58:27,888 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 14:58:27,888 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 14:58:27,889 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 14:58:27,890 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 14:58:27,891 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 14:58:27,891 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 14:58:27,891 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 14:58:27,891 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 14:58:27,891 INFO: Model [MTNBModel] is created.
2022-11-05 14:58:27,900 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-11-05 14:58:28,400 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 1, n_lower: 4
2022-11-05 14:58:28,412 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4897, Acc: 0.9200, ]
2022-11-05 14:58:29,269 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 85, n_lower: 44
2022-11-05 14:58:29,274 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 44, n_lower: 41
2022-11-05 14:58:29,278 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 19, n_lower: 8
2022-11-05 14:58:29,284 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 31, n_lower: 0
2022-11-05 14:58:29,287 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.1424, Acc: 0.9600, ]
2022-11-05 14:58:30,063 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 337, n_lower: 373
2022-11-05 14:58:30,071 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 121, n_lower: 121
2022-11-05 14:58:30,079 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 155, n_lower: 64
2022-11-05 14:58:30,087 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 43, n_lower: 14
2022-11-05 14:58:30,095 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.0931, Acc: 0.9600, ]
2022-11-05 14:58:30,993 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 379, n_lower: 387
2022-11-05 14:58:30,999 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 123, n_lower: 131
2022-11-05 14:58:31,005 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 165, n_lower: 74
2022-11-05 14:58:31,011 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 48, n_lower: 14
2022-11-05 14:58:31,019 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.0273, Acc: 1.0000, ]
2022-11-05 14:58:32,368 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 462, n_lower: 394
2022-11-05 14:58:32,375 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 170, n_lower: 135
2022-11-05 14:58:32,383 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 212, n_lower: 81
2022-11-05 14:58:32,390 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 71, n_lower: 14
2022-11-05 14:58:32,397 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.0253, Acc: 1.0000, ]
2022-11-05 14:58:32,413 INFO: Epoch 4, Validation Step:

2022-11-05 14:59:31,472 INFO: [Test_acc of task 1 on test 4: 0.66554][acc of former classes: 0.70950][acc of former samples in all classes: 0.69483]
[acc of novel samples in all classes: 0.31400]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
2022-11-05 14:59:32,689 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 462, n_lower: 394
2022-11-05 14:59:32,690 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 170, n_lower: 135
2022-11-05 14:59:32,690 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 212, n_lower: 81
2022-11-05 14:59:32,691 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 71, n_lower: 14
2022-11-05 14:59:32,691 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0000, Acc: 1.0000, ]
2022-11-05 14:59:32,816 INFO: fine-tune procedure is finished!
2022-11-05 15:00:32,228 INFO: [Test_acc of task 1 on test 4: 0.66538][acc of former classes: 0.70933][acc of former samples in all classes: 0.69467]
[acc of novel samples in all classes: 0.31400]
2022-11-05 15:00:32,280 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 15:00:32,287 WARNING: Current net - loaded net:
2022-11-05 15:00:32,287 WARNING: Loaded net - current net:
2022-11-05 15:00:32,287 WARNING:   func.fc.bias
2022-11-05 15:00:32,287 WARNING:   func.fc.weight
2022-11-05 15:00:32,326 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_1.pth.
2022-11-05 15:00:32,373 INFO: Obtain parameters for train
2022-11-05 15:00:32,377 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:00:32,377 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:00:32,377 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:00:32,377 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:00:32,378 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:00:32,379 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:00:32,380 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:00:32,380 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:00:32,380 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:00:32,380 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:00:32,380 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 15:00:32,380 INFO: Model [MTNBModel] is created.
2022-11-05 15:00:32,387 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:00:32,392 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:00:32,930 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 138, n_lower: 260
2022-11-05 15:00:32,938 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 53, n_lower: 76
2022-11-05 15:00:32,940 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 58, n_lower: 54
2022-11-05 15:00:32,945 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 15, n_lower: 10
2022-11-05 15:00:32,948 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4393, Acc: 0.9000, ]
2022-11-05 15:00:34,007 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 146, n_lower: 260
2022-11-05 15:00:34,011 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 60, n_lower: 77
2022-11-05 15:00:34,018 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 67, n_lower: 65
2022-11-05 15:00:34,023 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 23, n_lower: 17
2022-11-05 15:00:34,027 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.3242, Acc: 0.9000, ]
2022-11-05 15:00:34,815 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 199, n_lower: 319
2022-11-05 15:00:34,822 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 76, n_lower: 112
2022-11-05 15:00:34,831 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 88, n_lower: 153
2022-11-05 15:00:34,840 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 23, n_lower: 58
2022-11-05 15:00:34,848 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.2572, Acc: 0.9400, ]
2022-11-05 15:00:35,781 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 214, n_lower: 337
2022-11-05 15:00:35,788 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 82, n_lower: 112
2022-11-05 15:00:35,793 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 96, n_lower: 153
2022-11-05 15:00:35,801 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 29, n_lower: 58
2022-11-05 15:00:35,804 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.1150, Acc: 0.9400, ]
2022-11-05 15:00:36,779 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 219, n_lower: 361
2022-11-05 15:00:36,786 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 82, n_lower: 112
2022-11-05 15:00:36,791 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 108, n_lower: 160
2022-11-05 15:00:36,795 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 33, n_lower: 81
2022-11-05 15:00:36,800 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.1876, Acc: 0.9200, ]
2022-11-05 15:00:36,831 INFO: Epoch 4, Validation Step:

2022-11-05 15:01:36,765 INFO: [Test_acc of task 2 on test 4: 0.63100][acc of former classes: 0.70967][acc of former samples in all classes: 0.68600]
[acc of novel samples in all classes: 0.30100]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-11-05 15:01:38,508 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 219, n_lower: 362
2022-11-05 15:01:38,509 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 108, n_lower: 124
2022-11-05 15:01:38,510 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 108, n_lower: 160
2022-11-05 15:01:38,511 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 57, n_lower: 82
2022-11-05 15:01:38,511 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.0521, Acc: 0.9800, ]
2022-11-05 15:01:38,597 INFO: fine-tune procedure is finished!
2022-11-05 15:02:41,416 INFO: [Test_acc of task 2 on test 4: 0.63086][acc of former classes: 0.70950][acc of former samples in all classes: 0.68600]
[acc of novel samples in all classes: 0.30000]
2022-11-05 15:02:41,441 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 15:02:41,448 WARNING: Current net - loaded net:
2022-11-05 15:02:41,448 WARNING: Loaded net - current net:
2022-11-05 15:02:41,448 WARNING:   func.fc.bias
2022-11-05 15:02:41,448 WARNING:   func.fc.weight
2022-11-05 15:02:41,462 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_2.pth.
2022-11-05 15:02:41,502 INFO: Obtain parameters for train
2022-11-05 15:02:41,504 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:02:41,504 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:02:41,504 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:02:41,504 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:02:41,505 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:02:41,506 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:02:41,507 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 15:02:41,507 INFO: Model [MTNBModel] is created.
2022-11-05 15:02:41,515 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:41,523 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:02:41,530 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 15:02:42,170 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 166, n_lower: 325
2022-11-05 15:02:42,175 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 66, n_lower: 103
2022-11-05 15:02:42,180 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 66, n_lower: 114
2022-11-05 15:02:42,185 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 63
2022-11-05 15:02:42,186 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.4956, Acc: 0.8533, ]
2022-11-05 15:02:43,072 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 167, n_lower: 325
2022-11-05 15:02:43,092 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 103
2022-11-05 15:02:43,096 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 66, n_lower: 114
2022-11-05 15:02:43,100 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 25, n_lower: 63
2022-11-05 15:02:43,104 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.4255, Acc: 0.8800, ]
2022-11-05 15:02:44,047 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 220, n_lower: 352
2022-11-05 15:02:44,051 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 82, n_lower: 109
2022-11-05 15:02:44,057 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 78, n_lower: 147
2022-11-05 15:02:44,062 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 38, n_lower: 90
2022-11-05 15:02:44,064 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.5305, Acc: 0.8533, ]
2022-11-05 15:02:44,755 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 224, n_lower: 351
2022-11-05 15:02:44,762 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 105, n_lower: 182
2022-11-05 15:02:44,768 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 87, n_lower: 147
2022-11-05 15:02:44,773 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 44, n_lower: 160
2022-11-05 15:02:44,778 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4772, Acc: 0.8667, ]
2022-11-05 15:02:45,779 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 288, n_lower: 383
2022-11-05 15:02:45,785 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 109, n_lower: 193
2022-11-05 15:02:45,791 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 114, n_lower: 169
2022-11-05 15:02:45,797 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 77, n_lower: 330
2022-11-05 15:02:45,803 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.4298, Acc: 0.8800, ]
2022-11-05 15:02:45,836 INFO: Epoch 4, Validation Step:

2022-11-05 15:03:50,672 INFO: [Test_acc of task 3 on test 4: 0.59467][acc of former classes: 0.71183][acc of former samples in all classes: 0.67900]
[acc of novel samples in all classes: 0.25733]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-11-05 15:03:51,434 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 296, n_lower: 392
2022-11-05 15:03:51,445 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 112, n_lower: 201
2022-11-05 15:03:51,461 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 127, n_lower: 179
2022-11-05 15:03:51,463 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 83, n_lower: 437
2022-11-05 15:03:51,465 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.2283, Acc: 0.9200, ]
2022-11-05 15:03:51,714 INFO: fine-tune procedure is finished!
2022-11-05 15:04:59,443 INFO: [Test_acc of task 3 on test 4: 0.59533][acc of former classes: 0.71233][acc of former samples in all classes: 0.67967]
[acc of novel samples in all classes: 0.25800]
2022-11-05 15:04:59,493 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 15:04:59,501 WARNING: Current net - loaded net:
2022-11-05 15:04:59,501 WARNING: Loaded net - current net:
2022-11-05 15:04:59,501 WARNING:   func.fc.bias
2022-11-05 15:04:59,501 WARNING:   func.fc.weight
2022-11-05 15:04:59,542 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_3.pth.
2022-11-05 15:04:59,586 INFO: Obtain parameters for train
2022-11-05 15:04:59,590 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:04:59,590 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 15:04:59,591 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:04:59,592 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 15:04:59,593 INFO: Model [MTNBModel] is created.
2022-11-05 15:04:59,599 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:04:59,606 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:04:59,611 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:04:59,617 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:05:00,271 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 192, n_lower: 370
2022-11-05 15:05:00,276 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 76, n_lower: 183
2022-11-05 15:05:00,280 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 84, n_lower: 167
2022-11-05 15:05:00,285 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 56, n_lower: 278
2022-11-05 15:05:00,290 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.3510, Acc: 0.9300, ]
2022-11-05 15:05:01,140 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 192, n_lower: 370
2022-11-05 15:05:01,144 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 85, n_lower: 191
2022-11-05 15:05:01,149 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 115, n_lower: 180
2022-11-05 15:05:01,154 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 56, n_lower: 280
2022-11-05 15:05:01,159 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.3365, Acc: 0.9100, ]
2022-11-05 15:05:01,814 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 205, n_lower: 370
2022-11-05 15:05:01,819 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 92, n_lower: 209
2022-11-05 15:05:01,825 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 138, n_lower: 246
2022-11-05 15:05:01,830 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 60, n_lower: 294
2022-11-05 15:05:01,834 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.3598, Acc: 0.9100, ]
2022-11-05 15:05:03,064 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 205, n_lower: 372
2022-11-05 15:05:03,071 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 102, n_lower: 219
2022-11-05 15:05:03,077 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 174, n_lower: 274
2022-11-05 15:05:03,082 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 60, n_lower: 301
2022-11-05 15:05:03,088 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4157, Acc: 0.8600, ]
2022-11-05 15:05:03,877 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 248, n_lower: 420
2022-11-05 15:05:03,883 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 132, n_lower: 221
2022-11-05 15:05:03,889 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 202, n_lower: 288
2022-11-05 15:05:03,892 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 101, n_lower: 305
2022-11-05 15:05:03,898 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.2199, Acc: 0.9300, ]
2022-11-05 15:05:03,978 INFO: Epoch 4, Validation Step:

2022-11-05 15:06:09,465 INFO: [Test_acc of task 4 on test 4: 0.56600][acc of former classes: 0.71167][acc of former samples in all classes: 0.67250]
[acc of novel samples in all classes: 0.24650]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-11-05 15:06:10,212 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 253, n_lower: 425
2022-11-05 15:06:10,218 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 134, n_lower: 251
2022-11-05 15:06:10,223 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 258, n_lower: 332
2022-11-05 15:06:10,227 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 101, n_lower: 306
2022-11-05 15:06:10,232 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3125, Acc: 0.9400, ]
2022-11-05 15:06:10,373 INFO: fine-tune procedure is finished!
2022-11-05 15:07:19,277 INFO: [Test_acc of task 4 on test 4: 0.56612][acc of former classes: 0.71183][acc of former samples in all classes: 0.67267]
[acc of novel samples in all classes: 0.24650]
2022-11-05 15:07:19,315 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 15:07:19,324 WARNING: Current net - loaded net:
2022-11-05 15:07:19,324 WARNING: Loaded net - current net:
2022-11-05 15:07:19,324 WARNING:   func.fc.bias
2022-11-05 15:07:19,324 WARNING:   func.fc.weight
2022-11-05 15:07:19,347 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_4.pth.
2022-11-05 15:07:19,378 INFO: Obtain parameters for train
2022-11-05 15:07:19,381 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:07:19,381 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 15:07:19,382 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:07:19,383 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:07:19,384 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 15:07:19,385 INFO: Model [MTNBModel] is created.
2022-11-05 15:07:19,394 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:07:19,402 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:07:19,411 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:07:19,418 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:07:19,424 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 15:07:20,251 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 200, n_lower: 398
2022-11-05 15:07:20,258 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 90, n_lower: 230
2022-11-05 15:07:20,260 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 112, n_lower: 278
2022-11-05 15:07:20,266 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 291
2022-11-05 15:07:20,270 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5934, Acc: 0.8640, ]
2022-11-05 15:07:21,142 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 207, n_lower: 414
2022-11-05 15:07:21,149 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 93, n_lower: 236
2022-11-05 15:07:21,154 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 117, n_lower: 289
2022-11-05 15:07:21,158 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 291
2022-11-05 15:07:21,163 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5006, Acc: 0.8720, ]
2022-11-05 15:07:22,055 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 233, n_lower: 424
2022-11-05 15:07:22,057 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 100, n_lower: 275
2022-11-05 15:07:22,064 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 122, n_lower: 303
2022-11-05 15:07:22,068 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 78, n_lower: 297
2022-11-05 15:07:22,073 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4988, Acc: 0.9040, ]
2022-11-05 15:07:22,910 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 286, n_lower: 462
2022-11-05 15:07:22,917 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 107, n_lower: 279
2022-11-05 15:07:22,924 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 135, n_lower: 362
2022-11-05 15:07:22,931 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 78, n_lower: 297
2022-11-05 15:07:22,937 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.5158, Acc: 0.8960, ]
2022-11-05 15:07:23,846 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 306, n_lower: 496
2022-11-05 15:07:23,854 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 110, n_lower: 293
2022-11-05 15:07:23,861 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 140, n_lower: 398
2022-11-05 15:07:23,869 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 79, n_lower: 309
2022-11-05 15:07:23,876 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5759, Acc: 0.8640, ]
2022-11-05 15:07:24,585 INFO: Epoch 4, Validation Step:

2022-11-05 15:08:34,281 INFO: [Test_acc of task 5 on test 4: 0.54200][acc of former classes: 0.71117][acc of former samples in all classes: 0.66500]
[acc of novel samples in all classes: 0.24680]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-11-05 15:08:35,150 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 330, n_lower: 529
2022-11-05 15:08:35,157 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 111, n_lower: 293
2022-11-05 15:08:35,162 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 147, n_lower: 411
2022-11-05 15:08:35,167 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 79, n_lower: 309
2022-11-05 15:08:35,172 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3351, Acc: 0.9280, ]
2022-11-05 15:08:35,403 INFO: fine-tune procedure is finished!
2022-11-05 15:09:45,345 INFO: [Test_acc of task 5 on test 4: 0.54200][acc of former classes: 0.71083][acc of former samples in all classes: 0.66517]
[acc of novel samples in all classes: 0.24640]
2022-11-05 15:09:45,376 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 15:09:45,385 WARNING: Current net - loaded net:
2022-11-05 15:09:45,386 WARNING: Loaded net - current net:
2022-11-05 15:09:45,386 WARNING:   func.fc.bias
2022-11-05 15:09:45,386 WARNING:   func.fc.weight
2022-11-05 15:09:45,403 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_5.pth.
2022-11-05 15:09:45,430 INFO: Obtain parameters for train
2022-11-05 15:09:45,432 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:09:45,432 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:09:45,432 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:09:45,432 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:09:45,432 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:09:45,432 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:09:45,432 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:09:45,432 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:09:45,433 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 15:09:45,434 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:09:45,435 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:09:45,436 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 15:09:45,436 INFO: Model [MTNBModel] is created.
2022-11-05 15:09:45,446 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:45,455 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:45,464 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:45,473 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:45,482 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:09:45,490 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:09:46,156 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 229, n_lower: 482
2022-11-05 15:09:46,157 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 79, n_lower: 261
2022-11-05 15:09:46,158 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 141, n_lower: 395
2022-11-05 15:09:46,159 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 296
2022-11-05 15:09:46,160 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5669, Acc: 0.8733, ]
2022-11-05 15:09:47,302 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 253, n_lower: 488
2022-11-05 15:09:47,303 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 80, n_lower: 264
2022-11-05 15:09:47,304 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 141, n_lower: 395
2022-11-05 15:09:47,305 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 296
2022-11-05 15:09:47,305 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.5266, Acc: 0.8800, ]
2022-11-05 15:09:48,334 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 310, n_lower: 524
2022-11-05 15:09:48,342 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 84, n_lower: 268
2022-11-05 15:09:48,350 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 163, n_lower: 438
2022-11-05 15:09:48,359 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 298
2022-11-05 15:09:48,367 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.4784, Acc: 0.9000, ]
2022-11-05 15:09:49,543 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 361, n_lower: 543
2022-11-05 15:09:49,544 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 88, n_lower: 269
2022-11-05 15:09:49,545 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 163, n_lower: 443
2022-11-05 15:09:49,546 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 298
2022-11-05 15:09:49,547 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.4824, Acc: 0.8667, ]
2022-11-05 15:09:50,331 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 394, n_lower: 598
2022-11-05 15:09:50,332 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 95, n_lower: 271
2022-11-05 15:09:50,333 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 184, n_lower: 454
2022-11-05 15:09:50,334 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 298
2022-11-05 15:09:50,335 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.5651, Acc: 0.8400, ]
2022-11-05 15:09:50,426 INFO: Epoch 4, Validation Step:

2022-11-05 15:11:09,592 INFO: [Test_acc of task 6 on test 4: 0.52200][acc of former classes: 0.71117][acc of former samples in all classes: 0.65633]
[acc of novel samples in all classes: 0.25333]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-11-05 15:11:10,635 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 397, n_lower: 608
2022-11-05 15:11:10,636 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 95, n_lower: 273
2022-11-05 15:11:10,637 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 184, n_lower: 459
2022-11-05 15:11:10,638 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 298
2022-11-05 15:11:10,638 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.3844, Acc: 0.9133, ]
2022-11-05 15:11:10,926 INFO: fine-tune procedure is finished!
2022-11-05 15:12:34,549 INFO: [Test_acc of task 6 on test 4: 0.52244][acc of former classes: 0.71083][acc of former samples in all classes: 0.65650]
[acc of novel samples in all classes: 0.25433]
2022-11-05 15:12:34,593 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 15:12:34,601 WARNING: Current net - loaded net:
2022-11-05 15:12:34,601 WARNING: Loaded net - current net:
2022-11-05 15:12:34,601 WARNING:   func.fc.bias
2022-11-05 15:12:34,601 WARNING:   func.fc.weight
2022-11-05 15:12:34,632 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_6.pth.
2022-11-05 15:12:34,744 INFO: Obtain parameters for train
2022-11-05 15:12:34,748 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 15:12:34,749 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:12:34,750 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:12:34,751 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:12:34,752 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 15:12:34,752 INFO: Model [MTNBModel] is created.
2022-11-05 15:12:34,763 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:12:34,772 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:12:34,784 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:12:34,791 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:12:34,797 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:12:34,803 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:12:34,809 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 15:12:35,543 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 282, n_lower: 565
2022-11-05 15:12:35,633 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 83, n_lower: 269
2022-11-05 15:12:35,659 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 142, n_lower: 430
2022-11-05 15:12:35,661 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 296
2022-11-05 15:12:35,667 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.6146, Acc: 0.8571, ]
2022-11-05 15:12:36,800 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 298, n_lower: 578
2022-11-05 15:12:36,808 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 84, n_lower: 273
2022-11-05 15:12:36,814 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 142, n_lower: 430
2022-11-05 15:12:36,818 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 298
2022-11-05 15:12:36,825 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.6595, Acc: 0.8286, ]
2022-11-05 15:12:37,938 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 315, n_lower: 592
2022-11-05 15:12:37,939 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 89, n_lower: 289
2022-11-05 15:12:37,940 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 143, n_lower: 438
2022-11-05 15:12:37,940 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 302
2022-11-05 15:12:37,941 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6578, Acc: 0.8057, ]
2022-11-05 15:12:39,440 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 341, n_lower: 637
2022-11-05 15:12:39,447 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 91, n_lower: 305
2022-11-05 15:12:39,452 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 143, n_lower: 438
2022-11-05 15:12:39,455 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 307
2022-11-05 15:12:39,463 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.7191, Acc: 0.8400, ]
2022-11-05 15:12:40,622 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 345, n_lower: 641
2022-11-05 15:12:40,623 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 98, n_lower: 331
2022-11-05 15:12:40,624 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 143, n_lower: 438
2022-11-05 15:12:40,625 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 311
2022-11-05 15:12:40,625 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.6678, Acc: 0.8229, ]
2022-11-05 15:12:40,723 INFO: Epoch 4, Validation Step:

2022-11-05 15:14:14,555 INFO: [Test_acc of task 7 on test 4: 0.50568][acc of former classes: 0.71167][acc of former samples in all classes: 0.65217]
[acc of novel samples in all classes: 0.25457]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-11-05 15:14:15,936 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 384, n_lower: 689
2022-11-05 15:14:15,941 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 99, n_lower: 336
2022-11-05 15:14:15,946 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 143, n_lower: 439
2022-11-05 15:14:15,952 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 314
2022-11-05 15:14:15,956 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5366, Acc: 0.8286, ]
2022-11-05 15:14:16,137 INFO: fine-tune procedure is finished!
2022-11-05 15:15:45,210 INFO: [Test_acc of task 7 on test 4: 0.50611][acc of former classes: 0.71217][acc of former samples in all classes: 0.65250]
[acc of novel samples in all classes: 0.25514]
2022-11-05 15:15:45,276 INFO: Loading Resnet20_cifar_small model from ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth.
2022-11-05 15:15:45,283 WARNING: Current net - loaded net:
2022-11-05 15:15:45,283 WARNING: Loaded net - current net:
2022-11-05 15:15:45,284 WARNING:   func.fc.bias
2022-11-05 15:15:45,284 WARNING:   func.fc.weight
2022-11-05 15:15:45,301 INFO: Loading Resnet20_cifar_small model from /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_7.pth.
2022-11-05 15:15:45,327 INFO: Obtain parameters for train
2022-11-05 15:15:45,329 WARNING: Params func.conv1.weight will not be optimized.
2022-11-05 15:15:45,329 WARNING: Params func.bn1.weight will not be optimized.
2022-11-05 15:15:45,329 WARNING: Params func.bn1.bias will not be optimized.
2022-11-05 15:15:45,329 WARNING: Params func.layer1.0.conv1.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.0.bn1.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.0.bn1.bias will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.0.conv2.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.0.bn2.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.0.bn2.bias will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.1.conv1.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.1.bn1.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.1.bn1.bias will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.1.conv2.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.1.bn2.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.1.bn2.bias will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.2.conv1.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.2.bn1.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.2.bn1.bias will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.2.conv2.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.2.bn2.weight will not be optimized.
2022-11-05 15:15:45,330 WARNING: Params func.layer1.2.bn2.bias will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.conv1.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.bn1.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.bn1.bias will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.conv2.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.bn2.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.bn2.bias will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.downsample.0.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.downsample.1.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.0.downsample.1.bias will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.1.conv1.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.1.bn1.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.1.bn1.bias will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.1.conv2.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.1.bn2.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.1.bn2.bias will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.2.conv1.weight will not be optimized.
2022-11-05 15:15:45,331 WARNING: Params func.layer2.2.bn1.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer2.2.bn1.bias will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer2.2.conv2.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer2.2.bn2.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer2.2.bn2.bias will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.conv1.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.bn1.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.bn1.bias will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.conv2.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.bn2.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.bn2.bias will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.downsample.0.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.downsample.1.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.0.downsample.1.bias will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.1.bn1.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.1.bn1.bias will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.1.bn2.weight will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.1.bn2.bias will not be optimized.
2022-11-05 15:15:45,332 WARNING: Params func.layer3.2.bn1.weight will not be optimized.
2022-11-05 15:15:45,333 WARNING: Params func.layer3.2.bn1.bias will not be optimized.
2022-11-05 15:15:45,333 WARNING: Params func.layer3.2.bn2.weight will not be optimized.
2022-11-05 15:15:45,333 WARNING: Params func.layer3.2.bn2.bias will not be optimized.
2022-11-05 15:15:45,333 INFO: Model [MTNBModel] is created.
2022-11-05 15:15:45,344 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:45,352 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:45,361 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:45,370 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:45,379 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:45,387 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:45,396 INFO: Dataset NormalDataset - cifar-100 is created.
2022-11-05 15:15:45,405 INFO: Dataset NormalDataset - cifar-100 is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/cifar-100_bases60/CFRPModel_res18_cifar_60base_wandb_001_ori/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:15:46,297 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 281, n_lower: 637
2022-11-05 15:15:46,298 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 302
2022-11-05 15:15:46,299 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 129, n_lower: 434
2022-11-05 15:15:46,300 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 313
2022-11-05 15:15:46,300 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 0.5592, Acc: 0.8550, ]
2022-11-05 15:15:47,456 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 292, n_lower: 641
2022-11-05 15:15:47,465 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 86, n_lower: 302
2022-11-05 15:15:47,473 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 129, n_lower: 434
2022-11-05 15:15:47,482 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 313
2022-11-05 15:15:47,490 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 0.6911, Acc: 0.8200, ]
2022-11-05 15:15:49,214 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 294, n_lower: 646
2022-11-05 15:15:49,215 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 87, n_lower: 302
2022-11-05 15:15:49,216 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 134, n_lower: 445
2022-11-05 15:15:49,217 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 313
2022-11-05 15:15:49,218 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 0.6610, Acc: 0.8000, ]
2022-11-05 15:15:50,423 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 303, n_lower: 651
2022-11-05 15:15:50,431 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 87, n_lower: 304
2022-11-05 15:15:50,440 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 150, n_lower: 451
2022-11-05 15:15:50,448 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 316
2022-11-05 15:15:50,456 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 0.8319, Acc: 0.7950, ]
2022-11-05 15:15:51,859 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 315, n_lower: 652
2022-11-05 15:15:51,860 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 93, n_lower: 304
2022-11-05 15:15:51,861 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 169, n_lower: 476
2022-11-05 15:15:51,861 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 317
2022-11-05 15:15:51,862 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 0.7367, Acc: 0.8250, ]
2022-11-05 15:15:51,945 INFO: Epoch 4, Validation Step:

2022-11-05 15:17:16,079 INFO: [Test_acc of task 8 on test 4: 0.48510][acc of former classes: 0.71217][acc of former samples in all classes: 0.64433]
[acc of novel samples in all classes: 0.24625]
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-11-05 15:17:16,939 INFO: clamp range params 0: func.layer3.1.conv1.weight, n_upper: 315, n_lower: 653
2022-11-05 15:17:16,952 INFO: clamp range params 1: func.layer3.1.conv2.weight, n_upper: 99, n_lower: 306
2022-11-05 15:17:16,959 INFO: clamp range params 2: func.layer3.2.conv1.weight, n_upper: 182, n_lower: 486
2022-11-05 15:17:16,964 INFO: clamp range params 3: func.layer3.2.conv2.weight, n_upper: 75, n_lower: 317
2022-11-05 15:17:16,966 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 0.5554, Acc: 0.8750, ]
2022-11-05 15:17:17,261 INFO: fine-tune procedure is finished!
2022-11-05 15:18:39,182 INFO: [Test_acc of task 8 on test 4: 0.48510][acc of former classes: 0.71183][acc of former samples in all classes: 0.64367]
[acc of novel samples in all classes: 0.24725]
2022-11-05 15:18:39,196 INFO: --------------------------Final Avg Acc-------------------------
2022-11-05 15:18:39,196 INFO: Session 1: 71.40+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.7140]
2022-11-05 15:18:39,196 INFO: Session 2: 66.65+-1.16[acc of former classes: 0.7077][acc of former samples in all classes: 0.6932]
[acc of novel samples in all classes: 0.3464]
2022-11-05 15:18:39,196 INFO: Session 3: 63.20+-1.04[acc of former classes: 0.7071][acc of former samples in all classes: 0.6831]
[acc of novel samples in all classes: 0.3254]
2022-11-05 15:18:39,196 INFO: Session 4: 59.54+-0.80[acc of former classes: 0.7073][acc of former samples in all classes: 0.6753]
[acc of novel samples in all classes: 0.2757]
2022-11-05 15:18:39,196 INFO: Session 5: 56.61+-0.74[acc of former classes: 0.7071][acc of former samples in all classes: 0.6693]
[acc of novel samples in all classes: 0.2566]
2022-11-05 15:18:39,197 INFO: Session 6: 54.08+-0.76[acc of former classes: 0.7071][acc of former samples in all classes: 0.6589]
[acc of novel samples in all classes: 0.2574]
2022-11-05 15:18:39,197 INFO: Session 7: 52.20+-0.66[acc of former classes: 0.7071][acc of former samples in all classes: 0.6502]
[acc of novel samples in all classes: 0.2657]
2022-11-05 15:18:39,197 INFO: Session 8: 50.49+-0.75[acc of former classes: 0.7074][acc of former samples in all classes: 0.6454]
[acc of novel samples in all classes: 0.2639]
2022-11-05 15:18:39,197 INFO: Session 9: 48.40+-0.65[acc of former classes: 0.7072][acc of former samples in all classes: 0.6368]
[acc of novel samples in all classes: 0.2547]
2022-11-05 15:18:39,197 INFO: random seed: 1997
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/cifar-100_bases60/F2M_res18_cifar_5shots_debug_02/models/test4_session_8.pth
finish!!
