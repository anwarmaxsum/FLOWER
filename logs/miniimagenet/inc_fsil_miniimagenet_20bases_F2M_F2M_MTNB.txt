2022-10-31 22:10:00,596 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-10-31 22:10:00,597 INFO: 
  name: MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases
  model_type: MTNBModel
  gpu: 1
  manual_seed: 1997
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  datasets:[
    train:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/train
      aug: True
      num_worker_per_gpu: 8
      batch_size_base_classes: None
      pin_memory: True
      pre_load: False
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    val:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      num_worker_per_gpu: 8
      pin_memory: True
      pre_load: False
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    test:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      num_worker_per_gpu: 8
      pin_memory: True
      pre_load: False
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
  ]
  network_g:[
    type: Resnet18_softmax
    Embed_dim: 512
    pretrained: False
    norm: False
    num_classes: 20
    adopt_classifier: False
    addition_net: False
    flatten: True
    cut_at_pooling: False
  ]
  path:[
    pretrain_model_g: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
    pretrain_prototypes: None
    base_model: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases
    training_states: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/training_states
    log: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases
    models: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models
    prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.02
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [10]
      gamma: 1e-06
    ]
    random_noise:[
      distribution:[
        type: DiscreteBeta
      ]
      type: suffix_conv_weight
      num_layers: 4
      low: 0.1
      high: 5.0
      reduction_factor: 4
      bound_value: 0.01
      random_times: 2
    ]
    max_steps: 1
    ratio: 1
    fine_tune: True
    incremental: True
    fine_tune_epoch: 6
    warmup_iter: -1
    bases: 20
    tasks: 9
    novel_exemplars: 5
    shots: 5
    num_test: 5
    test_id: 1
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
  ]
  val:[
    val_freq: 100
    test_type: NCM
    use_all_bases: False
  ]
  logger:[
    print_freq: 1
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-miniImageNet-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-10-31 22:10:00,597 INFO: Random seed: 1997
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:181: UserWarning: nn.init.kaiming_normal is now deprecated in favor of nn.init.kaiming_normal_.
  init.kaiming_normal(m.weight, mode='fan_out')
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:188: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  init.normal(m.weight, std=0.001)
2022-10-31 22:10:02,536 INFO: Network: Resnet18_softmax, with parameters: 11,689,512
2022-10-31 22:10:02,536 INFO: Resnet18_softmax(
  (func): ResNet_pytorch(
    (base): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=1000, bias=True)
    )
  )
)
2022-10-31 22:10:02,536 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:10:02,577 WARNING: Current net - loaded net:
2022-10-31 22:10:02,577 WARNING: Loaded net - current net:
2022-10-31 22:10:02,577 WARNING:   func.classifier.bias
2022-10-31 22:10:02,578 WARNING:   func.classifier.weight
2022-10-31 22:10:02,619 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:10:02,652 WARNING: Current net - loaded net:
2022-10-31 22:10:02,652 WARNING: Loaded net - current net:
2022-10-31 22:10:02,652 WARNING:   func.classifier.bias
2022-10-31 22:10:02,652 WARNING:   func.classifier.weight
2022-10-31 22:10:02,694 INFO: Obtain parameters for train
2022-10-31 22:10:02,702 INFO: Model [MTNBModel] is created.
2022-10-31 22:10:19,593 INFO: [Test_acc of task 0 on test 0: 0.65450][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.65450]
2022-10-31 22:10:19,854 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:10:19,882 WARNING: Current net - loaded net:
2022-10-31 22:10:19,883 WARNING: Loaded net - current net:
2022-10-31 22:10:19,883 WARNING:   func.classifier.bias
2022-10-31 22:10:19,883 WARNING:   func.classifier.weight
2022-10-31 22:10:19,924 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth.
2022-10-31 22:10:20,000 INFO: Obtain parameters for train
2022-10-31 22:10:20,007 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:10:20,007 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:10:20,007 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:10:20,007 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:10:20,007 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:10:20,007 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:10:20,008 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:10:20,009 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:10:20,010 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:10:20,010 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:10:20,010 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:10:20,010 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:10:20,010 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:10:20,010 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:10:20,010 INFO: Model [MTNBModel] is created.
2022-10-31 22:10:20,023 INFO: Dataset NormalDataset - miniImageNet is created.
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
>>> Test >>>
Former classes: []
Novel classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:10:20,782 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.1591, Acc: 0.7400, ]
2022-10-31 22:10:21,412 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.1505, Acc: 0.6800, ]
2022-10-31 22:10:22,078 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.1579, Acc: 0.5800, ]
2022-10-31 22:10:22,685 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.1514, Acc: 0.6400, ]
2022-10-31 22:10:23,345 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.1573, Acc: 0.5400, ]
2022-10-31 22:10:23,987 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.1458, Acc: 0.6200, ]
2022-10-31 22:10:24,095 INFO: fine-tune procedure is finished!
2022-10-31 22:10:41,774 INFO: [Test_acc of task 1 on test 0: 0.45133][acc of former classes: 0.65450][acc of former samples in all classes: 0.60000]
[acc of novel samples in all classes: 0.15400]
2022-10-31 22:10:42,073 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:10:42,101 WARNING: Current net - loaded net:
2022-10-31 22:10:42,101 WARNING: Loaded net - current net:
2022-10-31 22:10:42,101 WARNING:   func.classifier.bias
2022-10-31 22:10:42,101 WARNING:   func.classifier.weight
2022-10-31 22:10:42,141 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_1.pth.
2022-10-31 22:10:42,212 INFO: Obtain parameters for train
2022-10-31 22:10:42,217 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:10:42,217 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:10:42,218 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:10:42,219 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:10:42,220 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:10:42,220 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:10:42,220 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:10:42,220 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:10:42,220 INFO: Model [MTNBModel] is created.
2022-10-31 22:10:42,231 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:10:42,241 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:10:42,777 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.4681, Acc: 0.5600, ]
2022-10-31 22:10:43,440 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.4706, Acc: 0.5100, ]
2022-10-31 22:10:44,044 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.4682, Acc: 0.5200, ]
2022-10-31 22:10:44,743 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.4721, Acc: 0.5500, ]
2022-10-31 22:10:45,366 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.4661, Acc: 0.5700, ]
2022-10-31 22:10:46,033 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.4683, Acc: 0.4900, ]
2022-10-31 22:10:46,153 INFO: fine-tune procedure is finished!
2022-10-31 22:11:08,958 INFO: [Test_acc of task 2 on test 0: 0.35975][acc of former classes: 0.65450][acc of former samples in all classes: 0.57750]
[acc of novel samples in all classes: 0.14200]
2022-10-31 22:11:09,261 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:11:09,290 WARNING: Current net - loaded net:
2022-10-31 22:11:09,290 WARNING: Loaded net - current net:
2022-10-31 22:11:09,290 WARNING:   func.classifier.bias
2022-10-31 22:11:09,290 WARNING:   func.classifier.weight
2022-10-31 22:11:09,329 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_2.pth.
2022-10-31 22:11:09,402 INFO: Obtain parameters for train
2022-10-31 22:11:09,407 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:11:09,407 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:11:09,408 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:11:09,409 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:11:09,409 INFO: Model [MTNBModel] is created.
2022-10-31 22:11:09,420 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:11:09,430 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:11:09,440 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:11:10,030 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.7105, Acc: 0.4533, ]
2022-10-31 22:11:10,816 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.7057, Acc: 0.4467, ]
2022-10-31 22:11:11,549 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.7056, Acc: 0.4600, ]
2022-10-31 22:11:12,230 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.7158, Acc: 0.4600, ]
2022-10-31 22:11:12,919 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.7103, Acc: 0.4600, ]
2022-10-31 22:11:13,618 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.7022, Acc: 0.4867, ]
2022-10-31 22:11:13,720 INFO: fine-tune procedure is finished!
2022-10-31 22:11:42,206 INFO: [Test_acc of task 3 on test 0: 0.29180][acc of former classes: 0.65450][acc of former samples in all classes: 0.57000]
[acc of novel samples in all classes: 0.10633]
2022-10-31 22:11:42,496 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:11:42,523 WARNING: Current net - loaded net:
2022-10-31 22:11:42,523 WARNING: Loaded net - current net:
2022-10-31 22:11:42,523 WARNING:   func.classifier.bias
2022-10-31 22:11:42,523 WARNING:   func.classifier.weight
2022-10-31 22:11:42,648 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_3.pth.
2022-10-31 22:11:42,710 INFO: Obtain parameters for train
2022-10-31 22:11:42,715 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:11:42,715 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:11:42,716 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:11:42,717 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:11:42,717 INFO: Model [MTNBModel] is created.
2022-10-31 22:11:42,728 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:11:42,741 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:11:42,751 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:11:42,761 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:11:43,432 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.8975, Acc: 0.4950, ]
2022-10-31 22:11:44,208 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9016, Acc: 0.4300, ]
2022-10-31 22:11:44,910 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.8958, Acc: 0.4450, ]
2022-10-31 22:11:45,684 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9018, Acc: 0.4150, ]
2022-10-31 22:11:46,373 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.8996, Acc: 0.4200, ]
2022-10-31 22:11:47,127 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.8980, Acc: 0.4500, ]
2022-10-31 22:11:47,235 INFO: fine-tune procedure is finished!
2022-10-31 22:12:20,123 INFO: [Test_acc of task 4 on test 0: 0.24817][acc of former classes: 0.65450][acc of former samples in all classes: 0.56200]
[acc of novel samples in all classes: 0.09125]
2022-10-31 22:12:20,429 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:12:20,458 WARNING: Current net - loaded net:
2022-10-31 22:12:20,458 WARNING: Loaded net - current net:
2022-10-31 22:12:20,458 WARNING:   func.classifier.bias
2022-10-31 22:12:20,458 WARNING:   func.classifier.weight
2022-10-31 22:12:20,495 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_4.pth.
2022-10-31 22:12:20,567 INFO: Obtain parameters for train
2022-10-31 22:12:20,572 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:12:20,572 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:12:20,573 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:12:20,574 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:12:20,574 INFO: Model [MTNBModel] is created.
2022-10-31 22:12:20,585 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:12:20,596 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:12:20,606 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:12:20,616 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:12:20,627 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:12:21,308 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0620, Acc: 0.4320, ]
2022-10-31 22:12:22,133 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0537, Acc: 0.4080, ]
2022-10-31 22:12:22,988 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0628, Acc: 0.4040, ]
2022-10-31 22:12:24,038 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0554, Acc: 0.4320, ]
2022-10-31 22:12:24,822 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0631, Acc: 0.3560, ]
2022-10-31 22:12:25,547 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0644, Acc: 0.3960, ]
2022-10-31 22:12:25,662 INFO: fine-tune procedure is finished!
2022-10-31 22:13:04,304 INFO: [Test_acc of task 5 on test 0: 0.21657][acc of former classes: 0.65450][acc of former samples in all classes: 0.55550]
[acc of novel samples in all classes: 0.08100]
2022-10-31 22:13:04,611 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:13:04,640 WARNING: Current net - loaded net:
2022-10-31 22:13:04,640 WARNING: Loaded net - current net:
2022-10-31 22:13:04,640 WARNING:   func.classifier.bias
2022-10-31 22:13:04,640 WARNING:   func.classifier.weight
2022-10-31 22:13:04,685 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_5.pth.
2022-10-31 22:13:04,758 INFO: Obtain parameters for train
2022-10-31 22:13:04,762 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:13:04,762 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:13:04,763 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:13:04,764 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:13:04,765 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:13:04,765 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:13:04,765 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:13:04,765 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:13:04,765 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:13:04,765 INFO: Model [MTNBModel] is created.
2022-10-31 22:13:04,776 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:04,786 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:04,796 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:04,806 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:04,816 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:04,827 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:13:05,561 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2050, Acc: 0.3400, ]
2022-10-31 22:13:06,379 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2045, Acc: 0.3500, ]
2022-10-31 22:13:07,334 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1992, Acc: 0.3633, ]
2022-10-31 22:13:08,236 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1911, Acc: 0.4033, ]
2022-10-31 22:13:09,091 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1977, Acc: 0.3867, ]
2022-10-31 22:13:10,014 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2011, Acc: 0.3800, ]
2022-10-31 22:13:10,116 INFO: fine-tune procedure is finished!
2022-10-31 22:13:54,142 INFO: [Test_acc of task 6 on test 0: 0.19300][acc of former classes: 0.65500][acc of former samples in all classes: 0.55150]
[acc of novel samples in all classes: 0.07350]
2022-10-31 22:13:54,438 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:13:54,467 WARNING: Current net - loaded net:
2022-10-31 22:13:54,468 WARNING: Loaded net - current net:
2022-10-31 22:13:54,468 WARNING:   func.classifier.bias
2022-10-31 22:13:54,468 WARNING:   func.classifier.weight
2022-10-31 22:13:54,503 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_6.pth.
2022-10-31 22:13:54,576 INFO: Obtain parameters for train
2022-10-31 22:13:54,581 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:13:54,581 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:13:54,582 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:13:54,583 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:13:54,583 INFO: Model [MTNBModel] is created.
2022-10-31 22:13:54,594 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:54,604 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:54,614 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:54,624 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:54,634 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:54,644 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:13:54,654 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:13:55,720 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3213, Acc: 0.3629, ]
2022-10-31 22:13:56,614 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3191, Acc: 0.3686, ]
2022-10-31 22:13:57,533 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3167, Acc: 0.3600, ]
2022-10-31 22:13:58,399 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3238, Acc: 0.3200, ]
2022-10-31 22:13:59,268 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3191, Acc: 0.3829, ]
2022-10-31 22:14:00,185 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3219, Acc: 0.3429, ]
2022-10-31 22:14:00,315 INFO: fine-tune procedure is finished!
2022-10-31 22:14:49,395 INFO: [Test_acc of task 7 on test 0: 0.17267][acc of former classes: 0.65500][acc of former samples in all classes: 0.54700]
[acc of novel samples in all classes: 0.06571]
2022-10-31 22:14:49,687 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:14:49,717 WARNING: Current net - loaded net:
2022-10-31 22:14:49,718 WARNING: Loaded net - current net:
2022-10-31 22:14:49,718 WARNING:   func.classifier.bias
2022-10-31 22:14:49,718 WARNING:   func.classifier.weight
2022-10-31 22:14:49,758 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_7.pth.
2022-10-31 22:14:49,834 INFO: Obtain parameters for train
2022-10-31 22:14:49,840 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:14:49,840 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:14:49,840 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:14:49,840 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:14:49,840 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:14:49,840 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:14:49,841 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:14:49,842 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:14:49,843 INFO: Model [MTNBModel] is created.
2022-10-31 22:14:49,854 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:14:49,864 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:14:49,874 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:14:49,884 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:14:49,894 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:14:49,904 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:14:49,916 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:14:49,927 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:14:50,827 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4244, Acc: 0.3700, ]
2022-10-31 22:14:51,775 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4165, Acc: 0.3800, ]
2022-10-31 22:14:52,752 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4214, Acc: 0.3725, ]
2022-10-31 22:14:53,693 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4196, Acc: 0.3600, ]
2022-10-31 22:14:54,662 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4201, Acc: 0.3675, ]
2022-10-31 22:14:55,609 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4227, Acc: 0.3750, ]
2022-10-31 22:14:55,713 INFO: fine-tune procedure is finished!
2022-10-31 22:15:49,931 INFO: [Test_acc of task 8 on test 0: 0.16060][acc of former classes: 0.65500][acc of former samples in all classes: 0.54000]
[acc of novel samples in all classes: 0.06575]
2022-10-31 22:15:50,243 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:15:50,270 WARNING: Current net - loaded net:
2022-10-31 22:15:50,271 WARNING: Loaded net - current net:
2022-10-31 22:15:50,271 WARNING:   func.classifier.bias
2022-10-31 22:15:50,271 WARNING:   func.classifier.weight
2022-10-31 22:15:50,308 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth.
2022-10-31 22:15:50,380 INFO: Obtain parameters for train
2022-10-31 22:15:50,387 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:15:50,387 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:15:50,388 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:15:50,389 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:15:50,389 INFO: Model [MTNBModel] is created.
2022-10-31 22:15:50,400 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:15:50,905 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.1574, Acc: 0.6000, ]
2022-10-31 22:15:51,527 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.1641, Acc: 0.5000, ]
2022-10-31 22:15:52,189 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.1682, Acc: 0.5000, ]
2022-10-31 22:15:52,801 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.1720, Acc: 0.4800, ]
2022-10-31 22:15:53,481 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.1552, Acc: 0.5800, ]
2022-10-31 22:15:54,165 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.1578, Acc: 0.4400, ]
2022-10-31 22:15:54,276 INFO: fine-tune procedure is finished!
2022-10-31 22:16:12,216 INFO: [Test_acc of task 1 on test 1: 0.45100][acc of former classes: 0.65450][acc of former samples in all classes: 0.61650]
[acc of novel samples in all classes: 0.12000]
2022-10-31 22:16:12,517 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:16:12,549 WARNING: Current net - loaded net:
2022-10-31 22:16:12,549 WARNING: Loaded net - current net:
2022-10-31 22:16:12,549 WARNING:   func.classifier.bias
2022-10-31 22:16:12,549 WARNING:   func.classifier.weight
2022-10-31 22:16:12,588 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_1.pth.
2022-10-31 22:16:12,659 INFO: Obtain parameters for train
2022-10-31 22:16:12,664 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:16:12,664 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:16:12,665 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:16:12,666 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:16:12,666 INFO: Model [MTNBModel] is created.
2022-10-31 22:16:12,677 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:16:12,688 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:16:13,301 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.4650, Acc: 0.4700, ]
2022-10-31 22:16:13,977 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.4670, Acc: 0.5600, ]
2022-10-31 22:16:14,666 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.4594, Acc: 0.5300, ]
2022-10-31 22:16:15,335 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.4649, Acc: 0.5100, ]
2022-10-31 22:16:16,020 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.4635, Acc: 0.5100, ]
2022-10-31 22:16:16,749 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.4702, Acc: 0.4500, ]
2022-10-31 22:16:16,861 INFO: fine-tune procedure is finished!
2022-10-31 22:16:39,654 INFO: [Test_acc of task 2 on test 1: 0.35950][acc of former classes: 0.65450][acc of former samples in all classes: 0.58550]
[acc of novel samples in all classes: 0.13350]
2022-10-31 22:16:39,965 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:16:39,994 WARNING: Current net - loaded net:
2022-10-31 22:16:39,994 WARNING: Loaded net - current net:
2022-10-31 22:16:39,994 WARNING:   func.classifier.bias
2022-10-31 22:16:39,994 WARNING:   func.classifier.weight
2022-10-31 22:16:40,037 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_2.pth.
2022-10-31 22:16:40,112 INFO: Obtain parameters for train
2022-10-31 22:16:40,119 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:16:40,119 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:16:40,119 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:16:40,119 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:16:40,119 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:16:40,120 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:16:40,121 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:16:40,122 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:16:40,122 INFO: Model [MTNBModel] is created.
2022-10-31 22:16:40,133 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:16:40,143 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:16:40,153 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:16:40,762 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.7223, Acc: 0.3333, ]
2022-10-31 22:16:41,472 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.7016, Acc: 0.4400, ]
2022-10-31 22:16:42,185 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.7083, Acc: 0.4200, ]
2022-10-31 22:16:42,911 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.7083, Acc: 0.4133, ]
2022-10-31 22:16:43,718 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.7111, Acc: 0.4800, ]
2022-10-31 22:16:44,458 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.7058, Acc: 0.4467, ]
2022-10-31 22:16:44,571 INFO: fine-tune procedure is finished!
2022-10-31 22:17:13,206 INFO: [Test_acc of task 3 on test 1: 0.28960][acc of former classes: 0.65450][acc of former samples in all classes: 0.57400]
[acc of novel samples in all classes: 0.10000]
2022-10-31 22:17:13,506 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:17:13,534 WARNING: Current net - loaded net:
2022-10-31 22:17:13,535 WARNING: Loaded net - current net:
2022-10-31 22:17:13,535 WARNING:   func.classifier.bias
2022-10-31 22:17:13,535 WARNING:   func.classifier.weight
2022-10-31 22:17:13,572 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_3.pth.
2022-10-31 22:17:13,643 INFO: Obtain parameters for train
2022-10-31 22:17:13,654 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:17:13,654 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:17:13,655 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:17:13,656 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:17:13,656 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:17:13,656 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:17:13,656 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:17:13,656 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:17:13,656 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:17:13,656 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:17:13,656 INFO: Model [MTNBModel] is created.
2022-10-31 22:17:13,667 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:17:13,677 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:17:13,690 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:17:13,700 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:17:14,371 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9014, Acc: 0.3550, ]
2022-10-31 22:17:15,069 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9050, Acc: 0.4000, ]
2022-10-31 22:17:15,830 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9042, Acc: 0.3800, ]
2022-10-31 22:17:16,588 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9007, Acc: 0.4300, ]
2022-10-31 22:17:17,365 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9025, Acc: 0.4250, ]
2022-10-31 22:17:18,114 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9058, Acc: 0.3900, ]
2022-10-31 22:17:18,223 INFO: fine-tune procedure is finished!
2022-10-31 22:17:51,833 INFO: [Test_acc of task 4 on test 1: 0.24667][acc of former classes: 0.65450][acc of former samples in all classes: 0.56800]
[acc of novel samples in all classes: 0.08600]
2022-10-31 22:17:52,166 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:17:52,197 WARNING: Current net - loaded net:
2022-10-31 22:17:52,197 WARNING: Loaded net - current net:
2022-10-31 22:17:52,197 WARNING:   func.classifier.bias
2022-10-31 22:17:52,197 WARNING:   func.classifier.weight
2022-10-31 22:17:52,238 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_4.pth.
2022-10-31 22:17:52,312 INFO: Obtain parameters for train
2022-10-31 22:17:52,318 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:17:52,318 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:17:52,319 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:17:52,320 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:17:52,320 INFO: Model [MTNBModel] is created.
2022-10-31 22:17:52,331 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:17:52,341 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:17:52,351 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:17:52,361 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:17:52,371 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:17:53,098 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0717, Acc: 0.3600, ]
2022-10-31 22:17:53,904 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0661, Acc: 0.3480, ]
2022-10-31 22:17:54,720 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0646, Acc: 0.3880, ]
2022-10-31 22:17:55,512 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0660, Acc: 0.3840, ]
2022-10-31 22:17:56,341 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0657, Acc: 0.4000, ]
2022-10-31 22:17:57,201 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0703, Acc: 0.3480, ]
2022-10-31 22:17:57,310 INFO: fine-tune procedure is finished!
2022-10-31 22:18:35,869 INFO: [Test_acc of task 5 on test 1: 0.21129][acc of former classes: 0.65450][acc of former samples in all classes: 0.56050]
[acc of novel samples in all classes: 0.07160]
2022-10-31 22:18:36,176 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:18:36,215 WARNING: Current net - loaded net:
2022-10-31 22:18:36,215 WARNING: Loaded net - current net:
2022-10-31 22:18:36,215 WARNING:   func.classifier.bias
2022-10-31 22:18:36,216 WARNING:   func.classifier.weight
2022-10-31 22:18:36,252 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_5.pth.
2022-10-31 22:18:36,320 INFO: Obtain parameters for train
2022-10-31 22:18:36,324 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:18:36,324 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:18:36,325 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:18:36,326 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:18:36,327 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:18:36,327 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:18:36,327 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:18:36,327 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:18:36,327 INFO: Model [MTNBModel] is created.
2022-10-31 22:18:36,338 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:18:36,348 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:18:36,358 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:18:36,368 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:18:36,378 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:18:36,388 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:18:37,120 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2023, Acc: 0.3500, ]
2022-10-31 22:18:37,937 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2010, Acc: 0.3900, ]
2022-10-31 22:18:38,784 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2027, Acc: 0.3700, ]
2022-10-31 22:18:39,619 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2026, Acc: 0.3833, ]
2022-10-31 22:18:40,484 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2001, Acc: 0.3500, ]
2022-10-31 22:18:41,359 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1997, Acc: 0.3933, ]
2022-10-31 22:18:41,520 INFO: fine-tune procedure is finished!
2022-10-31 22:19:25,712 INFO: [Test_acc of task 6 on test 1: 0.18950][acc of former classes: 0.65500][acc of former samples in all classes: 0.55300]
[acc of novel samples in all classes: 0.06833]
2022-10-31 22:19:26,010 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:19:26,037 WARNING: Current net - loaded net:
2022-10-31 22:19:26,038 WARNING: Loaded net - current net:
2022-10-31 22:19:26,038 WARNING:   func.classifier.bias
2022-10-31 22:19:26,038 WARNING:   func.classifier.weight
2022-10-31 22:19:26,076 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_6.pth.
2022-10-31 22:19:26,144 INFO: Obtain parameters for train
2022-10-31 22:19:26,149 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:19:26,149 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:19:26,150 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:19:26,151 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:19:26,151 INFO: Model [MTNBModel] is created.
2022-10-31 22:19:26,162 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:19:26,172 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:19:26,182 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:19:26,192 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:19:26,202 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:19:26,212 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:19:26,222 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:19:26,983 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3288, Acc: 0.3457, ]
2022-10-31 22:19:27,823 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3169, Acc: 0.3429, ]
2022-10-31 22:19:28,686 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3256, Acc: 0.3314, ]
2022-10-31 22:19:29,582 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3210, Acc: 0.3371, ]
2022-10-31 22:19:30,438 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3223, Acc: 0.3600, ]
2022-10-31 22:19:31,255 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3233, Acc: 0.3343, ]
2022-10-31 22:19:31,361 INFO: fine-tune procedure is finished!
2022-10-31 22:20:20,192 INFO: [Test_acc of task 7 on test 1: 0.17144][acc of former classes: 0.65500][acc of former samples in all classes: 0.54850]
[acc of novel samples in all classes: 0.06371]
2022-10-31 22:20:20,493 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:20:20,520 WARNING: Current net - loaded net:
2022-10-31 22:20:20,520 WARNING: Loaded net - current net:
2022-10-31 22:20:20,521 WARNING:   func.classifier.bias
2022-10-31 22:20:20,521 WARNING:   func.classifier.weight
2022-10-31 22:20:20,559 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_7.pth.
2022-10-31 22:20:20,627 INFO: Obtain parameters for train
2022-10-31 22:20:20,634 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:20:20,634 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:20:20,635 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:20:20,636 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:20:20,636 INFO: Model [MTNBModel] is created.
2022-10-31 22:20:20,647 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:20:20,657 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:20:20,667 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:20:20,677 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:20:20,687 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:20:20,697 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:20:20,707 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:20:20,717 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:20:21,474 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4322, Acc: 0.3175, ]
2022-10-31 22:20:22,385 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4301, Acc: 0.3350, ]
2022-10-31 22:20:23,308 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4300, Acc: 0.3150, ]
2022-10-31 22:20:24,265 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4332, Acc: 0.3250, ]
2022-10-31 22:20:25,152 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4258, Acc: 0.3625, ]
2022-10-31 22:20:26,092 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4299, Acc: 0.3225, ]
2022-10-31 22:20:26,206 INFO: fine-tune procedure is finished!
2022-10-31 22:21:20,380 INFO: [Test_acc of task 8 on test 1: 0.15800][acc of former classes: 0.65500][acc of former samples in all classes: 0.54000]
[acc of novel samples in all classes: 0.06250]
2022-10-31 22:21:20,694 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:21:20,722 WARNING: Current net - loaded net:
2022-10-31 22:21:20,722 WARNING: Loaded net - current net:
2022-10-31 22:21:20,722 WARNING:   func.classifier.bias
2022-10-31 22:21:20,722 WARNING:   func.classifier.weight
2022-10-31 22:21:20,759 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth.
2022-10-31 22:21:20,831 INFO: Obtain parameters for train
2022-10-31 22:21:20,843 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:21:20,843 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:21:20,844 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:21:20,845 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:21:20,845 INFO: Model [MTNBModel] is created.
2022-10-31 22:21:20,856 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:21:21,342 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.1732, Acc: 0.5400, ]
2022-10-31 22:21:22,040 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.1795, Acc: 0.4800, ]
2022-10-31 22:21:22,654 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.1647, Acc: 0.5800, ]
2022-10-31 22:21:23,283 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.1852, Acc: 0.4800, ]
2022-10-31 22:21:23,981 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.1785, Acc: 0.6200, ]
2022-10-31 22:21:24,591 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.1768, Acc: 0.4600, ]
2022-10-31 22:21:24,684 INFO: fine-tune procedure is finished!
2022-10-31 22:21:42,769 INFO: [Test_acc of task 1 on test 2: 0.46700][acc of former classes: 0.65450][acc of former samples in all classes: 0.61200]
[acc of novel samples in all classes: 0.17700]
2022-10-31 22:21:43,074 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:21:43,105 WARNING: Current net - loaded net:
2022-10-31 22:21:43,105 WARNING: Loaded net - current net:
2022-10-31 22:21:43,105 WARNING:   func.classifier.bias
2022-10-31 22:21:43,105 WARNING:   func.classifier.weight
2022-10-31 22:21:43,145 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_1.pth.
2022-10-31 22:21:43,213 INFO: Obtain parameters for train
2022-10-31 22:21:43,221 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:21:43,221 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:21:43,222 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:21:43,223 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:21:43,223 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:21:43,223 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:21:43,223 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:21:43,223 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:21:43,223 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:21:43,223 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:21:43,223 INFO: Model [MTNBModel] is created.
2022-10-31 22:21:43,234 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:21:43,244 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:21:43,793 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.4755, Acc: 0.4400, ]
2022-10-31 22:21:44,487 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.4805, Acc: 0.4600, ]
2022-10-31 22:21:45,118 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.4589, Acc: 0.5200, ]
2022-10-31 22:21:45,957 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.4633, Acc: 0.4900, ]
2022-10-31 22:21:46,660 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.4674, Acc: 0.5100, ]
2022-10-31 22:21:47,370 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.4846, Acc: 0.4500, ]
2022-10-31 22:21:47,483 INFO: fine-tune procedure is finished!
2022-10-31 22:22:10,879 INFO: [Test_acc of task 2 on test 2: 0.36400][acc of former classes: 0.65450][acc of former samples in all classes: 0.58800]
[acc of novel samples in all classes: 0.14000]
2022-10-31 22:22:11,181 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:22:11,209 WARNING: Current net - loaded net:
2022-10-31 22:22:11,209 WARNING: Loaded net - current net:
2022-10-31 22:22:11,209 WARNING:   func.classifier.bias
2022-10-31 22:22:11,209 WARNING:   func.classifier.weight
2022-10-31 22:22:11,245 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_2.pth.
2022-10-31 22:22:11,319 INFO: Obtain parameters for train
2022-10-31 22:22:11,323 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:22:11,323 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:22:11,323 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:22:11,323 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:22:11,323 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:22:11,323 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:22:11,323 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:22:11,323 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:22:11,324 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:22:11,325 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:22:11,326 INFO: Model [MTNBModel] is created.
2022-10-31 22:22:11,336 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:22:11,347 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:22:11,357 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:22:11,965 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.7135, Acc: 0.4067, ]
2022-10-31 22:22:12,652 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.7116, Acc: 0.4333, ]
2022-10-31 22:22:13,404 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.7141, Acc: 0.4200, ]
2022-10-31 22:22:14,172 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.7117, Acc: 0.5067, ]
2022-10-31 22:22:14,859 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.7144, Acc: 0.4333, ]
2022-10-31 22:22:15,562 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.7096, Acc: 0.4933, ]
2022-10-31 22:22:15,665 INFO: fine-tune procedure is finished!
2022-10-31 22:22:43,491 INFO: [Test_acc of task 3 on test 2: 0.29380][acc of former classes: 0.65450][acc of former samples in all classes: 0.57750]
[acc of novel samples in all classes: 0.10467]
2022-10-31 22:22:43,799 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:22:43,830 WARNING: Current net - loaded net:
2022-10-31 22:22:43,830 WARNING: Loaded net - current net:
2022-10-31 22:22:43,830 WARNING:   func.classifier.bias
2022-10-31 22:22:43,830 WARNING:   func.classifier.weight
2022-10-31 22:22:43,869 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_3.pth.
2022-10-31 22:22:43,942 INFO: Obtain parameters for train
2022-10-31 22:22:43,946 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:22:43,947 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:22:43,948 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:22:43,949 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:22:43,949 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:22:43,949 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:22:43,949 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:22:43,949 INFO: Model [MTNBModel] is created.
2022-10-31 22:22:43,960 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:22:43,970 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:22:43,980 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:22:43,990 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:22:44,742 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9123, Acc: 0.4150, ]
2022-10-31 22:22:45,454 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9122, Acc: 0.4150, ]
2022-10-31 22:22:46,221 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9119, Acc: 0.4250, ]
2022-10-31 22:22:46,966 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9059, Acc: 0.4250, ]
2022-10-31 22:22:47,688 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9057, Acc: 0.4800, ]
2022-10-31 22:22:48,438 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9049, Acc: 0.3900, ]
2022-10-31 22:22:48,562 INFO: fine-tune procedure is finished!
2022-10-31 22:23:22,232 INFO: [Test_acc of task 4 on test 2: 0.24600][acc of former classes: 0.65450][acc of former samples in all classes: 0.56850]
[acc of novel samples in all classes: 0.08475]
2022-10-31 22:23:22,529 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:23:22,559 WARNING: Current net - loaded net:
2022-10-31 22:23:22,559 WARNING: Loaded net - current net:
2022-10-31 22:23:22,559 WARNING:   func.classifier.bias
2022-10-31 22:23:22,559 WARNING:   func.classifier.weight
2022-10-31 22:23:22,599 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_4.pth.
2022-10-31 22:23:22,671 INFO: Obtain parameters for train
2022-10-31 22:23:22,677 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:23:22,677 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:23:22,678 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:23:22,679 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:23:22,679 INFO: Model [MTNBModel] is created.
2022-10-31 22:23:22,690 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:23:22,700 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:23:22,710 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:23:22,720 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:23:22,730 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:23:23,411 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0738, Acc: 0.3920, ]
2022-10-31 22:23:24,296 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0761, Acc: 0.3840, ]
2022-10-31 22:23:25,092 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0669, Acc: 0.3960, ]
2022-10-31 22:23:25,886 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0785, Acc: 0.3440, ]
2022-10-31 22:23:26,733 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0767, Acc: 0.3400, ]
2022-10-31 22:23:27,638 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0690, Acc: 0.4200, ]
2022-10-31 22:23:27,792 INFO: fine-tune procedure is finished!
2022-10-31 22:24:06,484 INFO: [Test_acc of task 5 on test 2: 0.21229][acc of former classes: 0.65450][acc of former samples in all classes: 0.56450]
[acc of novel samples in all classes: 0.07140]
2022-10-31 22:24:06,788 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:24:06,821 WARNING: Current net - loaded net:
2022-10-31 22:24:06,821 WARNING: Loaded net - current net:
2022-10-31 22:24:06,821 WARNING:   func.classifier.bias
2022-10-31 22:24:06,821 WARNING:   func.classifier.weight
2022-10-31 22:24:06,863 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_5.pth.
2022-10-31 22:24:06,935 INFO: Obtain parameters for train
2022-10-31 22:24:06,940 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:06,940 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:24:06,941 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:24:06,942 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:24:06,942 INFO: Model [MTNBModel] is created.
2022-10-31 22:24:06,953 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:06,963 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:06,974 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:06,984 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:06,994 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:07,004 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:24:07,716 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2056, Acc: 0.3500, ]
2022-10-31 22:24:08,556 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2022, Acc: 0.3267, ]
2022-10-31 22:24:09,440 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2049, Acc: 0.4233, ]
2022-10-31 22:24:10,258 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2069, Acc: 0.3633, ]
2022-10-31 22:24:11,182 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2048, Acc: 0.3567, ]
2022-10-31 22:24:12,134 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2079, Acc: 0.3633, ]
2022-10-31 22:24:12,244 INFO: fine-tune procedure is finished!
2022-10-31 22:24:56,290 INFO: [Test_acc of task 6 on test 2: 0.19350][acc of former classes: 0.65500][acc of former samples in all classes: 0.56250]
[acc of novel samples in all classes: 0.07050]
2022-10-31 22:24:56,588 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:24:56,616 WARNING: Current net - loaded net:
2022-10-31 22:24:56,616 WARNING: Loaded net - current net:
2022-10-31 22:24:56,616 WARNING:   func.classifier.bias
2022-10-31 22:24:56,616 WARNING:   func.classifier.weight
2022-10-31 22:24:56,655 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_6.pth.
2022-10-31 22:24:56,726 INFO: Obtain parameters for train
2022-10-31 22:24:56,733 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:24:56,733 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:24:56,733 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:24:56,733 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:24:56,733 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:24:56,733 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:24:56,733 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:24:56,733 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:24:56,734 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:24:56,735 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:24:56,736 INFO: Model [MTNBModel] is created.
2022-10-31 22:24:56,747 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:56,757 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:56,767 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:56,777 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:56,787 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:56,799 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:24:56,809 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:24:57,665 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3229, Acc: 0.3343, ]
2022-10-31 22:24:58,580 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3238, Acc: 0.3457, ]
2022-10-31 22:24:59,495 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3288, Acc: 0.3371, ]
2022-10-31 22:25:00,497 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3297, Acc: 0.3286, ]
2022-10-31 22:25:01,369 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3242, Acc: 0.3543, ]
2022-10-31 22:25:02,351 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3283, Acc: 0.3000, ]
2022-10-31 22:25:02,462 INFO: fine-tune procedure is finished!
2022-10-31 22:25:51,717 INFO: [Test_acc of task 7 on test 2: 0.17233][acc of former classes: 0.65500][acc of former samples in all classes: 0.54800]
[acc of novel samples in all classes: 0.06500]
2022-10-31 22:25:52,017 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:25:52,045 WARNING: Current net - loaded net:
2022-10-31 22:25:52,045 WARNING: Loaded net - current net:
2022-10-31 22:25:52,045 WARNING:   func.classifier.bias
2022-10-31 22:25:52,045 WARNING:   func.classifier.weight
2022-10-31 22:25:52,084 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_7.pth.
2022-10-31 22:25:52,156 INFO: Obtain parameters for train
2022-10-31 22:25:52,161 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:25:52,161 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:25:52,162 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:25:52,163 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:25:52,163 INFO: Model [MTNBModel] is created.
2022-10-31 22:25:52,174 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:52,184 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:52,194 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:52,204 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:52,214 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:52,225 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:52,235 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:52,245 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:25:53,005 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4218, Acc: 0.3450, ]
2022-10-31 22:25:54,066 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4261, Acc: 0.3600, ]
2022-10-31 22:25:54,935 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4250, Acc: 0.3375, ]
2022-10-31 22:25:55,839 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4281, Acc: 0.3350, ]
2022-10-31 22:25:56,705 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4291, Acc: 0.3575, ]
2022-10-31 22:25:57,709 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4277, Acc: 0.3600, ]
2022-10-31 22:25:57,806 INFO: fine-tune procedure is finished!
2022-10-31 22:26:52,197 INFO: [Test_acc of task 8 on test 2: 0.15970][acc of former classes: 0.65500][acc of former samples in all classes: 0.53550]
[acc of novel samples in all classes: 0.06575]
2022-10-31 22:26:52,496 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:26:52,526 WARNING: Current net - loaded net:
2022-10-31 22:26:52,526 WARNING: Loaded net - current net:
2022-10-31 22:26:52,526 WARNING:   func.classifier.bias
2022-10-31 22:26:52,526 WARNING:   func.classifier.weight
2022-10-31 22:26:52,565 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth.
2022-10-31 22:26:52,636 INFO: Obtain parameters for train
2022-10-31 22:26:52,642 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:26:52,642 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:26:52,642 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:26:52,642 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:26:52,642 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:26:52,642 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:26:52,642 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:26:52,642 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:26:52,643 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:26:52,644 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:26:52,645 INFO: Model [MTNBModel] is created.
2022-10-31 22:26:52,656 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:26:53,141 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.1695, Acc: 0.6400, ]
2022-10-31 22:26:53,750 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.1757, Acc: 0.4400, ]
2022-10-31 22:26:54,374 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.1658, Acc: 0.5800, ]
2022-10-31 22:26:54,964 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.1698, Acc: 0.6600, ]
2022-10-31 22:26:55,559 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.1719, Acc: 0.5400, ]
2022-10-31 22:26:56,151 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.1719, Acc: 0.4800, ]
2022-10-31 22:26:56,244 INFO: fine-tune procedure is finished!
2022-10-31 22:27:14,022 INFO: [Test_acc of task 1 on test 3: 0.46167][acc of former classes: 0.65450][acc of former samples in all classes: 0.61650]
[acc of novel samples in all classes: 0.15200]
2022-10-31 22:27:14,339 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:27:14,366 WARNING: Current net - loaded net:
2022-10-31 22:27:14,366 WARNING: Loaded net - current net:
2022-10-31 22:27:14,367 WARNING:   func.classifier.bias
2022-10-31 22:27:14,367 WARNING:   func.classifier.weight
2022-10-31 22:27:14,407 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_1.pth.
2022-10-31 22:27:14,485 INFO: Obtain parameters for train
2022-10-31 22:27:14,490 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,490 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,491 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:27:14,492 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:27:14,492 INFO: Model [MTNBModel] is created.
2022-10-31 22:27:14,504 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:27:14,514 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:27:15,093 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.4670, Acc: 0.4700, ]
2022-10-31 22:27:15,786 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.4639, Acc: 0.5000, ]
2022-10-31 22:27:16,458 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.4627, Acc: 0.5700, ]
2022-10-31 22:27:17,283 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.4573, Acc: 0.6300, ]
2022-10-31 22:27:17,989 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.4609, Acc: 0.5600, ]
2022-10-31 22:27:18,706 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.4653, Acc: 0.4900, ]
2022-10-31 22:27:18,814 INFO: fine-tune procedure is finished!
2022-10-31 22:27:42,242 INFO: [Test_acc of task 2 on test 3: 0.36775][acc of former classes: 0.65450][acc of former samples in all classes: 0.57900]
[acc of novel samples in all classes: 0.15650]
2022-10-31 22:27:42,542 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:27:42,569 WARNING: Current net - loaded net:
2022-10-31 22:27:42,569 WARNING: Loaded net - current net:
2022-10-31 22:27:42,569 WARNING:   func.classifier.bias
2022-10-31 22:27:42,569 WARNING:   func.classifier.weight
2022-10-31 22:27:42,610 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_2.pth.
2022-10-31 22:27:42,682 INFO: Obtain parameters for train
2022-10-31 22:27:42,688 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:27:42,688 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:27:42,688 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:27:42,688 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:27:42,688 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:27:42,688 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:27:42,688 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:27:42,688 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:27:42,689 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:27:42,690 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:27:42,691 INFO: Model [MTNBModel] is created.
2022-10-31 22:27:42,701 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:27:42,711 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:27:42,721 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:27:43,282 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.7103, Acc: 0.3867, ]
2022-10-31 22:27:44,009 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.7094, Acc: 0.4467, ]
2022-10-31 22:27:44,666 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.7026, Acc: 0.5400, ]
2022-10-31 22:27:45,320 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.7055, Acc: 0.4733, ]
2022-10-31 22:27:46,001 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.7088, Acc: 0.4467, ]
2022-10-31 22:27:46,698 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.7158, Acc: 0.4667, ]
2022-10-31 22:27:46,812 INFO: fine-tune procedure is finished!
2022-10-31 22:28:15,161 INFO: [Test_acc of task 3 on test 3: 0.29500][acc of former classes: 0.65450][acc of former samples in all classes: 0.56550]
[acc of novel samples in all classes: 0.11467]
2022-10-31 22:28:15,459 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:28:15,486 WARNING: Current net - loaded net:
2022-10-31 22:28:15,487 WARNING: Loaded net - current net:
2022-10-31 22:28:15,487 WARNING:   func.classifier.bias
2022-10-31 22:28:15,487 WARNING:   func.classifier.weight
2022-10-31 22:28:15,527 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_3.pth.
2022-10-31 22:28:15,601 INFO: Obtain parameters for train
2022-10-31 22:28:15,616 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:28:15,616 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:28:15,617 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:28:15,618 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:28:15,618 INFO: Model [MTNBModel] is created.
2022-10-31 22:28:15,629 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:15,639 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:15,649 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:15,659 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:28:16,301 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.8952, Acc: 0.4550, ]
2022-10-31 22:28:17,129 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.8923, Acc: 0.4250, ]
2022-10-31 22:28:17,907 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.8972, Acc: 0.4650, ]
2022-10-31 22:28:18,772 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9041, Acc: 0.3950, ]
2022-10-31 22:28:19,597 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9021, Acc: 0.3850, ]
2022-10-31 22:28:20,379 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.8994, Acc: 0.4050, ]
2022-10-31 22:28:20,481 INFO: fine-tune procedure is finished!
2022-10-31 22:28:50,079 INFO: [Test_acc of task 4 on test 3: 0.25100][acc of former classes: 0.65450][acc of former samples in all classes: 0.55750]
[acc of novel samples in all classes: 0.09775]
2022-10-31 22:28:50,367 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:28:50,396 WARNING: Current net - loaded net:
2022-10-31 22:28:50,396 WARNING: Loaded net - current net:
2022-10-31 22:28:50,396 WARNING:   func.classifier.bias
2022-10-31 22:28:50,396 WARNING:   func.classifier.weight
2022-10-31 22:28:50,415 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_4.pth.
2022-10-31 22:28:50,468 INFO: Obtain parameters for train
2022-10-31 22:28:50,471 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:28:50,471 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:28:50,472 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:28:50,473 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:28:50,473 INFO: Model [MTNBModel] is created.
2022-10-31 22:28:50,484 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:50,494 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:50,504 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:50,514 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:50,524 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:28:51,192 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0636, Acc: 0.4200, ]
2022-10-31 22:28:51,996 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0633, Acc: 0.4040, ]
2022-10-31 22:28:52,768 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0656, Acc: 0.3800, ]
2022-10-31 22:28:53,741 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0609, Acc: 0.3680, ]
2022-10-31 22:28:54,556 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0680, Acc: 0.3680, ]
2022-10-31 22:28:55,317 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0672, Acc: 0.3520, ]
2022-10-31 22:28:55,428 INFO: fine-tune procedure is finished!
2022-10-31 22:29:27,509 INFO: [Test_acc of task 5 on test 3: 0.21514][acc of former classes: 0.65450][acc of former samples in all classes: 0.55550]
[acc of novel samples in all classes: 0.07900]
2022-10-31 22:29:27,796 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:29:27,827 WARNING: Current net - loaded net:
2022-10-31 22:29:27,827 WARNING: Loaded net - current net:
2022-10-31 22:29:27,827 WARNING:   func.classifier.bias
2022-10-31 22:29:27,827 WARNING:   func.classifier.weight
2022-10-31 22:29:27,846 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_5.pth.
2022-10-31 22:29:27,894 INFO: Obtain parameters for train
2022-10-31 22:29:27,901 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:29:27,902 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:29:27,903 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:29:27,904 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:29:27,904 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:29:27,904 INFO: Model [MTNBModel] is created.
2022-10-31 22:29:27,915 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:27,925 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:27,935 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:27,945 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:27,955 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:27,964 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:29:28,702 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1986, Acc: 0.3333, ]
2022-10-31 22:29:29,557 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1952, Acc: 0.3967, ]
2022-10-31 22:29:30,352 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1966, Acc: 0.3167, ]
2022-10-31 22:29:31,245 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2002, Acc: 0.3733, ]
2022-10-31 22:29:32,101 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2023, Acc: 0.3267, ]
2022-10-31 22:29:32,918 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2024, Acc: 0.3533, ]
2022-10-31 22:29:33,018 INFO: fine-tune procedure is finished!
2022-10-31 22:30:09,808 INFO: [Test_acc of task 6 on test 3: 0.19550][acc of former classes: 0.65500][acc of former samples in all classes: 0.54850]
[acc of novel samples in all classes: 0.07783]
2022-10-31 22:30:10,088 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:30:10,117 WARNING: Current net - loaded net:
2022-10-31 22:30:10,117 WARNING: Loaded net - current net:
2022-10-31 22:30:10,117 WARNING:   func.classifier.bias
2022-10-31 22:30:10,117 WARNING:   func.classifier.weight
2022-10-31 22:30:10,135 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_6.pth.
2022-10-31 22:30:10,185 INFO: Obtain parameters for train
2022-10-31 22:30:10,187 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:30:10,188 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:30:10,189 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:30:10,190 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:30:10,190 INFO: Model [MTNBModel] is created.
2022-10-31 22:30:10,201 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:10,211 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:10,221 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:10,231 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:10,241 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:10,251 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:10,261 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:30:11,025 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3219, Acc: 0.3200, ]
2022-10-31 22:30:12,000 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3146, Acc: 0.3543, ]
2022-10-31 22:30:12,805 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3231, Acc: 0.3514, ]
2022-10-31 22:30:13,683 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3217, Acc: 0.3343, ]
2022-10-31 22:30:14,594 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3209, Acc: 0.3657, ]
2022-10-31 22:30:15,434 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3170, Acc: 0.3714, ]
2022-10-31 22:30:15,545 INFO: fine-tune procedure is finished!
2022-10-31 22:30:56,368 INFO: [Test_acc of task 7 on test 3: 0.17333][acc of former classes: 0.65500][acc of former samples in all classes: 0.54700]
[acc of novel samples in all classes: 0.06657]
2022-10-31 22:30:56,645 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:30:56,674 WARNING: Current net - loaded net:
2022-10-31 22:30:56,674 WARNING: Loaded net - current net:
2022-10-31 22:30:56,674 WARNING:   func.classifier.bias
2022-10-31 22:30:56,674 WARNING:   func.classifier.weight
2022-10-31 22:30:56,693 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_7.pth.
2022-10-31 22:30:56,744 INFO: Obtain parameters for train
2022-10-31 22:30:56,747 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:30:56,747 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:30:56,747 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:30:56,747 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:30:56,748 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:30:56,749 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:30:56,750 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:30:56,750 INFO: Model [MTNBModel] is created.
2022-10-31 22:30:56,761 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:56,771 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:56,781 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:56,791 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:56,801 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:56,811 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:56,821 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:30:56,831 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:30:58,548 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4261, Acc: 0.3075, ]
2022-10-31 22:30:59,405 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4250, Acc: 0.3600, ]
2022-10-31 22:31:00,299 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4266, Acc: 0.3225, ]
2022-10-31 22:31:01,220 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4271, Acc: 0.3075, ]
2022-10-31 22:31:02,101 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4245, Acc: 0.3250, ]
2022-10-31 22:31:02,984 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4302, Acc: 0.3175, ]
2022-10-31 22:31:03,091 INFO: fine-tune procedure is finished!
2022-10-31 22:31:48,469 INFO: [Test_acc of task 8 on test 3: 0.16030][acc of former classes: 0.65500][acc of former samples in all classes: 0.53900]
[acc of novel samples in all classes: 0.06563]
2022-10-31 22:31:48,752 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:31:48,782 WARNING: Current net - loaded net:
2022-10-31 22:31:48,782 WARNING: Loaded net - current net:
2022-10-31 22:31:48,782 WARNING:   func.classifier.bias
2022-10-31 22:31:48,782 WARNING:   func.classifier.weight
2022-10-31 22:31:48,804 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth.
2022-10-31 22:31:48,857 INFO: Obtain parameters for train
2022-10-31 22:31:48,864 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:31:48,864 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:31:48,864 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:31:48,864 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:31:48,864 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:31:48,865 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:31:48,866 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:31:48,867 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:31:48,867 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:31:48,867 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:31:48,867 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:31:48,867 INFO: Model [MTNBModel] is created.
2022-10-31 22:31:48,881 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:31:49,425 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.1846, Acc: 0.4400, ]
2022-10-31 22:31:50,030 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.1808, Acc: 0.4600, ]
2022-10-31 22:31:50,703 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.1763, Acc: 0.5200, ]
2022-10-31 22:31:51,345 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.1783, Acc: 0.6000, ]
2022-10-31 22:31:51,987 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.1747, Acc: 0.4400, ]
2022-10-31 22:31:52,600 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.1738, Acc: 0.5800, ]
2022-10-31 22:31:52,721 INFO: fine-tune procedure is finished!
2022-10-31 22:32:07,342 INFO: [Test_acc of task 1 on test 4: 0.45400][acc of former classes: 0.65450][acc of former samples in all classes: 0.61150]
[acc of novel samples in all classes: 0.13900]
2022-10-31 22:32:07,644 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:32:07,673 WARNING: Current net - loaded net:
2022-10-31 22:32:07,673 WARNING: Loaded net - current net:
2022-10-31 22:32:07,673 WARNING:   func.classifier.bias
2022-10-31 22:32:07,673 WARNING:   func.classifier.weight
2022-10-31 22:32:07,692 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_1.pth.
2022-10-31 22:32:07,747 INFO: Obtain parameters for train
2022-10-31 22:32:07,751 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:32:07,751 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:32:07,752 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:32:07,753 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:32:07,754 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:32:07,754 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:32:07,754 INFO: Model [MTNBModel] is created.
2022-10-31 22:32:07,767 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:32:07,777 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:32:08,356 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.4694, Acc: 0.4900, ]
2022-10-31 22:32:08,991 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.4770, Acc: 0.4800, ]
2022-10-31 22:32:09,692 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.4805, Acc: 0.4100, ]
2022-10-31 22:32:10,333 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.4756, Acc: 0.4700, ]
2022-10-31 22:32:11,085 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.4756, Acc: 0.4000, ]
2022-10-31 22:32:11,800 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.4757, Acc: 0.4900, ]
2022-10-31 22:32:11,899 INFO: fine-tune procedure is finished!
2022-10-31 22:32:30,947 INFO: [Test_acc of task 2 on test 4: 0.35650][acc of former classes: 0.65450][acc of former samples in all classes: 0.58250]
[acc of novel samples in all classes: 0.13050]
2022-10-31 22:32:31,233 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:32:31,262 WARNING: Current net - loaded net:
2022-10-31 22:32:31,262 WARNING: Loaded net - current net:
2022-10-31 22:32:31,262 WARNING:   func.classifier.bias
2022-10-31 22:32:31,262 WARNING:   func.classifier.weight
2022-10-31 22:32:31,281 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_2.pth.
2022-10-31 22:32:31,332 INFO: Obtain parameters for train
2022-10-31 22:32:31,335 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:32:31,336 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:31,337 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:31,338 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:32:31,338 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:32:31,338 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:32:31,338 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:32:31,338 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:32:31,338 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:32:31,338 INFO: Model [MTNBModel] is created.
2022-10-31 22:32:31,349 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:32:31,359 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:32:31,369 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:32:32,025 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.7126, Acc: 0.4400, ]
2022-10-31 22:32:32,772 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.7163, Acc: 0.4467, ]
2022-10-31 22:32:33,540 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.7189, Acc: 0.3933, ]
2022-10-31 22:32:34,207 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.7092, Acc: 0.4467, ]
2022-10-31 22:32:34,923 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.7027, Acc: 0.4000, ]
2022-10-31 22:32:35,632 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.7095, Acc: 0.3933, ]
2022-10-31 22:32:35,740 INFO: fine-tune procedure is finished!
2022-10-31 22:32:59,072 INFO: [Test_acc of task 3 on test 4: 0.28920][acc of former classes: 0.65450][acc of former samples in all classes: 0.56500]
[acc of novel samples in all classes: 0.10533]
2022-10-31 22:32:59,363 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:32:59,391 WARNING: Current net - loaded net:
2022-10-31 22:32:59,391 WARNING: Loaded net - current net:
2022-10-31 22:32:59,391 WARNING:   func.classifier.bias
2022-10-31 22:32:59,391 WARNING:   func.classifier.weight
2022-10-31 22:32:59,410 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_3.pth.
2022-10-31 22:32:59,462 INFO: Obtain parameters for train
2022-10-31 22:32:59,467 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:32:59,467 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:32:59,467 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:32:59,467 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:32:59,467 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:32:59,467 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:32:59,467 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:32:59,468 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:32:59,469 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:32:59,470 INFO: Model [MTNBModel] is created.
2022-10-31 22:32:59,480 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:32:59,490 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:32:59,500 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:32:59,510 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:33:00,134 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 3.9086, Acc: 0.4050, ]
2022-10-31 22:33:00,904 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 3.9112, Acc: 0.3750, ]
2022-10-31 22:33:01,643 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 3.9102, Acc: 0.3450, ]
2022-10-31 22:33:02,353 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 3.9102, Acc: 0.4200, ]
2022-10-31 22:33:03,083 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 3.9028, Acc: 0.4150, ]
2022-10-31 22:33:03,826 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 3.9029, Acc: 0.4250, ]
2022-10-31 22:33:03,983 INFO: fine-tune procedure is finished!
2022-10-31 22:33:32,111 INFO: [Test_acc of task 4 on test 4: 0.24467][acc of former classes: 0.65450][acc of former samples in all classes: 0.55250]
[acc of novel samples in all classes: 0.09075]
2022-10-31 22:33:32,407 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:33:32,438 WARNING: Current net - loaded net:
2022-10-31 22:33:32,439 WARNING: Loaded net - current net:
2022-10-31 22:33:32,439 WARNING:   func.classifier.bias
2022-10-31 22:33:32,439 WARNING:   func.classifier.weight
2022-10-31 22:33:32,459 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_4.pth.
2022-10-31 22:33:32,511 INFO: Obtain parameters for train
2022-10-31 22:33:32,514 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:33:32,514 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:33:32,515 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:33:32,516 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:33:32,516 INFO: Model [MTNBModel] is created.
2022-10-31 22:33:32,527 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:32,537 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:32,547 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:32,557 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:32,567 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:33:33,333 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0695, Acc: 0.3600, ]
2022-10-31 22:33:34,181 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0634, Acc: 0.3400, ]
2022-10-31 22:33:34,963 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0710, Acc: 0.3240, ]
2022-10-31 22:33:35,795 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0711, Acc: 0.3640, ]
2022-10-31 22:33:36,571 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0604, Acc: 0.3880, ]
2022-10-31 22:33:37,377 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0660, Acc: 0.3240, ]
2022-10-31 22:33:37,523 INFO: fine-tune procedure is finished!
2022-10-31 22:34:09,546 INFO: [Test_acc of task 5 on test 4: 0.20943][acc of former classes: 0.65450][acc of former samples in all classes: 0.54500]
[acc of novel samples in all classes: 0.07520]
2022-10-31 22:34:09,825 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:34:09,853 WARNING: Current net - loaded net:
2022-10-31 22:34:09,853 WARNING: Loaded net - current net:
2022-10-31 22:34:09,853 WARNING:   func.classifier.bias
2022-10-31 22:34:09,853 WARNING:   func.classifier.weight
2022-10-31 22:34:09,872 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_5.pth.
2022-10-31 22:34:09,922 INFO: Obtain parameters for train
2022-10-31 22:34:09,933 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:34:09,933 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:34:09,934 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:34:09,935 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:34:09,935 INFO: Model [MTNBModel] is created.
2022-10-31 22:34:09,946 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:09,956 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:09,966 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:09,976 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:09,986 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:09,996 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:34:10,709 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1972, Acc: 0.3567, ]
2022-10-31 22:34:11,469 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2015, Acc: 0.3633, ]
2022-10-31 22:34:12,294 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1977, Acc: 0.3467, ]
2022-10-31 22:34:13,275 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2060, Acc: 0.3467, ]
2022-10-31 22:34:14,057 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1980, Acc: 0.3900, ]
2022-10-31 22:34:14,746 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1966, Acc: 0.3567, ]
2022-10-31 22:34:14,821 INFO: fine-tune procedure is finished!
2022-10-31 22:34:51,634 INFO: [Test_acc of task 6 on test 4: 0.18750][acc of former classes: 0.65500][acc of former samples in all classes: 0.53700]
[acc of novel samples in all classes: 0.07100]
2022-10-31 22:34:51,921 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:34:51,948 WARNING: Current net - loaded net:
2022-10-31 22:34:51,948 WARNING: Loaded net - current net:
2022-10-31 22:34:51,948 WARNING:   func.classifier.bias
2022-10-31 22:34:51,948 WARNING:   func.classifier.weight
2022-10-31 22:34:51,968 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_6.pth.
2022-10-31 22:34:52,019 INFO: Obtain parameters for train
2022-10-31 22:34:52,021 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:34:52,021 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:34:52,022 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:34:52,023 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:34:52,024 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:34:52,024 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:34:52,024 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:34:52,024 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:34:52,024 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:34:52,024 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:34:52,024 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:34:52,024 INFO: Model [MTNBModel] is created.
2022-10-31 22:34:52,035 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:52,045 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:52,055 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:52,065 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:52,075 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:52,086 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:34:52,096 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:34:52,795 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3255, Acc: 0.3286, ]
2022-10-31 22:34:53,630 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3165, Acc: 0.3000, ]
2022-10-31 22:34:54,519 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3195, Acc: 0.3629, ]
2022-10-31 22:34:55,389 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3166, Acc: 0.3257, ]
2022-10-31 22:34:56,404 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3182, Acc: 0.3657, ]
2022-10-31 22:34:57,350 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3205, Acc: 0.3286, ]
2022-10-31 22:34:57,522 INFO: fine-tune procedure is finished!
2022-10-31 22:35:38,550 INFO: [Test_acc of task 7 on test 4: 0.16933][acc of former classes: 0.65500][acc of former samples in all classes: 0.53200]
[acc of novel samples in all classes: 0.06571]
2022-10-31 22:35:38,833 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:35:38,862 WARNING: Current net - loaded net:
2022-10-31 22:35:38,863 WARNING: Loaded net - current net:
2022-10-31 22:35:38,863 WARNING:   func.classifier.bias
2022-10-31 22:35:38,863 WARNING:   func.classifier.weight
2022-10-31 22:35:38,882 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_7.pth.
2022-10-31 22:35:38,936 INFO: Obtain parameters for train
2022-10-31 22:35:38,939 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:35:38,939 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:35:38,940 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-31 22:35:38,941 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-31 22:35:38,942 INFO: Model [MTNBModel] is created.
2022-10-31 22:35:38,952 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:35:38,963 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:35:38,973 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:35:38,983 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:35:38,993 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:35:39,003 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:35:39,013 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:35:39,023 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/CFRModel_res18_miniImageNet_small_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:35:39,905 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4192, Acc: 0.3550, ]
2022-10-31 22:35:40,835 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4192, Acc: 0.3125, ]
2022-10-31 22:35:41,813 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4185, Acc: 0.3200, ]
2022-10-31 22:35:42,647 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4225, Acc: 0.3275, ]
2022-10-31 22:35:43,594 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4242, Acc: 0.3275, ]
2022-10-31 22:35:44,731 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4240, Acc: 0.3275, ]
2022-10-31 22:35:44,842 INFO: fine-tune procedure is finished!
2022-10-31 22:36:30,264 INFO: [Test_acc of task 8 on test 4: 0.15700][acc of former classes: 0.65500][acc of former samples in all classes: 0.52600]
[acc of novel samples in all classes: 0.06475]
2022-10-31 22:36:30,376 INFO: --------------------------Final Avg Acc-------------------------
2022-10-31 22:36:30,376 INFO: Session 1: 65.45+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.6545]
2022-10-31 22:36:30,376 INFO: Session 2: 45.70+-0.55[acc of former classes: 0.6545][acc of former samples in all classes: 0.6113]
[acc of novel samples in all classes: 0.1484]
2022-10-31 22:36:30,376 INFO: Session 3: 36.15+-0.34[acc of former classes: 0.6545][acc of former samples in all classes: 0.5825]
[acc of novel samples in all classes: 0.1405]
2022-10-31 22:36:30,377 INFO: Session 4: 29.19+-0.20[acc of former classes: 0.6545][acc of former samples in all classes: 0.5704]
[acc of novel samples in all classes: 0.1062]
2022-10-31 22:36:30,377 INFO: Session 5: 24.73+-0.19[acc of former classes: 0.6545][acc of former samples in all classes: 0.5617]
[acc of novel samples in all classes: 0.0901]
2022-10-31 22:36:30,377 INFO: Session 6: 21.29+-0.23[acc of former classes: 0.6545][acc of former samples in all classes: 0.5562]
[acc of novel samples in all classes: 0.0756]
2022-10-31 22:36:30,377 INFO: Session 7: 19.18+-0.25[acc of former classes: 0.6550][acc of former samples in all classes: 0.5505]
[acc of novel samples in all classes: 0.0722]
2022-10-31 22:36:30,377 INFO: Session 8: 17.18+-0.12[acc of former classes: 0.6550][acc of former samples in all classes: 0.5445]
[acc of novel samples in all classes: 0.0653]
2022-10-31 22:36:30,377 INFO: Session 9: 15.91+-0.12[acc of former classes: 0.6550][acc of former samples in all classes: 0.5361]
[acc of novel samples in all classes: 0.0649]
2022-10-31 22:36:30,377 INFO: random seed: 1997
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Novel classes: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_20bases/models/test4_session_8.pth
finish!!
