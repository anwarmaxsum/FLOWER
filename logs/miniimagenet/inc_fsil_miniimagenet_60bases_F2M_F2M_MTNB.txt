Path already exists. Rename it to /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug_archived_20221028_063637
2022-10-28 06:36:37,357 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-10-28 06:36:37,357 INFO: 
  name: MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug
  model_type: MTNBModel
  gpu: 1
  manual_seed: 1997
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  datasets:[
    train:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/train
      aug: True
      num_worker_per_gpu: 8
      batch_size_base_classes: None
      pin_memory: True
      pre_load: False
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    val:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      num_worker_per_gpu: 8
      pin_memory: True
      pre_load: False
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    test:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      num_worker_per_gpu: 8
      pin_memory: True
      pre_load: False
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
  ]
  network_g:[
    type: Resnet18_softmax
    Embed_dim: 512
    pretrained: False
    norm: False
    num_classes: 60
    adopt_classifier: False
    addition_net: False
    flatten: True
    cut_at_pooling: False
  ]
  path:[
    pretrain_model_g: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
    pretrain_prototypes: None
    base_model: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug
    training_states: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/training_states
    log: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug
    models: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.02
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [10]
      gamma: 1e-06
    ]
    random_noise:[
      distribution:[
        type: DiscreteBeta
      ]
      type: suffix_conv_weight
      num_layers: 4
      low: 0.1
      high: 5.0
      reduction_factor: 4
      bound_value: 0.01
      random_times: 4
    ]
    max_steps: 1
    ratio: 1
    fine_tune: True
    incremental: True
    fine_tune_epoch: 6
    warmup_iter: -1
    bases: 60
    tasks: 9
    novel_exemplars: 5
    shots: 5
    num_test: 5
    test_id: 1
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
  ]
  val:[
    val_freq: 100
    test_type: NCM
    use_all_bases: False
  ]
  logger:[
    print_freq: 1
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-miniImageNet-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-10-28 06:36:37,358 INFO: Random seed: 1997
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:181: UserWarning: nn.init.kaiming_normal is now deprecated in favor of nn.init.kaiming_normal_.
  init.kaiming_normal(m.weight, mode='fan_out')
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:188: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  init.normal(m.weight, std=0.001)
2022-10-28 06:36:39,445 INFO: Network: Resnet18_softmax, with parameters: 11,689,512
2022-10-28 06:36:39,445 INFO: Resnet18_softmax(
  (func): ResNet_pytorch(
    (base): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=1000, bias=True)
    )
  )
)
2022-10-28 06:36:39,446 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:36:39,483 WARNING: Current net - loaded net:
2022-10-28 06:36:39,483 WARNING: Loaded net - current net:
2022-10-28 06:36:39,483 WARNING:   func.classifier.bias
2022-10-28 06:36:39,483 WARNING:   func.classifier.weight
2022-10-28 06:36:39,507 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:36:39,544 WARNING: Current net - loaded net:
2022-10-28 06:36:39,544 WARNING: Loaded net - current net:
2022-10-28 06:36:39,544 WARNING:   func.classifier.bias
2022-10-28 06:36:39,544 WARNING:   func.classifier.weight
2022-10-28 06:36:39,567 INFO: Obtain parameters for train
2022-10-28 06:36:39,573 INFO: Model [MTNBModel] is created.
2022-10-28 06:37:19,129 INFO: [Test_acc of task 0 on test 0: 0.66067][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.66067]
2022-10-28 06:37:19,376 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:37:19,404 WARNING: Current net - loaded net:
2022-10-28 06:37:19,405 WARNING: Loaded net - current net:
2022-10-28 06:37:19,405 WARNING:   func.classifier.bias
2022-10-28 06:37:19,405 WARNING:   func.classifier.weight
2022-10-28 06:37:19,422 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth.
2022-10-28 06:37:19,472 INFO: Obtain parameters for train
2022-10-28 06:37:19,477 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:37:19,477 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:37:19,478 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:37:19,479 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:37:19,479 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:37:19,479 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:37:19,479 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:37:19,479 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:37:19,479 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:37:19,479 INFO: Model [MTNBModel] is created.
2022-10-28 06:37:19,486 INFO: Dataset NormalDataset - miniImageNet is created.
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
>>> Test >>>
Former classes: []
Novel classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-28 06:37:20,093 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0085, Acc: 0.6000, ]
2022-10-28 06:37:20,606 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0030, Acc: 0.7200, ]
2022-10-28 06:37:21,316 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0032, Acc: 0.6800, ]
2022-10-28 06:37:21,930 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0096, Acc: 0.6000, ]
2022-10-28 06:37:22,523 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0122, Acc: 0.6000, ]
2022-10-28 06:37:23,219 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0084, Acc: 0.7600, ]
2022-10-28 06:37:23,327 INFO: fine-tune procedure is finished!
2022-10-28 06:38:03,026 INFO: [Test_acc of task 1 on test 0: 0.60892][acc of former classes: 0.66067][acc of former samples in all classes: 0.64733]
[acc of novel samples in all classes: 0.14800]
2022-10-28 06:38:03,318 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:38:03,351 WARNING: Current net - loaded net:
2022-10-28 06:38:03,352 WARNING: Loaded net - current net:
2022-10-28 06:38:03,352 WARNING:   func.classifier.bias
2022-10-28 06:38:03,352 WARNING:   func.classifier.weight
2022-10-28 06:38:03,372 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_1.pth.
2022-10-28 06:38:03,426 INFO: Obtain parameters for train
2022-10-28 06:38:03,436 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:38:03,437 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:38:03,438 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:38:03,439 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:38:03,439 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:38:03,439 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:38:03,439 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:38:03,439 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:38:03,439 INFO: Model [MTNBModel] is created.
2022-10-28 06:38:03,445 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:38:03,450 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-28 06:38:03,930 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0787, Acc: 0.7600, ]
2022-10-28 06:38:04,573 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0804, Acc: 0.6800, ]
2022-10-28 06:38:05,094 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0776, Acc: 0.7800, ]
2022-10-28 06:38:05,652 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0848, Acc: 0.6800, ]
2022-10-28 06:38:06,282 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0806, Acc: 0.6800, ]
2022-10-28 06:38:06,937 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0802, Acc: 0.6400, ]
2022-10-28 06:38:07,051 INFO: fine-tune procedure is finished!
2022-10-28 06:38:49,068 INFO: [Test_acc of task 2 on test 0: 0.56614][acc of former classes: 0.66067][acc of former samples in all classes: 0.63867]
[acc of novel samples in all classes: 0.13100]
2022-10-28 06:38:49,345 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:38:49,375 WARNING: Current net - loaded net:
2022-10-28 06:38:49,375 WARNING: Loaded net - current net:
2022-10-28 06:38:49,375 WARNING:   func.classifier.bias
2022-10-28 06:38:49,375 WARNING:   func.classifier.weight
2022-10-28 06:38:49,393 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_2.pth.
2022-10-28 06:38:49,448 INFO: Obtain parameters for train
2022-10-28 06:38:49,450 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:38:49,450 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:38:49,451 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:38:49,452 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:38:49,453 INFO: Model [MTNBModel] is created.
2022-10-28 06:38:49,459 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:38:49,464 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:38:49,470 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-28 06:38:49,944 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1538, Acc: 0.5867, ]
2022-10-28 06:38:50,572 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1512, Acc: 0.6800, ]
2022-10-28 06:38:51,302 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1495, Acc: 0.7200, ]
2022-10-28 06:38:52,056 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1479, Acc: 0.7600, ]
2022-10-28 06:38:52,720 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1538, Acc: 0.6800, ]
2022-10-28 06:38:53,408 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1509, Acc: 0.7200, ]
2022-10-28 06:38:53,496 INFO: fine-tune procedure is finished!
2022-10-28 06:39:37,678 INFO: [Test_acc of task 3 on test 0: 0.53613][acc of former classes: 0.66067][acc of former samples in all classes: 0.63350]
[acc of novel samples in all classes: 0.14667]
2022-10-28 06:39:37,947 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:39:37,975 WARNING: Current net - loaded net:
2022-10-28 06:39:37,975 WARNING: Loaded net - current net:
2022-10-28 06:39:37,975 WARNING:   func.classifier.bias
2022-10-28 06:39:37,975 WARNING:   func.classifier.weight
2022-10-28 06:39:37,993 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_3.pth.
2022-10-28 06:39:38,045 INFO: Obtain parameters for train
2022-10-28 06:39:38,048 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:39:38,048 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:39:38,049 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:39:38,050 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:39:38,050 INFO: Model [MTNBModel] is created.
2022-10-28 06:39:38,057 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:39:38,062 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:39:38,068 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:39:38,073 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-28 06:39:38,553 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2178, Acc: 0.6700, ]
2022-10-28 06:39:39,100 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2131, Acc: 0.6600, ]
2022-10-28 06:39:39,639 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2146, Acc: 0.6500, ]
2022-10-28 06:39:40,227 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2140, Acc: 0.7200, ]
2022-10-28 06:39:40,818 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2161, Acc: 0.6100, ]
2022-10-28 06:39:41,446 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2129, Acc: 0.7100, ]
2022-10-28 06:39:41,536 INFO: fine-tune procedure is finished!
2022-10-28 06:40:27,592 INFO: [Test_acc of task 4 on test 0: 0.50650][acc of former classes: 0.66067][acc of former samples in all classes: 0.62667]
[acc of novel samples in all classes: 0.14600]
2022-10-28 06:40:27,866 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:40:27,994 WARNING: Current net - loaded net:
2022-10-28 06:40:27,994 WARNING: Loaded net - current net:
2022-10-28 06:40:27,994 WARNING:   func.classifier.bias
2022-10-28 06:40:27,994 WARNING:   func.classifier.weight
2022-10-28 06:40:28,012 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_4.pth.
2022-10-28 06:40:28,067 INFO: Obtain parameters for train
2022-10-28 06:40:28,070 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:40:28,070 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:40:28,071 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:40:28,072 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:40:28,072 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:40:28,072 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:40:28,072 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:40:28,072 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:40:28,072 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:40:28,072 INFO: Model [MTNBModel] is created.
2022-10-28 06:40:28,078 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:40:28,085 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:40:28,091 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:40:28,097 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:40:28,104 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-28 06:40:28,588 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2707, Acc: 0.6960, ]
2022-10-28 06:40:29,189 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2710, Acc: 0.6560, ]
2022-10-28 06:40:29,747 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2748, Acc: 0.7120, ]
2022-10-28 06:40:30,319 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2721, Acc: 0.6960, ]
2022-10-28 06:40:30,890 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2716, Acc: 0.6640, ]
2022-10-28 06:40:31,490 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2719, Acc: 0.6560, ]
2022-10-28 06:40:31,578 INFO: fine-tune procedure is finished!
2022-10-28 06:41:20,190 INFO: [Test_acc of task 5 on test 0: 0.48059][acc of former classes: 0.66067][acc of former samples in all classes: 0.62000]
[acc of novel samples in all classes: 0.14600]
2022-10-28 06:41:20,458 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:41:20,485 WARNING: Current net - loaded net:
2022-10-28 06:41:20,485 WARNING: Loaded net - current net:
2022-10-28 06:41:20,485 WARNING:   func.classifier.bias
2022-10-28 06:41:20,485 WARNING:   func.classifier.weight
2022-10-28 06:41:20,504 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_5.pth.
2022-10-28 06:41:20,556 INFO: Obtain parameters for train
2022-10-28 06:41:20,558 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:41:20,559 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:41:20,560 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:41:20,561 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:41:20,561 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:41:20,561 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:41:20,561 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:41:20,561 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:41:20,561 INFO: Model [MTNBModel] is created.
2022-10-28 06:41:20,567 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:41:20,572 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:41:20,578 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:41:20,583 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:41:20,589 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:41:20,594 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-28 06:41:21,308 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3389, Acc: 0.6733, ]
2022-10-28 06:41:21,915 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3352, Acc: 0.6200, ]
2022-10-28 06:41:22,489 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3334, Acc: 0.6667, ]
2022-10-28 06:41:23,074 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3340, Acc: 0.7267, ]
2022-10-28 06:41:23,681 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3329, Acc: 0.7133, ]
2022-10-28 06:41:24,506 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3372, Acc: 0.6533, ]
2022-10-28 06:41:24,597 INFO: fine-tune procedure is finished!
2022-10-28 06:42:14,945 INFO: [Test_acc of task 6 on test 0: 0.45933][acc of former classes: 0.66067][acc of former samples in all classes: 0.61550]
[acc of novel samples in all classes: 0.14700]
2022-10-28 06:42:15,214 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:42:15,241 WARNING: Current net - loaded net:
2022-10-28 06:42:15,241 WARNING: Loaded net - current net:
2022-10-28 06:42:15,241 WARNING:   func.classifier.bias
2022-10-28 06:42:15,241 WARNING:   func.classifier.weight
2022-10-28 06:42:15,257 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_6.pth.
2022-10-28 06:42:15,298 INFO: Obtain parameters for train
2022-10-28 06:42:15,301 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:42:15,301 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:42:15,302 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:42:15,303 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:42:15,303 INFO: Model [MTNBModel] is created.
2022-10-28 06:42:15,310 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:42:15,315 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:42:15,320 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:42:15,326 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:42:15,331 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:42:15,337 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:42:15,342 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-28 06:42:15,899 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3874, Acc: 0.6971, ]
2022-10-28 06:42:16,534 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3837, Acc: 0.6629, ]
2022-10-28 06:42:17,146 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3865, Acc: 0.6514, ]
2022-10-28 06:42:17,812 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3869, Acc: 0.6629, ]
2022-10-28 06:42:18,614 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3842, Acc: 0.6629, ]
2022-10-28 06:42:19,481 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3904, Acc: 0.6914, ]
2022-10-28 06:42:19,568 INFO: fine-tune procedure is finished!
2022-10-28 06:43:11,882 INFO: [Test_acc of task 7 on test 0: 0.44116][acc of former classes: 0.66067][acc of former samples in all classes: 0.61050]
[acc of novel samples in all classes: 0.15086]
2022-10-28 06:43:12,152 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:43:12,181 WARNING: Current net - loaded net:
2022-10-28 06:43:12,182 WARNING: Loaded net - current net:
2022-10-28 06:43:12,182 WARNING:   func.classifier.bias
2022-10-28 06:43:12,182 WARNING:   func.classifier.weight
2022-10-28 06:43:12,200 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_7.pth.
2022-10-28 06:43:12,247 INFO: Obtain parameters for train
2022-10-28 06:43:12,250 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:43:12,250 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:43:12,251 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:43:12,252 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:43:12,253 INFO: Model [MTNBModel] is created.
2022-10-28 06:43:12,259 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:43:12,264 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:43:12,270 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:43:12,275 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:43:12,280 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:43:12,286 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:43:12,291 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:43:12,296 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-28 06:43:13,848 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4359, Acc: 0.6550, ]
2022-10-28 06:43:14,630 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4340, Acc: 0.7000, ]
2022-10-28 06:43:15,250 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4358, Acc: 0.7050, ]
2022-10-28 06:43:15,917 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4396, Acc: 0.7100, ]
2022-10-28 06:43:16,538 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4364, Acc: 0.6700, ]
2022-10-28 06:43:17,281 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4381, Acc: 0.6750, ]
2022-10-28 06:43:17,362 INFO: fine-tune procedure is finished!
2022-10-28 06:44:11,850 INFO: [Test_acc of task 8 on test 0: 0.42610][acc of former classes: 0.66067][acc of former samples in all classes: 0.60500]
[acc of novel samples in all classes: 0.15775]
2022-10-28 06:44:12,115 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:44:12,142 WARNING: Current net - loaded net:
2022-10-28 06:44:12,142 WARNING: Loaded net - current net:
2022-10-28 06:44:12,142 WARNING:   func.classifier.bias
2022-10-28 06:44:12,142 WARNING:   func.classifier.weight
2022-10-28 06:44:12,159 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth.
2022-10-28 06:44:12,199 INFO: Obtain parameters for train
2022-10-28 06:44:12,202 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:44:12,202 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:44:12,203 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:44:12,204 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:44:12,204 INFO: Model [MTNBModel] is created.
2022-10-28 06:44:12,211 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-28 06:44:12,629 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0136, Acc: 0.6800, ]
2022-10-28 06:44:13,314 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0141, Acc: 0.5600, ]
2022-10-28 06:44:13,955 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0150, Acc: 0.6000, ]
2022-10-28 06:44:14,532 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0097, Acc: 0.7600, ]
2022-10-28 06:44:15,139 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0125, Acc: 0.7200, ]
2022-10-28 06:44:15,671 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0127, Acc: 0.6400, ]
2022-10-28 06:44:15,755 INFO: fine-tune procedure is finished!
2022-10-28 06:44:55,396 INFO: [Test_acc of task 1 on test 1: 0.61231][acc of former classes: 0.66067][acc of former samples in all classes: 0.64883]
[acc of novel samples in all classes: 0.17400]
2022-10-28 06:44:55,683 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:44:55,711 WARNING: Current net - loaded net:
2022-10-28 06:44:55,711 WARNING: Loaded net - current net:
2022-10-28 06:44:55,711 WARNING:   func.classifier.bias
2022-10-28 06:44:55,711 WARNING:   func.classifier.weight
2022-10-28 06:44:55,729 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_1.pth.
2022-10-28 06:44:55,779 INFO: Obtain parameters for train
2022-10-28 06:44:55,782 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:44:55,782 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:44:55,783 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:44:55,784 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:44:55,784 INFO: Model [MTNBModel] is created.
2022-10-28 06:44:55,791 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:44:55,796 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-28 06:44:56,255 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0852, Acc: 0.5800, ]
2022-10-28 06:44:56,782 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0826, Acc: 0.6600, ]
2022-10-28 06:44:57,425 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0800, Acc: 0.7000, ]
2022-10-28 06:44:58,005 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0830, Acc: 0.6600, ]
2022-10-28 06:44:58,530 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0864, Acc: 0.5800, ]
2022-10-28 06:44:59,057 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0808, Acc: 0.7600, ]
2022-10-28 06:44:59,173 INFO: fine-tune procedure is finished!
2022-10-28 06:45:40,566 INFO: [Test_acc of task 2 on test 1: 0.56657][acc of former classes: 0.66067][acc of former samples in all classes: 0.63883]
[acc of novel samples in all classes: 0.13300]
2022-10-28 06:45:40,849 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:45:40,875 WARNING: Current net - loaded net:
2022-10-28 06:45:40,875 WARNING: Loaded net - current net:
2022-10-28 06:45:40,875 WARNING:   func.classifier.bias
2022-10-28 06:45:40,875 WARNING:   func.classifier.weight
2022-10-28 06:45:40,893 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_2.pth.
2022-10-28 06:45:40,943 INFO: Obtain parameters for train
2022-10-28 06:45:40,945 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:45:40,945 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:45:40,946 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:45:40,947 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:45:40,948 INFO: Model [MTNBModel] is created.
2022-10-28 06:45:40,954 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:45:40,959 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:45:40,965 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-28 06:45:41,441 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1536, Acc: 0.7067, ]
2022-10-28 06:45:41,984 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1552, Acc: 0.6533, ]
2022-10-28 06:45:42,774 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1525, Acc: 0.6533, ]
2022-10-28 06:45:43,462 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1546, Acc: 0.6800, ]
2022-10-28 06:45:44,139 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1505, Acc: 0.6800, ]
2022-10-28 06:45:44,779 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1565, Acc: 0.6667, ]
2022-10-28 06:45:44,901 INFO: fine-tune procedure is finished!
2022-10-28 06:46:28,989 INFO: [Test_acc of task 3 on test 1: 0.53173][acc of former classes: 0.66067][acc of former samples in all classes: 0.63117]
[acc of novel samples in all classes: 0.13400]
2022-10-28 06:46:29,263 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:46:29,292 WARNING: Current net - loaded net:
2022-10-28 06:46:29,292 WARNING: Loaded net - current net:
2022-10-28 06:46:29,292 WARNING:   func.classifier.bias
2022-10-28 06:46:29,292 WARNING:   func.classifier.weight
2022-10-28 06:46:29,311 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_3.pth.
2022-10-28 06:46:29,359 INFO: Obtain parameters for train
2022-10-28 06:46:29,362 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:46:29,362 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:46:29,362 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:46:29,363 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:46:29,364 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:46:29,365 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:46:29,365 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:46:29,365 INFO: Model [MTNBModel] is created.
2022-10-28 06:46:29,371 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:46:29,376 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:46:29,382 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:46:29,387 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-28 06:46:29,848 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2154, Acc: 0.6600, ]
2022-10-28 06:46:30,605 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2167, Acc: 0.6500, ]
2022-10-28 06:46:31,349 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2155, Acc: 0.6900, ]
2022-10-28 06:46:31,952 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2201, Acc: 0.6700, ]
2022-10-28 06:46:32,490 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2156, Acc: 0.6200, ]
2022-10-28 06:46:33,076 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2162, Acc: 0.6600, ]
2022-10-28 06:46:33,172 INFO: fine-tune procedure is finished!
2022-10-28 06:47:18,782 INFO: [Test_acc of task 4 on test 1: 0.50738][acc of former classes: 0.66067][acc of former samples in all classes: 0.62450]
[acc of novel samples in all classes: 0.15600]
2022-10-28 06:47:19,060 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:47:19,088 WARNING: Current net - loaded net:
2022-10-28 06:47:19,088 WARNING: Loaded net - current net:
2022-10-28 06:47:19,088 WARNING:   func.classifier.bias
2022-10-28 06:47:19,088 WARNING:   func.classifier.weight
2022-10-28 06:47:19,106 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_4.pth.
2022-10-28 06:47:19,156 INFO: Obtain parameters for train
2022-10-28 06:47:19,158 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:47:19,158 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:47:19,159 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:47:19,160 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:47:19,161 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:47:19,161 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:47:19,161 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:47:19,161 INFO: Model [MTNBModel] is created.
2022-10-28 06:47:19,168 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:47:19,173 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:47:19,179 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:47:19,184 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:47:19,190 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-28 06:47:19,669 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2758, Acc: 0.7040, ]
2022-10-28 06:47:20,350 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2761, Acc: 0.7040, ]
2022-10-28 06:47:21,063 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2786, Acc: 0.6720, ]
2022-10-28 06:47:21,719 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2801, Acc: 0.6560, ]
2022-10-28 06:47:22,272 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2770, Acc: 0.6560, ]
2022-10-28 06:47:22,850 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2786, Acc: 0.6880, ]
2022-10-28 06:47:22,951 INFO: fine-tune procedure is finished!
2022-10-28 06:48:10,969 INFO: [Test_acc of task 5 on test 1: 0.48271][acc of former classes: 0.66067][acc of former samples in all classes: 0.61750]
[acc of novel samples in all classes: 0.15920]
2022-10-28 06:48:11,364 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:48:11,408 WARNING: Current net - loaded net:
2022-10-28 06:48:11,409 WARNING: Loaded net - current net:
2022-10-28 06:48:11,409 WARNING:   func.classifier.bias
2022-10-28 06:48:11,409 WARNING:   func.classifier.weight
2022-10-28 06:48:11,444 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_5.pth.
2022-10-28 06:48:11,499 INFO: Obtain parameters for train
2022-10-28 06:48:11,516 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:48:11,516 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:48:11,517 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:48:11,518 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:48:11,520 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:48:11,522 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:48:11,524 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:48:11,524 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:48:11,524 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:48:11,524 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:48:11,526 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:48:11,526 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:48:11,526 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:48:11,526 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:48:11,526 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:48:11,526 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:48:11,526 INFO: Model [MTNBModel] is created.
2022-10-28 06:48:11,533 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:48:11,539 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:48:11,545 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:48:11,551 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:48:11,557 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:48:11,563 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-28 06:48:12,121 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3308, Acc: 0.7067, ]
2022-10-28 06:48:12,902 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3384, Acc: 0.6600, ]
2022-10-28 06:48:13,691 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3356, Acc: 0.6200, ]
2022-10-28 06:48:14,355 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3353, Acc: 0.6800, ]
2022-10-28 06:48:15,148 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3387, Acc: 0.6667, ]
2022-10-28 06:48:15,940 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3368, Acc: 0.7200, ]
2022-10-28 06:48:16,065 INFO: fine-tune procedure is finished!
2022-10-28 06:49:06,482 INFO: [Test_acc of task 6 on test 1: 0.45567][acc of former classes: 0.66067][acc of former samples in all classes: 0.61233]
[acc of novel samples in all classes: 0.14233]
2022-10-28 06:49:06,785 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:49:06,813 WARNING: Current net - loaded net:
2022-10-28 06:49:06,813 WARNING: Loaded net - current net:
2022-10-28 06:49:06,813 WARNING:   func.classifier.bias
2022-10-28 06:49:06,813 WARNING:   func.classifier.weight
2022-10-28 06:49:06,831 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_6.pth.
2022-10-28 06:49:06,888 INFO: Obtain parameters for train
2022-10-28 06:49:06,902 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:49:06,902 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:49:06,903 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:49:06,904 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:49:06,905 INFO: Model [MTNBModel] is created.
2022-10-28 06:49:06,911 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:49:06,917 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:49:06,922 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:49:06,928 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:49:06,933 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:49:06,938 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:49:06,944 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-28 06:49:07,517 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3900, Acc: 0.6800, ]
2022-10-28 06:49:08,350 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3899, Acc: 0.6800, ]
2022-10-28 06:49:09,069 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3859, Acc: 0.6914, ]
2022-10-28 06:49:09,724 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3914, Acc: 0.7086, ]
2022-10-28 06:49:10,337 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3919, Acc: 0.6857, ]
2022-10-28 06:49:11,133 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3920, Acc: 0.6971, ]
2022-10-28 06:49:11,252 INFO: fine-tune procedure is finished!
2022-10-28 06:50:02,958 INFO: [Test_acc of task 7 on test 1: 0.44021][acc of former classes: 0.66067][acc of former samples in all classes: 0.60867]
[acc of novel samples in all classes: 0.15143]
2022-10-28 06:50:03,238 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:50:03,265 WARNING: Current net - loaded net:
2022-10-28 06:50:03,265 WARNING: Loaded net - current net:
2022-10-28 06:50:03,265 WARNING:   func.classifier.bias
2022-10-28 06:50:03,265 WARNING:   func.classifier.weight
2022-10-28 06:50:03,281 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_7.pth.
2022-10-28 06:50:03,322 INFO: Obtain parameters for train
2022-10-28 06:50:03,327 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:50:03,327 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:50:03,328 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:50:03,329 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:50:03,329 INFO: Model [MTNBModel] is created.
2022-10-28 06:50:03,336 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:50:03,341 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:50:03,347 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:50:03,352 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:50:03,358 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:50:03,363 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:50:03,368 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:50:03,374 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-28 06:50:04,161 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4344, Acc: 0.7350, ]
2022-10-28 06:50:04,768 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4417, Acc: 0.6900, ]
2022-10-28 06:50:05,432 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4381, Acc: 0.6850, ]
2022-10-28 06:50:06,113 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4388, Acc: 0.6800, ]
2022-10-28 06:50:06,906 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4476, Acc: 0.6900, ]
2022-10-28 06:50:07,528 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4413, Acc: 0.6800, ]
2022-10-28 06:50:07,614 INFO: fine-tune procedure is finished!
2022-10-28 06:51:01,781 INFO: [Test_acc of task 8 on test 1: 0.42660][acc of former classes: 0.66067][acc of former samples in all classes: 0.60167]
[acc of novel samples in all classes: 0.16400]
2022-10-28 06:51:02,058 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:51:02,086 WARNING: Current net - loaded net:
2022-10-28 06:51:02,086 WARNING: Loaded net - current net:
2022-10-28 06:51:02,086 WARNING:   func.classifier.bias
2022-10-28 06:51:02,086 WARNING:   func.classifier.weight
2022-10-28 06:51:02,104 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth.
2022-10-28 06:51:02,153 INFO: Obtain parameters for train
2022-10-28 06:51:02,161 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:51:02,162 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:51:02,163 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:51:02,164 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:51:02,164 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:51:02,164 INFO: Model [MTNBModel] is created.
2022-10-28 06:51:02,170 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-28 06:51:02,588 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0162, Acc: 0.6000, ]
2022-10-28 06:51:03,219 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0037, Acc: 0.6800, ]
2022-10-28 06:51:03,904 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0022, Acc: 0.6800, ]
2022-10-28 06:51:04,458 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0047, Acc: 0.6800, ]
2022-10-28 06:51:05,067 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0092, Acc: 0.6800, ]
2022-10-28 06:51:05,557 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0078, Acc: 0.6800, ]
2022-10-28 06:51:05,646 INFO: fine-tune procedure is finished!
2022-10-28 06:51:44,690 INFO: [Test_acc of task 1 on test 2: 0.61185][acc of former classes: 0.66067][acc of former samples in all classes: 0.64850]
[acc of novel samples in all classes: 0.17200]
2022-10-28 06:51:44,976 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:51:45,005 WARNING: Current net - loaded net:
2022-10-28 06:51:45,005 WARNING: Loaded net - current net:
2022-10-28 06:51:45,005 WARNING:   func.classifier.bias
2022-10-28 06:51:45,005 WARNING:   func.classifier.weight
2022-10-28 06:51:45,024 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_1.pth.
2022-10-28 06:51:45,078 INFO: Obtain parameters for train
2022-10-28 06:51:45,083 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:51:45,083 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:51:45,084 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:51:45,085 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:51:45,085 INFO: Model [MTNBModel] is created.
2022-10-28 06:51:45,091 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:51:45,097 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-28 06:51:45,584 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0884, Acc: 0.6800, ]
2022-10-28 06:51:46,079 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0786, Acc: 0.7000, ]
2022-10-28 06:51:46,556 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0867, Acc: 0.7000, ]
2022-10-28 06:51:47,283 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0835, Acc: 0.6200, ]
2022-10-28 06:51:47,940 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0885, Acc: 0.7400, ]
2022-10-28 06:51:48,498 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0788, Acc: 0.7400, ]
2022-10-28 06:51:48,588 INFO: fine-tune procedure is finished!
2022-10-28 06:52:30,274 INFO: [Test_acc of task 2 on test 2: 0.57214][acc of former classes: 0.66067][acc of former samples in all classes: 0.63933]
[acc of novel samples in all classes: 0.16900]
2022-10-28 06:52:30,550 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:52:30,579 WARNING: Current net - loaded net:
2022-10-28 06:52:30,579 WARNING: Loaded net - current net:
2022-10-28 06:52:30,579 WARNING:   func.classifier.bias
2022-10-28 06:52:30,579 WARNING:   func.classifier.weight
2022-10-28 06:52:30,599 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_2.pth.
2022-10-28 06:52:30,650 INFO: Obtain parameters for train
2022-10-28 06:52:30,652 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:52:30,652 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:52:30,652 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:52:30,652 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:52:30,652 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:52:30,652 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:52:30,653 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:52:30,654 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:52:30,655 INFO: Model [MTNBModel] is created.
2022-10-28 06:52:30,661 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:52:30,666 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:52:30,672 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-28 06:52:31,116 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1553, Acc: 0.6533, ]
2022-10-28 06:52:31,725 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1542, Acc: 0.5467, ]
2022-10-28 06:52:32,267 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1517, Acc: 0.7467, ]
2022-10-28 06:52:32,957 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1602, Acc: 0.6667, ]
2022-10-28 06:52:33,626 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1540, Acc: 0.5867, ]
2022-10-28 06:52:34,350 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1559, Acc: 0.7333, ]
2022-10-28 06:52:34,521 INFO: fine-tune procedure is finished!
2022-10-28 06:53:18,114 INFO: [Test_acc of task 3 on test 2: 0.53827][acc of former classes: 0.66067][acc of former samples in all classes: 0.63300]
[acc of novel samples in all classes: 0.15933]
2022-10-28 06:53:18,386 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:53:18,417 WARNING: Current net - loaded net:
2022-10-28 06:53:18,417 WARNING: Loaded net - current net:
2022-10-28 06:53:18,417 WARNING:   func.classifier.bias
2022-10-28 06:53:18,417 WARNING:   func.classifier.weight
2022-10-28 06:53:18,435 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_3.pth.
2022-10-28 06:53:18,472 INFO: Obtain parameters for train
2022-10-28 06:53:18,475 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:53:18,475 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:53:18,475 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:53:18,475 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:53:18,475 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:53:18,475 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:53:18,476 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:53:18,477 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:53:18,478 INFO: Model [MTNBModel] is created.
2022-10-28 06:53:18,484 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:53:18,489 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:53:18,495 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:53:18,501 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-28 06:53:18,997 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2167, Acc: 0.6600, ]
2022-10-28 06:53:19,584 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2163, Acc: 0.6700, ]
2022-10-28 06:53:20,243 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2174, Acc: 0.6200, ]
2022-10-28 06:53:20,961 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2165, Acc: 0.7300, ]
2022-10-28 06:53:21,782 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2176, Acc: 0.6500, ]
2022-10-28 06:53:22,376 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2154, Acc: 0.6500, ]
2022-10-28 06:53:22,468 INFO: fine-tune procedure is finished!
2022-10-28 06:54:08,334 INFO: [Test_acc of task 4 on test 2: 0.51087][acc of former classes: 0.66067][acc of former samples in all classes: 0.62600]
[acc of novel samples in all classes: 0.16550]
2022-10-28 06:54:08,608 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:54:08,636 WARNING: Current net - loaded net:
2022-10-28 06:54:08,636 WARNING: Loaded net - current net:
2022-10-28 06:54:08,636 WARNING:   func.classifier.bias
2022-10-28 06:54:08,636 WARNING:   func.classifier.weight
2022-10-28 06:54:08,654 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_4.pth.
2022-10-28 06:54:08,693 INFO: Obtain parameters for train
2022-10-28 06:54:08,696 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:54:08,696 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:54:08,697 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:54:08,698 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:54:08,698 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:54:08,698 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:54:08,698 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:54:08,698 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:54:08,698 INFO: Model [MTNBModel] is created.
2022-10-28 06:54:08,704 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:54:08,710 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:54:08,715 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:54:08,721 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:54:08,726 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-28 06:54:09,267 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2791, Acc: 0.6960, ]
2022-10-28 06:54:10,022 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2765, Acc: 0.6400, ]
2022-10-28 06:54:10,721 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2796, Acc: 0.6960, ]
2022-10-28 06:54:11,508 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2751, Acc: 0.6720, ]
2022-10-28 06:54:12,160 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2780, Acc: 0.6240, ]
2022-10-28 06:54:12,898 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2840, Acc: 0.6080, ]
2022-10-28 06:54:13,007 INFO: fine-tune procedure is finished!
2022-10-28 06:55:00,741 INFO: [Test_acc of task 5 on test 2: 0.48765][acc of former classes: 0.66067][acc of former samples in all classes: 0.62083]
[acc of novel samples in all classes: 0.16800]
2022-10-28 06:55:01,015 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:55:01,042 WARNING: Current net - loaded net:
2022-10-28 06:55:01,042 WARNING: Loaded net - current net:
2022-10-28 06:55:01,042 WARNING:   func.classifier.bias
2022-10-28 06:55:01,042 WARNING:   func.classifier.weight
2022-10-28 06:55:01,059 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_5.pth.
2022-10-28 06:55:01,096 INFO: Obtain parameters for train
2022-10-28 06:55:01,101 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:55:01,101 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:55:01,101 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:55:01,101 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:55:01,101 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:55:01,102 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:55:01,103 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:55:01,104 INFO: Model [MTNBModel] is created.
2022-10-28 06:55:01,112 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:01,118 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:01,123 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:01,128 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:01,134 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:01,139 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-28 06:55:01,657 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3346, Acc: 0.6400, ]
2022-10-28 06:55:02,326 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3379, Acc: 0.6533, ]
2022-10-28 06:55:02,954 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3392, Acc: 0.6000, ]
2022-10-28 06:55:03,678 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3410, Acc: 0.6000, ]
2022-10-28 06:55:04,364 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3400, Acc: 0.6600, ]
2022-10-28 06:55:04,920 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3421, Acc: 0.6200, ]
2022-10-28 06:55:05,042 INFO: fine-tune procedure is finished!
2022-10-28 06:55:55,110 INFO: [Test_acc of task 6 on test 2: 0.46111][acc of former classes: 0.66067][acc of former samples in all classes: 0.61533]
[acc of novel samples in all classes: 0.15267]
2022-10-28 06:55:55,388 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:55:55,416 WARNING: Current net - loaded net:
2022-10-28 06:55:55,416 WARNING: Loaded net - current net:
2022-10-28 06:55:55,416 WARNING:   func.classifier.bias
2022-10-28 06:55:55,416 WARNING:   func.classifier.weight
2022-10-28 06:55:55,432 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_6.pth.
2022-10-28 06:55:55,469 INFO: Obtain parameters for train
2022-10-28 06:55:55,472 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:55:55,472 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:55:55,473 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:55:55,474 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:55:55,474 INFO: Model [MTNBModel] is created.
2022-10-28 06:55:55,480 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:55,486 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:55,491 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:55,497 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:55,502 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:55,507 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:55:55,513 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-28 06:55:56,086 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3931, Acc: 0.6571, ]
2022-10-28 06:55:56,806 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3916, Acc: 0.6457, ]
2022-10-28 06:55:57,448 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3968, Acc: 0.6057, ]
2022-10-28 06:55:58,204 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3949, Acc: 0.6571, ]
2022-10-28 06:55:58,812 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3926, Acc: 0.6229, ]
2022-10-28 06:55:59,485 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3955, Acc: 0.6514, ]
2022-10-28 06:55:59,581 INFO: fine-tune procedure is finished!
2022-10-28 06:56:51,728 INFO: [Test_acc of task 7 on test 2: 0.44505][acc of former classes: 0.66067][acc of former samples in all classes: 0.61183]
[acc of novel samples in all classes: 0.15914]
2022-10-28 06:56:52,007 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:56:52,035 WARNING: Current net - loaded net:
2022-10-28 06:56:52,035 WARNING: Loaded net - current net:
2022-10-28 06:56:52,035 WARNING:   func.classifier.bias
2022-10-28 06:56:52,035 WARNING:   func.classifier.weight
2022-10-28 06:56:52,053 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_7.pth.
2022-10-28 06:56:52,103 INFO: Obtain parameters for train
2022-10-28 06:56:52,105 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:56:52,105 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:56:52,106 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:56:52,107 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:56:52,108 INFO: Model [MTNBModel] is created.
2022-10-28 06:56:52,114 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:56:52,119 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:56:52,125 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:56:52,131 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:56:52,136 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:56:52,142 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:56:52,147 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:56:52,153 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-28 06:56:52,688 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4410, Acc: 0.6650, ]
2022-10-28 06:56:53,428 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4456, Acc: 0.6100, ]
2022-10-28 06:56:54,055 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4460, Acc: 0.6200, ]
2022-10-28 06:56:54,691 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4417, Acc: 0.6200, ]
2022-10-28 06:56:55,497 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4473, Acc: 0.6050, ]
2022-10-28 06:56:56,332 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4476, Acc: 0.6650, ]
2022-10-28 06:56:56,447 INFO: fine-tune procedure is finished!
2022-10-28 06:57:50,664 INFO: [Test_acc of task 8 on test 2: 0.42910][acc of former classes: 0.66067][acc of former samples in all classes: 0.60933]
[acc of novel samples in all classes: 0.15875]
2022-10-28 06:57:50,937 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:57:50,963 WARNING: Current net - loaded net:
2022-10-28 06:57:50,963 WARNING: Loaded net - current net:
2022-10-28 06:57:50,964 WARNING:   func.classifier.bias
2022-10-28 06:57:50,964 WARNING:   func.classifier.weight
2022-10-28 06:57:50,985 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth.
2022-10-28 06:57:51,036 INFO: Obtain parameters for train
2022-10-28 06:57:51,039 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:57:51,039 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:57:51,040 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:57:51,041 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:57:51,042 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:57:51,042 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:57:51,042 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:57:51,042 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:57:51,042 INFO: Model [MTNBModel] is created.
2022-10-28 06:57:51,048 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-28 06:57:51,481 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0112, Acc: 0.6000, ]
2022-10-28 06:57:52,215 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0045, Acc: 0.6400, ]
2022-10-28 06:57:52,951 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0130, Acc: 0.5600, ]
2022-10-28 06:57:53,473 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0007, Acc: 0.6800, ]
2022-10-28 06:57:53,948 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0051, Acc: 0.6800, ]
2022-10-28 06:57:54,457 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0160, Acc: 0.7200, ]
2022-10-28 06:57:54,541 INFO: fine-tune procedure is finished!
2022-10-28 06:58:33,716 INFO: [Test_acc of task 1 on test 3: 0.60908][acc of former classes: 0.66067][acc of former samples in all classes: 0.64533]
[acc of novel samples in all classes: 0.17400]
2022-10-28 06:58:33,989 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:58:34,018 WARNING: Current net - loaded net:
2022-10-28 06:58:34,018 WARNING: Loaded net - current net:
2022-10-28 06:58:34,018 WARNING:   func.classifier.bias
2022-10-28 06:58:34,018 WARNING:   func.classifier.weight
2022-10-28 06:58:34,036 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_1.pth.
2022-10-28 06:58:34,086 INFO: Obtain parameters for train
2022-10-28 06:58:34,088 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:58:34,088 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:58:34,088 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:58:34,088 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:58:34,088 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:58:34,088 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:58:34,088 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:58:34,089 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:58:34,090 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:58:34,091 INFO: Model [MTNBModel] is created.
2022-10-28 06:58:34,097 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:58:34,103 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-28 06:58:34,534 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0744, Acc: 0.6000, ]
2022-10-28 06:58:35,021 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0808, Acc: 0.6000, ]
2022-10-28 06:58:35,681 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0781, Acc: 0.5600, ]
2022-10-28 06:58:36,469 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0822, Acc: 0.6200, ]
2022-10-28 06:58:37,067 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0729, Acc: 0.6200, ]
2022-10-28 06:58:37,631 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0725, Acc: 0.6200, ]
2022-10-28 06:58:37,734 INFO: fine-tune procedure is finished!
2022-10-28 06:59:19,283 INFO: [Test_acc of task 2 on test 3: 0.56543][acc of former classes: 0.66067][acc of former samples in all classes: 0.63783]
[acc of novel samples in all classes: 0.13100]
2022-10-28 06:59:19,568 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 06:59:19,596 WARNING: Current net - loaded net:
2022-10-28 06:59:19,596 WARNING: Loaded net - current net:
2022-10-28 06:59:19,596 WARNING:   func.classifier.bias
2022-10-28 06:59:19,596 WARNING:   func.classifier.weight
2022-10-28 06:59:19,615 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_2.pth.
2022-10-28 06:59:19,665 INFO: Obtain parameters for train
2022-10-28 06:59:19,668 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 06:59:19,668 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 06:59:19,669 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 06:59:19,670 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 06:59:19,670 INFO: Model [MTNBModel] is created.
2022-10-28 06:59:19,677 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:59:19,682 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 06:59:19,688 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-28 06:59:20,164 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1451, Acc: 0.7067, ]
2022-10-28 06:59:20,853 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1494, Acc: 0.6267, ]
2022-10-28 06:59:21,529 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1432, Acc: 0.6800, ]
2022-10-28 06:59:22,196 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1459, Acc: 0.6667, ]
2022-10-28 06:59:22,732 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1423, Acc: 0.6800, ]
2022-10-28 06:59:23,494 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1464, Acc: 0.6533, ]
2022-10-28 06:59:23,612 INFO: fine-tune procedure is finished!
2022-10-28 07:00:07,333 INFO: [Test_acc of task 3 on test 3: 0.53080][acc of former classes: 0.66067][acc of former samples in all classes: 0.62850]
[acc of novel samples in all classes: 0.14000]
2022-10-28 07:00:07,730 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:00:07,767 WARNING: Current net - loaded net:
2022-10-28 07:00:07,767 WARNING: Loaded net - current net:
2022-10-28 07:00:07,768 WARNING:   func.classifier.bias
2022-10-28 07:00:07,768 WARNING:   func.classifier.weight
2022-10-28 07:00:07,786 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_3.pth.
2022-10-28 07:00:07,837 INFO: Obtain parameters for train
2022-10-28 07:00:07,842 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:00:07,842 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:00:07,843 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:00:07,844 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:00:07,844 INFO: Model [MTNBModel] is created.
2022-10-28 07:00:07,850 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:00:07,856 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:00:07,861 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:00:07,867 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-28 07:00:08,330 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2101, Acc: 0.7300, ]
2022-10-28 07:00:08,886 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2154, Acc: 0.6600, ]
2022-10-28 07:00:09,583 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2145, Acc: 0.6800, ]
2022-10-28 07:00:10,141 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2179, Acc: 0.5900, ]
2022-10-28 07:00:10,720 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2179, Acc: 0.6300, ]
2022-10-28 07:00:11,338 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2114, Acc: 0.6400, ]
2022-10-28 07:00:11,439 INFO: fine-tune procedure is finished!
2022-10-28 07:00:57,150 INFO: [Test_acc of task 4 on test 3: 0.50138][acc of former classes: 0.66067][acc of former samples in all classes: 0.62183]
[acc of novel samples in all classes: 0.14000]
2022-10-28 07:00:57,427 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:00:57,459 WARNING: Current net - loaded net:
2022-10-28 07:00:57,459 WARNING: Loaded net - current net:
2022-10-28 07:00:57,459 WARNING:   func.classifier.bias
2022-10-28 07:00:57,459 WARNING:   func.classifier.weight
2022-10-28 07:00:57,479 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_4.pth.
2022-10-28 07:00:57,529 INFO: Obtain parameters for train
2022-10-28 07:00:57,532 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:00:57,532 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:00:57,533 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:00:57,534 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:00:57,534 INFO: Model [MTNBModel] is created.
2022-10-28 07:00:57,540 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:00:57,546 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:00:57,551 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:00:57,557 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:00:57,562 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-28 07:00:58,044 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2827, Acc: 0.6400, ]
2022-10-28 07:00:58,629 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2736, Acc: 0.6320, ]
2022-10-28 07:00:59,258 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2752, Acc: 0.6320, ]
2022-10-28 07:00:59,877 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2775, Acc: 0.6560, ]
2022-10-28 07:01:00,529 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2760, Acc: 0.6800, ]
2022-10-28 07:01:01,096 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2783, Acc: 0.6320, ]
2022-10-28 07:01:01,182 INFO: fine-tune procedure is finished!
2022-10-28 07:01:48,791 INFO: [Test_acc of task 5 on test 3: 0.47647][acc of former classes: 0.66067][acc of former samples in all classes: 0.61617]
[acc of novel samples in all classes: 0.14120]
2022-10-28 07:01:49,067 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:01:49,094 WARNING: Current net - loaded net:
2022-10-28 07:01:49,094 WARNING: Loaded net - current net:
2022-10-28 07:01:49,094 WARNING:   func.classifier.bias
2022-10-28 07:01:49,094 WARNING:   func.classifier.weight
2022-10-28 07:01:49,112 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_5.pth.
2022-10-28 07:01:49,166 INFO: Obtain parameters for train
2022-10-28 07:01:49,173 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:01:49,173 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:01:49,174 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:01:49,175 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:01:49,175 INFO: Model [MTNBModel] is created.
2022-10-28 07:01:49,181 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:01:49,187 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:01:49,193 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:01:49,198 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:01:49,203 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:01:49,209 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-28 07:01:49,812 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3399, Acc: 0.5667, ]
2022-10-28 07:01:50,607 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3334, Acc: 0.7000, ]
2022-10-28 07:01:51,341 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3351, Acc: 0.6333, ]
2022-10-28 07:01:52,089 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3397, Acc: 0.5400, ]
2022-10-28 07:01:52,694 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3376, Acc: 0.6733, ]
2022-10-28 07:01:53,561 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3397, Acc: 0.6067, ]
2022-10-28 07:01:53,658 INFO: fine-tune procedure is finished!
2022-10-28 07:02:43,535 INFO: [Test_acc of task 6 on test 3: 0.45244][acc of former classes: 0.66067][acc of former samples in all classes: 0.61300]
[acc of novel samples in all classes: 0.13133]
2022-10-28 07:02:43,809 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:02:43,836 WARNING: Current net - loaded net:
2022-10-28 07:02:43,836 WARNING: Loaded net - current net:
2022-10-28 07:02:43,836 WARNING:   func.classifier.bias
2022-10-28 07:02:43,836 WARNING:   func.classifier.weight
2022-10-28 07:02:43,855 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_6.pth.
2022-10-28 07:02:43,908 INFO: Obtain parameters for train
2022-10-28 07:02:43,911 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:02:43,911 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:02:43,912 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:02:43,913 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:02:43,913 INFO: Model [MTNBModel] is created.
2022-10-28 07:02:43,919 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:02:43,925 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:02:43,930 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:02:43,936 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:02:43,941 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:02:43,946 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:02:43,952 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-28 07:02:44,500 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3879, Acc: 0.5771, ]
2022-10-28 07:02:45,103 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3922, Acc: 0.6686, ]
2022-10-28 07:02:45,846 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3921, Acc: 0.6229, ]
2022-10-28 07:02:46,663 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3941, Acc: 0.6343, ]
2022-10-28 07:02:47,285 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3918, Acc: 0.6457, ]
2022-10-28 07:02:48,136 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3899, Acc: 0.6686, ]
2022-10-28 07:02:48,256 INFO: fine-tune procedure is finished!
2022-10-28 07:03:40,291 INFO: [Test_acc of task 7 on test 3: 0.43568][acc of former classes: 0.66067][acc of former samples in all classes: 0.60900]
[acc of novel samples in all classes: 0.13857]
2022-10-28 07:03:40,583 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:03:40,610 WARNING: Current net - loaded net:
2022-10-28 07:03:40,610 WARNING: Loaded net - current net:
2022-10-28 07:03:40,610 WARNING:   func.classifier.bias
2022-10-28 07:03:40,610 WARNING:   func.classifier.weight
2022-10-28 07:03:40,627 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_7.pth.
2022-10-28 07:03:40,667 INFO: Obtain parameters for train
2022-10-28 07:03:40,672 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:03:40,672 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:03:40,673 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:03:40,674 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:03:40,675 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:03:40,675 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:03:40,675 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:03:40,675 INFO: Model [MTNBModel] is created.
2022-10-28 07:03:40,681 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:03:40,686 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:03:40,692 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:03:40,697 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:03:40,703 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:03:40,708 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:03:40,713 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:03:40,719 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-28 07:03:41,267 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4451, Acc: 0.5650, ]
2022-10-28 07:03:42,039 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4412, Acc: 0.6250, ]
2022-10-28 07:03:42,944 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4408, Acc: 0.6600, ]
2022-10-28 07:03:43,692 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4471, Acc: 0.6200, ]
2022-10-28 07:03:44,384 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4448, Acc: 0.6400, ]
2022-10-28 07:03:45,049 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4457, Acc: 0.6400, ]
2022-10-28 07:03:45,155 INFO: fine-tune procedure is finished!
2022-10-28 07:04:39,738 INFO: [Test_acc of task 8 on test 3: 0.42250][acc of former classes: 0.66067][acc of former samples in all classes: 0.60433]
[acc of novel samples in all classes: 0.14975]
2022-10-28 07:04:40,012 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:04:40,041 WARNING: Current net - loaded net:
2022-10-28 07:04:40,041 WARNING: Loaded net - current net:
2022-10-28 07:04:40,041 WARNING:   func.classifier.bias
2022-10-28 07:04:40,041 WARNING:   func.classifier.weight
2022-10-28 07:04:40,058 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth.
2022-10-28 07:04:40,096 INFO: Obtain parameters for train
2022-10-28 07:04:40,099 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:04:40,099 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:04:40,100 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:04:40,101 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:04:40,101 INFO: Model [MTNBModel] is created.
2022-10-28 07:04:40,107 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-28 07:04:40,535 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0009, Acc: 0.6400, ]
2022-10-28 07:04:41,018 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0107, Acc: 0.6800, ]
2022-10-28 07:04:41,754 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0083, Acc: 0.6000, ]
2022-10-28 07:04:42,384 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0059, Acc: 0.7600, ]
2022-10-28 07:04:43,078 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0057, Acc: 0.7200, ]
2022-10-28 07:04:43,758 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0101, Acc: 0.7200, ]
2022-10-28 07:04:43,853 INFO: fine-tune procedure is finished!
2022-10-28 07:05:23,167 INFO: [Test_acc of task 1 on test 4: 0.61015][acc of former classes: 0.66067][acc of former samples in all classes: 0.64533]
[acc of novel samples in all classes: 0.18800]
2022-10-28 07:05:23,443 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:05:23,470 WARNING: Current net - loaded net:
2022-10-28 07:05:23,470 WARNING: Loaded net - current net:
2022-10-28 07:05:23,470 WARNING:   func.classifier.bias
2022-10-28 07:05:23,470 WARNING:   func.classifier.weight
2022-10-28 07:05:23,490 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_1.pth.
2022-10-28 07:05:23,541 INFO: Obtain parameters for train
2022-10-28 07:05:23,543 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:05:23,543 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:05:23,543 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:05:23,543 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:05:23,543 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:05:23,543 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:05:23,543 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:05:23,543 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:05:23,544 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:05:23,545 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:05:23,546 INFO: Model [MTNBModel] is created.
2022-10-28 07:05:23,552 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:05:23,557 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-28 07:05:24,023 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.0823, Acc: 0.7400, ]
2022-10-28 07:05:24,531 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.0859, Acc: 0.6800, ]
2022-10-28 07:05:25,041 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.0784, Acc: 0.7200, ]
2022-10-28 07:05:25,776 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.0844, Acc: 0.6600, ]
2022-10-28 07:05:26,505 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.0811, Acc: 0.7000, ]
2022-10-28 07:05:27,229 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.0829, Acc: 0.7000, ]
2022-10-28 07:05:27,313 INFO: fine-tune procedure is finished!
2022-10-28 07:06:08,860 INFO: [Test_acc of task 2 on test 4: 0.57057][acc of former classes: 0.66067][acc of former samples in all classes: 0.63767]
[acc of novel samples in all classes: 0.16800]
2022-10-28 07:06:09,133 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:06:09,160 WARNING: Current net - loaded net:
2022-10-28 07:06:09,160 WARNING: Loaded net - current net:
2022-10-28 07:06:09,160 WARNING:   func.classifier.bias
2022-10-28 07:06:09,161 WARNING:   func.classifier.weight
2022-10-28 07:06:09,178 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_2.pth.
2022-10-28 07:06:09,228 INFO: Obtain parameters for train
2022-10-28 07:06:09,232 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:06:09,232 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:06:09,232 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:06:09,232 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:06:09,232 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:06:09,233 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:06:09,234 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:06:09,235 INFO: Model [MTNBModel] is created.
2022-10-28 07:06:09,241 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:06:09,246 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:06:09,252 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-28 07:06:09,816 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.1495, Acc: 0.6800, ]
2022-10-28 07:06:10,548 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.1476, Acc: 0.7067, ]
2022-10-28 07:06:11,215 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.1529, Acc: 0.6667, ]
2022-10-28 07:06:11,938 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.1494, Acc: 0.6667, ]
2022-10-28 07:06:12,508 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.1470, Acc: 0.6933, ]
2022-10-28 07:06:13,137 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.1480, Acc: 0.6133, ]
2022-10-28 07:06:13,240 INFO: fine-tune procedure is finished!
2022-10-28 07:06:56,856 INFO: [Test_acc of task 3 on test 4: 0.53853][acc of former classes: 0.66067][acc of former samples in all classes: 0.63067]
[acc of novel samples in all classes: 0.17000]
2022-10-28 07:06:57,161 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:06:57,203 WARNING: Current net - loaded net:
2022-10-28 07:06:57,203 WARNING: Loaded net - current net:
2022-10-28 07:06:57,203 WARNING:   func.classifier.bias
2022-10-28 07:06:57,203 WARNING:   func.classifier.weight
2022-10-28 07:06:57,224 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_3.pth.
2022-10-28 07:06:57,291 INFO: Obtain parameters for train
2022-10-28 07:06:57,295 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:06:57,295 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:06:57,296 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:06:57,297 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:06:57,297 INFO: Model [MTNBModel] is created.
2022-10-28 07:06:57,304 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:06:57,314 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:06:57,320 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:06:57,325 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-28 07:06:57,905 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2129, Acc: 0.6200, ]
2022-10-28 07:06:58,646 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2123, Acc: 0.5900, ]
2022-10-28 07:06:59,460 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2146, Acc: 0.6800, ]
2022-10-28 07:07:00,198 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2165, Acc: 0.6900, ]
2022-10-28 07:07:00,974 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2156, Acc: 0.6700, ]
2022-10-28 07:07:01,540 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2190, Acc: 0.6200, ]
2022-10-28 07:07:01,666 INFO: fine-tune procedure is finished!
2022-10-28 07:07:46,945 INFO: [Test_acc of task 4 on test 4: 0.51175][acc of former classes: 0.66067][acc of former samples in all classes: 0.62467]
[acc of novel samples in all classes: 0.17300]
2022-10-28 07:07:47,221 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:07:47,248 WARNING: Current net - loaded net:
2022-10-28 07:07:47,248 WARNING: Loaded net - current net:
2022-10-28 07:07:47,249 WARNING:   func.classifier.bias
2022-10-28 07:07:47,249 WARNING:   func.classifier.weight
2022-10-28 07:07:47,267 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_4.pth.
2022-10-28 07:07:47,321 INFO: Obtain parameters for train
2022-10-28 07:07:47,324 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:07:47,325 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:07:47,326 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:07:47,327 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:07:47,327 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:07:47,327 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:07:47,327 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:07:47,327 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:07:47,327 INFO: Model [MTNBModel] is created.
2022-10-28 07:07:47,333 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:07:47,339 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:07:47,344 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:07:47,349 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:07:47,355 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-28 07:07:47,876 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.2779, Acc: 0.6640, ]
2022-10-28 07:07:48,504 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.2744, Acc: 0.6320, ]
2022-10-28 07:07:49,241 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.2722, Acc: 0.7680, ]
2022-10-28 07:07:50,054 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.2757, Acc: 0.6400, ]
2022-10-28 07:07:50,683 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.2725, Acc: 0.6160, ]
2022-10-28 07:07:51,238 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.2703, Acc: 0.6160, ]
2022-10-28 07:07:51,326 INFO: fine-tune procedure is finished!
2022-10-28 07:08:39,188 INFO: [Test_acc of task 5 on test 4: 0.48553][acc of former classes: 0.66067][acc of former samples in all classes: 0.61917]
[acc of novel samples in all classes: 0.16480]
2022-10-28 07:08:39,465 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:08:39,492 WARNING: Current net - loaded net:
2022-10-28 07:08:39,492 WARNING: Loaded net - current net:
2022-10-28 07:08:39,492 WARNING:   func.classifier.bias
2022-10-28 07:08:39,492 WARNING:   func.classifier.weight
2022-10-28 07:08:39,512 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_5.pth.
2022-10-28 07:08:39,565 INFO: Obtain parameters for train
2022-10-28 07:08:39,567 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:08:39,567 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:08:39,567 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:08:39,567 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:08:39,567 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:08:39,568 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:08:39,569 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:08:39,570 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:08:39,570 INFO: Model [MTNBModel] is created.
2022-10-28 07:08:39,576 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:08:39,581 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:08:39,587 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:08:39,592 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:08:39,598 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:08:39,603 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-28 07:08:40,135 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3379, Acc: 0.6800, ]
2022-10-28 07:08:40,850 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3320, Acc: 0.7200, ]
2022-10-28 07:08:41,471 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3362, Acc: 0.6600, ]
2022-10-28 07:08:42,194 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3377, Acc: 0.6067, ]
2022-10-28 07:08:42,970 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3394, Acc: 0.6667, ]
2022-10-28 07:08:43,765 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3322, Acc: 0.7333, ]
2022-10-28 07:08:43,894 INFO: fine-tune procedure is finished!
2022-10-28 07:09:34,271 INFO: [Test_acc of task 6 on test 4: 0.46078][acc of former classes: 0.66067][acc of former samples in all classes: 0.61367]
[acc of novel samples in all classes: 0.15500]
2022-10-28 07:09:34,557 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:09:34,583 WARNING: Current net - loaded net:
2022-10-28 07:09:34,583 WARNING: Loaded net - current net:
2022-10-28 07:09:34,583 WARNING:   func.classifier.bias
2022-10-28 07:09:34,583 WARNING:   func.classifier.weight
2022-10-28 07:09:34,602 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_6.pth.
2022-10-28 07:09:34,655 INFO: Obtain parameters for train
2022-10-28 07:09:34,660 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:09:34,660 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:09:34,660 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:09:34,660 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:09:34,661 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:09:34,662 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:09:34,663 INFO: Model [MTNBModel] is created.
2022-10-28 07:09:34,672 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:09:34,677 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:09:34,683 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:09:34,688 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:09:34,693 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:09:34,699 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:09:34,704 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-28 07:09:35,254 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.3851, Acc: 0.6343, ]
2022-10-28 07:09:36,254 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.3924, Acc: 0.6857, ]
2022-10-28 07:09:36,908 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.3892, Acc: 0.6857, ]
2022-10-28 07:09:37,563 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.3871, Acc: 0.7029, ]
2022-10-28 07:09:38,193 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.3922, Acc: 0.6514, ]
2022-10-28 07:09:38,801 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.3887, Acc: 0.7029, ]
2022-10-28 07:09:38,891 INFO: fine-tune procedure is finished!
2022-10-28 07:10:30,642 INFO: [Test_acc of task 7 on test 4: 0.44147][acc of former classes: 0.66067][acc of former samples in all classes: 0.60883]
[acc of novel samples in all classes: 0.15457]
2022-10-28 07:10:30,920 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth.
2022-10-28 07:10:30,948 WARNING: Current net - loaded net:
2022-10-28 07:10:30,948 WARNING: Loaded net - current net:
2022-10-28 07:10:30,948 WARNING:   func.classifier.bias
2022-10-28 07:10:30,948 WARNING:   func.classifier.weight
2022-10-28 07:10:30,966 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_7.pth.
2022-10-28 07:10:31,011 INFO: Obtain parameters for train
2022-10-28 07:10:31,015 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-28 07:10:31,015 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.1.conv2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-28 07:10:31,016 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.fc.weight will not be optimized.
2022-10-28 07:10:31,017 WARNING: Params func.base.fc.bias will not be optimized.
2022-10-28 07:10:31,017 INFO: Model [MTNBModel] is created.
2022-10-28 07:10:31,024 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:10:31,029 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:10:31,034 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:10:31,040 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:10:31,045 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:10:31,050 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:10:31,056 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-28 07:10:31,061 INFO: Dataset NormalDataset - miniImageNet is created.
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/CFRModel_res18_miniImageNet_small_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-28 07:10:31,612 INFO: [epoch:  0, iter:   1, lr:(2.000e-02)] [ PTFixPNLoss: 4.4375, Acc: 0.6650, ]
2022-10-28 07:10:32,457 INFO: [epoch:  1, iter:   2, lr:(2.000e-02)] [ PTFixPNLoss: 4.4412, Acc: 0.7000, ]
2022-10-28 07:10:33,245 INFO: [epoch:  2, iter:   3, lr:(2.000e-02)] [ PTFixPNLoss: 4.4408, Acc: 0.6800, ]
2022-10-28 07:10:33,922 INFO: [epoch:  3, iter:   4, lr:(2.000e-02)] [ PTFixPNLoss: 4.4415, Acc: 0.7150, ]
2022-10-28 07:10:34,608 INFO: [epoch:  4, iter:   5, lr:(2.000e-02)] [ PTFixPNLoss: 4.4376, Acc: 0.6750, ]
2022-10-28 07:10:35,402 INFO: [epoch:  5, iter:   6, lr:(2.000e-02)] [ PTFixPNLoss: 4.4387, Acc: 0.6450, ]
2022-10-28 07:10:35,517 INFO: fine-tune procedure is finished!
2022-10-28 07:11:29,924 INFO: [Test_acc of task 8 on test 4: 0.42650][acc of former classes: 0.66067][acc of former samples in all classes: 0.60417]
[acc of novel samples in all classes: 0.16000]
2022-10-28 07:11:30,025 INFO: --------------------------Final Avg Acc-------------------------
2022-10-28 07:11:30,025 INFO: Session 1: 66.07+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.6607]
2022-10-28 07:11:30,026 INFO: Session 2: 61.05+-0.12[acc of former classes: 0.6607][acc of former samples in all classes: 0.6471]
[acc of novel samples in all classes: 0.1712]
2022-10-28 07:11:30,026 INFO: Session 3: 56.82+-0.23[acc of former classes: 0.6607][acc of former samples in all classes: 0.6385]
[acc of novel samples in all classes: 0.1464]
2022-10-28 07:11:30,026 INFO: Session 4: 53.51+-0.28[acc of former classes: 0.6607][acc of former samples in all classes: 0.6314]
[acc of novel samples in all classes: 0.1500]
2022-10-28 07:11:30,026 INFO: Session 5: 50.76+-0.32[acc of former classes: 0.6607][acc of former samples in all classes: 0.6247]
[acc of novel samples in all classes: 0.1561]
2022-10-28 07:11:30,026 INFO: Session 6: 48.26+-0.34[acc of former classes: 0.6607][acc of former samples in all classes: 0.6187]
[acc of novel samples in all classes: 0.1558]
2022-10-28 07:11:30,026 INFO: Session 7: 45.79+-0.29[acc of former classes: 0.6607][acc of former samples in all classes: 0.6140]
[acc of novel samples in all classes: 0.1457]
2022-10-28 07:11:30,026 INFO: Session 8: 44.07+-0.26[acc of former classes: 0.6607][acc of former samples in all classes: 0.6098]
[acc of novel samples in all classes: 0.1509]
2022-10-28 07:11:30,026 INFO: Session 9: 42.62+-0.19[acc of former classes: 0.6607][acc of former samples in all classes: 0.6049]
[acc of novel samples in all classes: 0.1580]
2022-10-28 07:11:30,026 INFO: random seed: 1997
>>> Test >>>
Former classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Novel classes: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/MFSIL_MTNBModel_res18_miniImageNet_small_DB_sfc4_0.01_std3.0_debug/models/test4_session_8.pth
finish!!
