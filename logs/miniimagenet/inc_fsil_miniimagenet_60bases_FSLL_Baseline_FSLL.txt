2022-10-31 21:06:24,877 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-10-31 21:06:24,877 INFO: 
  name: FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug
  model_type: FSLLModel
  gpu: 1
  manual_seed: 1997
  use_cosine: False
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  datasets:[
    train:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: 25
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    val:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    test:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      pre_load: True
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
  ]
  network_g:[
    type: Resnet18_softmax
    Embed_dim: 512
    pretrained: False
    norm: False
    num_classes: 60
    adopt_classifier: False
    addition_net: False
    flatten: True
    cut_at_pooling: False
  ]
  path:[
    pretrain_model_g: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
    base_model: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug
    training_states: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/training_states
    log: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug
    models: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.001
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [160]
      gamma: 0.1
    ]
    fine_tune: True
    fine_tune_epoch: 15
    threshold: 0.16
    warmup_iter: -1
    bases: 60
    tasks: 9
    shots: 5
    novel_exemplars: 5
    num_test: 5
    metric_opt:[
      type: TripletLossNoHardMining
      margin: 0.0
      num_instances: 5
    ]
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
    regularization:[
      type: IncrementalNetworkFixLoss
      w: 5.0
    ]
  ]
  val:[
    val_freq: 200
    test_type: NCM
    p_norm: None
  ]
  logger:[
    print_freq: 2
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-10-31 21:06:24,877 INFO: Random seed: 1997
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:181: UserWarning: nn.init.kaiming_normal is now deprecated in favor of nn.init.kaiming_normal_.
  init.kaiming_normal(m.weight, mode='fan_out')
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:188: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  init.normal(m.weight, std=0.001)
2022-10-31 21:06:26,683 INFO: Network: Resnet18_softmax, with parameters: 11,689,512
2022-10-31 21:06:26,683 INFO: Resnet18_softmax(
  (func): ResNet_pytorch(
    (base): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=1000, bias=True)
    )
  )
)
2022-10-31 21:06:26,683 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:06:26,724 WARNING: Current net - loaded net:
2022-10-31 21:06:26,724 WARNING: Loaded net - current net:
2022-10-31 21:06:26,724 WARNING:   func.classifier.bias
2022-10-31 21:06:26,724 WARNING:   func.classifier.weight
2022-10-31 21:06:26,754 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:06:26,792 WARNING: Current net - loaded net:
2022-10-31 21:06:26,792 WARNING: Loaded net - current net:
2022-10-31 21:06:26,792 WARNING:   func.classifier.bias
2022-10-31 21:06:26,792 WARNING:   func.classifier.weight
2022-10-31 21:06:26,848 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:06:26,848 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:06:26,848 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:06:26,848 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:06:26,848 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:06:26,848 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:06:26,848 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:06:26,848 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:06:26,848 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:06:26,848 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:06:26,848 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:06:26,848 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:06:26,849 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:06:26,850 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:06:26,851 INFO: Model [FSLLModel] is created.
2022-10-31 21:07:12,246 INFO: [Test_acc of task 0 on test 0: 0.66983][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.66983]
2022-10-31 21:07:12,497 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:07:12,526 WARNING: Current net - loaded net:
2022-10-31 21:07:12,526 WARNING: Loaded net - current net:
2022-10-31 21:07:12,526 WARNING:   func.classifier.bias
2022-10-31 21:07:12,526 WARNING:   func.classifier.weight
2022-10-31 21:07:12,555 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-10-31 21:07:12,615 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:07:12,640 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:07:12,640 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:07:12,640 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:07:12,640 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:07:12,640 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:07:12,640 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:07:12,640 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:07:12,641 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:07:12,642 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:07:12,643 INFO: Model [FSLLModel] is created.
2022-10-31 21:07:12,649 INFO: Dataset NormalDataset - miniImageNet is created.
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
/workspace/FLOWER/f2m/methods/losses/losses.py:736: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1005.)
  dist.addmm_(1, -2, inputs, inputs.t())
2022-10-31 21:07:14,047 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4330, Pos_dist: 9.0022, Neg_dist: 11.2619, Acc: 0.6800, PTFixPNLoss: 3.9136, NetFixLoss: 0.0000, ]
2022-10-31 21:07:14,730 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5762, Pos_dist: 9.0860, Neg_dist: 11.4973, Acc: 0.5600, PTFixPNLoss: 3.9180, NetFixLoss: 2.3187, ]
2022-10-31 21:07:15,393 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2900, Pos_dist: 8.8938, Neg_dist: 11.4544, Acc: 0.6000, PTFixPNLoss: 3.9255, NetFixLoss: 5.1990, ]
2022-10-31 21:07:16,039 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.6311, Pos_dist: 9.0802, Neg_dist: 11.1805, Acc: 0.6000, PTFixPNLoss: 3.9222, NetFixLoss: 8.4153, ]
2022-10-31 21:07:16,653 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4169, Pos_dist: 9.0971, Neg_dist: 11.5145, Acc: 0.6400, PTFixPNLoss: 3.9206, NetFixLoss: 11.8702, ]
2022-10-31 21:07:17,438 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3108, Pos_dist: 8.9614, Neg_dist: 11.8064, Acc: 0.6000, PTFixPNLoss: 3.9150, NetFixLoss: 15.5973, ]
2022-10-31 21:07:18,227 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4869, Pos_dist: 8.9220, Neg_dist: 11.5085, Acc: 0.5600, PTFixPNLoss: 3.9097, NetFixLoss: 19.4269, ]
2022-10-31 21:07:18,986 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4737, Pos_dist: 8.9042, Neg_dist: 11.2394, Acc: 0.5200, PTFixPNLoss: 3.9167, NetFixLoss: 23.3242, ]
2022-10-31 21:07:19,727 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3954, Pos_dist: 8.8836, Neg_dist: 11.4607, Acc: 0.6000, PTFixPNLoss: 3.9102, NetFixLoss: 27.4127, ]
2022-10-31 21:07:20,445 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.6469, Pos_dist: 8.9644, Neg_dist: 10.7532, Acc: 0.7200, PTFixPNLoss: 3.9184, NetFixLoss: 31.6065, ]
2022-10-31 21:07:22,083 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2325, Pos_dist: 9.1793, Neg_dist: 12.0086, Acc: 0.5200, PTFixPNLoss: 3.9193, NetFixLoss: 35.8417, ]
2022-10-31 21:07:22,767 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5990, Pos_dist: 9.0578, Neg_dist: 11.2045, Acc: 0.6000, PTFixPNLoss: 3.9180, NetFixLoss: 40.0280, ]
2022-10-31 21:07:23,431 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2868, Pos_dist: 9.0098, Neg_dist: 11.5085, Acc: 0.6800, PTFixPNLoss: 3.9151, NetFixLoss: 44.1690, ]
2022-10-31 21:07:24,102 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.6022, Pos_dist: 8.9026, Neg_dist: 11.1211, Acc: 0.7200, PTFixPNLoss: 3.9120, NetFixLoss: 48.3034, ]
2022-10-31 21:07:24,898 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2361, Pos_dist: 8.9739, Neg_dist: 11.8765, Acc: 0.6400, PTFixPNLoss: 3.9163, NetFixLoss: 52.5279, ]
2022-10-31 21:07:24,979 INFO: fine-tune procedure is finished!
2022-10-31 21:08:12,254 INFO: [Test_acc of task 1 on test 0: 0.57600][acc of former classes: 0.62300][acc of former samples in all classes: 0.61833]
[acc of novel samples in all classes: 0.06800]
2022-10-31 21:08:12,544 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:08:12,574 WARNING: Current net - loaded net:
2022-10-31 21:08:12,574 WARNING: Loaded net - current net:
2022-10-31 21:08:12,574 WARNING:   func.classifier.bias
2022-10-31 21:08:12,574 WARNING:   func.classifier.weight
2022-10-31 21:08:12,606 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_1.pth.
2022-10-31 21:08:12,664 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:08:12,697 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:08:12,697 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:08:12,697 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:08:12,697 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:08:12,697 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:08:12,697 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:08:12,697 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:08:12,698 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:08:12,699 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:08:12,699 INFO: Model [FSLLModel] is created.
2022-10-31 21:08:12,705 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:08:12,711 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 21:08:13,560 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5104, Pos_dist: 8.8907, Neg_dist: 11.2446, Acc: 0.7600, PTFixPNLoss: 3.9700, NetFixLoss: 0.0000, ]
2022-10-31 21:08:14,588 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2153, Pos_dist: 8.8763, Neg_dist: 11.9232, Acc: 0.7000, PTFixPNLoss: 3.9722, NetFixLoss: 1.8437, ]
2022-10-31 21:08:15,603 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2214, Pos_dist: 8.8763, Neg_dist: 12.3513, Acc: 0.7600, PTFixPNLoss: 3.9740, NetFixLoss: 3.9993, ]
2022-10-31 21:08:16,512 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2699, Pos_dist: 8.7388, Neg_dist: 11.6454, Acc: 0.8200, PTFixPNLoss: 3.9730, NetFixLoss: 6.3704, ]
2022-10-31 21:08:17,480 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4272, Pos_dist: 8.9976, Neg_dist: 11.5706, Acc: 0.7000, PTFixPNLoss: 3.9816, NetFixLoss: 8.8613, ]
2022-10-31 21:08:18,381 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3494, Pos_dist: 8.7828, Neg_dist: 11.5997, Acc: 0.8200, PTFixPNLoss: 3.9705, NetFixLoss: 11.5744, ]
2022-10-31 21:08:19,438 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2583, Pos_dist: 8.7954, Neg_dist: 11.9257, Acc: 0.7600, PTFixPNLoss: 3.9685, NetFixLoss: 14.6353, ]
2022-10-31 21:08:20,390 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2829, Pos_dist: 8.9370, Neg_dist: 11.7493, Acc: 0.7600, PTFixPNLoss: 3.9724, NetFixLoss: 17.9002, ]
2022-10-31 21:08:21,322 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3185, Pos_dist: 8.7452, Neg_dist: 11.2660, Acc: 0.8200, PTFixPNLoss: 3.9664, NetFixLoss: 21.2061, ]
2022-10-31 21:08:22,346 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4595, Pos_dist: 8.9156, Neg_dist: 11.1435, Acc: 0.7800, PTFixPNLoss: 3.9787, NetFixLoss: 24.6074, ]
2022-10-31 21:08:23,277 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2687, Pos_dist: 8.7212, Neg_dist: 11.7716, Acc: 0.8200, PTFixPNLoss: 3.9660, NetFixLoss: 28.2413, ]
2022-10-31 21:08:24,166 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4048, Pos_dist: 8.7601, Neg_dist: 11.0259, Acc: 0.7800, PTFixPNLoss: 3.9631, NetFixLoss: 31.9362, ]
2022-10-31 21:08:25,141 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2554, Pos_dist: 8.8591, Neg_dist: 11.8347, Acc: 0.7400, PTFixPNLoss: 3.9734, NetFixLoss: 35.7819, ]
2022-10-31 21:08:26,064 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4284, Pos_dist: 8.8687, Neg_dist: 11.5817, Acc: 0.6800, PTFixPNLoss: 3.9711, NetFixLoss: 39.7613, ]
2022-10-31 21:08:26,955 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1821, Pos_dist: 8.6422, Neg_dist: 11.4489, Acc: 0.8400, PTFixPNLoss: 3.9641, NetFixLoss: 43.6295, ]
2022-10-31 21:08:27,063 INFO: fine-tune procedure is finished!
2022-10-31 21:09:17,057 INFO: [Test_acc of task 2 on test 0: 0.52929][acc of former classes: 0.61200][acc of former samples in all classes: 0.60150]
[acc of novel samples in all classes: 0.09600]
2022-10-31 21:09:17,343 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:09:17,371 WARNING: Current net - loaded net:
2022-10-31 21:09:17,372 WARNING: Loaded net - current net:
2022-10-31 21:09:17,372 WARNING:   func.classifier.bias
2022-10-31 21:09:17,372 WARNING:   func.classifier.weight
2022-10-31 21:09:17,401 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_2.pth.
2022-10-31 21:09:17,458 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:09:17,485 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:09:17,485 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:09:17,485 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:09:17,485 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:09:17,485 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:09:17,485 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:09:17,485 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:09:17,486 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:09:17,487 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:09:17,487 INFO: Model [FSLLModel] is created.
2022-10-31 21:09:17,493 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:09:17,499 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:09:17,504 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-31 21:09:18,571 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1089, Pos_dist: 8.6502, Neg_dist: 12.5619, Acc: 0.7733, PTFixPNLoss: 4.0363, NetFixLoss: 0.0000, ]
2022-10-31 21:09:19,700 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3410, Pos_dist: 8.7185, Neg_dist: 11.3955, Acc: 0.7600, PTFixPNLoss: 4.0367, NetFixLoss: 0.7315, ]
2022-10-31 21:09:20,984 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2486, Pos_dist: 8.6592, Neg_dist: 11.3519, Acc: 0.8267, PTFixPNLoss: 4.0405, NetFixLoss: 2.3658, ]
2022-10-31 21:09:22,116 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.6771, Pos_dist: 8.7202, Neg_dist: 10.5359, Acc: 0.7333, PTFixPNLoss: 4.0410, NetFixLoss: 4.5072, ]
2022-10-31 21:09:23,258 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3180, Pos_dist: 8.7513, Neg_dist: 11.4599, Acc: 0.7600, PTFixPNLoss: 4.0380, NetFixLoss: 7.1158, ]
2022-10-31 21:09:23,873 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3091, Pos_dist: 8.9299, Neg_dist: 11.6822, Acc: 0.7333, PTFixPNLoss: 4.0444, NetFixLoss: 9.9793, ]
2022-10-31 21:09:25,006 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1583, Pos_dist: 8.7768, Neg_dist: 12.1264, Acc: 0.7067, PTFixPNLoss: 4.0342, NetFixLoss: 12.9342, ]
2022-10-31 21:09:26,179 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4096, Pos_dist: 8.7435, Neg_dist: 11.1562, Acc: 0.8133, PTFixPNLoss: 4.0367, NetFixLoss: 16.0122, ]
2022-10-31 21:09:27,325 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2278, Pos_dist: 8.6326, Neg_dist: 11.4292, Acc: 0.7067, PTFixPNLoss: 4.0368, NetFixLoss: 19.0676, ]
2022-10-31 21:09:28,628 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4702, Pos_dist: 8.7310, Neg_dist: 11.0093, Acc: 0.8000, PTFixPNLoss: 4.0397, NetFixLoss: 22.2205, ]
2022-10-31 21:09:29,909 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2419, Pos_dist: 8.7019, Neg_dist: 11.5203, Acc: 0.8133, PTFixPNLoss: 4.0344, NetFixLoss: 25.4399, ]
2022-10-31 21:09:31,037 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3903, Pos_dist: 8.7172, Neg_dist: 11.5680, Acc: 0.7467, PTFixPNLoss: 4.0376, NetFixLoss: 28.5660, ]
2022-10-31 21:09:32,169 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4027, Pos_dist: 8.6092, Neg_dist: 11.1186, Acc: 0.7600, PTFixPNLoss: 4.0326, NetFixLoss: 31.6803, ]
2022-10-31 21:09:33,296 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1838, Pos_dist: 8.8021, Neg_dist: 11.9470, Acc: 0.7333, PTFixPNLoss: 4.0365, NetFixLoss: 34.8084, ]
2022-10-31 21:09:34,455 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3120, Pos_dist: 8.6360, Neg_dist: 11.2953, Acc: 0.8400, PTFixPNLoss: 4.0279, NetFixLoss: 37.9684, ]
2022-10-31 21:09:34,551 INFO: fine-tune procedure is finished!
2022-10-31 21:10:27,642 INFO: [Test_acc of task 3 on test 0: 0.50280][acc of former classes: 0.61133][acc of former samples in all classes: 0.59750]
[acc of novel samples in all classes: 0.12400]
2022-10-31 21:10:27,928 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:10:27,957 WARNING: Current net - loaded net:
2022-10-31 21:10:27,957 WARNING: Loaded net - current net:
2022-10-31 21:10:27,957 WARNING:   func.classifier.bias
2022-10-31 21:10:27,957 WARNING:   func.classifier.weight
2022-10-31 21:10:27,981 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_3.pth.
2022-10-31 21:10:28,040 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:10:28,167 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:10:28,168 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:10:28,168 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:10:28,168 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:10:28,168 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:10:28,168 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:10:28,168 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:10:28,169 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:10:28,170 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:10:28,170 INFO: Model [FSLLModel] is created.
2022-10-31 21:10:28,176 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:10:28,182 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:10:28,187 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:10:28,193 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 21:10:29,488 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4801, Pos_dist: 8.7419, Neg_dist: 11.0231, Acc: 0.8400, PTFixPNLoss: 4.0941, NetFixLoss: 0.0000, ]
2022-10-31 21:10:30,848 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3661, Pos_dist: 8.7615, Neg_dist: 11.1886, Acc: 0.7600, PTFixPNLoss: 4.1008, NetFixLoss: 1.7612, ]
2022-10-31 21:10:32,229 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3970, Pos_dist: 8.8132, Neg_dist: 11.5247, Acc: 0.7500, PTFixPNLoss: 4.1083, NetFixLoss: 3.9724, ]
2022-10-31 21:10:33,982 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4770, Pos_dist: 8.7205, Neg_dist: 11.2392, Acc: 0.7900, PTFixPNLoss: 4.1022, NetFixLoss: 6.4370, ]
2022-10-31 21:10:35,421 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1894, Pos_dist: 8.6094, Neg_dist: 11.7807, Acc: 0.7800, PTFixPNLoss: 4.0923, NetFixLoss: 9.1118, ]
2022-10-31 21:10:36,869 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3245, Pos_dist: 8.7589, Neg_dist: 11.6343, Acc: 0.7500, PTFixPNLoss: 4.1000, NetFixLoss: 11.8943, ]
2022-10-31 21:10:38,313 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3449, Pos_dist: 8.6302, Neg_dist: 11.1382, Acc: 0.8000, PTFixPNLoss: 4.0996, NetFixLoss: 14.7801, ]
2022-10-31 21:10:39,822 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3546, Pos_dist: 8.6381, Neg_dist: 11.2798, Acc: 0.8400, PTFixPNLoss: 4.0937, NetFixLoss: 17.8156, ]
2022-10-31 21:10:41,272 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4405, Pos_dist: 8.6137, Neg_dist: 11.1352, Acc: 0.8000, PTFixPNLoss: 4.0978, NetFixLoss: 20.8613, ]
2022-10-31 21:10:42,804 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3724, Pos_dist: 8.7128, Neg_dist: 11.2601, Acc: 0.7400, PTFixPNLoss: 4.0960, NetFixLoss: 23.9039, ]
2022-10-31 21:10:43,758 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4870, Pos_dist: 8.7187, Neg_dist: 11.3717, Acc: 0.7400, PTFixPNLoss: 4.0961, NetFixLoss: 26.9600, ]
2022-10-31 21:10:45,234 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3329, Pos_dist: 8.6745, Neg_dist: 11.6547, Acc: 0.8100, PTFixPNLoss: 4.1000, NetFixLoss: 30.0109, ]
2022-10-31 21:10:46,699 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2434, Pos_dist: 8.7094, Neg_dist: 11.7954, Acc: 0.7600, PTFixPNLoss: 4.1030, NetFixLoss: 33.0962, ]
2022-10-31 21:10:48,235 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4490, Pos_dist: 8.6934, Neg_dist: 11.2428, Acc: 0.7800, PTFixPNLoss: 4.0939, NetFixLoss: 36.1599, ]
2022-10-31 21:10:49,694 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3937, Pos_dist: 8.6101, Neg_dist: 11.2542, Acc: 0.8100, PTFixPNLoss: 4.0962, NetFixLoss: 39.2009, ]
2022-10-31 21:10:49,765 INFO: fine-tune procedure is finished!
2022-10-31 21:11:45,513 INFO: [Test_acc of task 4 on test 0: 0.48187][acc of former classes: 0.61783][acc of former samples in all classes: 0.59767]
[acc of novel samples in all classes: 0.13450]
2022-10-31 21:11:45,800 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:11:45,829 WARNING: Current net - loaded net:
2022-10-31 21:11:45,830 WARNING: Loaded net - current net:
2022-10-31 21:11:45,830 WARNING:   func.classifier.bias
2022-10-31 21:11:45,830 WARNING:   func.classifier.weight
2022-10-31 21:11:45,861 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_4.pth.
2022-10-31 21:11:45,918 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:11:45,944 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:11:45,944 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:11:45,944 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:11:45,944 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:11:45,944 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:11:45,944 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:11:45,945 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:11:45,946 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:11:45,947 INFO: Model [FSLLModel] is created.
2022-10-31 21:11:45,953 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:11:45,959 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:11:45,964 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:11:45,970 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:11:45,975 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-31 21:11:47,553 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2160, Pos_dist: 8.5759, Neg_dist: 11.7243, Acc: 0.8080, PTFixPNLoss: 4.1560, NetFixLoss: 0.0000, ]
2022-10-31 21:11:49,294 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2792, Pos_dist: 8.6170, Neg_dist: 11.2825, Acc: 0.8160, PTFixPNLoss: 4.1633, NetFixLoss: 1.1554, ]
2022-10-31 21:11:50,932 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1675, Pos_dist: 8.6691, Neg_dist: 12.7787, Acc: 0.7680, PTFixPNLoss: 4.1568, NetFixLoss: 2.8559, ]
2022-10-31 21:11:52,591 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5179, Pos_dist: 8.5866, Neg_dist: 10.7742, Acc: 0.8000, PTFixPNLoss: 4.1590, NetFixLoss: 4.7805, ]
2022-10-31 21:11:54,235 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2904, Pos_dist: 8.7675, Neg_dist: 11.4884, Acc: 0.7920, PTFixPNLoss: 4.1612, NetFixLoss: 6.9887, ]
2022-10-31 21:11:55,855 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2523, Pos_dist: 8.7372, Neg_dist: 12.1888, Acc: 0.7200, PTFixPNLoss: 4.1616, NetFixLoss: 9.4279, ]
2022-10-31 21:11:57,614 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2684, Pos_dist: 8.7693, Neg_dist: 12.2034, Acc: 0.7360, PTFixPNLoss: 4.1604, NetFixLoss: 11.9763, ]
2022-10-31 21:11:59,277 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4293, Pos_dist: 8.6484, Neg_dist: 11.1113, Acc: 0.7600, PTFixPNLoss: 4.1595, NetFixLoss: 14.5612, ]
2022-10-31 21:12:01,031 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4765, Pos_dist: 8.7215, Neg_dist: 11.1405, Acc: 0.7920, PTFixPNLoss: 4.1659, NetFixLoss: 17.2133, ]
2022-10-31 21:12:02,893 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1522, Pos_dist: 8.5460, Neg_dist: 12.3033, Acc: 0.8080, PTFixPNLoss: 4.1547, NetFixLoss: 19.9052, ]
2022-10-31 21:12:04,611 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4595, Pos_dist: 8.6361, Neg_dist: 10.9264, Acc: 0.7440, PTFixPNLoss: 4.1632, NetFixLoss: 22.6035, ]
2022-10-31 21:12:06,276 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2054, Pos_dist: 8.7239, Neg_dist: 11.9204, Acc: 0.7680, PTFixPNLoss: 4.1596, NetFixLoss: 25.4117, ]
2022-10-31 21:12:08,222 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3151, Pos_dist: 8.6139, Neg_dist: 11.2324, Acc: 0.7920, PTFixPNLoss: 4.1600, NetFixLoss: 28.1567, ]
2022-10-31 21:12:09,906 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2296, Pos_dist: 8.6160, Neg_dist: 11.4778, Acc: 0.7840, PTFixPNLoss: 4.1549, NetFixLoss: 30.9088, ]
2022-10-31 21:12:11,754 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1832, Pos_dist: 8.6271, Neg_dist: 11.9028, Acc: 0.7680, PTFixPNLoss: 4.1587, NetFixLoss: 33.6123, ]
2022-10-31 21:12:11,835 INFO: fine-tune procedure is finished!
2022-10-31 21:13:09,950 INFO: [Test_acc of task 5 on test 0: 0.45365][acc of former classes: 0.61200][acc of former samples in all classes: 0.58733]
[acc of novel samples in all classes: 0.13280]
2022-10-31 21:13:10,242 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:13:10,272 WARNING: Current net - loaded net:
2022-10-31 21:13:10,273 WARNING: Loaded net - current net:
2022-10-31 21:13:10,273 WARNING:   func.classifier.bias
2022-10-31 21:13:10,273 WARNING:   func.classifier.weight
2022-10-31 21:13:10,303 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_5.pth.
2022-10-31 21:13:10,361 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:13:10,386 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:13:10,386 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:13:10,386 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:13:10,386 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:13:10,386 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:13:10,387 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:13:10,387 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:13:10,388 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:13:10,389 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:13:10,389 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:13:10,389 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:13:10,389 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:13:10,389 INFO: Model [FSLLModel] is created.
2022-10-31 21:13:10,395 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:13:10,400 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:13:10,406 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:13:10,411 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:13:10,417 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:13:10,422 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 21:13:12,239 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2498, Pos_dist: 8.5297, Neg_dist: 11.4318, Acc: 0.8600, PTFixPNLoss: 4.2069, NetFixLoss: 0.0000, ]
2022-10-31 21:13:14,261 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2624, Pos_dist: 8.6345, Neg_dist: 11.6587, Acc: 0.7667, PTFixPNLoss: 4.2200, NetFixLoss: 1.2760, ]
2022-10-31 21:13:16,338 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2526, Pos_dist: 8.6823, Neg_dist: 11.7514, Acc: 0.7467, PTFixPNLoss: 4.2190, NetFixLoss: 2.8033, ]
2022-10-31 21:13:18,407 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1473, Pos_dist: 8.6117, Neg_dist: 12.1305, Acc: 0.8200, PTFixPNLoss: 4.2181, NetFixLoss: 4.5968, ]
2022-10-31 21:13:20,322 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2246, Pos_dist: 8.5783, Neg_dist: 11.8146, Acc: 0.8200, PTFixPNLoss: 4.2151, NetFixLoss: 6.4892, ]
2022-10-31 21:13:23,029 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2203, Pos_dist: 8.5975, Neg_dist: 11.6505, Acc: 0.8133, PTFixPNLoss: 4.2133, NetFixLoss: 8.4932, ]
2022-10-31 21:13:24,999 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4281, Pos_dist: 8.7442, Neg_dist: 11.3055, Acc: 0.7533, PTFixPNLoss: 4.2206, NetFixLoss: 10.5971, ]
2022-10-31 21:13:26,934 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3125, Pos_dist: 8.6451, Neg_dist: 11.3725, Acc: 0.7667, PTFixPNLoss: 4.2184, NetFixLoss: 12.8909, ]
2022-10-31 21:13:28,955 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3312, Pos_dist: 8.6084, Neg_dist: 11.2912, Acc: 0.8133, PTFixPNLoss: 4.2158, NetFixLoss: 15.3648, ]
2022-10-31 21:13:30,983 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2984, Pos_dist: 8.7032, Neg_dist: 11.5923, Acc: 0.7733, PTFixPNLoss: 4.2206, NetFixLoss: 17.9495, ]
2022-10-31 21:13:32,817 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1732, Pos_dist: 8.6019, Neg_dist: 11.9349, Acc: 0.8533, PTFixPNLoss: 4.2120, NetFixLoss: 20.6499, ]
2022-10-31 21:13:34,787 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2544, Pos_dist: 8.5445, Neg_dist: 11.5709, Acc: 0.8133, PTFixPNLoss: 4.2123, NetFixLoss: 23.3663, ]
2022-10-31 21:13:36,750 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1909, Pos_dist: 8.6112, Neg_dist: 11.7644, Acc: 0.7600, PTFixPNLoss: 4.2167, NetFixLoss: 26.0500, ]
2022-10-31 21:13:38,837 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2690, Pos_dist: 8.6240, Neg_dist: 12.4794, Acc: 0.7933, PTFixPNLoss: 4.2127, NetFixLoss: 28.6902, ]
2022-10-31 21:13:40,839 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3573, Pos_dist: 8.6946, Neg_dist: 11.2184, Acc: 0.7333, PTFixPNLoss: 4.2205, NetFixLoss: 31.3072, ]
2022-10-31 21:13:40,915 INFO: fine-tune procedure is finished!
2022-10-31 21:14:41,561 INFO: [Test_acc of task 6 on test 0: 0.43400][acc of former classes: 0.61633][acc of former samples in all classes: 0.58850]
[acc of novel samples in all classes: 0.12500]
2022-10-31 21:14:41,850 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:14:41,879 WARNING: Current net - loaded net:
2022-10-31 21:14:41,879 WARNING: Loaded net - current net:
2022-10-31 21:14:41,880 WARNING:   func.classifier.bias
2022-10-31 21:14:41,880 WARNING:   func.classifier.weight
2022-10-31 21:14:41,910 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_6.pth.
2022-10-31 21:14:41,968 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:14:41,992 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:14:41,992 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:14:41,992 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:14:41,992 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:14:41,992 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:14:41,992 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:14:41,992 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:14:41,993 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:14:41,994 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:14:41,994 INFO: Model [FSLLModel] is created.
2022-10-31 21:14:42,001 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:14:42,006 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:14:42,012 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:14:42,017 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:14:42,023 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:14:42,028 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:14:42,033 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-31 21:14:44,116 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2281, Pos_dist: 8.6070, Neg_dist: 11.6237, Acc: 0.7371, PTFixPNLoss: 4.2738, NetFixLoss: 0.0000, ]
2022-10-31 21:14:46,379 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4595, Pos_dist: 8.5238, Neg_dist: 10.7918, Acc: 0.8114, PTFixPNLoss: 4.2687, NetFixLoss: 1.1225, ]
2022-10-31 21:14:48,694 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2420, Pos_dist: 8.6434, Neg_dist: 11.5598, Acc: 0.7543, PTFixPNLoss: 4.2712, NetFixLoss: 2.8192, ]
2022-10-31 21:14:50,955 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1217, Pos_dist: 8.5835, Neg_dist: 12.1454, Acc: 0.7657, PTFixPNLoss: 4.2655, NetFixLoss: 4.8533, ]
2022-10-31 21:14:53,198 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3075, Pos_dist: 8.6801, Neg_dist: 11.7635, Acc: 0.7429, PTFixPNLoss: 4.2706, NetFixLoss: 6.9663, ]
2022-10-31 21:14:55,406 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2421, Pos_dist: 8.6292, Neg_dist: 11.5670, Acc: 0.7829, PTFixPNLoss: 4.2720, NetFixLoss: 9.1910, ]
2022-10-31 21:14:57,877 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2165, Pos_dist: 8.6176, Neg_dist: 11.8452, Acc: 0.7429, PTFixPNLoss: 4.2777, NetFixLoss: 11.5639, ]
2022-10-31 21:14:59,921 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1249, Pos_dist: 8.5924, Neg_dist: 11.9859, Acc: 0.8057, PTFixPNLoss: 4.2717, NetFixLoss: 13.9549, ]
2022-10-31 21:15:02,042 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1870, Pos_dist: 8.6426, Neg_dist: 11.9341, Acc: 0.7771, PTFixPNLoss: 4.2742, NetFixLoss: 16.3768, ]
2022-10-31 21:15:04,137 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2903, Pos_dist: 8.6609, Neg_dist: 11.5079, Acc: 0.8286, PTFixPNLoss: 4.2704, NetFixLoss: 18.7824, ]
2022-10-31 21:15:06,256 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2951, Pos_dist: 8.5955, Neg_dist: 11.2819, Acc: 0.7886, PTFixPNLoss: 4.2745, NetFixLoss: 21.1995, ]
2022-10-31 21:15:08,314 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2095, Pos_dist: 8.7307, Neg_dist: 12.1732, Acc: 0.7657, PTFixPNLoss: 4.2716, NetFixLoss: 23.6810, ]
2022-10-31 21:15:10,467 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3728, Pos_dist: 8.6193, Neg_dist: 11.3401, Acc: 0.8000, PTFixPNLoss: 4.2690, NetFixLoss: 26.1681, ]
2022-10-31 21:15:12,549 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1149, Pos_dist: 8.6335, Neg_dist: 12.0337, Acc: 0.7771, PTFixPNLoss: 4.2741, NetFixLoss: 28.6716, ]
2022-10-31 21:15:14,738 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1619, Pos_dist: 8.5710, Neg_dist: 12.0179, Acc: 0.7657, PTFixPNLoss: 4.2690, NetFixLoss: 31.2271, ]
2022-10-31 21:15:14,825 INFO: fine-tune procedure is finished!
2022-10-31 21:16:18,089 INFO: [Test_acc of task 7 on test 0: 0.42042][acc of former classes: 0.61683][acc of former samples in all classes: 0.58533]
[acc of novel samples in all classes: 0.13771]
2022-10-31 21:16:18,376 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:16:18,406 WARNING: Current net - loaded net:
2022-10-31 21:16:18,406 WARNING: Loaded net - current net:
2022-10-31 21:16:18,406 WARNING:   func.classifier.bias
2022-10-31 21:16:18,406 WARNING:   func.classifier.weight
2022-10-31 21:16:18,436 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_7.pth.
2022-10-31 21:16:18,498 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:16:18,528 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:16:18,528 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:16:18,528 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:16:18,528 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:16:18,528 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:16:18,528 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:16:18,528 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:16:18,528 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:16:18,528 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:16:18,528 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:16:18,528 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:16:18,529 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:16:18,530 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:16:18,531 INFO: Model [FSLLModel] is created.
2022-10-31 21:16:18,537 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:16:18,542 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:16:18,548 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:16:18,553 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:16:18,559 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:16:18,564 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:16:18,570 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:16:18,575 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 21:16:20,948 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2353, Pos_dist: 8.6323, Neg_dist: 12.0905, Acc: 0.7700, PTFixPNLoss: 4.3149, NetFixLoss: 0.0000, ]
2022-10-31 21:16:23,352 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1595, Pos_dist: 8.4865, Neg_dist: 11.9492, Acc: 0.8050, PTFixPNLoss: 4.3102, NetFixLoss: 0.9762, ]
2022-10-31 21:16:25,907 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2673, Pos_dist: 8.5784, Neg_dist: 11.8686, Acc: 0.7650, PTFixPNLoss: 4.3214, NetFixLoss: 2.1888, ]
2022-10-31 21:16:28,269 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1357, Pos_dist: 8.6712, Neg_dist: 12.3267, Acc: 0.7100, PTFixPNLoss: 4.3196, NetFixLoss: 3.6123, ]
2022-10-31 21:16:30,666 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2688, Pos_dist: 8.5951, Neg_dist: 11.6418, Acc: 0.7350, PTFixPNLoss: 4.3193, NetFixLoss: 5.1501, ]
2022-10-31 21:16:33,072 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2900, Pos_dist: 8.6866, Neg_dist: 11.7064, Acc: 0.7750, PTFixPNLoss: 4.3235, NetFixLoss: 6.9117, ]
2022-10-31 21:16:35,464 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1856, Pos_dist: 8.5896, Neg_dist: 11.9028, Acc: 0.7900, PTFixPNLoss: 4.3192, NetFixLoss: 8.8539, ]
2022-10-31 21:16:37,890 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4102, Pos_dist: 8.6065, Neg_dist: 11.0330, Acc: 0.8150, PTFixPNLoss: 4.3163, NetFixLoss: 10.9040, ]
2022-10-31 21:16:40,313 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2760, Pos_dist: 8.6126, Neg_dist: 11.5975, Acc: 0.7800, PTFixPNLoss: 4.3226, NetFixLoss: 13.1198, ]
2022-10-31 21:16:42,711 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1092, Pos_dist: 8.6157, Neg_dist: 12.5347, Acc: 0.8150, PTFixPNLoss: 4.3150, NetFixLoss: 15.4123, ]
2022-10-31 21:16:45,208 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2038, Pos_dist: 8.5618, Neg_dist: 11.6764, Acc: 0.8000, PTFixPNLoss: 4.3195, NetFixLoss: 17.7070, ]
2022-10-31 21:16:47,165 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4884, Pos_dist: 8.5310, Neg_dist: 10.7997, Acc: 0.7800, PTFixPNLoss: 4.3155, NetFixLoss: 19.9718, ]
2022-10-31 21:16:49,823 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1563, Pos_dist: 8.5963, Neg_dist: 12.6664, Acc: 0.7400, PTFixPNLoss: 4.3141, NetFixLoss: 22.3716, ]
2022-10-31 21:16:52,626 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1367, Pos_dist: 8.4963, Neg_dist: 12.2776, Acc: 0.7800, PTFixPNLoss: 4.3134, NetFixLoss: 24.7614, ]
2022-10-31 21:16:55,073 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2549, Pos_dist: 8.6235, Neg_dist: 11.4769, Acc: 0.8000, PTFixPNLoss: 4.3141, NetFixLoss: 27.1025, ]
2022-10-31 21:16:55,148 INFO: fine-tune procedure is finished!
2022-10-31 21:18:00,718 INFO: [Test_acc of task 8 on test 0: 0.41330][acc of former classes: 0.62600][acc of former samples in all classes: 0.59067]
[acc of novel samples in all classes: 0.14725]
2022-10-31 21:18:01,007 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:18:01,035 WARNING: Current net - loaded net:
2022-10-31 21:18:01,035 WARNING: Loaded net - current net:
2022-10-31 21:18:01,036 WARNING:   func.classifier.bias
2022-10-31 21:18:01,036 WARNING:   func.classifier.weight
2022-10-31 21:18:01,066 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-10-31 21:18:01,127 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:18:01,152 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:18:01,152 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:18:01,152 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:18:01,153 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:18:01,153 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:18:01,153 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:18:01,153 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:18:01,154 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:18:01,155 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:18:01,155 INFO: Model [FSLLModel] is created.
2022-10-31 21:18:01,161 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-31 21:18:01,730 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2941, Pos_dist: 8.9805, Neg_dist: 11.8444, Acc: 0.8400, PTFixPNLoss: 3.9196, NetFixLoss: 0.0000, ]
2022-10-31 21:18:02,403 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5471, Pos_dist: 9.0320, Neg_dist: 11.4523, Acc: 0.6800, PTFixPNLoss: 3.9155, NetFixLoss: 1.4032, ]
2022-10-31 21:18:03,072 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4503, Pos_dist: 8.7616, Neg_dist: 10.9902, Acc: 0.8800, PTFixPNLoss: 3.9077, NetFixLoss: 3.4648, ]
2022-10-31 21:18:03,741 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2953, Pos_dist: 8.9331, Neg_dist: 11.6956, Acc: 0.6400, PTFixPNLoss: 3.9171, NetFixLoss: 6.2248, ]
2022-10-31 21:18:04,412 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.5049, Pos_dist: 8.9918, Neg_dist: 11.1093, Acc: 0.6400, PTFixPNLoss: 3.9208, NetFixLoss: 9.3503, ]
2022-10-31 21:18:05,064 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.6604, Pos_dist: 9.1960, Neg_dist: 11.1551, Acc: 0.6000, PTFixPNLoss: 3.9215, NetFixLoss: 12.8377, ]
2022-10-31 21:18:05,880 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.6873, Pos_dist: 9.0970, Neg_dist: 10.9629, Acc: 0.7200, PTFixPNLoss: 3.9164, NetFixLoss: 16.7395, ]
2022-10-31 21:18:06,666 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4097, Pos_dist: 8.9172, Neg_dist: 11.2629, Acc: 0.6400, PTFixPNLoss: 3.9168, NetFixLoss: 20.9444, ]
2022-10-31 21:18:07,424 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4097, Pos_dist: 9.1390, Neg_dist: 11.5382, Acc: 0.8000, PTFixPNLoss: 3.9182, NetFixLoss: 25.4192, ]
2022-10-31 21:18:08,247 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3669, Pos_dist: 8.9959, Neg_dist: 11.5539, Acc: 0.6800, PTFixPNLoss: 3.9215, NetFixLoss: 30.1560, ]
2022-10-31 21:18:09,001 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4289, Pos_dist: 9.0600, Neg_dist: 11.5297, Acc: 0.7600, PTFixPNLoss: 3.9166, NetFixLoss: 34.8720, ]
2022-10-31 21:18:09,841 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2496, Pos_dist: 8.9434, Neg_dist: 11.5761, Acc: 0.7600, PTFixPNLoss: 3.9137, NetFixLoss: 39.4401, ]
2022-10-31 21:18:10,699 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4289, Pos_dist: 8.8370, Neg_dist: 11.6262, Acc: 0.8000, PTFixPNLoss: 3.9189, NetFixLoss: 43.9503, ]
2022-10-31 21:18:11,350 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3049, Pos_dist: 8.8581, Neg_dist: 11.7935, Acc: 0.7600, PTFixPNLoss: 3.9159, NetFixLoss: 48.3583, ]
2022-10-31 21:18:12,171 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.6405, Pos_dist: 8.9285, Neg_dist: 10.9861, Acc: 0.6800, PTFixPNLoss: 3.9198, NetFixLoss: 52.7937, ]
2022-10-31 21:18:12,242 INFO: fine-tune procedure is finished!
2022-10-31 21:18:59,973 INFO: [Test_acc of task 1 on test 1: 0.56923][acc of former classes: 0.61633][acc of former samples in all classes: 0.61133]
[acc of novel samples in all classes: 0.06400]
2022-10-31 21:19:00,267 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:19:00,298 WARNING: Current net - loaded net:
2022-10-31 21:19:00,298 WARNING: Loaded net - current net:
2022-10-31 21:19:00,299 WARNING:   func.classifier.bias
2022-10-31 21:19:00,299 WARNING:   func.classifier.weight
2022-10-31 21:19:00,329 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_1.pth.
2022-10-31 21:19:00,384 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:19:00,473 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:19:00,474 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:19:00,474 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:19:00,474 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:19:00,474 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:19:00,474 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:19:00,474 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:19:00,475 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:19:00,476 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:19:00,476 INFO: Model [FSLLModel] is created.
2022-10-31 21:19:00,482 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:19:00,488 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 21:19:01,267 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.9718, Pos_dist: 8.9198, Neg_dist: 10.2387, Acc: 0.8000, PTFixPNLoss: 3.9838, NetFixLoss: 0.0000, ]
2022-10-31 21:19:02,360 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5033, Pos_dist: 8.7925, Neg_dist: 11.5464, Acc: 0.7800, PTFixPNLoss: 3.9801, NetFixLoss: 2.1582, ]
2022-10-31 21:19:03,263 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3395, Pos_dist: 8.9698, Neg_dist: 11.7518, Acc: 0.7000, PTFixPNLoss: 3.9839, NetFixLoss: 4.7470, ]
2022-10-31 21:19:04,172 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4035, Pos_dist: 8.8288, Neg_dist: 11.8267, Acc: 0.7000, PTFixPNLoss: 3.9776, NetFixLoss: 7.6345, ]
2022-10-31 21:19:05,137 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3876, Pos_dist: 8.9435, Neg_dist: 11.7158, Acc: 0.6400, PTFixPNLoss: 3.9787, NetFixLoss: 10.6858, ]
2022-10-31 21:19:06,182 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3921, Pos_dist: 8.8149, Neg_dist: 11.1485, Acc: 0.7200, PTFixPNLoss: 3.9731, NetFixLoss: 13.8413, ]
2022-10-31 21:19:07,272 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2697, Pos_dist: 8.7237, Neg_dist: 11.6157, Acc: 0.8000, PTFixPNLoss: 3.9716, NetFixLoss: 17.2232, ]
2022-10-31 21:19:07,884 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2990, Pos_dist: 8.8504, Neg_dist: 11.7030, Acc: 0.7400, PTFixPNLoss: 3.9743, NetFixLoss: 20.6489, ]
2022-10-31 21:19:08,962 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4396, Pos_dist: 8.8243, Neg_dist: 11.0746, Acc: 0.7600, PTFixPNLoss: 3.9752, NetFixLoss: 24.0233, ]
2022-10-31 21:19:09,953 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4247, Pos_dist: 8.8129, Neg_dist: 11.4091, Acc: 0.7000, PTFixPNLoss: 3.9758, NetFixLoss: 27.4645, ]
2022-10-31 21:19:10,944 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3133, Pos_dist: 8.9130, Neg_dist: 11.7626, Acc: 0.7400, PTFixPNLoss: 3.9826, NetFixLoss: 30.9698, ]
2022-10-31 21:19:11,984 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4630, Pos_dist: 8.7992, Neg_dist: 11.1604, Acc: 0.8400, PTFixPNLoss: 3.9743, NetFixLoss: 34.5347, ]
2022-10-31 21:19:13,023 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3182, Pos_dist: 9.0169, Neg_dist: 11.7476, Acc: 0.6800, PTFixPNLoss: 3.9822, NetFixLoss: 38.1653, ]
2022-10-31 21:19:14,064 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4107, Pos_dist: 8.7782, Neg_dist: 11.4823, Acc: 0.7600, PTFixPNLoss: 3.9726, NetFixLoss: 41.8703, ]
2022-10-31 21:19:15,141 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3168, Pos_dist: 8.8743, Neg_dist: 12.1462, Acc: 0.7200, PTFixPNLoss: 3.9725, NetFixLoss: 45.5799, ]
2022-10-31 21:19:15,236 INFO: fine-tune procedure is finished!
2022-10-31 21:20:05,401 INFO: [Test_acc of task 2 on test 1: 0.52600][acc of former classes: 0.61050][acc of former samples in all classes: 0.60100]
[acc of novel samples in all classes: 0.07600]
2022-10-31 21:20:05,692 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:20:05,722 WARNING: Current net - loaded net:
2022-10-31 21:20:05,722 WARNING: Loaded net - current net:
2022-10-31 21:20:05,723 WARNING:   func.classifier.bias
2022-10-31 21:20:05,723 WARNING:   func.classifier.weight
2022-10-31 21:20:05,751 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_2.pth.
2022-10-31 21:20:05,808 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:20:05,833 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:20:05,833 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:20:05,833 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:20:05,833 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:20:05,833 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:20:05,833 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:20:05,833 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:20:05,834 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:20:05,835 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:20:05,835 INFO: Model [FSLLModel] is created.
2022-10-31 21:20:05,842 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:20:05,847 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:20:05,853 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-31 21:20:06,930 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2921, Pos_dist: 8.6823, Neg_dist: 11.4417, Acc: 0.7200, PTFixPNLoss: 4.0368, NetFixLoss: 0.0000, ]
2022-10-31 21:20:08,078 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3850, Pos_dist: 8.9008, Neg_dist: 11.4001, Acc: 0.7600, PTFixPNLoss: 4.0428, NetFixLoss: 1.3442, ]
2022-10-31 21:20:09,334 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2197, Pos_dist: 8.8059, Neg_dist: 11.8290, Acc: 0.7067, PTFixPNLoss: 4.0399, NetFixLoss: 3.2554, ]
2022-10-31 21:20:10,519 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3673, Pos_dist: 8.8773, Neg_dist: 11.5875, Acc: 0.7467, PTFixPNLoss: 4.0399, NetFixLoss: 5.4736, ]
2022-10-31 21:20:11,654 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4303, Pos_dist: 8.7688, Neg_dist: 11.0175, Acc: 0.7733, PTFixPNLoss: 4.0430, NetFixLoss: 7.9628, ]
2022-10-31 21:20:12,978 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2490, Pos_dist: 8.7991, Neg_dist: 11.5806, Acc: 0.7600, PTFixPNLoss: 4.0409, NetFixLoss: 10.7821, ]
2022-10-31 21:20:14,164 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.0810, Pos_dist: 8.7923, Neg_dist: 12.8717, Acc: 0.6667, PTFixPNLoss: 4.0451, NetFixLoss: 13.8027, ]
2022-10-31 21:20:15,372 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3349, Pos_dist: 8.7984, Neg_dist: 11.3538, Acc: 0.8000, PTFixPNLoss: 4.0446, NetFixLoss: 16.8024, ]
2022-10-31 21:20:16,586 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2377, Pos_dist: 8.7898, Neg_dist: 11.5955, Acc: 0.7067, PTFixPNLoss: 4.0393, NetFixLoss: 19.8034, ]
2022-10-31 21:20:17,743 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.6021, Pos_dist: 8.8087, Neg_dist: 10.9937, Acc: 0.7067, PTFixPNLoss: 4.0411, NetFixLoss: 22.7829, ]
2022-10-31 21:20:18,903 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2974, Pos_dist: 8.7161, Neg_dist: 11.6155, Acc: 0.7200, PTFixPNLoss: 4.0362, NetFixLoss: 25.8342, ]
2022-10-31 21:20:20,088 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2983, Pos_dist: 8.8182, Neg_dist: 11.2025, Acc: 0.7333, PTFixPNLoss: 4.0416, NetFixLoss: 28.9513, ]
2022-10-31 21:20:21,334 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.5427, Pos_dist: 8.8481, Neg_dist: 10.9877, Acc: 0.7333, PTFixPNLoss: 4.0370, NetFixLoss: 32.0776, ]
2022-10-31 21:20:22,488 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3120, Pos_dist: 8.8560, Neg_dist: 11.6931, Acc: 0.7200, PTFixPNLoss: 4.0414, NetFixLoss: 35.2435, ]
2022-10-31 21:20:23,648 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3976, Pos_dist: 8.8307, Neg_dist: 11.7056, Acc: 0.6933, PTFixPNLoss: 4.0416, NetFixLoss: 38.3858, ]
2022-10-31 21:20:23,742 INFO: fine-tune procedure is finished!
2022-10-31 21:21:16,868 INFO: [Test_acc of task 3 on test 1: 0.49960][acc of former classes: 0.61750][acc of former samples in all classes: 0.60267]
[acc of novel samples in all classes: 0.08733]
2022-10-31 21:21:17,162 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:21:17,191 WARNING: Current net - loaded net:
2022-10-31 21:21:17,191 WARNING: Loaded net - current net:
2022-10-31 21:21:17,191 WARNING:   func.classifier.bias
2022-10-31 21:21:17,191 WARNING:   func.classifier.weight
2022-10-31 21:21:17,219 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_3.pth.
2022-10-31 21:21:17,268 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:21:17,294 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:21:17,294 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:21:17,294 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:21:17,294 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:21:17,294 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:21:17,295 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:21:17,295 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:21:17,296 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:21:17,297 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:21:17,297 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:21:17,297 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:21:17,297 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:21:17,297 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:21:17,297 INFO: Model [FSLLModel] is created.
2022-10-31 21:21:17,305 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:21:17,310 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:21:17,316 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:21:17,322 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 21:21:18,678 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3990, Pos_dist: 8.8780, Neg_dist: 11.6191, Acc: 0.6800, PTFixPNLoss: 4.1046, NetFixLoss: 0.0000, ]
2022-10-31 21:21:20,034 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3624, Pos_dist: 8.8174, Neg_dist: 11.2904, Acc: 0.7900, PTFixPNLoss: 4.1028, NetFixLoss: 1.4016, ]
2022-10-31 21:21:21,532 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1583, Pos_dist: 8.8131, Neg_dist: 12.4623, Acc: 0.7400, PTFixPNLoss: 4.1030, NetFixLoss: 3.3780, ]
2022-10-31 21:21:22,963 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3889, Pos_dist: 8.7555, Neg_dist: 11.2132, Acc: 0.8200, PTFixPNLoss: 4.1040, NetFixLoss: 5.5661, ]
2022-10-31 21:21:24,372 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4241, Pos_dist: 8.7920, Neg_dist: 11.3387, Acc: 0.7200, PTFixPNLoss: 4.1036, NetFixLoss: 7.9679, ]
2022-10-31 21:21:25,760 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4153, Pos_dist: 8.9112, Neg_dist: 11.4975, Acc: 0.6800, PTFixPNLoss: 4.1070, NetFixLoss: 10.5924, ]
2022-10-31 21:21:27,156 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.6122, Pos_dist: 8.8239, Neg_dist: 10.7460, Acc: 0.6500, PTFixPNLoss: 4.1084, NetFixLoss: 13.3371, ]
2022-10-31 21:21:28,514 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2874, Pos_dist: 8.7590, Neg_dist: 11.5700, Acc: 0.7400, PTFixPNLoss: 4.1042, NetFixLoss: 16.3487, ]
2022-10-31 21:21:29,932 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2694, Pos_dist: 8.8500, Neg_dist: 11.6709, Acc: 0.7400, PTFixPNLoss: 4.1088, NetFixLoss: 19.4199, ]
2022-10-31 21:21:31,504 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3218, Pos_dist: 8.7950, Neg_dist: 11.6508, Acc: 0.7400, PTFixPNLoss: 4.1059, NetFixLoss: 22.5840, ]
2022-10-31 21:21:33,041 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5490, Pos_dist: 8.7879, Neg_dist: 10.9389, Acc: 0.7700, PTFixPNLoss: 4.1045, NetFixLoss: 25.8582, ]
2022-10-31 21:21:34,488 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2424, Pos_dist: 8.7480, Neg_dist: 11.8154, Acc: 0.7900, PTFixPNLoss: 4.1091, NetFixLoss: 29.1647, ]
2022-10-31 21:21:35,985 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4022, Pos_dist: 8.6603, Neg_dist: 10.9554, Acc: 0.7000, PTFixPNLoss: 4.1012, NetFixLoss: 32.4417, ]
2022-10-31 21:21:37,334 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4097, Pos_dist: 8.7394, Neg_dist: 11.4264, Acc: 0.7900, PTFixPNLoss: 4.0980, NetFixLoss: 35.7061, ]
2022-10-31 21:21:38,896 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3662, Pos_dist: 8.7895, Neg_dist: 11.3523, Acc: 0.7300, PTFixPNLoss: 4.1055, NetFixLoss: 38.9425, ]
2022-10-31 21:21:38,970 INFO: fine-tune procedure is finished!
2022-10-31 21:22:34,631 INFO: [Test_acc of task 4 on test 1: 0.47300][acc of former classes: 0.61733][acc of former samples in all classes: 0.59317]
[acc of novel samples in all classes: 0.11250]
2022-10-31 21:22:34,921 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:22:34,950 WARNING: Current net - loaded net:
2022-10-31 21:22:34,951 WARNING: Loaded net - current net:
2022-10-31 21:22:34,951 WARNING:   func.classifier.bias
2022-10-31 21:22:34,951 WARNING:   func.classifier.weight
2022-10-31 21:22:34,981 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_4.pth.
2022-10-31 21:22:35,038 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:22:35,063 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:22:35,063 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:22:35,063 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:22:35,063 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:22:35,063 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:22:35,063 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:22:35,063 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:22:35,063 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:22:35,064 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:22:35,065 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:22:35,066 INFO: Model [FSLLModel] is created.
2022-10-31 21:22:35,072 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:22:35,077 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:22:35,083 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:22:35,088 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:22:35,093 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-31 21:22:36,672 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3418, Pos_dist: 8.7423, Neg_dist: 11.4559, Acc: 0.7280, PTFixPNLoss: 4.1623, NetFixLoss: 0.0000, ]
2022-10-31 21:22:38,316 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5459, Pos_dist: 8.7595, Neg_dist: 10.8213, Acc: 0.7760, PTFixPNLoss: 4.1618, NetFixLoss: 1.4615, ]
2022-10-31 21:22:39,937 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5070, Pos_dist: 8.6979, Neg_dist: 10.8254, Acc: 0.7360, PTFixPNLoss: 4.1570, NetFixLoss: 3.4659, ]
2022-10-31 21:22:41,534 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.6997, Pos_dist: 8.7455, Neg_dist: 10.4819, Acc: 0.7520, PTFixPNLoss: 4.1644, NetFixLoss: 5.9063, ]
2022-10-31 21:22:43,301 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4120, Pos_dist: 8.6913, Neg_dist: 11.6473, Acc: 0.7280, PTFixPNLoss: 4.1594, NetFixLoss: 8.7328, ]
2022-10-31 21:22:45,171 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3739, Pos_dist: 8.7640, Neg_dist: 11.3534, Acc: 0.7680, PTFixPNLoss: 4.1633, NetFixLoss: 11.6827, ]
2022-10-31 21:22:46,893 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3011, Pos_dist: 8.8043, Neg_dist: 11.5791, Acc: 0.7120, PTFixPNLoss: 4.1592, NetFixLoss: 14.7295, ]
2022-10-31 21:22:48,715 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2262, Pos_dist: 8.7165, Neg_dist: 11.8713, Acc: 0.7680, PTFixPNLoss: 4.1605, NetFixLoss: 17.8198, ]
2022-10-31 21:22:50,151 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1620, Pos_dist: 8.7477, Neg_dist: 12.5897, Acc: 0.7680, PTFixPNLoss: 4.1627, NetFixLoss: 20.8949, ]
2022-10-31 21:22:51,831 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1529, Pos_dist: 8.7793, Neg_dist: 12.3050, Acc: 0.7680, PTFixPNLoss: 4.1624, NetFixLoss: 23.9213, ]
2022-10-31 21:22:53,591 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3492, Pos_dist: 8.7179, Neg_dist: 11.1982, Acc: 0.8160, PTFixPNLoss: 4.1540, NetFixLoss: 26.8854, ]
2022-10-31 21:22:55,409 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4622, Pos_dist: 8.6596, Neg_dist: 10.8761, Acc: 0.7680, PTFixPNLoss: 4.1594, NetFixLoss: 29.7961, ]
2022-10-31 21:22:57,240 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1775, Pos_dist: 8.7053, Neg_dist: 12.2850, Acc: 0.7360, PTFixPNLoss: 4.1574, NetFixLoss: 32.7192, ]
2022-10-31 21:22:59,045 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2975, Pos_dist: 8.7125, Neg_dist: 11.5715, Acc: 0.7520, PTFixPNLoss: 4.1581, NetFixLoss: 35.6334, ]
2022-10-31 21:23:00,680 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4569, Pos_dist: 8.6988, Neg_dist: 10.9774, Acc: 0.7760, PTFixPNLoss: 4.1600, NetFixLoss: 38.5264, ]
2022-10-31 21:23:00,762 INFO: fine-tune procedure is finished!
2022-10-31 21:23:58,740 INFO: [Test_acc of task 5 on test 1: 0.45412][acc of former classes: 0.61817][acc of former samples in all classes: 0.59350]
[acc of novel samples in all classes: 0.11960]
2022-10-31 21:23:59,032 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:23:59,063 WARNING: Current net - loaded net:
2022-10-31 21:23:59,064 WARNING: Loaded net - current net:
2022-10-31 21:23:59,064 WARNING:   func.classifier.bias
2022-10-31 21:23:59,064 WARNING:   func.classifier.weight
2022-10-31 21:23:59,096 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_5.pth.
2022-10-31 21:23:59,155 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:23:59,180 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:23:59,180 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:23:59,180 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:23:59,180 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:23:59,180 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:23:59,180 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:23:59,180 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:23:59,181 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:23:59,182 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:23:59,182 INFO: Model [FSLLModel] is created.
2022-10-31 21:23:59,188 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:23:59,194 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:23:59,199 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:23:59,205 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:23:59,210 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:23:59,216 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 21:24:01,038 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4932, Pos_dist: 8.7286, Neg_dist: 11.0534, Acc: 0.7667, PTFixPNLoss: 4.2202, NetFixLoss: 0.0000, ]
2022-10-31 21:24:03,035 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4032, Pos_dist: 8.8071, Neg_dist: 11.2154, Acc: 0.7600, PTFixPNLoss: 4.2231, NetFixLoss: 1.4250, ]
2022-10-31 21:24:04,955 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4701, Pos_dist: 8.7253, Neg_dist: 10.9532, Acc: 0.7333, PTFixPNLoss: 4.2256, NetFixLoss: 3.5030, ]
2022-10-31 21:24:06,865 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3687, Pos_dist: 8.7122, Neg_dist: 11.2897, Acc: 0.7800, PTFixPNLoss: 4.2211, NetFixLoss: 6.0537, ]
2022-10-31 21:24:08,942 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1850, Pos_dist: 8.7206, Neg_dist: 11.7638, Acc: 0.7333, PTFixPNLoss: 4.2227, NetFixLoss: 8.8618, ]
2022-10-31 21:24:10,909 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2493, Pos_dist: 8.6972, Neg_dist: 12.0527, Acc: 0.7533, PTFixPNLoss: 4.2161, NetFixLoss: 11.7379, ]
2022-10-31 21:24:12,837 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4534, Pos_dist: 8.6772, Neg_dist: 11.2215, Acc: 0.7867, PTFixPNLoss: 4.2219, NetFixLoss: 14.5693, ]
2022-10-31 21:24:14,981 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2732, Pos_dist: 8.7449, Neg_dist: 11.8148, Acc: 0.7467, PTFixPNLoss: 4.2197, NetFixLoss: 17.4039, ]
2022-10-31 21:24:17,039 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3834, Pos_dist: 8.7579, Neg_dist: 11.5191, Acc: 0.6933, PTFixPNLoss: 4.2236, NetFixLoss: 20.2639, ]
2022-10-31 21:24:19,019 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2472, Pos_dist: 8.7595, Neg_dist: 12.0679, Acc: 0.8000, PTFixPNLoss: 4.2188, NetFixLoss: 23.0954, ]
2022-10-31 21:24:20,659 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4069, Pos_dist: 8.6558, Neg_dist: 11.1621, Acc: 0.8133, PTFixPNLoss: 4.2152, NetFixLoss: 25.8943, ]
2022-10-31 21:24:22,548 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2399, Pos_dist: 8.7054, Neg_dist: 11.6404, Acc: 0.8067, PTFixPNLoss: 4.2181, NetFixLoss: 28.6925, ]
2022-10-31 21:24:24,611 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.5530, Pos_dist: 8.8310, Neg_dist: 10.9487, Acc: 0.7133, PTFixPNLoss: 4.2259, NetFixLoss: 31.5072, ]
2022-10-31 21:24:26,552 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4379, Pos_dist: 8.6729, Neg_dist: 11.0052, Acc: 0.7800, PTFixPNLoss: 4.2196, NetFixLoss: 34.4720, ]
2022-10-31 21:24:28,587 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4397, Pos_dist: 8.7994, Neg_dist: 11.2170, Acc: 0.7667, PTFixPNLoss: 4.2222, NetFixLoss: 37.4218, ]
2022-10-31 21:24:28,666 INFO: fine-tune procedure is finished!
2022-10-31 21:25:29,392 INFO: [Test_acc of task 6 on test 1: 0.43733][acc of former classes: 0.62633][acc of former samples in all classes: 0.59583]
[acc of novel samples in all classes: 0.12033]
2022-10-31 21:25:29,686 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:25:29,717 WARNING: Current net - loaded net:
2022-10-31 21:25:29,717 WARNING: Loaded net - current net:
2022-10-31 21:25:29,717 WARNING:   func.classifier.bias
2022-10-31 21:25:29,717 WARNING:   func.classifier.weight
2022-10-31 21:25:29,749 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_6.pth.
2022-10-31 21:25:29,807 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:25:29,832 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:25:29,832 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:25:29,832 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:25:29,832 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:25:29,832 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:25:29,832 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:25:29,832 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:25:29,833 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:25:29,834 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:25:29,835 INFO: Model [FSLLModel] is created.
2022-10-31 21:25:29,841 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:25:29,847 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:25:29,852 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:25:29,857 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:25:29,863 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:25:29,868 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:25:29,874 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-31 21:25:31,983 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2161, Pos_dist: 8.6527, Neg_dist: 12.3530, Acc: 0.7886, PTFixPNLoss: 4.2724, NetFixLoss: 0.0000, ]
2022-10-31 21:25:34,123 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2877, Pos_dist: 8.7070, Neg_dist: 11.3686, Acc: 0.7657, PTFixPNLoss: 4.2731, NetFixLoss: 0.9512, ]
2022-10-31 21:25:36,247 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3227, Pos_dist: 8.6243, Neg_dist: 11.5040, Acc: 0.7314, PTFixPNLoss: 4.2740, NetFixLoss: 2.4947, ]
2022-10-31 21:25:38,730 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3228, Pos_dist: 8.6914, Neg_dist: 11.3733, Acc: 0.7600, PTFixPNLoss: 4.2712, NetFixLoss: 4.4015, ]
2022-10-31 21:25:40,908 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3087, Pos_dist: 8.7434, Neg_dist: 11.3204, Acc: 0.7829, PTFixPNLoss: 4.2741, NetFixLoss: 6.5453, ]
2022-10-31 21:25:43,059 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1999, Pos_dist: 8.7576, Neg_dist: 11.9803, Acc: 0.8057, PTFixPNLoss: 4.2777, NetFixLoss: 8.8812, ]
2022-10-31 21:25:45,262 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3087, Pos_dist: 8.6118, Neg_dist: 11.1117, Acc: 0.8000, PTFixPNLoss: 4.2715, NetFixLoss: 11.3258, ]
2022-10-31 21:25:47,482 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4349, Pos_dist: 8.7160, Neg_dist: 10.9803, Acc: 0.7600, PTFixPNLoss: 4.2736, NetFixLoss: 13.8627, ]
2022-10-31 21:25:49,673 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2563, Pos_dist: 8.6527, Neg_dist: 11.5603, Acc: 0.7714, PTFixPNLoss: 4.2729, NetFixLoss: 16.6584, ]
2022-10-31 21:25:51,831 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4777, Pos_dist: 8.6690, Neg_dist: 10.9074, Acc: 0.7943, PTFixPNLoss: 4.2736, NetFixLoss: 19.5167, ]
2022-10-31 21:25:54,044 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3271, Pos_dist: 8.6368, Neg_dist: 11.2635, Acc: 0.7829, PTFixPNLoss: 4.2744, NetFixLoss: 22.4241, ]
2022-10-31 21:25:56,273 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3443, Pos_dist: 8.5924, Neg_dist: 11.4280, Acc: 0.7600, PTFixPNLoss: 4.2710, NetFixLoss: 25.3442, ]
2022-10-31 21:25:58,487 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3247, Pos_dist: 8.7192, Neg_dist: 11.4678, Acc: 0.7771, PTFixPNLoss: 4.2762, NetFixLoss: 28.3017, ]
2022-10-31 21:26:00,769 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1914, Pos_dist: 8.6972, Neg_dist: 11.9473, Acc: 0.7943, PTFixPNLoss: 4.2721, NetFixLoss: 31.2113, ]
2022-10-31 21:26:02,861 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1855, Pos_dist: 8.6466, Neg_dist: 11.9504, Acc: 0.7943, PTFixPNLoss: 4.2672, NetFixLoss: 34.0686, ]
2022-10-31 21:26:02,946 INFO: fine-tune procedure is finished!
2022-10-31 21:27:06,178 INFO: [Test_acc of task 7 on test 1: 0.42253][acc of former classes: 0.62533][acc of former samples in all classes: 0.59233]
[acc of novel samples in all classes: 0.13143]
2022-10-31 21:27:06,483 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:27:06,513 WARNING: Current net - loaded net:
2022-10-31 21:27:06,513 WARNING: Loaded net - current net:
2022-10-31 21:27:06,513 WARNING:   func.classifier.bias
2022-10-31 21:27:06,514 WARNING:   func.classifier.weight
2022-10-31 21:27:06,545 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_7.pth.
2022-10-31 21:27:06,592 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:27:06,619 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:27:06,619 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:27:06,619 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:27:06,619 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:27:06,619 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:27:06,619 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:27:06,620 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:27:06,621 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:27:06,622 INFO: Model [FSLLModel] is created.
2022-10-31 21:27:06,628 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:27:06,634 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:27:06,639 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:27:06,645 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:27:06,650 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:27:06,655 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:27:06,662 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:27:06,667 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 21:27:08,986 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2702, Pos_dist: 8.6037, Neg_dist: 11.5766, Acc: 0.8050, PTFixPNLoss: 4.3166, NetFixLoss: 0.0000, ]
2022-10-31 21:27:11,446 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1423, Pos_dist: 8.7263, Neg_dist: 12.1185, Acc: 0.7700, PTFixPNLoss: 4.3234, NetFixLoss: 1.2045, ]
2022-10-31 21:27:13,863 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2230, Pos_dist: 8.6396, Neg_dist: 12.0060, Acc: 0.7800, PTFixPNLoss: 4.3187, NetFixLoss: 2.5289, ]
2022-10-31 21:27:16,238 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2166, Pos_dist: 8.6447, Neg_dist: 11.7654, Acc: 0.7650, PTFixPNLoss: 4.3188, NetFixLoss: 4.0302, ]
2022-10-31 21:27:18,710 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4053, Pos_dist: 8.6476, Neg_dist: 11.0923, Acc: 0.7650, PTFixPNLoss: 4.3256, NetFixLoss: 5.7595, ]
2022-10-31 21:27:21,160 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3128, Pos_dist: 8.6676, Neg_dist: 11.3077, Acc: 0.7850, PTFixPNLoss: 4.3225, NetFixLoss: 7.7996, ]
2022-10-31 21:27:23,762 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2785, Pos_dist: 8.6984, Neg_dist: 11.8662, Acc: 0.7650, PTFixPNLoss: 4.3219, NetFixLoss: 10.0641, ]
2022-10-31 21:27:27,045 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1292, Pos_dist: 8.6274, Neg_dist: 12.1665, Acc: 0.7700, PTFixPNLoss: 4.3196, NetFixLoss: 12.4849, ]
2022-10-31 21:27:29,698 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1193, Pos_dist: 8.6460, Neg_dist: 12.4099, Acc: 0.7950, PTFixPNLoss: 4.3190, NetFixLoss: 14.9234, ]
2022-10-31 21:27:31,590 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2894, Pos_dist: 8.6412, Neg_dist: 11.4922, Acc: 0.7900, PTFixPNLoss: 4.3213, NetFixLoss: 17.3180, ]
2022-10-31 21:27:33,987 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1624, Pos_dist: 8.6318, Neg_dist: 12.1757, Acc: 0.8350, PTFixPNLoss: 4.3183, NetFixLoss: 19.7313, ]
2022-10-31 21:27:36,613 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3418, Pos_dist: 8.6031, Neg_dist: 11.4367, Acc: 0.7750, PTFixPNLoss: 4.3179, NetFixLoss: 22.1420, ]
2022-10-31 21:27:39,015 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3022, Pos_dist: 8.6994, Neg_dist: 11.6588, Acc: 0.7750, PTFixPNLoss: 4.3178, NetFixLoss: 24.5648, ]
2022-10-31 21:27:41,455 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4711, Pos_dist: 8.7220, Neg_dist: 11.2762, Acc: 0.7550, PTFixPNLoss: 4.3216, NetFixLoss: 27.0421, ]
2022-10-31 21:27:43,872 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2298, Pos_dist: 8.6848, Neg_dist: 12.0323, Acc: 0.7650, PTFixPNLoss: 4.3224, NetFixLoss: 29.5759, ]
2022-10-31 21:27:43,979 INFO: fine-tune procedure is finished!
2022-10-31 21:28:50,038 INFO: [Test_acc of task 8 on test 1: 0.41290][acc of former classes: 0.63383][acc of former samples in all classes: 0.59217]
[acc of novel samples in all classes: 0.14400]
2022-10-31 21:28:50,333 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:28:50,364 WARNING: Current net - loaded net:
2022-10-31 21:28:50,364 WARNING: Loaded net - current net:
2022-10-31 21:28:50,364 WARNING:   func.classifier.bias
2022-10-31 21:28:50,364 WARNING:   func.classifier.weight
2022-10-31 21:28:50,395 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-10-31 21:28:50,455 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:28:50,482 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:28:50,482 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:28:50,482 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:28:50,482 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:28:50,482 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:28:50,482 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:28:50,482 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:28:50,483 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:28:50,484 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:28:50,484 INFO: Model [FSLLModel] is created.
2022-10-31 21:28:50,491 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-31 21:28:51,069 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4782, Pos_dist: 8.9096, Neg_dist: 11.1045, Acc: 0.8000, PTFixPNLoss: 3.9073, NetFixLoss: 0.0000, ]
2022-10-31 21:28:51,919 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3015, Pos_dist: 8.7311, Neg_dist: 11.4512, Acc: 0.9200, PTFixPNLoss: 3.8997, NetFixLoss: 2.2318, ]
2022-10-31 21:28:52,382 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2876, Pos_dist: 8.7553, Neg_dist: 11.5563, Acc: 0.7200, PTFixPNLoss: 3.9091, NetFixLoss: 4.7776, ]
2022-10-31 21:28:53,020 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5306, Pos_dist: 8.7681, Neg_dist: 10.7534, Acc: 0.9200, PTFixPNLoss: 3.9079, NetFixLoss: 7.5883, ]
2022-10-31 21:28:53,880 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4095, Pos_dist: 8.9301, Neg_dist: 11.3891, Acc: 0.7600, PTFixPNLoss: 3.9064, NetFixLoss: 10.8971, ]
2022-10-31 21:28:54,679 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4431, Pos_dist: 8.8398, Neg_dist: 11.2615, Acc: 0.8000, PTFixPNLoss: 3.9072, NetFixLoss: 14.5161, ]
2022-10-31 21:28:55,397 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2455, Pos_dist: 8.9710, Neg_dist: 11.8907, Acc: 0.8400, PTFixPNLoss: 3.9149, NetFixLoss: 18.3221, ]
2022-10-31 21:28:56,190 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2282, Pos_dist: 8.8223, Neg_dist: 11.3433, Acc: 0.6400, PTFixPNLoss: 3.9082, NetFixLoss: 22.1530, ]
2022-10-31 21:28:56,899 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2219, Pos_dist: 8.9823, Neg_dist: 11.8671, Acc: 0.8400, PTFixPNLoss: 3.9048, NetFixLoss: 25.9224, ]
2022-10-31 21:28:57,731 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.0772, Pos_dist: 8.8532, Neg_dist: 12.0437, Acc: 0.9200, PTFixPNLoss: 3.8982, NetFixLoss: 29.7306, ]
2022-10-31 21:28:58,489 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2009, Pos_dist: 8.7559, Neg_dist: 11.9514, Acc: 0.8000, PTFixPNLoss: 3.9003, NetFixLoss: 33.4604, ]
2022-10-31 21:28:59,161 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4128, Pos_dist: 8.9919, Neg_dist: 11.3748, Acc: 0.7200, PTFixPNLoss: 3.9132, NetFixLoss: 37.1940, ]
2022-10-31 21:28:59,897 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2917, Pos_dist: 8.7212, Neg_dist: 11.2410, Acc: 0.8800, PTFixPNLoss: 3.9061, NetFixLoss: 40.9178, ]
2022-10-31 21:29:00,740 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3776, Pos_dist: 8.6640, Neg_dist: 10.9780, Acc: 0.8000, PTFixPNLoss: 3.9086, NetFixLoss: 44.6552, ]
2022-10-31 21:29:01,420 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4577, Pos_dist: 8.9197, Neg_dist: 11.4071, Acc: 0.7600, PTFixPNLoss: 3.9018, NetFixLoss: 48.4759, ]
2022-10-31 21:29:01,570 INFO: fine-tune procedure is finished!
2022-10-31 21:29:49,056 INFO: [Test_acc of task 1 on test 2: 0.57554][acc of former classes: 0.62250][acc of former samples in all classes: 0.61517]
[acc of novel samples in all classes: 0.10000]
2022-10-31 21:29:49,361 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:29:49,390 WARNING: Current net - loaded net:
2022-10-31 21:29:49,390 WARNING: Loaded net - current net:
2022-10-31 21:29:49,390 WARNING:   func.classifier.bias
2022-10-31 21:29:49,390 WARNING:   func.classifier.weight
2022-10-31 21:29:49,421 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_1.pth.
2022-10-31 21:29:49,479 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:29:49,565 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:29:49,566 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:29:49,566 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:29:49,566 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:29:49,566 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:29:49,566 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:29:49,566 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:29:49,567 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:29:49,568 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:29:49,568 INFO: Model [FSLLModel] is created.
2022-10-31 21:29:49,574 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:29:49,580 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 21:29:50,401 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3820, Pos_dist: 8.7476, Neg_dist: 11.1006, Acc: 0.7200, PTFixPNLoss: 3.9754, NetFixLoss: 0.0000, ]
2022-10-31 21:29:51,302 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3377, Pos_dist: 8.7761, Neg_dist: 11.9723, Acc: 0.7600, PTFixPNLoss: 3.9701, NetFixLoss: 1.4755, ]
2022-10-31 21:29:52,400 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2709, Pos_dist: 8.7675, Neg_dist: 11.7349, Acc: 0.7600, PTFixPNLoss: 3.9721, NetFixLoss: 3.4530, ]
2022-10-31 21:29:53,416 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5564, Pos_dist: 8.9347, Neg_dist: 11.1974, Acc: 0.7200, PTFixPNLoss: 3.9757, NetFixLoss: 5.8676, ]
2022-10-31 21:29:54,367 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1710, Pos_dist: 8.6563, Neg_dist: 11.8248, Acc: 0.7200, PTFixPNLoss: 3.9664, NetFixLoss: 8.7100, ]
2022-10-31 21:29:55,263 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1492, Pos_dist: 8.7463, Neg_dist: 12.2248, Acc: 0.7600, PTFixPNLoss: 3.9681, NetFixLoss: 11.7153, ]
2022-10-31 21:29:56,199 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2384, Pos_dist: 8.5791, Neg_dist: 11.3394, Acc: 0.8200, PTFixPNLoss: 3.9695, NetFixLoss: 14.7652, ]
2022-10-31 21:29:57,112 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2857, Pos_dist: 8.6678, Neg_dist: 11.6616, Acc: 0.7200, PTFixPNLoss: 3.9757, NetFixLoss: 17.8603, ]
2022-10-31 21:29:58,033 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2177, Pos_dist: 8.7711, Neg_dist: 11.7647, Acc: 0.7800, PTFixPNLoss: 3.9784, NetFixLoss: 21.0361, ]
2022-10-31 21:29:58,931 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2869, Pos_dist: 8.8006, Neg_dist: 11.7450, Acc: 0.6600, PTFixPNLoss: 3.9686, NetFixLoss: 24.2056, ]
2022-10-31 21:29:59,896 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2795, Pos_dist: 8.5807, Neg_dist: 11.1065, Acc: 0.8600, PTFixPNLoss: 3.9665, NetFixLoss: 27.4902, ]
2022-10-31 21:30:00,772 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4733, Pos_dist: 8.7732, Neg_dist: 10.8949, Acc: 0.7600, PTFixPNLoss: 3.9805, NetFixLoss: 30.9168, ]
2022-10-31 21:30:01,644 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3106, Pos_dist: 8.7248, Neg_dist: 11.6089, Acc: 0.7200, PTFixPNLoss: 3.9634, NetFixLoss: 34.3339, ]
2022-10-31 21:30:02,550 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2188, Pos_dist: 8.8486, Neg_dist: 12.4697, Acc: 0.7800, PTFixPNLoss: 3.9735, NetFixLoss: 37.8101, ]
2022-10-31 21:30:03,414 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.5119, Pos_dist: 8.7279, Neg_dist: 10.7676, Acc: 0.8400, PTFixPNLoss: 3.9677, NetFixLoss: 41.2039, ]
2022-10-31 21:30:03,521 INFO: fine-tune procedure is finished!
2022-10-31 21:30:53,906 INFO: [Test_acc of task 2 on test 2: 0.52714][acc of former classes: 0.61017][acc of former samples in all classes: 0.59917]
[acc of novel samples in all classes: 0.09500]
2022-10-31 21:30:54,200 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:30:54,253 WARNING: Current net - loaded net:
2022-10-31 21:30:54,254 WARNING: Loaded net - current net:
2022-10-31 21:30:54,254 WARNING:   func.classifier.bias
2022-10-31 21:30:54,254 WARNING:   func.classifier.weight
2022-10-31 21:30:54,294 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_2.pth.
2022-10-31 21:30:54,362 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:30:54,388 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:30:54,388 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:30:54,388 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:30:54,388 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:30:54,388 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:30:54,389 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:30:54,389 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:30:54,390 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:30:54,391 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:30:54,391 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:30:54,391 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:30:54,391 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:30:54,391 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:30:54,391 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:30:54,391 INFO: Model [FSLLModel] is created.
2022-10-31 21:30:54,397 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:30:54,403 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:30:54,409 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-31 21:30:55,600 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3674, Pos_dist: 8.7413, Neg_dist: 11.6848, Acc: 0.8267, PTFixPNLoss: 4.0416, NetFixLoss: 0.0000, ]
2022-10-31 21:30:56,741 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5025, Pos_dist: 8.7679, Neg_dist: 10.8477, Acc: 0.7867, PTFixPNLoss: 4.0421, NetFixLoss: 1.1798, ]
2022-10-31 21:30:58,068 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3445, Pos_dist: 8.7654, Neg_dist: 11.6938, Acc: 0.7467, PTFixPNLoss: 4.0496, NetFixLoss: 3.2590, ]
2022-10-31 21:30:59,351 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3270, Pos_dist: 8.6749, Neg_dist: 11.4143, Acc: 0.8267, PTFixPNLoss: 4.0372, NetFixLoss: 5.6780, ]
2022-10-31 21:31:00,489 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4513, Pos_dist: 8.7358, Neg_dist: 10.9869, Acc: 0.7733, PTFixPNLoss: 4.0359, NetFixLoss: 8.3357, ]
2022-10-31 21:31:01,812 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4158, Pos_dist: 8.5368, Neg_dist: 10.8261, Acc: 0.8400, PTFixPNLoss: 4.0352, NetFixLoss: 11.2738, ]
2022-10-31 21:31:03,107 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1018, Pos_dist: 8.7397, Neg_dist: 12.7716, Acc: 0.7600, PTFixPNLoss: 4.0414, NetFixLoss: 14.4396, ]
2022-10-31 21:31:04,361 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2644, Pos_dist: 8.6869, Neg_dist: 11.6742, Acc: 0.7867, PTFixPNLoss: 4.0352, NetFixLoss: 17.6075, ]
2022-10-31 21:31:05,492 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4730, Pos_dist: 8.6898, Neg_dist: 10.9627, Acc: 0.7200, PTFixPNLoss: 4.0418, NetFixLoss: 20.7702, ]
2022-10-31 21:31:06,874 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3577, Pos_dist: 8.7988, Neg_dist: 11.5183, Acc: 0.7867, PTFixPNLoss: 4.0449, NetFixLoss: 24.0385, ]
2022-10-31 21:31:08,033 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3400, Pos_dist: 8.8493, Neg_dist: 11.8657, Acc: 0.7067, PTFixPNLoss: 4.0462, NetFixLoss: 27.3005, ]
2022-10-31 21:31:09,151 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4822, Pos_dist: 8.7464, Neg_dist: 11.0590, Acc: 0.7333, PTFixPNLoss: 4.0378, NetFixLoss: 30.6083, ]
2022-10-31 21:31:10,261 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4094, Pos_dist: 8.7012, Neg_dist: 11.0482, Acc: 0.7600, PTFixPNLoss: 4.0389, NetFixLoss: 33.9631, ]
2022-10-31 21:31:11,381 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2825, Pos_dist: 8.7076, Neg_dist: 11.6827, Acc: 0.7333, PTFixPNLoss: 4.0367, NetFixLoss: 37.3419, ]
2022-10-31 21:31:12,090 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2659, Pos_dist: 8.4633, Neg_dist: 10.9687, Acc: 0.7867, PTFixPNLoss: 4.0329, NetFixLoss: 40.7494, ]
2022-10-31 21:31:12,190 INFO: fine-tune procedure is finished!
2022-10-31 21:32:05,208 INFO: [Test_acc of task 3 on test 2: 0.49533][acc of former classes: 0.60600][acc of former samples in all classes: 0.59083]
[acc of novel samples in all classes: 0.11333]
2022-10-31 21:32:05,497 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:32:05,525 WARNING: Current net - loaded net:
2022-10-31 21:32:05,525 WARNING: Loaded net - current net:
2022-10-31 21:32:05,525 WARNING:   func.classifier.bias
2022-10-31 21:32:05,525 WARNING:   func.classifier.weight
2022-10-31 21:32:05,552 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_3.pth.
2022-10-31 21:32:05,580 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:32:05,595 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:32:05,595 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:32:05,595 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:32:05,595 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:32:05,595 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:32:05,595 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:32:05,595 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:32:05,596 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:32:05,597 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:32:05,598 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:32:05,598 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:32:05,598 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:32:05,598 INFO: Model [FSLLModel] is created.
2022-10-31 21:32:05,606 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:32:05,612 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:32:05,617 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:32:05,623 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 21:32:06,877 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2487, Pos_dist: 8.6722, Neg_dist: 11.8274, Acc: 0.7900, PTFixPNLoss: 4.0863, NetFixLoss: 0.0000, ]
2022-10-31 21:32:08,361 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2938, Pos_dist: 8.9068, Neg_dist: 11.8132, Acc: 0.7300, PTFixPNLoss: 4.1031, NetFixLoss: 1.0782, ]
2022-10-31 21:32:09,721 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2401, Pos_dist: 8.8376, Neg_dist: 11.8239, Acc: 0.7200, PTFixPNLoss: 4.1065, NetFixLoss: 2.5636, ]
2022-10-31 21:32:11,124 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4889, Pos_dist: 8.7281, Neg_dist: 10.9768, Acc: 0.8100, PTFixPNLoss: 4.0963, NetFixLoss: 4.3607, ]
2022-10-31 21:32:12,788 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4088, Pos_dist: 8.7807, Neg_dist: 11.1895, Acc: 0.7200, PTFixPNLoss: 4.1024, NetFixLoss: 6.6040, ]
2022-10-31 21:32:14,359 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1535, Pos_dist: 8.8553, Neg_dist: 12.3410, Acc: 0.7200, PTFixPNLoss: 4.1052, NetFixLoss: 9.1559, ]
2022-10-31 21:32:15,806 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3971, Pos_dist: 8.8530, Neg_dist: 11.5170, Acc: 0.7700, PTFixPNLoss: 4.1040, NetFixLoss: 11.8411, ]
2022-10-31 21:32:17,237 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4215, Pos_dist: 8.6722, Neg_dist: 11.0878, Acc: 0.8700, PTFixPNLoss: 4.0960, NetFixLoss: 14.6401, ]
2022-10-31 21:32:18,883 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.5132, Pos_dist: 8.7635, Neg_dist: 10.9848, Acc: 0.8000, PTFixPNLoss: 4.0996, NetFixLoss: 17.5505, ]
2022-10-31 21:32:20,434 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4173, Pos_dist: 8.8398, Neg_dist: 11.1945, Acc: 0.7400, PTFixPNLoss: 4.1008, NetFixLoss: 20.5405, ]
2022-10-31 21:32:21,845 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4472, Pos_dist: 8.9175, Neg_dist: 11.3113, Acc: 0.7700, PTFixPNLoss: 4.1061, NetFixLoss: 23.6907, ]
2022-10-31 21:32:23,465 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3131, Pos_dist: 8.6745, Neg_dist: 11.7772, Acc: 0.7700, PTFixPNLoss: 4.1000, NetFixLoss: 26.9783, ]
2022-10-31 21:32:25,002 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2265, Pos_dist: 8.7904, Neg_dist: 12.0799, Acc: 0.7500, PTFixPNLoss: 4.1052, NetFixLoss: 30.3179, ]
2022-10-31 21:32:26,457 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3769, Pos_dist: 8.7317, Neg_dist: 11.5299, Acc: 0.7600, PTFixPNLoss: 4.1017, NetFixLoss: 33.5945, ]
2022-10-31 21:32:27,869 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2056, Pos_dist: 8.7767, Neg_dist: 11.7423, Acc: 0.7000, PTFixPNLoss: 4.1006, NetFixLoss: 36.8395, ]
2022-10-31 21:32:27,961 INFO: fine-tune procedure is finished!
2022-10-31 21:33:19,701 INFO: [Test_acc of task 4 on test 2: 0.47425][acc of former classes: 0.61083][acc of former samples in all classes: 0.59050]
[acc of novel samples in all classes: 0.12550]
2022-10-31 21:33:19,976 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:33:20,006 WARNING: Current net - loaded net:
2022-10-31 21:33:20,006 WARNING: Loaded net - current net:
2022-10-31 21:33:20,006 WARNING:   func.classifier.bias
2022-10-31 21:33:20,007 WARNING:   func.classifier.weight
2022-10-31 21:33:20,017 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_4.pth.
2022-10-31 21:33:20,056 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:33:20,071 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:33:20,071 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:33:20,071 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:33:20,071 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:33:20,071 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:33:20,072 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:33:20,072 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:33:20,073 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:33:20,074 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:33:20,074 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:33:20,074 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:33:20,074 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:33:20,074 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:33:20,074 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:33:20,074 INFO: Model [FSLLModel] is created.
2022-10-31 21:33:20,080 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:33:20,086 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:33:20,091 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:33:20,097 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:33:20,103 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-31 21:33:20,880 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2204, Pos_dist: 8.7002, Neg_dist: 11.6862, Acc: 0.7840, PTFixPNLoss: 4.1588, NetFixLoss: 0.0000, ]
2022-10-31 21:33:21,687 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3389, Pos_dist: 8.6964, Neg_dist: 11.4795, Acc: 0.7520, PTFixPNLoss: 4.1635, NetFixLoss: 1.2019, ]
2022-10-31 21:33:22,470 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2702, Pos_dist: 8.8485, Neg_dist: 11.9312, Acc: 0.7920, PTFixPNLoss: 4.1648, NetFixLoss: 2.7603, ]
2022-10-31 21:33:23,245 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3128, Pos_dist: 8.8015, Neg_dist: 11.7014, Acc: 0.7520, PTFixPNLoss: 4.1638, NetFixLoss: 4.6603, ]
2022-10-31 21:33:24,057 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3503, Pos_dist: 8.6327, Neg_dist: 11.5638, Acc: 0.8160, PTFixPNLoss: 4.1586, NetFixLoss: 6.9530, ]
2022-10-31 21:33:24,996 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3045, Pos_dist: 8.8067, Neg_dist: 11.6906, Acc: 0.7600, PTFixPNLoss: 4.1669, NetFixLoss: 9.4250, ]
2022-10-31 21:33:25,833 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1686, Pos_dist: 8.7725, Neg_dist: 11.8816, Acc: 0.7680, PTFixPNLoss: 4.1632, NetFixLoss: 11.9897, ]
2022-10-31 21:33:26,605 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2005, Pos_dist: 8.7260, Neg_dist: 12.0490, Acc: 0.8080, PTFixPNLoss: 4.1593, NetFixLoss: 14.6135, ]
2022-10-31 21:33:27,590 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1011, Pos_dist: 8.7905, Neg_dist: 12.7143, Acc: 0.7680, PTFixPNLoss: 4.1621, NetFixLoss: 17.2211, ]
2022-10-31 21:33:28,539 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2129, Pos_dist: 8.7526, Neg_dist: 12.0256, Acc: 0.7840, PTFixPNLoss: 4.1643, NetFixLoss: 19.7457, ]
2022-10-31 21:33:29,393 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2298, Pos_dist: 8.7665, Neg_dist: 11.8298, Acc: 0.7200, PTFixPNLoss: 4.1653, NetFixLoss: 22.2233, ]
2022-10-31 21:33:30,275 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3369, Pos_dist: 8.6648, Neg_dist: 11.2302, Acc: 0.7760, PTFixPNLoss: 4.1604, NetFixLoss: 24.6491, ]
2022-10-31 21:33:31,095 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4583, Pos_dist: 8.8130, Neg_dist: 11.3222, Acc: 0.7520, PTFixPNLoss: 4.1666, NetFixLoss: 27.0789, ]
2022-10-31 21:33:32,253 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2945, Pos_dist: 8.6347, Neg_dist: 11.2723, Acc: 0.7920, PTFixPNLoss: 4.1630, NetFixLoss: 29.5474, ]
2022-10-31 21:33:33,044 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1556, Pos_dist: 8.6483, Neg_dist: 12.1818, Acc: 0.8080, PTFixPNLoss: 4.1616, NetFixLoss: 32.0734, ]
2022-10-31 21:33:33,140 INFO: fine-tune procedure is finished!
2022-10-31 21:34:22,296 INFO: [Test_acc of task 5 on test 2: 0.45518][acc of former classes: 0.61417][acc of former samples in all classes: 0.58967]
[acc of novel samples in all classes: 0.13240]
2022-10-31 21:34:22,568 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:34:22,596 WARNING: Current net - loaded net:
2022-10-31 21:34:22,596 WARNING: Loaded net - current net:
2022-10-31 21:34:22,596 WARNING:   func.classifier.bias
2022-10-31 21:34:22,596 WARNING:   func.classifier.weight
2022-10-31 21:34:22,608 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_5.pth.
2022-10-31 21:34:22,648 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:34:22,661 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:34:22,661 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:34:22,661 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:34:22,661 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:34:22,661 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:34:22,661 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:34:22,661 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:34:22,662 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:34:22,663 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:34:22,663 INFO: Model [FSLLModel] is created.
2022-10-31 21:34:22,669 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:34:22,675 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:34:22,680 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:34:22,686 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:34:22,691 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:34:22,697 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 21:34:23,539 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5016, Pos_dist: 8.7445, Neg_dist: 11.1909, Acc: 0.7800, PTFixPNLoss: 4.2141, NetFixLoss: 0.0000, ]
2022-10-31 21:34:24,437 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3553, Pos_dist: 8.7463, Neg_dist: 11.5565, Acc: 0.7200, PTFixPNLoss: 4.2193, NetFixLoss: 1.3775, ]
2022-10-31 21:34:25,266 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4643, Pos_dist: 8.7510, Neg_dist: 11.4445, Acc: 0.7333, PTFixPNLoss: 4.2219, NetFixLoss: 3.2280, ]
2022-10-31 21:34:26,150 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3042, Pos_dist: 8.8306, Neg_dist: 11.5398, Acc: 0.7533, PTFixPNLoss: 4.2247, NetFixLoss: 5.4216, ]
2022-10-31 21:34:26,980 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3203, Pos_dist: 8.7421, Neg_dist: 11.3091, Acc: 0.7667, PTFixPNLoss: 4.2236, NetFixLoss: 7.9544, ]
2022-10-31 21:34:27,995 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4048, Pos_dist: 8.7718, Neg_dist: 11.6730, Acc: 0.7533, PTFixPNLoss: 4.2226, NetFixLoss: 10.7610, ]
2022-10-31 21:34:28,865 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3253, Pos_dist: 8.7589, Neg_dist: 11.5152, Acc: 0.7667, PTFixPNLoss: 4.2267, NetFixLoss: 13.6853, ]
2022-10-31 21:34:29,761 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.5513, Pos_dist: 8.7067, Neg_dist: 10.8345, Acc: 0.7600, PTFixPNLoss: 4.2140, NetFixLoss: 16.6660, ]
2022-10-31 21:34:30,593 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1730, Pos_dist: 8.7373, Neg_dist: 12.2493, Acc: 0.7267, PTFixPNLoss: 4.2212, NetFixLoss: 19.8429, ]
2022-10-31 21:34:31,434 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3095, Pos_dist: 8.6104, Neg_dist: 11.6754, Acc: 0.7733, PTFixPNLoss: 4.2216, NetFixLoss: 23.0946, ]
2022-10-31 21:34:32,267 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3402, Pos_dist: 8.7460, Neg_dist: 11.4257, Acc: 0.7733, PTFixPNLoss: 4.2182, NetFixLoss: 26.2923, ]
2022-10-31 21:34:33,103 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.7738, Pos_dist: 8.7285, Neg_dist: 10.4461, Acc: 0.7867, PTFixPNLoss: 4.2220, NetFixLoss: 29.4194, ]
2022-10-31 21:34:33,966 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2530, Pos_dist: 8.7554, Neg_dist: 11.7901, Acc: 0.8000, PTFixPNLoss: 4.2200, NetFixLoss: 32.6193, ]
2022-10-31 21:34:34,844 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3311, Pos_dist: 8.5911, Neg_dist: 11.1698, Acc: 0.7867, PTFixPNLoss: 4.2172, NetFixLoss: 35.7702, ]
2022-10-31 21:34:35,686 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4956, Pos_dist: 8.7323, Neg_dist: 11.5982, Acc: 0.7533, PTFixPNLoss: 4.2248, NetFixLoss: 39.0651, ]
2022-10-31 21:34:35,807 INFO: fine-tune procedure is finished!
2022-10-31 21:35:27,214 INFO: [Test_acc of task 6 on test 2: 0.43467][acc of former classes: 0.61767][acc of former samples in all classes: 0.58767]
[acc of novel samples in all classes: 0.12867]
2022-10-31 21:35:27,486 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:35:27,514 WARNING: Current net - loaded net:
2022-10-31 21:35:27,515 WARNING: Loaded net - current net:
2022-10-31 21:35:27,515 WARNING:   func.classifier.bias
2022-10-31 21:35:27,515 WARNING:   func.classifier.weight
2022-10-31 21:35:27,525 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_6.pth.
2022-10-31 21:35:27,562 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:35:27,575 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:35:27,575 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:35:27,575 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:35:27,575 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:35:27,576 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:35:27,576 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:35:27,576 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:35:27,577 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:35:27,578 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:35:27,578 INFO: Model [FSLLModel] is created.
2022-10-31 21:35:27,584 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:35:27,590 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:35:27,595 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:35:27,601 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:35:27,606 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:35:27,612 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:35:27,617 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-31 21:35:28,489 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3232, Pos_dist: 8.7293, Neg_dist: 11.2680, Acc: 0.7714, PTFixPNLoss: 4.2761, NetFixLoss: 0.0000, ]
2022-10-31 21:35:29,654 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4452, Pos_dist: 8.7799, Neg_dist: 11.2342, Acc: 0.7600, PTFixPNLoss: 4.2842, NetFixLoss: 1.2721, ]
2022-10-31 21:35:30,814 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3163, Pos_dist: 8.7645, Neg_dist: 11.3105, Acc: 0.8114, PTFixPNLoss: 4.2724, NetFixLoss: 2.9488, ]
2022-10-31 21:35:31,942 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1740, Pos_dist: 8.6565, Neg_dist: 11.9705, Acc: 0.8114, PTFixPNLoss: 4.2730, NetFixLoss: 5.0473, ]
2022-10-31 21:35:33,076 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2437, Pos_dist: 8.6636, Neg_dist: 11.4679, Acc: 0.7886, PTFixPNLoss: 4.2744, NetFixLoss: 7.2566, ]
2022-10-31 21:35:34,101 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5704, Pos_dist: 8.7679, Neg_dist: 10.7138, Acc: 0.7600, PTFixPNLoss: 4.2813, NetFixLoss: 9.5596, ]
2022-10-31 21:35:35,065 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4792, Pos_dist: 8.7208, Neg_dist: 11.1563, Acc: 0.7543, PTFixPNLoss: 4.2775, NetFixLoss: 12.0965, ]
2022-10-31 21:35:35,988 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2507, Pos_dist: 8.7249, Neg_dist: 12.0794, Acc: 0.7714, PTFixPNLoss: 4.2737, NetFixLoss: 14.7962, ]
2022-10-31 21:35:37,119 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3373, Pos_dist: 8.7914, Neg_dist: 11.4250, Acc: 0.6857, PTFixPNLoss: 4.2723, NetFixLoss: 17.5233, ]
2022-10-31 21:35:38,290 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3387, Pos_dist: 8.6164, Neg_dist: 11.1272, Acc: 0.7257, PTFixPNLoss: 4.2766, NetFixLoss: 20.2845, ]
2022-10-31 21:35:39,249 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4127, Pos_dist: 8.7812, Neg_dist: 11.2349, Acc: 0.7829, PTFixPNLoss: 4.2815, NetFixLoss: 23.1032, ]
2022-10-31 21:35:40,212 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3031, Pos_dist: 8.7144, Neg_dist: 11.5225, Acc: 0.7600, PTFixPNLoss: 4.2762, NetFixLoss: 25.9970, ]
2022-10-31 21:35:41,290 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4619, Pos_dist: 8.7978, Neg_dist: 11.0876, Acc: 0.7600, PTFixPNLoss: 4.2770, NetFixLoss: 28.8851, ]
2022-10-31 21:35:42,399 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2484, Pos_dist: 8.6778, Neg_dist: 11.7436, Acc: 0.7600, PTFixPNLoss: 4.2728, NetFixLoss: 31.8920, ]
2022-10-31 21:35:43,446 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3531, Pos_dist: 8.7060, Neg_dist: 11.1359, Acc: 0.7600, PTFixPNLoss: 4.2766, NetFixLoss: 34.8909, ]
2022-10-31 21:35:43,536 INFO: fine-tune procedure is finished!
2022-10-31 21:36:37,205 INFO: [Test_acc of task 7 on test 2: 0.42379][acc of former classes: 0.62050][acc of former samples in all classes: 0.58833]
[acc of novel samples in all classes: 0.14171]
2022-10-31 21:36:37,479 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:36:37,511 WARNING: Current net - loaded net:
2022-10-31 21:36:37,511 WARNING: Loaded net - current net:
2022-10-31 21:36:37,511 WARNING:   func.classifier.bias
2022-10-31 21:36:37,511 WARNING:   func.classifier.weight
2022-10-31 21:36:37,522 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_7.pth.
2022-10-31 21:36:37,562 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:36:37,578 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:36:37,578 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:36:37,578 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:36:37,578 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:36:37,578 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:36:37,579 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:36:37,579 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:36:37,580 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:36:37,581 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:36:37,581 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:36:37,581 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:36:37,581 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:36:37,581 INFO: Model [FSLLModel] is created.
2022-10-31 21:36:37,587 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:36:37,592 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:36:37,598 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:36:37,603 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:36:37,609 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:36:37,614 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:36:37,620 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:36:37,625 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 21:36:38,567 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1442, Pos_dist: 8.6750, Neg_dist: 11.9168, Acc: 0.7550, PTFixPNLoss: 4.3259, NetFixLoss: 0.0000, ]
2022-10-31 21:36:39,710 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3079, Pos_dist: 8.7607, Neg_dist: 11.5817, Acc: 0.7400, PTFixPNLoss: 4.3270, NetFixLoss: 0.9628, ]
2022-10-31 21:36:40,817 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3216, Pos_dist: 8.7306, Neg_dist: 11.5433, Acc: 0.7300, PTFixPNLoss: 4.3272, NetFixLoss: 2.3870, ]
2022-10-31 21:36:42,075 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2295, Pos_dist: 8.7680, Neg_dist: 11.6887, Acc: 0.8100, PTFixPNLoss: 4.3244, NetFixLoss: 4.2311, ]
2022-10-31 21:36:43,132 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3285, Pos_dist: 8.7311, Neg_dist: 11.9330, Acc: 0.7050, PTFixPNLoss: 4.3296, NetFixLoss: 6.2965, ]
2022-10-31 21:36:44,213 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3196, Pos_dist: 8.7379, Neg_dist: 11.5156, Acc: 0.7700, PTFixPNLoss: 4.3245, NetFixLoss: 8.4696, ]
2022-10-31 21:36:45,305 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1885, Pos_dist: 8.8926, Neg_dist: 12.8882, Acc: 0.6850, PTFixPNLoss: 4.3365, NetFixLoss: 10.7932, ]
2022-10-31 21:36:46,299 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4991, Pos_dist: 8.6558, Neg_dist: 10.8560, Acc: 0.7900, PTFixPNLoss: 4.3277, NetFixLoss: 13.2410, ]
2022-10-31 21:36:47,399 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3002, Pos_dist: 8.6446, Neg_dist: 11.6063, Acc: 0.7450, PTFixPNLoss: 4.3226, NetFixLoss: 15.7487, ]
2022-10-31 21:36:48,426 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4473, Pos_dist: 8.6948, Neg_dist: 10.9704, Acc: 0.7900, PTFixPNLoss: 4.3305, NetFixLoss: 18.2841, ]
2022-10-31 21:36:49,426 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2190, Pos_dist: 8.7050, Neg_dist: 11.7065, Acc: 0.7250, PTFixPNLoss: 4.3243, NetFixLoss: 20.9385, ]
2022-10-31 21:36:50,432 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2861, Pos_dist: 8.7010, Neg_dist: 11.3286, Acc: 0.7450, PTFixPNLoss: 4.3234, NetFixLoss: 23.6737, ]
2022-10-31 21:36:51,426 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3785, Pos_dist: 8.7754, Neg_dist: 11.6357, Acc: 0.7550, PTFixPNLoss: 4.3257, NetFixLoss: 26.4021, ]
2022-10-31 21:36:52,667 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1914, Pos_dist: 8.5507, Neg_dist: 11.7635, Acc: 0.7850, PTFixPNLoss: 4.3207, NetFixLoss: 29.1247, ]
2022-10-31 21:36:53,836 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3287, Pos_dist: 8.6880, Neg_dist: 11.4696, Acc: 0.8000, PTFixPNLoss: 4.3232, NetFixLoss: 31.7967, ]
2022-10-31 21:36:53,913 INFO: fine-tune procedure is finished!
2022-10-31 21:37:50,393 INFO: [Test_acc of task 8 on test 2: 0.41360][acc of former classes: 0.62833][acc of former samples in all classes: 0.59317]
[acc of novel samples in all classes: 0.14425]
2022-10-31 21:37:50,672 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:37:50,701 WARNING: Current net - loaded net:
2022-10-31 21:37:50,701 WARNING: Loaded net - current net:
2022-10-31 21:37:50,701 WARNING:   func.classifier.bias
2022-10-31 21:37:50,701 WARNING:   func.classifier.weight
2022-10-31 21:37:50,712 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-10-31 21:37:50,752 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:37:50,768 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:37:50,768 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:37:50,768 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:37:50,768 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:37:50,768 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:37:50,768 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:37:50,768 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:37:50,769 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:37:50,770 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:37:50,770 INFO: Model [FSLLModel] is created.
2022-10-31 21:37:50,776 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-31 21:37:51,183 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2592, Pos_dist: 8.9241, Neg_dist: 11.6937, Acc: 0.6400, PTFixPNLoss: 3.9138, NetFixLoss: 0.0000, ]
2022-10-31 21:37:51,663 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5247, Pos_dist: 8.9494, Neg_dist: 10.9365, Acc: 0.6400, PTFixPNLoss: 3.9111, NetFixLoss: 1.7500, ]
2022-10-31 21:37:52,277 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5051, Pos_dist: 9.1141, Neg_dist: 11.6250, Acc: 0.7200, PTFixPNLoss: 3.9135, NetFixLoss: 4.5173, ]
2022-10-31 21:37:52,916 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2832, Pos_dist: 8.7199, Neg_dist: 11.3636, Acc: 0.7600, PTFixPNLoss: 3.9148, NetFixLoss: 7.8434, ]
2022-10-31 21:37:53,519 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3341, Pos_dist: 8.6191, Neg_dist: 11.2604, Acc: 0.8000, PTFixPNLoss: 3.9115, NetFixLoss: 11.3210, ]
2022-10-31 21:37:54,041 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4717, Pos_dist: 8.8209, Neg_dist: 11.1402, Acc: 0.6800, PTFixPNLoss: 3.9154, NetFixLoss: 14.9943, ]
2022-10-31 21:37:54,552 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.5650, Pos_dist: 8.8852, Neg_dist: 11.1296, Acc: 0.8800, PTFixPNLoss: 3.9139, NetFixLoss: 18.8723, ]
2022-10-31 21:37:55,049 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2468, Pos_dist: 8.6391, Neg_dist: 11.5452, Acc: 0.7200, PTFixPNLoss: 3.9073, NetFixLoss: 22.8574, ]
2022-10-31 21:37:55,530 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4203, Pos_dist: 8.9731, Neg_dist: 11.4878, Acc: 0.6800, PTFixPNLoss: 3.9144, NetFixLoss: 26.8709, ]
2022-10-31 21:37:56,073 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3724, Pos_dist: 8.5500, Neg_dist: 11.0810, Acc: 0.8800, PTFixPNLoss: 3.9022, NetFixLoss: 31.0414, ]
2022-10-31 21:37:56,544 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3305, Pos_dist: 8.8289, Neg_dist: 11.2731, Acc: 0.6000, PTFixPNLoss: 3.9081, NetFixLoss: 35.0899, ]
2022-10-31 21:37:57,029 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3312, Pos_dist: 8.8114, Neg_dist: 11.4181, Acc: 0.7600, PTFixPNLoss: 3.9044, NetFixLoss: 39.1595, ]
2022-10-31 21:37:57,631 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3082, Pos_dist: 8.8462, Neg_dist: 11.8340, Acc: 0.6800, PTFixPNLoss: 3.9043, NetFixLoss: 43.1857, ]
2022-10-31 21:37:58,210 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2320, Pos_dist: 8.8283, Neg_dist: 11.6544, Acc: 0.6400, PTFixPNLoss: 3.9064, NetFixLoss: 47.0884, ]
2022-10-31 21:37:58,740 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2314, Pos_dist: 8.8171, Neg_dist: 11.2685, Acc: 0.7600, PTFixPNLoss: 3.9117, NetFixLoss: 50.8651, ]
2022-10-31 21:37:58,813 INFO: fine-tune procedure is finished!
2022-10-31 21:38:39,821 INFO: [Test_acc of task 1 on test 3: 0.57569][acc of former classes: 0.62167][acc of former samples in all classes: 0.61550]
[acc of novel samples in all classes: 0.09800]
2022-10-31 21:38:40,096 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:38:40,125 WARNING: Current net - loaded net:
2022-10-31 21:38:40,125 WARNING: Loaded net - current net:
2022-10-31 21:38:40,125 WARNING:   func.classifier.bias
2022-10-31 21:38:40,125 WARNING:   func.classifier.weight
2022-10-31 21:38:40,136 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_1.pth.
2022-10-31 21:38:40,165 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:38:40,180 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:38:40,181 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:38:40,181 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:38:40,181 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:38:40,181 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:38:40,181 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:38:40,181 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:38:40,182 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:38:40,183 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:38:40,183 INFO: Model [FSLLModel] is created.
2022-10-31 21:38:40,193 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:38:40,200 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 21:38:40,781 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2932, Pos_dist: 8.9145, Neg_dist: 11.4937, Acc: 0.7000, PTFixPNLoss: 3.9754, NetFixLoss: 0.0000, ]
2022-10-31 21:38:41,307 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3710, Pos_dist: 8.8939, Neg_dist: 11.3746, Acc: 0.7000, PTFixPNLoss: 3.9747, NetFixLoss: 1.5662, ]
2022-10-31 21:38:41,960 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4243, Pos_dist: 8.8028, Neg_dist: 11.0768, Acc: 0.7800, PTFixPNLoss: 3.9702, NetFixLoss: 3.6263, ]
2022-10-31 21:38:42,555 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.0931, Pos_dist: 8.9509, Neg_dist: 12.2534, Acc: 0.6600, PTFixPNLoss: 3.9782, NetFixLoss: 6.1582, ]
2022-10-31 21:38:43,111 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3835, Pos_dist: 8.8050, Neg_dist: 11.2918, Acc: 0.7800, PTFixPNLoss: 3.9738, NetFixLoss: 8.7958, ]
2022-10-31 21:38:43,839 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1726, Pos_dist: 8.7850, Neg_dist: 11.9997, Acc: 0.7800, PTFixPNLoss: 3.9704, NetFixLoss: 11.4936, ]
2022-10-31 21:38:44,462 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.5010, Pos_dist: 8.8326, Neg_dist: 11.1856, Acc: 0.8400, PTFixPNLoss: 3.9633, NetFixLoss: 14.2638, ]
2022-10-31 21:38:45,016 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3014, Pos_dist: 8.9020, Neg_dist: 11.6549, Acc: 0.7600, PTFixPNLoss: 3.9810, NetFixLoss: 17.2102, ]
2022-10-31 21:38:45,604 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2615, Pos_dist: 8.8663, Neg_dist: 11.6920, Acc: 0.7800, PTFixPNLoss: 3.9774, NetFixLoss: 20.3752, ]
2022-10-31 21:38:46,344 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4199, Pos_dist: 8.7584, Neg_dist: 11.4439, Acc: 0.8000, PTFixPNLoss: 3.9705, NetFixLoss: 23.7048, ]
2022-10-31 21:38:47,018 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4850, Pos_dist: 8.9433, Neg_dist: 11.2652, Acc: 0.7200, PTFixPNLoss: 3.9736, NetFixLoss: 27.1009, ]
2022-10-31 21:38:47,764 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3225, Pos_dist: 8.8991, Neg_dist: 11.6593, Acc: 0.7400, PTFixPNLoss: 3.9732, NetFixLoss: 30.6686, ]
2022-10-31 21:38:48,439 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3361, Pos_dist: 8.7363, Neg_dist: 11.1781, Acc: 0.7800, PTFixPNLoss: 3.9684, NetFixLoss: 34.2032, ]
2022-10-31 21:38:49,026 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4386, Pos_dist: 8.8371, Neg_dist: 11.0565, Acc: 0.7600, PTFixPNLoss: 3.9758, NetFixLoss: 37.6941, ]
2022-10-31 21:38:49,635 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4105, Pos_dist: 8.7846, Neg_dist: 11.1852, Acc: 0.7200, PTFixPNLoss: 3.9732, NetFixLoss: 41.2229, ]
2022-10-31 21:38:49,729 INFO: fine-tune procedure is finished!
2022-10-31 21:39:32,459 INFO: [Test_acc of task 2 on test 3: 0.52257][acc of former classes: 0.60200][acc of former samples in all classes: 0.59233]
[acc of novel samples in all classes: 0.10400]
2022-10-31 21:39:32,743 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:39:32,771 WARNING: Current net - loaded net:
2022-10-31 21:39:32,771 WARNING: Loaded net - current net:
2022-10-31 21:39:32,771 WARNING:   func.classifier.bias
2022-10-31 21:39:32,772 WARNING:   func.classifier.weight
2022-10-31 21:39:32,783 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_2.pth.
2022-10-31 21:39:32,824 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:39:32,837 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:39:32,837 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:39:32,837 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:39:32,837 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:39:32,837 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:39:32,837 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:39:32,837 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:39:32,837 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:39:32,837 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:39:32,838 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:39:32,839 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:39:32,840 INFO: Model [FSLLModel] is created.
2022-10-31 21:39:32,846 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:39:32,851 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:39:32,857 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-31 21:39:33,453 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4876, Pos_dist: 8.8118, Neg_dist: 11.0872, Acc: 0.7333, PTFixPNLoss: 4.0350, NetFixLoss: 0.0000, ]
2022-10-31 21:39:34,113 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2511, Pos_dist: 8.6898, Neg_dist: 11.9699, Acc: 0.7733, PTFixPNLoss: 4.0337, NetFixLoss: 1.7193, ]
2022-10-31 21:39:34,847 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2740, Pos_dist: 8.6736, Neg_dist: 11.5127, Acc: 0.7733, PTFixPNLoss: 4.0314, NetFixLoss: 3.6471, ]
2022-10-31 21:39:35,612 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4051, Pos_dist: 8.8168, Neg_dist: 11.2686, Acc: 0.6800, PTFixPNLoss: 4.0435, NetFixLoss: 5.9315, ]
2022-10-31 21:39:36,305 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2949, Pos_dist: 8.7230, Neg_dist: 11.4001, Acc: 0.8133, PTFixPNLoss: 4.0348, NetFixLoss: 8.5546, ]
2022-10-31 21:39:37,129 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3461, Pos_dist: 8.7891, Neg_dist: 11.4467, Acc: 0.7600, PTFixPNLoss: 4.0381, NetFixLoss: 11.4470, ]
2022-10-31 21:39:37,995 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3950, Pos_dist: 8.7960, Neg_dist: 11.2972, Acc: 0.7867, PTFixPNLoss: 4.0409, NetFixLoss: 14.4769, ]
2022-10-31 21:39:38,705 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4273, Pos_dist: 8.8132, Neg_dist: 11.1894, Acc: 0.6800, PTFixPNLoss: 4.0380, NetFixLoss: 17.7420, ]
2022-10-31 21:39:39,423 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4567, Pos_dist: 8.8947, Neg_dist: 11.6949, Acc: 0.7200, PTFixPNLoss: 4.0358, NetFixLoss: 21.2521, ]
2022-10-31 21:39:40,238 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1359, Pos_dist: 8.6232, Neg_dist: 12.0907, Acc: 0.8400, PTFixPNLoss: 4.0376, NetFixLoss: 24.8261, ]
2022-10-31 21:39:41,022 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3165, Pos_dist: 8.7649, Neg_dist: 11.5676, Acc: 0.7200, PTFixPNLoss: 4.0347, NetFixLoss: 28.3257, ]
2022-10-31 21:39:41,721 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2052, Pos_dist: 8.6256, Neg_dist: 12.0602, Acc: 0.8133, PTFixPNLoss: 4.0298, NetFixLoss: 31.7044, ]
2022-10-31 21:39:42,340 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4727, Pos_dist: 8.7252, Neg_dist: 11.1352, Acc: 0.7733, PTFixPNLoss: 4.0351, NetFixLoss: 34.9525, ]
2022-10-31 21:39:43,061 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.5050, Pos_dist: 8.7156, Neg_dist: 10.6813, Acc: 0.7333, PTFixPNLoss: 4.0357, NetFixLoss: 38.2282, ]
2022-10-31 21:39:43,704 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2462, Pos_dist: 8.6935, Neg_dist: 11.7399, Acc: 0.7733, PTFixPNLoss: 4.0291, NetFixLoss: 41.4874, ]
2022-10-31 21:39:43,776 INFO: fine-tune procedure is finished!
2022-10-31 21:40:29,077 INFO: [Test_acc of task 3 on test 3: 0.49680][acc of former classes: 0.60850][acc of former samples in all classes: 0.59150]
[acc of novel samples in all classes: 0.11800]
2022-10-31 21:40:29,373 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:40:29,405 WARNING: Current net - loaded net:
2022-10-31 21:40:29,405 WARNING: Loaded net - current net:
2022-10-31 21:40:29,405 WARNING:   func.classifier.bias
2022-10-31 21:40:29,405 WARNING:   func.classifier.weight
2022-10-31 21:40:29,417 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_3.pth.
2022-10-31 21:40:29,459 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:40:29,472 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:40:29,472 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:40:29,472 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:40:29,473 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:40:29,473 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:40:29,473 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:40:29,473 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:40:29,474 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:40:29,475 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:40:29,475 INFO: Model [FSLLModel] is created.
2022-10-31 21:40:29,482 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:40:29,488 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:40:29,494 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:40:29,500 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 21:40:30,142 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5038, Pos_dist: 8.8187, Neg_dist: 11.0386, Acc: 0.7600, PTFixPNLoss: 4.1016, NetFixLoss: 0.0000, ]
2022-10-31 21:40:30,876 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4304, Pos_dist: 8.7716, Neg_dist: 11.1181, Acc: 0.7400, PTFixPNLoss: 4.1009, NetFixLoss: 1.6420, ]
2022-10-31 21:40:31,606 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4774, Pos_dist: 8.6803, Neg_dist: 11.1107, Acc: 0.7600, PTFixPNLoss: 4.0959, NetFixLoss: 3.7615, ]
2022-10-31 21:40:32,350 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.6943, Pos_dist: 8.6510, Neg_dist: 10.4099, Acc: 0.7600, PTFixPNLoss: 4.0980, NetFixLoss: 6.2999, ]
2022-10-31 21:40:33,050 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4039, Pos_dist: 8.8421, Neg_dist: 11.3800, Acc: 0.6900, PTFixPNLoss: 4.1003, NetFixLoss: 9.1980, ]
2022-10-31 21:40:33,820 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2749, Pos_dist: 8.8003, Neg_dist: 12.0129, Acc: 0.8500, PTFixPNLoss: 4.1039, NetFixLoss: 12.3402, ]
2022-10-31 21:40:34,575 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1881, Pos_dist: 8.6589, Neg_dist: 11.8687, Acc: 0.7600, PTFixPNLoss: 4.0976, NetFixLoss: 15.5858, ]
2022-10-31 21:40:35,289 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3875, Pos_dist: 8.8148, Neg_dist: 11.2209, Acc: 0.7300, PTFixPNLoss: 4.1011, NetFixLoss: 18.8025, ]
2022-10-31 21:40:36,079 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3195, Pos_dist: 8.6990, Neg_dist: 11.4617, Acc: 0.7900, PTFixPNLoss: 4.1026, NetFixLoss: 22.0636, ]
2022-10-31 21:40:37,073 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4057, Pos_dist: 8.6959, Neg_dist: 11.1174, Acc: 0.8000, PTFixPNLoss: 4.0972, NetFixLoss: 25.3632, ]
2022-10-31 21:40:37,937 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2600, Pos_dist: 8.8479, Neg_dist: 11.8210, Acc: 0.7900, PTFixPNLoss: 4.1066, NetFixLoss: 28.6808, ]
2022-10-31 21:40:38,653 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3367, Pos_dist: 8.7194, Neg_dist: 11.5318, Acc: 0.7800, PTFixPNLoss: 4.0964, NetFixLoss: 31.9633, ]
2022-10-31 21:40:39,365 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3761, Pos_dist: 8.7199, Neg_dist: 11.2886, Acc: 0.7800, PTFixPNLoss: 4.1014, NetFixLoss: 35.2404, ]
2022-10-31 21:40:40,110 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3230, Pos_dist: 8.7056, Neg_dist: 11.4426, Acc: 0.8000, PTFixPNLoss: 4.1007, NetFixLoss: 38.5176, ]
2022-10-31 21:40:40,855 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2866, Pos_dist: 8.7879, Neg_dist: 11.6074, Acc: 0.7600, PTFixPNLoss: 4.1054, NetFixLoss: 41.8222, ]
2022-10-31 21:40:40,924 INFO: fine-tune procedure is finished!
2022-10-31 21:41:28,374 INFO: [Test_acc of task 4 on test 3: 0.47737][acc of former classes: 0.61367][acc of former samples in all classes: 0.59433]
[acc of novel samples in all classes: 0.12650]
2022-10-31 21:41:28,649 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:41:28,678 WARNING: Current net - loaded net:
2022-10-31 21:41:28,679 WARNING: Loaded net - current net:
2022-10-31 21:41:28,679 WARNING:   func.classifier.bias
2022-10-31 21:41:28,679 WARNING:   func.classifier.weight
2022-10-31 21:41:28,690 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_4.pth.
2022-10-31 21:41:28,728 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:41:28,741 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:41:28,741 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:41:28,741 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:41:28,741 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:41:28,741 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:41:28,741 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:41:28,741 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:41:28,742 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:41:28,743 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:41:28,743 INFO: Model [FSLLModel] is created.
2022-10-31 21:41:28,750 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:41:28,755 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:41:28,761 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:41:28,766 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:41:28,772 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-31 21:41:29,528 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2968, Pos_dist: 8.7932, Neg_dist: 11.7102, Acc: 0.7520, PTFixPNLoss: 4.1630, NetFixLoss: 0.0000, ]
2022-10-31 21:41:30,284 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4030, Pos_dist: 8.7810, Neg_dist: 11.5927, Acc: 0.7200, PTFixPNLoss: 4.1737, NetFixLoss: 1.4099, ]
2022-10-31 21:41:31,249 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3459, Pos_dist: 8.6902, Neg_dist: 11.4845, Acc: 0.7440, PTFixPNLoss: 4.1619, NetFixLoss: 3.2814, ]
2022-10-31 21:41:32,188 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5106, Pos_dist: 8.7633, Neg_dist: 10.9407, Acc: 0.7520, PTFixPNLoss: 4.1641, NetFixLoss: 5.4336, ]
2022-10-31 21:41:33,007 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2172, Pos_dist: 8.7018, Neg_dist: 11.7628, Acc: 0.7920, PTFixPNLoss: 4.1583, NetFixLoss: 7.9312, ]
2022-10-31 21:41:33,998 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1379, Pos_dist: 8.7256, Neg_dist: 12.3584, Acc: 0.7360, PTFixPNLoss: 4.1620, NetFixLoss: 10.5445, ]
2022-10-31 21:41:34,902 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4782, Pos_dist: 8.6809, Neg_dist: 10.7779, Acc: 0.7840, PTFixPNLoss: 4.1632, NetFixLoss: 13.1970, ]
2022-10-31 21:41:35,705 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1390, Pos_dist: 8.8157, Neg_dist: 12.9852, Acc: 0.7680, PTFixPNLoss: 4.1671, NetFixLoss: 15.9323, ]
2022-10-31 21:41:36,569 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4044, Pos_dist: 8.6887, Neg_dist: 11.1708, Acc: 0.7920, PTFixPNLoss: 4.1578, NetFixLoss: 18.6785, ]
2022-10-31 21:41:37,450 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2745, Pos_dist: 8.7883, Neg_dist: 11.8043, Acc: 0.7600, PTFixPNLoss: 4.1626, NetFixLoss: 21.4651, ]
2022-10-31 21:41:38,406 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3211, Pos_dist: 8.7135, Neg_dist: 11.3968, Acc: 0.7680, PTFixPNLoss: 4.1631, NetFixLoss: 24.2235, ]
2022-10-31 21:41:39,294 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1869, Pos_dist: 8.6671, Neg_dist: 11.8578, Acc: 0.7280, PTFixPNLoss: 4.1576, NetFixLoss: 27.0137, ]
2022-10-31 21:41:40,259 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.5253, Pos_dist: 8.6875, Neg_dist: 10.8539, Acc: 0.7360, PTFixPNLoss: 4.1551, NetFixLoss: 29.8992, ]
2022-10-31 21:41:41,079 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3252, Pos_dist: 8.6424, Neg_dist: 11.3599, Acc: 0.7680, PTFixPNLoss: 4.1529, NetFixLoss: 32.7970, ]
2022-10-31 21:41:41,955 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.5067, Pos_dist: 8.6471, Neg_dist: 10.9856, Acc: 0.8080, PTFixPNLoss: 4.1612, NetFixLoss: 35.7014, ]
2022-10-31 21:41:42,056 INFO: fine-tune procedure is finished!
2022-10-31 21:42:31,780 INFO: [Test_acc of task 5 on test 3: 0.45376][acc of former classes: 0.61200][acc of former samples in all classes: 0.58517]
[acc of novel samples in all classes: 0.13840]
2022-10-31 21:42:32,053 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:42:32,083 WARNING: Current net - loaded net:
2022-10-31 21:42:32,084 WARNING: Loaded net - current net:
2022-10-31 21:42:32,084 WARNING:   func.classifier.bias
2022-10-31 21:42:32,084 WARNING:   func.classifier.weight
2022-10-31 21:42:32,093 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_5.pth.
2022-10-31 21:42:32,124 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:42:32,136 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:42:32,136 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:42:32,136 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:42:32,137 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:42:32,137 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:42:32,137 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:42:32,137 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:42:32,138 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:42:32,139 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:42:32,139 INFO: Model [FSLLModel] is created.
2022-10-31 21:42:32,145 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:42:32,151 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:42:32,156 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:42:32,162 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:42:32,167 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:42:32,173 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 21:42:32,940 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4108, Pos_dist: 8.6028, Neg_dist: 11.3607, Acc: 0.7467, PTFixPNLoss: 4.2107, NetFixLoss: 0.0000, ]
2022-10-31 21:42:33,807 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2682, Pos_dist: 8.7540, Neg_dist: 11.8471, Acc: 0.7467, PTFixPNLoss: 4.2236, NetFixLoss: 1.2142, ]
2022-10-31 21:42:34,690 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2546, Pos_dist: 8.6193, Neg_dist: 11.4492, Acc: 0.7600, PTFixPNLoss: 4.2154, NetFixLoss: 2.7760, ]
2022-10-31 21:42:35,513 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3920, Pos_dist: 8.7852, Neg_dist: 11.3035, Acc: 0.7267, PTFixPNLoss: 4.2258, NetFixLoss: 4.6890, ]
2022-10-31 21:42:36,392 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3312, Pos_dist: 8.6112, Neg_dist: 11.4207, Acc: 0.7667, PTFixPNLoss: 4.2157, NetFixLoss: 6.9483, ]
2022-10-31 21:42:37,423 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3311, Pos_dist: 8.6999, Neg_dist: 11.7377, Acc: 0.7800, PTFixPNLoss: 4.2248, NetFixLoss: 9.3946, ]
2022-10-31 21:42:38,429 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2475, Pos_dist: 8.6967, Neg_dist: 12.1774, Acc: 0.7733, PTFixPNLoss: 4.2201, NetFixLoss: 12.0880, ]
2022-10-31 21:42:39,457 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.5176, Pos_dist: 8.6921, Neg_dist: 10.8635, Acc: 0.7200, PTFixPNLoss: 4.2200, NetFixLoss: 14.8286, ]
2022-10-31 21:42:40,346 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3708, Pos_dist: 8.6727, Neg_dist: 11.3340, Acc: 0.7533, PTFixPNLoss: 4.2183, NetFixLoss: 17.7209, ]
2022-10-31 21:42:41,350 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2246, Pos_dist: 8.7892, Neg_dist: 11.7575, Acc: 0.7667, PTFixPNLoss: 4.2260, NetFixLoss: 20.8425, ]
2022-10-31 21:42:42,409 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4789, Pos_dist: 8.8511, Neg_dist: 11.5069, Acc: 0.7333, PTFixPNLoss: 4.2244, NetFixLoss: 23.9986, ]
2022-10-31 21:42:43,300 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1521, Pos_dist: 8.6915, Neg_dist: 12.1627, Acc: 0.7733, PTFixPNLoss: 4.2204, NetFixLoss: 27.1310, ]
2022-10-31 21:42:44,201 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2089, Pos_dist: 8.6030, Neg_dist: 11.8898, Acc: 0.7133, PTFixPNLoss: 4.2155, NetFixLoss: 30.2502, ]
2022-10-31 21:42:45,048 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3585, Pos_dist: 8.7083, Neg_dist: 11.2885, Acc: 0.8267, PTFixPNLoss: 4.2201, NetFixLoss: 33.2382, ]
2022-10-31 21:42:46,010 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3710, Pos_dist: 8.7372, Neg_dist: 11.3202, Acc: 0.7467, PTFixPNLoss: 4.2217, NetFixLoss: 36.1571, ]
2022-10-31 21:42:46,086 INFO: fine-tune procedure is finished!
2022-10-31 21:43:37,806 INFO: [Test_acc of task 6 on test 3: 0.43478][acc of former classes: 0.61683][acc of former samples in all classes: 0.58667]
[acc of novel samples in all classes: 0.13100]
2022-10-31 21:43:38,094 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:43:38,130 WARNING: Current net - loaded net:
2022-10-31 21:43:38,132 WARNING: Loaded net - current net:
2022-10-31 21:43:38,132 WARNING:   func.classifier.bias
2022-10-31 21:43:38,132 WARNING:   func.classifier.weight
2022-10-31 21:43:38,152 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_6.pth.
2022-10-31 21:43:38,194 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:43:38,208 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:43:38,208 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:43:38,208 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:43:38,208 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:43:38,208 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:43:38,208 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:43:38,208 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:43:38,208 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:43:38,208 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:43:38,208 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:43:38,208 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:43:38,208 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:43:38,209 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:43:38,210 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:43:38,211 INFO: Model [FSLLModel] is created.
2022-10-31 21:43:38,217 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:43:38,222 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:43:38,228 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:43:38,245 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:43:38,255 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:43:38,261 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:43:38,267 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-31 21:43:39,150 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2875, Pos_dist: 8.6798, Neg_dist: 11.8128, Acc: 0.7657, PTFixPNLoss: 4.2745, NetFixLoss: 0.0000, ]
2022-10-31 21:43:40,378 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3604, Pos_dist: 8.6820, Neg_dist: 11.2194, Acc: 0.7943, PTFixPNLoss: 4.2747, NetFixLoss: 1.1146, ]
2022-10-31 21:43:41,625 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3177, Pos_dist: 8.7397, Neg_dist: 11.7147, Acc: 0.7429, PTFixPNLoss: 4.2752, NetFixLoss: 2.8486, ]
2022-10-31 21:43:42,711 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2512, Pos_dist: 8.8055, Neg_dist: 11.8853, Acc: 0.7143, PTFixPNLoss: 4.2740, NetFixLoss: 4.8772, ]
2022-10-31 21:43:43,668 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1978, Pos_dist: 8.7302, Neg_dist: 11.9176, Acc: 0.7486, PTFixPNLoss: 4.2730, NetFixLoss: 7.0790, ]
2022-10-31 21:43:44,764 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2585, Pos_dist: 8.6730, Neg_dist: 11.4831, Acc: 0.7314, PTFixPNLoss: 4.2713, NetFixLoss: 9.3634, ]
2022-10-31 21:43:45,676 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3372, Pos_dist: 8.6946, Neg_dist: 11.2832, Acc: 0.7600, PTFixPNLoss: 4.2779, NetFixLoss: 11.7075, ]
2022-10-31 21:43:46,623 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4941, Pos_dist: 8.6655, Neg_dist: 11.1582, Acc: 0.7371, PTFixPNLoss: 4.2712, NetFixLoss: 14.1436, ]
2022-10-31 21:43:47,780 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3862, Pos_dist: 8.6489, Neg_dist: 11.2549, Acc: 0.7257, PTFixPNLoss: 4.2655, NetFixLoss: 16.6776, ]
2022-10-31 21:43:48,824 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2049, Pos_dist: 8.5987, Neg_dist: 11.5805, Acc: 0.8057, PTFixPNLoss: 4.2731, NetFixLoss: 19.3130, ]
2022-10-31 21:43:49,945 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2498, Pos_dist: 8.6682, Neg_dist: 11.5380, Acc: 0.7657, PTFixPNLoss: 4.2736, NetFixLoss: 21.9806, ]
2022-10-31 21:43:50,868 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.6337, Pos_dist: 8.7051, Neg_dist: 10.6914, Acc: 0.7600, PTFixPNLoss: 4.2752, NetFixLoss: 24.7013, ]
2022-10-31 21:43:51,909 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2549, Pos_dist: 8.6839, Neg_dist: 12.0365, Acc: 0.7543, PTFixPNLoss: 4.2749, NetFixLoss: 27.4901, ]
2022-10-31 21:43:52,975 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2104, Pos_dist: 8.6943, Neg_dist: 12.7448, Acc: 0.7257, PTFixPNLoss: 4.2757, NetFixLoss: 30.2883, ]
2022-10-31 21:43:53,963 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2528, Pos_dist: 8.6854, Neg_dist: 11.7597, Acc: 0.7143, PTFixPNLoss: 4.2726, NetFixLoss: 33.0221, ]
2022-10-31 21:43:54,035 INFO: fine-tune procedure is finished!
2022-10-31 21:44:47,940 INFO: [Test_acc of task 7 on test 3: 0.42589][acc of former classes: 0.62067][acc of former samples in all classes: 0.58467]
[acc of novel samples in all classes: 0.15371]
2022-10-31 21:44:48,213 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:44:48,242 WARNING: Current net - loaded net:
2022-10-31 21:44:48,242 WARNING: Loaded net - current net:
2022-10-31 21:44:48,242 WARNING:   func.classifier.bias
2022-10-31 21:44:48,242 WARNING:   func.classifier.weight
2022-10-31 21:44:48,251 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_7.pth.
2022-10-31 21:44:48,279 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:44:48,295 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:44:48,295 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:44:48,295 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:44:48,295 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:44:48,295 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:44:48,295 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:44:48,295 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:44:48,296 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:44:48,297 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:44:48,297 INFO: Model [FSLLModel] is created.
2022-10-31 21:44:48,304 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:44:48,309 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:44:48,315 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:44:48,320 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:44:48,326 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:44:48,331 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:44:48,337 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:44:48,342 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 21:44:49,313 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2522, Pos_dist: 8.6195, Neg_dist: 11.5290, Acc: 0.7800, PTFixPNLoss: 4.3183, NetFixLoss: 0.0000, ]
2022-10-31 21:44:50,315 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2257, Pos_dist: 8.6651, Neg_dist: 11.6111, Acc: 0.7750, PTFixPNLoss: 4.3193, NetFixLoss: 1.2386, ]
2022-10-31 21:44:51,317 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2512, Pos_dist: 8.6865, Neg_dist: 11.8186, Acc: 0.7350, PTFixPNLoss: 4.3239, NetFixLoss: 2.7928, ]
2022-10-31 21:44:52,548 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1419, Pos_dist: 8.6986, Neg_dist: 12.4259, Acc: 0.7400, PTFixPNLoss: 4.3222, NetFixLoss: 4.5789, ]
2022-10-31 21:44:53,698 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3811, Pos_dist: 8.6646, Neg_dist: 11.5345, Acc: 0.7300, PTFixPNLoss: 4.3294, NetFixLoss: 6.4571, ]
2022-10-31 21:44:54,865 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3513, Pos_dist: 8.6571, Neg_dist: 11.3742, Acc: 0.7750, PTFixPNLoss: 4.3179, NetFixLoss: 8.4678, ]
2022-10-31 21:44:55,917 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1554, Pos_dist: 8.6318, Neg_dist: 12.2142, Acc: 0.7650, PTFixPNLoss: 4.3237, NetFixLoss: 10.6463, ]
2022-10-31 21:44:57,149 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2746, Pos_dist: 8.6987, Neg_dist: 11.8132, Acc: 0.7650, PTFixPNLoss: 4.3248, NetFixLoss: 12.8411, ]
2022-10-31 21:44:58,193 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1210, Pos_dist: 8.5985, Neg_dist: 12.2196, Acc: 0.7600, PTFixPNLoss: 4.3195, NetFixLoss: 15.0519, ]
2022-10-31 21:44:59,182 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4220, Pos_dist: 8.6993, Neg_dist: 11.1059, Acc: 0.7700, PTFixPNLoss: 4.3236, NetFixLoss: 17.2212, ]
2022-10-31 21:45:00,178 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2807, Pos_dist: 8.6977, Neg_dist: 11.6852, Acc: 0.7550, PTFixPNLoss: 4.3248, NetFixLoss: 19.4540, ]
2022-10-31 21:45:01,183 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3908, Pos_dist: 8.7427, Neg_dist: 11.2816, Acc: 0.7050, PTFixPNLoss: 4.3270, NetFixLoss: 21.7707, ]
2022-10-31 21:45:02,209 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2847, Pos_dist: 8.6089, Neg_dist: 11.5570, Acc: 0.7650, PTFixPNLoss: 4.3148, NetFixLoss: 24.2063, ]
2022-10-31 21:45:03,201 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3813, Pos_dist: 8.6532, Neg_dist: 11.3082, Acc: 0.7500, PTFixPNLoss: 4.3192, NetFixLoss: 26.6892, ]
2022-10-31 21:45:04,209 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4697, Pos_dist: 8.7108, Neg_dist: 10.9174, Acc: 0.7500, PTFixPNLoss: 4.3230, NetFixLoss: 29.2656, ]
2022-10-31 21:45:04,294 INFO: fine-tune procedure is finished!
2022-10-31 21:46:00,198 INFO: [Test_acc of task 8 on test 3: 0.41670][acc of former classes: 0.62783][acc of former samples in all classes: 0.58850]
[acc of novel samples in all classes: 0.15900]
2022-10-31 21:46:00,472 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:46:00,501 WARNING: Current net - loaded net:
2022-10-31 21:46:00,501 WARNING: Loaded net - current net:
2022-10-31 21:46:00,501 WARNING:   func.classifier.bias
2022-10-31 21:46:00,501 WARNING:   func.classifier.weight
2022-10-31 21:46:00,511 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth.
2022-10-31 21:46:00,539 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:46:00,552 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:46:00,552 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:46:00,552 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:46:00,552 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:46:00,552 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:46:00,552 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:46:00,552 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:46:00,552 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:46:00,553 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:46:00,554 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:46:00,555 INFO: Model [FSLLModel] is created.
2022-10-31 21:46:00,561 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test0_session_0.pth
Trainset classes:
[64, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
2022-10-31 21:46:00,952 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5667, Pos_dist: 8.8237, Neg_dist: 11.3640, Acc: 0.6800, PTFixPNLoss: 3.9025, NetFixLoss: 0.0000, ]
2022-10-31 21:46:01,402 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4385, Pos_dist: 8.9271, Neg_dist: 11.2040, Acc: 0.6400, PTFixPNLoss: 3.9119, NetFixLoss: 1.9225, ]
2022-10-31 21:46:01,898 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5018, Pos_dist: 9.0180, Neg_dist: 11.2651, Acc: 0.6800, PTFixPNLoss: 3.9122, NetFixLoss: 4.4052, ]
2022-10-31 21:46:02,366 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3742, Pos_dist: 8.6219, Neg_dist: 10.7690, Acc: 0.6000, PTFixPNLoss: 3.9061, NetFixLoss: 7.6672, ]
2022-10-31 21:46:02,836 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4344, Pos_dist: 8.8179, Neg_dist: 10.8802, Acc: 0.7600, PTFixPNLoss: 3.9147, NetFixLoss: 11.3000, ]
2022-10-31 21:46:03,380 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4880, Pos_dist: 8.6121, Neg_dist: 10.8151, Acc: 0.7600, PTFixPNLoss: 3.9066, NetFixLoss: 15.2449, ]
2022-10-31 21:46:03,844 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2964, Pos_dist: 8.8625, Neg_dist: 11.3212, Acc: 0.8000, PTFixPNLoss: 3.9127, NetFixLoss: 19.2112, ]
2022-10-31 21:46:04,486 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4625, Pos_dist: 8.9204, Neg_dist: 11.2544, Acc: 0.7200, PTFixPNLoss: 3.9177, NetFixLoss: 23.2624, ]
2022-10-31 21:46:05,009 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4673, Pos_dist: 8.8507, Neg_dist: 11.1120, Acc: 0.7600, PTFixPNLoss: 3.9043, NetFixLoss: 27.3678, ]
2022-10-31 21:46:05,548 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2879, Pos_dist: 8.8017, Neg_dist: 11.5148, Acc: 0.6800, PTFixPNLoss: 3.9070, NetFixLoss: 31.5975, ]
2022-10-31 21:46:06,171 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1834, Pos_dist: 8.7886, Neg_dist: 11.6752, Acc: 0.6000, PTFixPNLoss: 3.9055, NetFixLoss: 35.9259, ]
2022-10-31 21:46:06,802 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2353, Pos_dist: 8.6566, Neg_dist: 11.3230, Acc: 0.7200, PTFixPNLoss: 3.9100, NetFixLoss: 40.3053, ]
2022-10-31 21:46:07,416 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1757, Pos_dist: 8.8371, Neg_dist: 11.7274, Acc: 0.6800, PTFixPNLoss: 3.9023, NetFixLoss: 44.5246, ]
2022-10-31 21:46:07,955 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3804, Pos_dist: 8.8588, Neg_dist: 11.1154, Acc: 0.6800, PTFixPNLoss: 3.9117, NetFixLoss: 48.6591, ]
2022-10-31 21:46:08,448 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3709, Pos_dist: 8.6312, Neg_dist: 11.0398, Acc: 0.6800, PTFixPNLoss: 3.9039, NetFixLoss: 52.7818, ]
2022-10-31 21:46:08,538 INFO: fine-tune procedure is finished!
2022-10-31 21:46:49,591 INFO: [Test_acc of task 1 on test 4: 0.56508][acc of former classes: 0.61100][acc of former samples in all classes: 0.60467]
[acc of novel samples in all classes: 0.09000]
2022-10-31 21:46:49,865 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:46:49,893 WARNING: Current net - loaded net:
2022-10-31 21:46:49,893 WARNING: Loaded net - current net:
2022-10-31 21:46:49,893 WARNING:   func.classifier.bias
2022-10-31 21:46:49,893 WARNING:   func.classifier.weight
2022-10-31 21:46:49,904 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_1.pth.
2022-10-31 21:46:49,940 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:46:49,957 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:46:49,958 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:46:49,958 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:46:49,958 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:46:49,958 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:46:49,958 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:46:49,958 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:46:49,959 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:46:49,960 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:46:49,960 INFO: Model [FSLLModel] is created.
2022-10-31 21:46:49,966 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:46:49,972 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_1.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 21:46:50,442 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3756, Pos_dist: 9.0063, Neg_dist: 11.3907, Acc: 0.5800, PTFixPNLoss: 3.9807, NetFixLoss: 0.0000, ]
2022-10-31 21:46:51,160 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4673, Pos_dist: 8.7786, Neg_dist: 11.0318, Acc: 0.7800, PTFixPNLoss: 3.9731, NetFixLoss: 1.8464, ]
2022-10-31 21:46:51,919 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2103, Pos_dist: 8.8717, Neg_dist: 11.9901, Acc: 0.8000, PTFixPNLoss: 3.9820, NetFixLoss: 4.2473, ]
2022-10-31 21:46:52,517 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1322, Pos_dist: 8.7632, Neg_dist: 12.0601, Acc: 0.7600, PTFixPNLoss: 3.9729, NetFixLoss: 6.8210, ]
2022-10-31 21:46:53,079 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4400, Pos_dist: 8.9044, Neg_dist: 11.2838, Acc: 0.7000, PTFixPNLoss: 3.9774, NetFixLoss: 9.3992, ]
2022-10-31 21:46:53,697 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.6457, Pos_dist: 8.8945, Neg_dist: 10.7462, Acc: 0.6800, PTFixPNLoss: 3.9717, NetFixLoss: 12.0945, ]
2022-10-31 21:46:54,247 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2773, Pos_dist: 8.8322, Neg_dist: 11.6905, Acc: 0.7800, PTFixPNLoss: 3.9756, NetFixLoss: 15.1296, ]
2022-10-31 21:46:54,803 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2887, Pos_dist: 8.9677, Neg_dist: 11.9613, Acc: 0.7600, PTFixPNLoss: 3.9793, NetFixLoss: 18.4262, ]
2022-10-31 21:46:55,346 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1889, Pos_dist: 8.8121, Neg_dist: 11.6999, Acc: 0.7200, PTFixPNLoss: 3.9733, NetFixLoss: 21.8629, ]
2022-10-31 21:46:55,959 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1687, Pos_dist: 8.8576, Neg_dist: 11.9522, Acc: 0.7600, PTFixPNLoss: 3.9812, NetFixLoss: 25.2868, ]
2022-10-31 21:46:56,507 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4245, Pos_dist: 8.7482, Neg_dist: 11.1474, Acc: 0.8200, PTFixPNLoss: 3.9695, NetFixLoss: 28.6973, ]
2022-10-31 21:46:57,080 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3443, Pos_dist: 8.8954, Neg_dist: 11.6798, Acc: 0.7200, PTFixPNLoss: 3.9718, NetFixLoss: 32.1149, ]
2022-10-31 21:46:57,762 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3268, Pos_dist: 8.7555, Neg_dist: 11.4313, Acc: 0.8000, PTFixPNLoss: 3.9679, NetFixLoss: 35.5566, ]
2022-10-31 21:46:58,338 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2730, Pos_dist: 8.8197, Neg_dist: 11.9468, Acc: 0.7400, PTFixPNLoss: 3.9773, NetFixLoss: 39.0470, ]
2022-10-31 21:46:59,051 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.5392, Pos_dist: 8.6566, Neg_dist: 10.7655, Acc: 0.7200, PTFixPNLoss: 3.9734, NetFixLoss: 42.5353, ]
2022-10-31 21:46:59,137 INFO: fine-tune procedure is finished!
2022-10-31 21:47:42,452 INFO: [Test_acc of task 2 on test 4: 0.51829][acc of former classes: 0.60017][acc of former samples in all classes: 0.59000]
[acc of novel samples in all classes: 0.08800]
2022-10-31 21:47:42,725 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:47:42,755 WARNING: Current net - loaded net:
2022-10-31 21:47:42,755 WARNING: Loaded net - current net:
2022-10-31 21:47:42,755 WARNING:   func.classifier.bias
2022-10-31 21:47:42,755 WARNING:   func.classifier.weight
2022-10-31 21:47:42,765 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_2.pth.
2022-10-31 21:47:42,802 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:47:42,815 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:47:42,815 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:47:42,815 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:47:42,815 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:47:42,815 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:47:42,816 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:47:42,816 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:47:42,817 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:47:42,818 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:47:42,818 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:47:42,818 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:47:42,818 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:47:42,818 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:47:42,818 INFO: Model [FSLLModel] is created.
2022-10-31 21:47:42,824 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:47:42,830 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:47:42,835 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_2.pth
Trainset classes:
[64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 60, 61, 62, 63]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74]
2022-10-31 21:47:43,439 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3291, Pos_dist: 8.6515, Neg_dist: 11.3985, Acc: 0.7733, PTFixPNLoss: 4.0348, NetFixLoss: 0.0000, ]
2022-10-31 21:47:44,198 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4089, Pos_dist: 8.9226, Neg_dist: 11.6575, Acc: 0.7600, PTFixPNLoss: 4.0469, NetFixLoss: 1.4518, ]
2022-10-31 21:47:44,917 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3593, Pos_dist: 8.7188, Neg_dist: 11.1947, Acc: 0.7333, PTFixPNLoss: 4.0377, NetFixLoss: 3.6675, ]
2022-10-31 21:47:45,609 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.6185, Pos_dist: 8.8010, Neg_dist: 10.9298, Acc: 0.7067, PTFixPNLoss: 4.0380, NetFixLoss: 6.4346, ]
2022-10-31 21:47:46,431 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3441, Pos_dist: 8.7367, Neg_dist: 11.7918, Acc: 0.7600, PTFixPNLoss: 4.0403, NetFixLoss: 9.5394, ]
2022-10-31 21:47:47,194 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4059, Pos_dist: 8.7808, Neg_dist: 11.0520, Acc: 0.8400, PTFixPNLoss: 4.0408, NetFixLoss: 12.8631, ]
2022-10-31 21:47:47,881 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1993, Pos_dist: 8.8670, Neg_dist: 12.0635, Acc: 0.7333, PTFixPNLoss: 4.0439, NetFixLoss: 16.2180, ]
2022-10-31 21:47:48,523 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1674, Pos_dist: 8.7161, Neg_dist: 12.1016, Acc: 0.8000, PTFixPNLoss: 4.0379, NetFixLoss: 19.5865, ]
2022-10-31 21:47:49,149 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3784, Pos_dist: 8.7298, Neg_dist: 11.1475, Acc: 0.8267, PTFixPNLoss: 4.0389, NetFixLoss: 22.9153, ]
2022-10-31 21:47:49,941 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.5892, Pos_dist: 8.8379, Neg_dist: 10.9434, Acc: 0.7467, PTFixPNLoss: 4.0448, NetFixLoss: 26.1672, ]
2022-10-31 21:47:50,664 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1830, Pos_dist: 8.8413, Neg_dist: 12.0428, Acc: 0.7467, PTFixPNLoss: 4.0456, NetFixLoss: 29.5314, ]
2022-10-31 21:47:51,381 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2812, Pos_dist: 8.6132, Neg_dist: 11.2683, Acc: 0.7867, PTFixPNLoss: 4.0377, NetFixLoss: 32.9305, ]
2022-10-31 21:47:52,116 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2895, Pos_dist: 8.6688, Neg_dist: 11.3187, Acc: 0.7467, PTFixPNLoss: 4.0365, NetFixLoss: 36.2599, ]
2022-10-31 21:47:52,797 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4950, Pos_dist: 8.8237, Neg_dist: 11.0775, Acc: 0.7467, PTFixPNLoss: 4.0407, NetFixLoss: 39.6122, ]
2022-10-31 21:47:53,572 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2295, Pos_dist: 8.7327, Neg_dist: 11.9159, Acc: 0.7067, PTFixPNLoss: 4.0417, NetFixLoss: 42.9140, ]
2022-10-31 21:47:53,642 INFO: fine-tune procedure is finished!
2022-10-31 21:48:38,652 INFO: [Test_acc of task 3 on test 4: 0.48840][acc of former classes: 0.59717][acc of former samples in all classes: 0.58167]
[acc of novel samples in all classes: 0.11533]
2022-10-31 21:48:38,935 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:48:38,965 WARNING: Current net - loaded net:
2022-10-31 21:48:38,965 WARNING: Loaded net - current net:
2022-10-31 21:48:38,965 WARNING:   func.classifier.bias
2022-10-31 21:48:38,965 WARNING:   func.classifier.weight
2022-10-31 21:48:38,976 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_3.pth.
2022-10-31 21:48:39,013 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:48:39,027 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:48:39,027 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:48:39,027 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:48:39,027 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:48:39,027 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:48:39,027 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:48:39,027 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:48:39,028 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:48:39,029 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:48:39,029 INFO: Model [FSLLModel] is created.
2022-10-31 21:48:39,036 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:48:39,041 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:48:39,047 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:48:39,052 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_3.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 21:48:39,739 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3431, Pos_dist: 8.6658, Neg_dist: 11.1545, Acc: 0.7900, PTFixPNLoss: 4.0964, NetFixLoss: 0.0000, ]
2022-10-31 21:48:40,496 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4972, Pos_dist: 8.7457, Neg_dist: 10.9943, Acc: 0.7500, PTFixPNLoss: 4.0985, NetFixLoss: 1.4625, ]
2022-10-31 21:48:41,408 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2034, Pos_dist: 8.6789, Neg_dist: 11.6258, Acc: 0.8100, PTFixPNLoss: 4.1038, NetFixLoss: 3.5722, ]
2022-10-31 21:48:42,119 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2433, Pos_dist: 8.6785, Neg_dist: 11.7610, Acc: 0.8100, PTFixPNLoss: 4.0953, NetFixLoss: 5.9445, ]
2022-10-31 21:48:42,823 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3548, Pos_dist: 8.7709, Neg_dist: 11.6707, Acc: 0.7800, PTFixPNLoss: 4.1028, NetFixLoss: 8.3604, ]
2022-10-31 21:48:43,544 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4301, Pos_dist: 8.7193, Neg_dist: 11.1303, Acc: 0.7900, PTFixPNLoss: 4.1041, NetFixLoss: 10.9343, ]
2022-10-31 21:48:44,267 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1885, Pos_dist: 8.7743, Neg_dist: 12.2041, Acc: 0.7900, PTFixPNLoss: 4.1013, NetFixLoss: 13.6534, ]
2022-10-31 21:48:45,036 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4116, Pos_dist: 8.8028, Neg_dist: 11.5396, Acc: 0.7400, PTFixPNLoss: 4.1039, NetFixLoss: 16.4435, ]
2022-10-31 21:48:45,744 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1610, Pos_dist: 8.8347, Neg_dist: 12.2901, Acc: 0.7300, PTFixPNLoss: 4.1079, NetFixLoss: 19.4250, ]
2022-10-31 21:48:46,427 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.5475, Pos_dist: 8.7622, Neg_dist: 10.7665, Acc: 0.7300, PTFixPNLoss: 4.0991, NetFixLoss: 22.4408, ]
2022-10-31 21:48:47,122 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3323, Pos_dist: 8.8824, Neg_dist: 11.7694, Acc: 0.7000, PTFixPNLoss: 4.1107, NetFixLoss: 25.5665, ]
2022-10-31 21:48:47,934 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2574, Pos_dist: 8.5990, Neg_dist: 11.7606, Acc: 0.8600, PTFixPNLoss: 4.0948, NetFixLoss: 28.7862, ]
2022-10-31 21:48:48,804 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3255, Pos_dist: 8.8125, Neg_dist: 11.4189, Acc: 0.7600, PTFixPNLoss: 4.1019, NetFixLoss: 32.0180, ]
2022-10-31 21:48:49,636 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2856, Pos_dist: 8.8037, Neg_dist: 11.7967, Acc: 0.7700, PTFixPNLoss: 4.0987, NetFixLoss: 35.2414, ]
2022-10-31 21:48:50,444 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2624, Pos_dist: 8.7230, Neg_dist: 11.6683, Acc: 0.7600, PTFixPNLoss: 4.1025, NetFixLoss: 38.3970, ]
2022-10-31 21:48:50,521 INFO: fine-tune procedure is finished!
2022-10-31 21:49:38,080 INFO: [Test_acc of task 4 on test 4: 0.46587][acc of former classes: 0.60000][acc of former samples in all classes: 0.58017]
[acc of novel samples in all classes: 0.12300]
2022-10-31 21:49:38,352 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:49:38,382 WARNING: Current net - loaded net:
2022-10-31 21:49:38,383 WARNING: Loaded net - current net:
2022-10-31 21:49:38,383 WARNING:   func.classifier.bias
2022-10-31 21:49:38,383 WARNING:   func.classifier.weight
2022-10-31 21:49:38,394 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_4.pth.
2022-10-31 21:49:38,431 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:49:38,446 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:49:38,446 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:49:38,446 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:49:38,446 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:49:38,446 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:49:38,446 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:49:38,446 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:49:38,447 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:49:38,448 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:49:38,449 INFO: Model [FSLLModel] is created.
2022-10-31 21:49:38,455 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:49:38,460 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:49:38,466 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:49:38,471 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:49:38,477 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_4.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]
2022-10-31 21:49:39,213 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3760, Pos_dist: 8.8018, Neg_dist: 11.7897, Acc: 0.7440, PTFixPNLoss: 4.1686, NetFixLoss: 0.0000, ]
2022-10-31 21:49:39,996 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3800, Pos_dist: 8.6766, Neg_dist: 11.2192, Acc: 0.7680, PTFixPNLoss: 4.1586, NetFixLoss: 1.1838, ]
2022-10-31 21:49:40,780 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2556, Pos_dist: 8.8573, Neg_dist: 11.9825, Acc: 0.7680, PTFixPNLoss: 4.1715, NetFixLoss: 3.0219, ]
2022-10-31 21:49:41,558 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1953, Pos_dist: 8.7103, Neg_dist: 12.2828, Acc: 0.7680, PTFixPNLoss: 4.1603, NetFixLoss: 5.2154, ]
2022-10-31 21:49:42,546 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3006, Pos_dist: 8.6352, Neg_dist: 11.6128, Acc: 0.7040, PTFixPNLoss: 4.1663, NetFixLoss: 7.5901, ]
2022-10-31 21:49:43,422 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5660, Pos_dist: 8.8673, Neg_dist: 11.0003, Acc: 0.7280, PTFixPNLoss: 4.1725, NetFixLoss: 10.0252, ]
2022-10-31 21:49:44,210 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1724, Pos_dist: 8.7351, Neg_dist: 12.2507, Acc: 0.7440, PTFixPNLoss: 4.1686, NetFixLoss: 12.6730, ]
2022-10-31 21:49:45,113 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2328, Pos_dist: 8.7690, Neg_dist: 11.8444, Acc: 0.7680, PTFixPNLoss: 4.1638, NetFixLoss: 15.3772, ]
2022-10-31 21:49:45,969 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3504, Pos_dist: 8.7726, Neg_dist: 11.3908, Acc: 0.7520, PTFixPNLoss: 4.1649, NetFixLoss: 18.0938, ]
2022-10-31 21:49:46,743 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3858, Pos_dist: 8.7985, Neg_dist: 11.3334, Acc: 0.7840, PTFixPNLoss: 4.1632, NetFixLoss: 20.8641, ]
2022-10-31 21:49:47,534 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3174, Pos_dist: 8.6559, Neg_dist: 11.5107, Acc: 0.7440, PTFixPNLoss: 4.1575, NetFixLoss: 23.6813, ]
2022-10-31 21:49:48,537 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1678, Pos_dist: 8.6625, Neg_dist: 12.1801, Acc: 0.8400, PTFixPNLoss: 4.1613, NetFixLoss: 26.6430, ]
2022-10-31 21:49:49,449 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2802, Pos_dist: 8.6493, Neg_dist: 11.4227, Acc: 0.7920, PTFixPNLoss: 4.1627, NetFixLoss: 29.5234, ]
2022-10-31 21:49:50,335 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1593, Pos_dist: 8.6972, Neg_dist: 11.9179, Acc: 0.7840, PTFixPNLoss: 4.1633, NetFixLoss: 32.5036, ]
2022-10-31 21:49:51,324 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4540, Pos_dist: 8.7199, Neg_dist: 11.1478, Acc: 0.7440, PTFixPNLoss: 4.1655, NetFixLoss: 35.3741, ]
2022-10-31 21:49:51,440 INFO: fine-tune procedure is finished!
2022-10-31 21:50:40,915 INFO: [Test_acc of task 5 on test 4: 0.44353][acc of former classes: 0.60333][acc of former samples in all classes: 0.57817]
[acc of novel samples in all classes: 0.12040]
2022-10-31 21:50:41,195 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:50:41,223 WARNING: Current net - loaded net:
2022-10-31 21:50:41,224 WARNING: Loaded net - current net:
2022-10-31 21:50:41,224 WARNING:   func.classifier.bias
2022-10-31 21:50:41,224 WARNING:   func.classifier.weight
2022-10-31 21:50:41,235 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_5.pth.
2022-10-31 21:50:41,271 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:50:41,285 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:50:41,285 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:50:41,285 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:50:41,285 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:50:41,285 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:50:41,286 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:50:41,286 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:50:41,287 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:50:41,288 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:50:41,288 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:50:41,288 INFO: Model [FSLLModel] is created.
2022-10-31 21:50:41,294 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:50:41,299 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:50:41,305 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:50:41,310 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:50:41,316 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:50:41,321 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_5.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 21:50:42,142 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1096, Pos_dist: 8.6244, Neg_dist: 12.1376, Acc: 0.7400, PTFixPNLoss: 4.2238, NetFixLoss: 0.0000, ]
2022-10-31 21:50:43,004 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1312, Pos_dist: 8.7325, Neg_dist: 12.4819, Acc: 0.7067, PTFixPNLoss: 4.2263, NetFixLoss: 0.7875, ]
2022-10-31 21:50:43,889 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4842, Pos_dist: 8.6793, Neg_dist: 11.0279, Acc: 0.7400, PTFixPNLoss: 4.2257, NetFixLoss: 1.8745, ]
2022-10-31 21:50:44,767 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4159, Pos_dist: 8.7372, Neg_dist: 11.2993, Acc: 0.7933, PTFixPNLoss: 4.2177, NetFixLoss: 3.5911, ]
2022-10-31 21:50:45,746 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4354, Pos_dist: 8.6223, Neg_dist: 11.2047, Acc: 0.7933, PTFixPNLoss: 4.2189, NetFixLoss: 5.7548, ]
2022-10-31 21:50:46,603 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2771, Pos_dist: 8.6780, Neg_dist: 11.5204, Acc: 0.8333, PTFixPNLoss: 4.2165, NetFixLoss: 8.1996, ]
2022-10-31 21:50:47,509 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2026, Pos_dist: 8.7130, Neg_dist: 12.1075, Acc: 0.7267, PTFixPNLoss: 4.2250, NetFixLoss: 10.7759, ]
2022-10-31 21:50:48,523 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3353, Pos_dist: 8.6946, Neg_dist: 11.4152, Acc: 0.7533, PTFixPNLoss: 4.2204, NetFixLoss: 13.3863, ]
2022-10-31 21:50:49,380 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3751, Pos_dist: 8.6920, Neg_dist: 11.1677, Acc: 0.7400, PTFixPNLoss: 4.2274, NetFixLoss: 16.1146, ]
2022-10-31 21:50:50,229 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3921, Pos_dist: 8.6704, Neg_dist: 11.0004, Acc: 0.7933, PTFixPNLoss: 4.2209, NetFixLoss: 18.9342, ]
2022-10-31 21:50:51,232 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2970, Pos_dist: 8.6921, Neg_dist: 11.6800, Acc: 0.7867, PTFixPNLoss: 4.2214, NetFixLoss: 21.8953, ]
2022-10-31 21:50:52,071 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3029, Pos_dist: 8.6096, Neg_dist: 11.1927, Acc: 0.7733, PTFixPNLoss: 4.2184, NetFixLoss: 24.8979, ]
2022-10-31 21:50:53,002 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1747, Pos_dist: 8.7038, Neg_dist: 12.0153, Acc: 0.7467, PTFixPNLoss: 4.2194, NetFixLoss: 27.8915, ]
2022-10-31 21:50:54,081 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4639, Pos_dist: 8.8066, Neg_dist: 11.3992, Acc: 0.7600, PTFixPNLoss: 4.2267, NetFixLoss: 30.8682, ]
2022-10-31 21:50:54,987 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.6828, Pos_dist: 8.6160, Neg_dist: 10.3823, Acc: 0.7733, PTFixPNLoss: 4.2217, NetFixLoss: 33.8298, ]
2022-10-31 21:50:55,097 INFO: fine-tune procedure is finished!
2022-10-31 21:51:46,511 INFO: [Test_acc of task 6 on test 4: 0.42356][acc of former classes: 0.60667][acc of former samples in all classes: 0.57850]
[acc of novel samples in all classes: 0.11367]
2022-10-31 21:51:46,781 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:51:46,810 WARNING: Current net - loaded net:
2022-10-31 21:51:46,811 WARNING: Loaded net - current net:
2022-10-31 21:51:46,811 WARNING:   func.classifier.bias
2022-10-31 21:51:46,811 WARNING:   func.classifier.weight
2022-10-31 21:51:46,822 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_6.pth.
2022-10-31 21:51:46,859 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:51:46,872 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:51:46,872 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:51:46,872 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:51:46,872 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:51:46,872 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:51:46,872 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:51:46,872 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:51:46,872 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:51:46,873 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:51:46,874 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:51:46,875 INFO: Model [FSLLModel] is created.
2022-10-31 21:51:46,881 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:51:46,886 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:51:46,892 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:51:46,898 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:51:46,904 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:51:46,909 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:51:46,914 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_6.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94]
2022-10-31 21:51:47,790 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3883, Pos_dist: 8.7494, Neg_dist: 11.2842, Acc: 0.7200, PTFixPNLoss: 4.2799, NetFixLoss: 0.0000, ]
2022-10-31 21:51:48,704 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2365, Pos_dist: 8.6778, Neg_dist: 11.9203, Acc: 0.7543, PTFixPNLoss: 4.2737, NetFixLoss: 1.5930, ]
2022-10-31 21:51:49,607 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3181, Pos_dist: 8.6436, Neg_dist: 11.4984, Acc: 0.8057, PTFixPNLoss: 4.2750, NetFixLoss: 3.3500, ]
2022-10-31 21:51:50,510 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1925, Pos_dist: 8.6369, Neg_dist: 12.3568, Acc: 0.8343, PTFixPNLoss: 4.2704, NetFixLoss: 5.3042, ]
2022-10-31 21:51:51,457 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3620, Pos_dist: 8.6702, Neg_dist: 11.1194, Acc: 0.7657, PTFixPNLoss: 4.2731, NetFixLoss: 7.3547, ]
2022-10-31 21:51:52,470 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2804, Pos_dist: 8.6674, Neg_dist: 11.7970, Acc: 0.7943, PTFixPNLoss: 4.2731, NetFixLoss: 9.5806, ]
2022-10-31 21:51:53,393 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2502, Pos_dist: 8.6810, Neg_dist: 11.8079, Acc: 0.8057, PTFixPNLoss: 4.2747, NetFixLoss: 12.0125, ]
2022-10-31 21:51:54,337 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.1741, Pos_dist: 8.7197, Neg_dist: 12.8215, Acc: 0.7771, PTFixPNLoss: 4.2785, NetFixLoss: 14.5712, ]
2022-10-31 21:51:55,277 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2835, Pos_dist: 8.6201, Neg_dist: 11.6064, Acc: 0.8229, PTFixPNLoss: 4.2764, NetFixLoss: 17.1916, ]
2022-10-31 21:51:56,251 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3278, Pos_dist: 8.6914, Neg_dist: 11.1136, Acc: 0.7657, PTFixPNLoss: 4.2779, NetFixLoss: 19.8073, ]
2022-10-31 21:51:57,215 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3778, Pos_dist: 8.7448, Neg_dist: 11.4136, Acc: 0.7486, PTFixPNLoss: 4.2779, NetFixLoss: 22.4929, ]
2022-10-31 21:51:58,194 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2970, Pos_dist: 8.6394, Neg_dist: 11.3744, Acc: 0.8114, PTFixPNLoss: 4.2767, NetFixLoss: 25.2922, ]
2022-10-31 21:51:59,145 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4768, Pos_dist: 8.7063, Neg_dist: 11.0207, Acc: 0.7600, PTFixPNLoss: 4.2773, NetFixLoss: 28.0658, ]
2022-10-31 21:52:00,065 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1884, Pos_dist: 8.7433, Neg_dist: 12.0896, Acc: 0.7257, PTFixPNLoss: 4.2808, NetFixLoss: 30.9296, ]
2022-10-31 21:52:00,980 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.5050, Pos_dist: 8.7255, Neg_dist: 10.8496, Acc: 0.7600, PTFixPNLoss: 4.2842, NetFixLoss: 33.7534, ]
2022-10-31 21:52:01,049 INFO: fine-tune procedure is finished!
2022-10-31 21:52:54,661 INFO: [Test_acc of task 7 on test 4: 0.41053][acc of former classes: 0.61167][acc of former samples in all classes: 0.57617]
[acc of novel samples in all classes: 0.12657]
2022-10-31 21:52:54,934 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth.
2022-10-31 21:52:54,963 WARNING: Current net - loaded net:
2022-10-31 21:52:54,963 WARNING: Loaded net - current net:
2022-10-31 21:52:54,963 WARNING:   func.classifier.bias
2022-10-31 21:52:54,963 WARNING:   func.classifier.weight
2022-10-31 21:52:54,974 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_7.pth.
2022-10-31 21:52:55,013 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/prototypes/test0_session0.pt
2022-10-31 21:52:55,026 INFO: Optimize parameters: func.base.layer3.1.conv1.weight.
2022-10-31 21:52:55,027 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 21:52:55,027 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 21:52:55,027 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 21:52:55,027 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 21:52:55,027 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 21:52:55,027 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 21:52:55,028 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.conv1.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 21:52:55,029 WARNING: Params func.base.layer4.1.bn2.bias will not be optimized.
2022-10-31 21:52:55,029 INFO: Model [FSLLModel] is created.
2022-10-31 21:52:55,036 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:52:55,041 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:52:55,047 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:52:55,052 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:52:55,058 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:52:55,063 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:52:55,069 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 21:52:55,074 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases60/FSIL_CFRPModel_res18_miniImageNet_normalDataset_baseline_baseline_60base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_7.pth
Trainset classes:
[60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 21:52:56,000 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2316, Pos_dist: 8.6582, Neg_dist: 11.9323, Acc: 0.7700, PTFixPNLoss: 4.3211, NetFixLoss: 0.0000, ]
2022-10-31 21:52:56,980 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2635, Pos_dist: 8.6551, Neg_dist: 11.6755, Acc: 0.7700, PTFixPNLoss: 4.3249, NetFixLoss: 1.0873, ]
2022-10-31 21:52:58,010 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1767, Pos_dist: 8.6169, Neg_dist: 12.4745, Acc: 0.8100, PTFixPNLoss: 4.3167, NetFixLoss: 2.4525, ]
2022-10-31 21:52:59,067 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1613, Pos_dist: 8.6085, Neg_dist: 12.3237, Acc: 0.7650, PTFixPNLoss: 4.3194, NetFixLoss: 4.0699, ]
2022-10-31 21:53:00,196 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1578, Pos_dist: 8.6317, Neg_dist: 12.0167, Acc: 0.7950, PTFixPNLoss: 4.3236, NetFixLoss: 5.7954, ]
2022-10-31 21:53:01,244 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3494, Pos_dist: 8.6358, Neg_dist: 11.2681, Acc: 0.7650, PTFixPNLoss: 4.3181, NetFixLoss: 7.6007, ]
2022-10-31 21:53:02,245 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2789, Pos_dist: 8.7034, Neg_dist: 11.8612, Acc: 0.7750, PTFixPNLoss: 4.3211, NetFixLoss: 9.5771, ]
2022-10-31 21:53:03,222 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2442, Pos_dist: 8.7300, Neg_dist: 12.0686, Acc: 0.7400, PTFixPNLoss: 4.3269, NetFixLoss: 11.7120, ]
2022-10-31 21:53:04,210 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2810, Pos_dist: 8.6028, Neg_dist: 11.3241, Acc: 0.7750, PTFixPNLoss: 4.3181, NetFixLoss: 13.9659, ]
2022-10-31 21:53:05,197 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2066, Pos_dist: 8.7367, Neg_dist: 11.9021, Acc: 0.7850, PTFixPNLoss: 4.3280, NetFixLoss: 16.3204, ]
2022-10-31 21:53:06,197 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3596, Pos_dist: 8.6572, Neg_dist: 11.2491, Acc: 0.7700, PTFixPNLoss: 4.3275, NetFixLoss: 18.7201, ]
2022-10-31 21:53:07,211 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1952, Pos_dist: 8.6785, Neg_dist: 11.9565, Acc: 0.7600, PTFixPNLoss: 4.3196, NetFixLoss: 21.1518, ]
2022-10-31 21:53:08,353 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.1331, Pos_dist: 8.5836, Neg_dist: 12.0359, Acc: 0.7850, PTFixPNLoss: 4.3181, NetFixLoss: 23.5712, ]
2022-10-31 21:53:09,425 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2565, Pos_dist: 8.6057, Neg_dist: 11.5336, Acc: 0.7550, PTFixPNLoss: 4.3211, NetFixLoss: 25.9477, ]
2022-10-31 21:53:10,578 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2627, Pos_dist: 8.5631, Neg_dist: 11.4137, Acc: 0.7950, PTFixPNLoss: 4.3216, NetFixLoss: 28.2808, ]
2022-10-31 21:53:10,662 INFO: fine-tune procedure is finished!
2022-10-31 21:54:06,354 INFO: [Test_acc of task 8 on test 4: 0.40260][acc of former classes: 0.62000][acc of former samples in all classes: 0.58000]
[acc of novel samples in all classes: 0.13650]
2022-10-31 21:54:06,504 INFO: --------------------------Final Avg Acc-------------------------
2022-10-31 21:54:06,504 INFO: Session 1: 66.98+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.6698]
2022-10-31 21:54:06,504 INFO: Session 2: 57.23+-0.39[acc of former classes: 0.6189][acc of former samples in all classes: 0.6130]
[acc of novel samples in all classes: 0.0840]
2022-10-31 21:54:06,504 INFO: Session 3: 52.47+-0.34[acc of former classes: 0.6070][acc of former samples in all classes: 0.5968]
[acc of novel samples in all classes: 0.0918]
2022-10-31 21:54:06,505 INFO: Session 4: 49.66+-0.42[acc of former classes: 0.6081][acc of former samples in all classes: 0.5928]
[acc of novel samples in all classes: 0.1116]
2022-10-31 21:54:06,505 INFO: Session 5: 47.45+-0.46[acc of former classes: 0.6119][acc of former samples in all classes: 0.5912]
[acc of novel samples in all classes: 0.1244]
2022-10-31 21:54:06,505 INFO: Session 6: 45.20+-0.38[acc of former classes: 0.6119][acc of former samples in all classes: 0.5868]
[acc of novel samples in all classes: 0.1287]
2022-10-31 21:54:06,505 INFO: Session 7: 43.29+-0.42[acc of former classes: 0.6168][acc of former samples in all classes: 0.5874]
[acc of novel samples in all classes: 0.1237]
2022-10-31 21:54:06,505 INFO: Session 8: 42.06+-0.47[acc of former classes: 0.6190][acc of former samples in all classes: 0.5854]
[acc of novel samples in all classes: 0.1382]
2022-10-31 21:54:06,505 INFO: Session 9: 41.18+-0.42[acc of former classes: 0.6272][acc of former samples in all classes: 0.5889]
[acc of novel samples in all classes: 0.1462]
2022-10-31 21:54:06,505 INFO: random seed: 1997
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases60/FSIL_FSLLModel_res18_cifar_baseline_5shots_wandb_debug/models/test4_session_8.pth
finish!!
