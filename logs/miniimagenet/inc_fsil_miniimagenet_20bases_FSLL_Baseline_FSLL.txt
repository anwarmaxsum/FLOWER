2022-10-31 22:24:39,574 INFO: 
Version Information: 
	PyTorch: 1.9.0a0+df837d0
	TorchVision: 0.9.0a0
2022-10-31 22:24:39,575 INFO: 
  name: FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug
  model_type: FSLLModel
  gpu: 1
  manual_seed: 1997
  use_cosine: False
  Random: False
  details: True
  transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
  datasets:[
    train:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/train
      aug: True
      pre_load: False
      num_worker_per_gpu: 8
      batch_size: 25
      pin_memory: True
      sampler:[
        type: TaskSampler
        num_samples: 5
      ]
      phase: train
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    val:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      pre_load: False
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: val
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
    test:[
      name: miniImageNet
      type: NormalDataset
      total_classes: 100
      dataroot: ./DataSet/FSIL_miniImageNet/miniimagenet/test
      aug: False
      pre_load: True
      num_worker_per_gpu: 8
      sampler:[
        type: None
      ]
      phase: test
      transformer_agu: [OrderedDict([('type', 'RandomResizedCrop'), ('size', 84)]), OrderedDict([('type', 'ColorJitter'), ('brightness', 0.4), ('contrast', 0.4), ('saturation', 0.4)]), OrderedDict([('type', 'RandomHorizontalFlip')]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
      transformer: [OrderedDict([('type', 'Resize'), ('size', 92)]), OrderedDict([('type', 'CenterCrop'), ('size', 84)]), OrderedDict([('type', 'ToTensor')]), OrderedDict([('type', 'Normalize'), ('mean', (0.485, 0.456, 0.406)), ('std', (0.229, 0.224, 0.225))])]
    ]
  ]
  network_g:[
    type: Resnet18_softmax
    Embed_dim: 512
    pretrained: False
    norm: False
    num_classes: 20
    adopt_classifier: False
    addition_net: False
    flatten: True
    cut_at_pooling: False
  ]
  path:[
    pretrain_model_g: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
    base_model: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
    strict_load: False
    root: /workspace/FLOWER/f2m
    incremental_root: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug
    training_states: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/training_states
    log: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug
    models: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models
    prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes
    feat_buffer: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/feat_buffer
  ]
  train:[
    optim_g:[
      type: SGD
      lr: 0.001
      weight_decay: 0.0005
      momentum: 0.9
    ]
    scheduler:[
      type: MultiStepLR
      milestones: [160]
      gamma: 0.1
    ]
    fine_tune: True
    fine_tune_epoch: 15
    threshold: 0.16
    warmup_iter: -1
    bases: 20
    tasks: 9
    shots: 5
    novel_exemplars: 5
    num_test: 5
    metric_opt:[
      type: TripletLossNoHardMining
      margin: 0.0
      num_instances: 5
    ]
    pn_opt:[
      type: IncrementalPTFixPNLoss
      w: 1.0
      omega: 1.0
      n_shots: 5
      use_cosine: True
    ]
    regularization:[
      type: IncrementalNetworkFixLoss
      w: 5.0
    ]
  ]
  val:[
    val_freq: 200
    test_type: NCM
    p_norm: None
  ]
  logger:[
    print_freq: 2
    use_tb_logger: True
    wandb:[
      project: FIL-Noise-Cifar-Incremental
      resume_id: None
    ]
  ]
  is_train: False
  is_incremental: True
  rank: 0
  world_size: 1

2022-10-31 22:24:39,575 INFO: Random seed: 1997
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:181: UserWarning: nn.init.kaiming_normal is now deprecated in favor of nn.init.kaiming_normal_.
  init.kaiming_normal(m.weight, mode='fan_out')
/workspace/FLOWER/f2m/methods/archs/resnet_pytorch_arch.py:188: UserWarning: nn.init.normal is now deprecated in favor of nn.init.normal_.
  init.normal(m.weight, std=0.001)
2022-10-31 22:24:41,431 INFO: Network: Resnet18_softmax, with parameters: 11,689,512
2022-10-31 22:24:41,431 INFO: Resnet18_softmax(
  (func): ResNet_pytorch(
    (base): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=1000, bias=True)
    )
  )
)
2022-10-31 22:24:41,431 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:24:41,477 WARNING: Current net - loaded net:
2022-10-31 22:24:41,477 WARNING: Loaded net - current net:
2022-10-31 22:24:41,477 WARNING:   func.classifier.bias
2022-10-31 22:24:41,477 WARNING:   func.classifier.weight
2022-10-31 22:24:41,507 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:24:41,535 WARNING: Current net - loaded net:
2022-10-31 22:24:41,535 WARNING: Loaded net - current net:
2022-10-31 22:24:41,535 WARNING:   func.classifier.bias
2022-10-31 22:24:41,535 WARNING:   func.classifier.weight
2022-10-31 22:24:41,597 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:24:41,597 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:24:41,597 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:24:41,597 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:24:41,597 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:24:41,597 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:24:41,598 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:24:41,598 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:24:41,599 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:24:41,600 INFO: Model [FSLLModel] is created.
2022-10-31 22:24:57,835 INFO: [Test_acc of task 0 on test 0: 0.68050][acc of former classes: 0.00000][acc of former samples in all classes: 0.00000]
[acc of novel samples in all classes: 0.68050]
2022-10-31 22:24:58,103 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:24:58,135 WARNING: Current net - loaded net:
2022-10-31 22:24:58,135 WARNING: Loaded net - current net:
2022-10-31 22:24:58,135 WARNING:   func.classifier.bias
2022-10-31 22:24:58,135 WARNING:   func.classifier.weight
2022-10-31 22:24:58,163 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth.
2022-10-31 22:24:58,222 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:24:58,251 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:24:58,251 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:24:58,251 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:24:58,251 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:24:58,251 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:24:58,251 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:24:58,251 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:24:58,251 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:24:58,251 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:24:58,251 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:24:58,252 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:24:58,253 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:24:58,254 INFO: Model [FSLLModel] is created.
2022-10-31 22:24:58,265 INFO: Dataset NormalDataset - miniImageNet is created.
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
/workspace/FLOWER/f2m/methods/losses/losses.py:736: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1005.)
  dist.addmm_(1, -2, inputs, inputs.t())
2022-10-31 22:25:00,151 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4818, Pos_dist: 5.4456, Neg_dist: 6.7971, Acc: 0.5800, PTFixPNLoss: 3.1393, NetFixLoss: 0.0000, ]
2022-10-31 22:25:01,207 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2497, Pos_dist: 5.3855, Neg_dist: 7.1895, Acc: 0.7200, PTFixPNLoss: 3.1113, NetFixLoss: 0.6144, ]
2022-10-31 22:25:02,316 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1897, Pos_dist: 5.2532, Neg_dist: 7.4347, Acc: 0.6200, PTFixPNLoss: 3.1179, NetFixLoss: 1.3943, ]
2022-10-31 22:25:03,260 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2926, Pos_dist: 5.3665, Neg_dist: 7.3474, Acc: 0.6000, PTFixPNLoss: 3.1285, NetFixLoss: 2.2546, ]
2022-10-31 22:25:04,225 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4137, Pos_dist: 5.4754, Neg_dist: 7.2979, Acc: 0.6400, PTFixPNLoss: 3.1386, NetFixLoss: 3.2495, ]
2022-10-31 22:25:05,156 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3342, Pos_dist: 5.3101, Neg_dist: 6.9510, Acc: 0.6200, PTFixPNLoss: 3.1276, NetFixLoss: 4.3092, ]
2022-10-31 22:25:06,141 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3764, Pos_dist: 5.4135, Neg_dist: 7.1517, Acc: 0.6600, PTFixPNLoss: 3.1222, NetFixLoss: 5.4616, ]
2022-10-31 22:25:07,187 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2868, Pos_dist: 5.3464, Neg_dist: 7.8752, Acc: 0.7000, PTFixPNLoss: 3.1184, NetFixLoss: 6.6745, ]
2022-10-31 22:25:07,884 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.5087, Pos_dist: 5.3584, Neg_dist: 6.7918, Acc: 0.5000, PTFixPNLoss: 3.1244, NetFixLoss: 7.9407, ]
2022-10-31 22:25:08,595 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3590, Pos_dist: 5.2775, Neg_dist: 6.8780, Acc: 0.7000, PTFixPNLoss: 3.1184, NetFixLoss: 9.2487, ]
2022-10-31 22:25:09,266 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.1453, Pos_dist: 5.3205, Neg_dist: 7.6541, Acc: 0.6400, PTFixPNLoss: 3.1181, NetFixLoss: 10.6375, ]
2022-10-31 22:25:09,946 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.6043, Pos_dist: 5.4263, Neg_dist: 6.6965, Acc: 0.6000, PTFixPNLoss: 3.1233, NetFixLoss: 12.0100, ]
2022-10-31 22:25:11,018 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3862, Pos_dist: 5.4738, Neg_dist: 7.1396, Acc: 0.6000, PTFixPNLoss: 3.1247, NetFixLoss: 13.3890, ]
2022-10-31 22:25:12,024 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2650, Pos_dist: 5.3876, Neg_dist: 7.6389, Acc: 0.6200, PTFixPNLoss: 3.1222, NetFixLoss: 14.8307, ]
2022-10-31 22:25:13,081 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4020, Pos_dist: 5.3104, Neg_dist: 6.9872, Acc: 0.6600, PTFixPNLoss: 3.1287, NetFixLoss: 16.2550, ]
2022-10-31 22:25:13,187 INFO: fine-tune procedure is finished!
2022-10-31 22:25:31,246 INFO: [Test_acc of task 1 on test 0: 0.47400][acc of former classes: 0.67800][acc of former samples in all classes: 0.64000]
[acc of novel samples in all classes: 0.14200]
2022-10-31 22:25:31,564 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:25:31,594 WARNING: Current net - loaded net:
2022-10-31 22:25:31,595 WARNING: Loaded net - current net:
2022-10-31 22:25:31,595 WARNING:   func.classifier.bias
2022-10-31 22:25:31,595 WARNING:   func.classifier.weight
2022-10-31 22:25:31,631 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_1.pth.
2022-10-31 22:25:31,694 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:25:31,724 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:25:31,724 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:25:31,724 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:25:31,724 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:25:31,724 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:25:31,725 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:25:31,725 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:25:31,725 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:25:31,726 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:25:31,727 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:25:31,727 INFO: Model [FSLLModel] is created.
2022-10-31 22:25:31,738 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:25:31,748 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:25:33,190 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4446, Pos_dist: 5.3632, Neg_dist: 6.8250, Acc: 0.6000, PTFixPNLoss: 3.4210, NetFixLoss: 0.0000, ]
2022-10-31 22:25:34,782 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4920, Pos_dist: 5.4519, Neg_dist: 6.7029, Acc: 0.6100, PTFixPNLoss: 3.4296, NetFixLoss: 0.5081, ]
2022-10-31 22:25:35,558 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2411, Pos_dist: 5.4009, Neg_dist: 7.6533, Acc: 0.6000, PTFixPNLoss: 3.4203, NetFixLoss: 1.2237, ]
2022-10-31 22:25:37,229 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4170, Pos_dist: 5.5139, Neg_dist: 7.1084, Acc: 0.5300, PTFixPNLoss: 3.4339, NetFixLoss: 2.0610, ]
2022-10-31 22:25:38,882 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4689, Pos_dist: 5.3158, Neg_dist: 6.6756, Acc: 0.5600, PTFixPNLoss: 3.4274, NetFixLoss: 2.9930, ]
2022-10-31 22:25:40,503 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2265, Pos_dist: 5.4275, Neg_dist: 7.6792, Acc: 0.5000, PTFixPNLoss: 3.4363, NetFixLoss: 4.0373, ]
2022-10-31 22:25:41,225 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2266, Pos_dist: 5.2990, Neg_dist: 7.3719, Acc: 0.6600, PTFixPNLoss: 3.4107, NetFixLoss: 5.1510, ]
2022-10-31 22:25:42,776 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3136, Pos_dist: 5.4847, Neg_dist: 7.4942, Acc: 0.5800, PTFixPNLoss: 3.4311, NetFixLoss: 6.2586, ]
2022-10-31 22:25:44,269 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1643, Pos_dist: 5.3690, Neg_dist: 7.8302, Acc: 0.5600, PTFixPNLoss: 3.4303, NetFixLoss: 7.3741, ]
2022-10-31 22:25:45,858 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4338, Pos_dist: 5.3715, Neg_dist: 6.7461, Acc: 0.5600, PTFixPNLoss: 3.4228, NetFixLoss: 8.4645, ]
2022-10-31 22:25:46,704 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3505, Pos_dist: 5.3864, Neg_dist: 6.9124, Acc: 0.5400, PTFixPNLoss: 3.4180, NetFixLoss: 9.5949, ]
2022-10-31 22:25:48,317 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3307, Pos_dist: 5.4628, Neg_dist: 7.3717, Acc: 0.6600, PTFixPNLoss: 3.4361, NetFixLoss: 10.7624, ]
2022-10-31 22:25:50,029 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4101, Pos_dist: 5.3536, Neg_dist: 6.8290, Acc: 0.6300, PTFixPNLoss: 3.4205, NetFixLoss: 11.9313, ]
2022-10-31 22:25:51,580 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2826, Pos_dist: 5.4787, Neg_dist: 7.9078, Acc: 0.6200, PTFixPNLoss: 3.4267, NetFixLoss: 13.1214, ]
2022-10-31 22:25:52,309 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3316, Pos_dist: 5.4216, Neg_dist: 7.0864, Acc: 0.6000, PTFixPNLoss: 3.4290, NetFixLoss: 14.3128, ]
2022-10-31 22:25:52,397 INFO: fine-tune procedure is finished!
2022-10-31 22:26:15,758 INFO: [Test_acc of task 2 on test 0: 0.37950][acc of former classes: 0.68500][acc of former samples in all classes: 0.62050]
[acc of novel samples in all classes: 0.13850]
2022-10-31 22:26:16,079 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:26:16,108 WARNING: Current net - loaded net:
2022-10-31 22:26:16,108 WARNING: Loaded net - current net:
2022-10-31 22:26:16,108 WARNING:   func.classifier.bias
2022-10-31 22:26:16,108 WARNING:   func.classifier.weight
2022-10-31 22:26:16,145 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_2.pth.
2022-10-31 22:26:16,210 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:26:16,240 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:26:16,240 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:26:16,240 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:26:16,240 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:26:16,240 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:26:16,240 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:26:16,241 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:26:16,241 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:26:16,242 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:26:16,243 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:26:16,243 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:26:16,243 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:26:16,243 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:26:16,243 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:26:16,243 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:26:16,243 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:26:16,243 INFO: Model [FSLLModel] is created.
2022-10-31 22:26:16,255 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:26:16,266 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:26:16,276 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:26:18,135 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5088, Pos_dist: 5.4190, Neg_dist: 6.6584, Acc: 0.5467, PTFixPNLoss: 3.6551, NetFixLoss: 0.0000, ]
2022-10-31 22:26:20,246 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2872, Pos_dist: 5.4114, Neg_dist: 7.3655, Acc: 0.4867, PTFixPNLoss: 3.6576, NetFixLoss: 0.6308, ]
2022-10-31 22:26:22,441 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4642, Pos_dist: 5.3151, Neg_dist: 6.5179, Acc: 0.5667, PTFixPNLoss: 3.6580, NetFixLoss: 1.3767, ]
2022-10-31 22:26:23,427 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3030, Pos_dist: 5.3514, Neg_dist: 7.0720, Acc: 0.5933, PTFixPNLoss: 3.6557, NetFixLoss: 2.2500, ]
2022-10-31 22:26:25,570 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.5034, Pos_dist: 5.3548, Neg_dist: 6.5501, Acc: 0.5133, PTFixPNLoss: 3.6496, NetFixLoss: 3.2009, ]
2022-10-31 22:26:27,768 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1943, Pos_dist: 5.3651, Neg_dist: 8.2964, Acc: 0.5333, PTFixPNLoss: 3.6523, NetFixLoss: 4.2248, ]
2022-10-31 22:26:29,876 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3866, Pos_dist: 5.4112, Neg_dist: 6.9837, Acc: 0.5467, PTFixPNLoss: 3.6628, NetFixLoss: 5.2724, ]
2022-10-31 22:26:32,117 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4267, Pos_dist: 5.3100, Neg_dist: 6.7829, Acc: 0.5267, PTFixPNLoss: 3.6587, NetFixLoss: 6.3374, ]
2022-10-31 22:26:34,307 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1846, Pos_dist: 5.3618, Neg_dist: 7.4411, Acc: 0.5333, PTFixPNLoss: 3.6594, NetFixLoss: 7.4286, ]
2022-10-31 22:26:36,516 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3820, Pos_dist: 5.3464, Neg_dist: 6.8614, Acc: 0.5133, PTFixPNLoss: 3.6608, NetFixLoss: 8.5365, ]
2022-10-31 22:26:37,446 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3848, Pos_dist: 5.2842, Neg_dist: 6.8229, Acc: 0.4933, PTFixPNLoss: 3.6492, NetFixLoss: 9.6485, ]
2022-10-31 22:26:39,468 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2866, Pos_dist: 5.3556, Neg_dist: 7.4096, Acc: 0.4933, PTFixPNLoss: 3.6671, NetFixLoss: 10.7574, ]
2022-10-31 22:26:41,578 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4768, Pos_dist: 5.4063, Neg_dist: 6.7339, Acc: 0.4667, PTFixPNLoss: 3.6680, NetFixLoss: 11.8617, ]
2022-10-31 22:26:43,618 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.5281, Pos_dist: 5.4492, Neg_dist: 6.6224, Acc: 0.4867, PTFixPNLoss: 3.6633, NetFixLoss: 12.9812, ]
2022-10-31 22:26:45,352 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.6045, Pos_dist: 5.4733, Neg_dist: 6.4621, Acc: 0.5400, PTFixPNLoss: 3.6749, NetFixLoss: 14.1206, ]
2022-10-31 22:26:45,436 INFO: fine-tune procedure is finished!
2022-10-31 22:27:13,774 INFO: [Test_acc of task 3 on test 0: 0.31220][acc of former classes: 0.68700][acc of former samples in all classes: 0.61000]
[acc of novel samples in all classes: 0.11367]
2022-10-31 22:27:14,079 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:27:14,105 WARNING: Current net - loaded net:
2022-10-31 22:27:14,106 WARNING: Loaded net - current net:
2022-10-31 22:27:14,106 WARNING:   func.classifier.bias
2022-10-31 22:27:14,106 WARNING:   func.classifier.weight
2022-10-31 22:27:14,136 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_3.pth.
2022-10-31 22:27:14,205 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:27:14,240 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:27:14,240 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:27:14,241 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:27:14,241 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:27:14,241 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:27:14,241 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:27:14,241 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,241 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:27:14,242 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:27:14,243 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:27:14,244 INFO: Model [FSLLModel] is created.
2022-10-31 22:27:14,257 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:27:14,268 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:27:14,279 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:27:14,289 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:27:17,122 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5764, Pos_dist: 5.3230, Neg_dist: 6.2432, Acc: 0.5100, PTFixPNLoss: 3.8442, NetFixLoss: 0.0000, ]
2022-10-31 22:27:19,926 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3556, Pos_dist: 5.4120, Neg_dist: 6.9453, Acc: 0.4150, PTFixPNLoss: 3.8508, NetFixLoss: 0.5782, ]
2022-10-31 22:27:22,555 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2688, Pos_dist: 5.4546, Neg_dist: 7.6629, Acc: 0.4900, PTFixPNLoss: 3.8499, NetFixLoss: 1.3512, ]
2022-10-31 22:27:25,334 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3681, Pos_dist: 5.4847, Neg_dist: 7.3220, Acc: 0.4550, PTFixPNLoss: 3.8572, NetFixLoss: 2.2495, ]
2022-10-31 22:27:28,102 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4060, Pos_dist: 5.4334, Neg_dist: 7.3644, Acc: 0.4650, PTFixPNLoss: 3.8452, NetFixLoss: 3.2110, ]
2022-10-31 22:27:30,884 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4636, Pos_dist: 5.4564, Neg_dist: 6.9234, Acc: 0.5250, PTFixPNLoss: 3.8507, NetFixLoss: 4.2295, ]
2022-10-31 22:27:33,651 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4706, Pos_dist: 5.4786, Neg_dist: 6.8172, Acc: 0.4550, PTFixPNLoss: 3.8544, NetFixLoss: 5.2828, ]
2022-10-31 22:27:36,171 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2523, Pos_dist: 5.4650, Neg_dist: 7.4398, Acc: 0.5150, PTFixPNLoss: 3.8496, NetFixLoss: 6.3909, ]
2022-10-31 22:27:38,679 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4295, Pos_dist: 5.4069, Neg_dist: 6.6817, Acc: 0.5100, PTFixPNLoss: 3.8530, NetFixLoss: 7.5523, ]
2022-10-31 22:27:41,101 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4358, Pos_dist: 5.3916, Neg_dist: 6.9680, Acc: 0.4700, PTFixPNLoss: 3.8500, NetFixLoss: 8.7334, ]
2022-10-31 22:27:43,571 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5389, Pos_dist: 5.3536, Neg_dist: 6.4937, Acc: 0.5000, PTFixPNLoss: 3.8443, NetFixLoss: 9.9169, ]
2022-10-31 22:27:46,021 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2677, Pos_dist: 5.4013, Neg_dist: 7.4188, Acc: 0.5000, PTFixPNLoss: 3.8430, NetFixLoss: 11.1081, ]
2022-10-31 22:27:48,571 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2491, Pos_dist: 5.4298, Neg_dist: 7.5720, Acc: 0.5400, PTFixPNLoss: 3.8390, NetFixLoss: 12.2670, ]
2022-10-31 22:27:51,028 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2756, Pos_dist: 5.4643, Neg_dist: 7.4456, Acc: 0.4750, PTFixPNLoss: 3.8443, NetFixLoss: 13.4087, ]
2022-10-31 22:27:53,545 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4535, Pos_dist: 5.3612, Neg_dist: 6.6235, Acc: 0.4700, PTFixPNLoss: 3.8426, NetFixLoss: 14.5472, ]
2022-10-31 22:27:53,638 INFO: fine-tune procedure is finished!
2022-10-31 22:28:27,330 INFO: [Test_acc of task 4 on test 0: 0.26150][acc of former classes: 0.68950][acc of former samples in all classes: 0.59850]
[acc of novel samples in all classes: 0.09300]
2022-10-31 22:28:27,618 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:28:27,642 WARNING: Current net - loaded net:
2022-10-31 22:28:27,643 WARNING: Loaded net - current net:
2022-10-31 22:28:27,643 WARNING:   func.classifier.bias
2022-10-31 22:28:27,643 WARNING:   func.classifier.weight
2022-10-31 22:28:27,660 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_4.pth.
2022-10-31 22:28:27,696 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:28:27,710 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:28:27,710 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:28:27,710 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:28:27,710 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:28:27,710 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:28:27,710 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:28:27,711 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:28:27,711 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:28:27,712 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:28:27,713 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:28:27,713 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:28:27,713 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:28:27,713 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:28:27,713 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:28:27,713 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:28:27,713 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:28:27,713 INFO: Model [FSLLModel] is created.
2022-10-31 22:28:27,724 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:27,734 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:27,744 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:27,755 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:28:27,765 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:28:31,016 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3702, Pos_dist: 5.3648, Neg_dist: 7.4281, Acc: 0.4640, PTFixPNLoss: 4.0067, NetFixLoss: 0.0000, ]
2022-10-31 22:28:34,328 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2513, Pos_dist: 5.4294, Neg_dist: 7.3848, Acc: 0.4440, PTFixPNLoss: 4.0127, NetFixLoss: 0.4890, ]
2022-10-31 22:28:37,614 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3722, Pos_dist: 5.4467, Neg_dist: 7.0208, Acc: 0.4520, PTFixPNLoss: 4.0095, NetFixLoss: 1.1351, ]
2022-10-31 22:28:40,854 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5176, Pos_dist: 5.4305, Neg_dist: 6.5859, Acc: 0.4960, PTFixPNLoss: 4.0087, NetFixLoss: 1.9345, ]
2022-10-31 22:28:44,239 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3667, Pos_dist: 5.4316, Neg_dist: 7.0018, Acc: 0.4760, PTFixPNLoss: 4.0107, NetFixLoss: 2.8505, ]
2022-10-31 22:28:47,486 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3233, Pos_dist: 5.4405, Neg_dist: 7.2044, Acc: 0.4560, PTFixPNLoss: 4.0138, NetFixLoss: 3.8776, ]
2022-10-31 22:28:50,802 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3397, Pos_dist: 5.4968, Neg_dist: 7.2251, Acc: 0.4760, PTFixPNLoss: 4.0126, NetFixLoss: 4.9634, ]
2022-10-31 22:28:54,025 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3079, Pos_dist: 5.3630, Neg_dist: 7.2415, Acc: 0.4720, PTFixPNLoss: 3.9936, NetFixLoss: 6.0948, ]
2022-10-31 22:28:57,318 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3494, Pos_dist: 5.3591, Neg_dist: 6.9572, Acc: 0.4760, PTFixPNLoss: 4.0053, NetFixLoss: 7.2373, ]
2022-10-31 22:29:00,578 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4009, Pos_dist: 5.4319, Neg_dist: 6.8307, Acc: 0.5000, PTFixPNLoss: 4.0150, NetFixLoss: 8.3856, ]
2022-10-31 22:29:04,155 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4621, Pos_dist: 5.4626, Neg_dist: 6.9627, Acc: 0.4280, PTFixPNLoss: 4.0061, NetFixLoss: 9.5594, ]
2022-10-31 22:29:07,482 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3518, Pos_dist: 5.3920, Neg_dist: 7.2141, Acc: 0.4680, PTFixPNLoss: 4.0043, NetFixLoss: 10.7679, ]
2022-10-31 22:29:10,852 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4800, Pos_dist: 5.5689, Neg_dist: 7.1144, Acc: 0.4440, PTFixPNLoss: 4.0157, NetFixLoss: 12.0096, ]
2022-10-31 22:29:14,046 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4735, Pos_dist: 5.3744, Neg_dist: 6.8747, Acc: 0.4760, PTFixPNLoss: 4.0014, NetFixLoss: 13.2379, ]
2022-10-31 22:29:17,254 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3299, Pos_dist: 5.4309, Neg_dist: 7.8428, Acc: 0.4400, PTFixPNLoss: 4.0107, NetFixLoss: 14.4410, ]
2022-10-31 22:29:17,338 INFO: fine-tune procedure is finished!
2022-10-31 22:29:56,322 INFO: [Test_acc of task 5 on test 0: 0.22857][acc of former classes: 0.69250][acc of former samples in all classes: 0.58350]
[acc of novel samples in all classes: 0.08660]
2022-10-31 22:29:56,625 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:29:56,650 WARNING: Current net - loaded net:
2022-10-31 22:29:56,651 WARNING: Loaded net - current net:
2022-10-31 22:29:56,651 WARNING:   func.classifier.bias
2022-10-31 22:29:56,651 WARNING:   func.classifier.weight
2022-10-31 22:29:56,687 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_5.pth.
2022-10-31 22:29:56,751 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:29:56,792 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:29:56,792 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:29:56,792 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:29:56,792 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:29:56,792 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:29:56,792 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:29:56,792 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:29:56,792 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:29:56,792 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:29:56,792 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:29:56,792 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:29:56,792 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:29:56,792 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:29:56,792 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:29:56,793 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:29:56,794 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:29:56,794 INFO: Model [FSLLModel] is created.
2022-10-31 22:29:56,806 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:56,816 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:56,826 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:56,836 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:56,846 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:29:56,857 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:29:58,790 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5956, Pos_dist: 5.4168, Neg_dist: 6.4919, Acc: 0.4467, PTFixPNLoss: 4.1429, NetFixLoss: 0.0000, ]
2022-10-31 22:30:02,668 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3755, Pos_dist: 5.3914, Neg_dist: 7.1788, Acc: 0.5033, PTFixPNLoss: 4.1431, NetFixLoss: 0.5057, ]
2022-10-31 22:30:06,489 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5519, Pos_dist: 5.4822, Neg_dist: 6.5891, Acc: 0.4867, PTFixPNLoss: 4.1454, NetFixLoss: 1.1122, ]
2022-10-31 22:30:09,728 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3183, Pos_dist: 5.4813, Neg_dist: 7.3925, Acc: 0.4367, PTFixPNLoss: 4.1487, NetFixLoss: 1.8749, ]
2022-10-31 22:30:13,441 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3410, Pos_dist: 5.4048, Neg_dist: 7.1456, Acc: 0.4733, PTFixPNLoss: 4.1445, NetFixLoss: 2.7332, ]
2022-10-31 22:30:17,298 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4169, Pos_dist: 5.4427, Neg_dist: 6.9365, Acc: 0.4467, PTFixPNLoss: 4.1464, NetFixLoss: 3.6471, ]
2022-10-31 22:30:20,984 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2229, Pos_dist: 5.4415, Neg_dist: 7.8354, Acc: 0.4767, PTFixPNLoss: 4.1429, NetFixLoss: 4.6368, ]
2022-10-31 22:30:24,878 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3516, Pos_dist: 5.4259, Neg_dist: 7.4156, Acc: 0.4300, PTFixPNLoss: 4.1437, NetFixLoss: 5.6547, ]
2022-10-31 22:30:27,276 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4042, Pos_dist: 5.3855, Neg_dist: 6.7791, Acc: 0.4667, PTFixPNLoss: 4.1372, NetFixLoss: 6.6863, ]
2022-10-31 22:30:31,182 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.5216, Pos_dist: 5.4399, Neg_dist: 6.6946, Acc: 0.4767, PTFixPNLoss: 4.1411, NetFixLoss: 7.7447, ]
2022-10-31 22:30:35,064 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3231, Pos_dist: 5.4293, Neg_dist: 7.1264, Acc: 0.4167, PTFixPNLoss: 4.1501, NetFixLoss: 8.8406, ]
2022-10-31 22:30:38,629 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4813, Pos_dist: 5.4343, Neg_dist: 6.9938, Acc: 0.4967, PTFixPNLoss: 4.1523, NetFixLoss: 9.9377, ]
2022-10-31 22:30:42,643 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4849, Pos_dist: 5.4240, Neg_dist: 6.6993, Acc: 0.4600, PTFixPNLoss: 4.1402, NetFixLoss: 11.0552, ]
2022-10-31 22:30:45,997 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.5233, Pos_dist: 5.4497, Neg_dist: 6.6716, Acc: 0.4700, PTFixPNLoss: 4.1467, NetFixLoss: 12.1913, ]
2022-10-31 22:30:49,768 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2655, Pos_dist: 5.4269, Neg_dist: 7.3343, Acc: 0.4467, PTFixPNLoss: 4.1442, NetFixLoss: 13.3160, ]
2022-10-31 22:30:49,858 INFO: fine-tune procedure is finished!
2022-10-31 22:31:34,529 INFO: [Test_acc of task 6 on test 0: 0.20850][acc of former classes: 0.69300][acc of former samples in all classes: 0.57150]
[acc of novel samples in all classes: 0.08750]
2022-10-31 22:31:34,840 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:31:34,866 WARNING: Current net - loaded net:
2022-10-31 22:31:34,866 WARNING: Loaded net - current net:
2022-10-31 22:31:34,866 WARNING:   func.classifier.bias
2022-10-31 22:31:34,866 WARNING:   func.classifier.weight
2022-10-31 22:31:34,903 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_6.pth.
2022-10-31 22:31:34,967 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:31:34,997 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:31:34,997 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:31:34,997 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:31:34,997 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:31:34,997 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:31:34,997 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:31:34,997 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:31:34,997 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:31:34,997 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:31:34,997 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:31:34,998 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:31:34,999 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:31:35,000 INFO: Model [FSLLModel] is created.
2022-10-31 22:31:35,010 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:31:35,021 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:31:35,033 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:31:35,044 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:31:35,054 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:31:35,064 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:31:35,074 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:31:39,256 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2970, Pos_dist: 5.4522, Neg_dist: 7.2615, Acc: 0.4200, PTFixPNLoss: 4.2721, NetFixLoss: 0.0000, ]
2022-10-31 22:31:43,727 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4330, Pos_dist: 5.4575, Neg_dist: 6.8936, Acc: 0.4314, PTFixPNLoss: 4.2632, NetFixLoss: 0.5319, ]
2022-10-31 22:31:48,276 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4536, Pos_dist: 5.4293, Neg_dist: 6.7488, Acc: 0.4457, PTFixPNLoss: 4.2679, NetFixLoss: 1.2447, ]
2022-10-31 22:31:52,673 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4055, Pos_dist: 5.3917, Neg_dist: 6.8606, Acc: 0.4371, PTFixPNLoss: 4.2654, NetFixLoss: 2.1489, ]
2022-10-31 22:31:55,615 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1846, Pos_dist: 5.4734, Neg_dist: 7.8620, Acc: 0.4314, PTFixPNLoss: 4.2727, NetFixLoss: 3.1538, ]
2022-10-31 22:31:59,984 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3952, Pos_dist: 5.4208, Neg_dist: 6.9634, Acc: 0.4114, PTFixPNLoss: 4.2621, NetFixLoss: 4.1852, ]
2022-10-31 22:32:04,332 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4177, Pos_dist: 5.4195, Neg_dist: 7.0178, Acc: 0.4314, PTFixPNLoss: 4.2677, NetFixLoss: 5.2405, ]
2022-10-31 22:32:06,955 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4032, Pos_dist: 5.4662, Neg_dist: 6.9933, Acc: 0.4286, PTFixPNLoss: 4.2671, NetFixLoss: 6.2993, ]
2022-10-31 22:32:11,275 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.6050, Pos_dist: 5.4348, Neg_dist: 6.5619, Acc: 0.4343, PTFixPNLoss: 4.2673, NetFixLoss: 7.3777, ]
2022-10-31 22:32:15,690 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.5738, Pos_dist: 5.4970, Neg_dist: 6.5565, Acc: 0.3971, PTFixPNLoss: 4.2679, NetFixLoss: 8.4742, ]
2022-10-31 22:32:21,068 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3533, Pos_dist: 5.4312, Neg_dist: 6.9995, Acc: 0.4743, PTFixPNLoss: 4.2677, NetFixLoss: 9.5934, ]
2022-10-31 22:32:25,521 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3069, Pos_dist: 5.3928, Neg_dist: 7.2748, Acc: 0.4657, PTFixPNLoss: 4.2601, NetFixLoss: 10.7091, ]
2022-10-31 22:32:28,278 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4291, Pos_dist: 5.4099, Neg_dist: 7.1188, Acc: 0.4514, PTFixPNLoss: 4.2654, NetFixLoss: 11.8388, ]
2022-10-31 22:32:32,775 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.5114, Pos_dist: 5.4253, Neg_dist: 6.5814, Acc: 0.4286, PTFixPNLoss: 4.2665, NetFixLoss: 12.9636, ]
2022-10-31 22:32:37,235 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.6049, Pos_dist: 5.4414, Neg_dist: 6.3848, Acc: 0.4543, PTFixPNLoss: 4.2673, NetFixLoss: 14.0877, ]
2022-10-31 22:32:37,330 INFO: fine-tune procedure is finished!
2022-10-31 22:33:26,497 INFO: [Test_acc of task 7 on test 0: 0.18933][acc of former classes: 0.69050][acc of former samples in all classes: 0.56450]
[acc of novel samples in all classes: 0.08214]
2022-10-31 22:33:26,800 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:33:26,826 WARNING: Current net - loaded net:
2022-10-31 22:33:26,826 WARNING: Loaded net - current net:
2022-10-31 22:33:26,826 WARNING:   func.classifier.bias
2022-10-31 22:33:26,826 WARNING:   func.classifier.weight
2022-10-31 22:33:26,863 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_7.pth.
2022-10-31 22:33:26,926 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:33:26,961 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:33:26,961 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:33:26,961 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:33:26,961 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:33:26,961 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:33:26,962 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:33:26,962 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:33:26,962 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:33:26,963 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:33:26,964 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:33:26,964 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:33:26,964 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:33:26,964 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:33:26,964 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:33:26,964 INFO: Model [FSLLModel] is created.
2022-10-31 22:33:26,975 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:26,985 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:26,995 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:27,005 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:27,015 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:27,025 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:27,035 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:33:27,045 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:33:31,219 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3712, Pos_dist: 5.4228, Neg_dist: 7.0229, Acc: 0.4400, PTFixPNLoss: 4.3674, NetFixLoss: 0.0000, ]
2022-10-31 22:33:36,352 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3059, Pos_dist: 5.4146, Neg_dist: 7.1635, Acc: 0.4625, PTFixPNLoss: 4.3716, NetFixLoss: 0.5246, ]
2022-10-31 22:33:39,372 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4139, Pos_dist: 5.4317, Neg_dist: 6.8153, Acc: 0.4250, PTFixPNLoss: 4.3779, NetFixLoss: 1.2480, ]
2022-10-31 22:33:44,546 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4215, Pos_dist: 5.4461, Neg_dist: 7.1440, Acc: 0.4100, PTFixPNLoss: 4.3702, NetFixLoss: 2.1222, ]
2022-10-31 22:33:49,515 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3027, Pos_dist: 5.4333, Neg_dist: 7.4721, Acc: 0.4375, PTFixPNLoss: 4.3660, NetFixLoss: 3.0501, ]
2022-10-31 22:33:54,639 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1691, Pos_dist: 5.4015, Neg_dist: 8.1884, Acc: 0.4400, PTFixPNLoss: 4.3686, NetFixLoss: 3.9950, ]
2022-10-31 22:33:59,672 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4263, Pos_dist: 5.4595, Neg_dist: 6.8681, Acc: 0.4375, PTFixPNLoss: 4.3720, NetFixLoss: 4.9298, ]
2022-10-31 22:34:02,611 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3132, Pos_dist: 5.3925, Neg_dist: 7.3700, Acc: 0.4675, PTFixPNLoss: 4.3644, NetFixLoss: 5.8878, ]
2022-10-31 22:34:07,553 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1922, Pos_dist: 5.4180, Neg_dist: 7.8185, Acc: 0.4325, PTFixPNLoss: 4.3721, NetFixLoss: 6.8935, ]
2022-10-31 22:34:12,501 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4006, Pos_dist: 5.4026, Neg_dist: 6.8122, Acc: 0.4150, PTFixPNLoss: 4.3708, NetFixLoss: 7.9077, ]
2022-10-31 22:34:17,748 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4613, Pos_dist: 5.4288, Neg_dist: 6.7208, Acc: 0.4400, PTFixPNLoss: 4.3679, NetFixLoss: 8.9188, ]
2022-10-31 22:34:23,479 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3623, Pos_dist: 5.4161, Neg_dist: 7.7096, Acc: 0.4325, PTFixPNLoss: 4.3735, NetFixLoss: 9.9627, ]
2022-10-31 22:34:28,609 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3182, Pos_dist: 5.4157, Neg_dist: 7.2479, Acc: 0.4275, PTFixPNLoss: 4.3687, NetFixLoss: 11.0238, ]
2022-10-31 22:34:33,614 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3775, Pos_dist: 5.4182, Neg_dist: 7.3814, Acc: 0.4250, PTFixPNLoss: 4.3710, NetFixLoss: 12.1538, ]
2022-10-31 22:34:38,990 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.5483, Pos_dist: 5.4093, Neg_dist: 6.4379, Acc: 0.4150, PTFixPNLoss: 4.3756, NetFixLoss: 13.2596, ]
2022-10-31 22:34:39,069 INFO: fine-tune procedure is finished!
2022-10-31 22:35:33,948 INFO: [Test_acc of task 8 on test 0: 0.17860][acc of former classes: 0.69200][acc of former samples in all classes: 0.56200]
[acc of novel samples in all classes: 0.08275]
2022-10-31 22:35:34,245 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:35:34,270 WARNING: Current net - loaded net:
2022-10-31 22:35:34,271 WARNING: Loaded net - current net:
2022-10-31 22:35:34,271 WARNING:   func.classifier.bias
2022-10-31 22:35:34,271 WARNING:   func.classifier.weight
2022-10-31 22:35:34,308 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth.
2022-10-31 22:35:34,373 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:35:34,411 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:35:34,412 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:35:34,412 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:35:34,412 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:35:34,412 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:35:34,412 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:35:34,412 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:35:34,412 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:35:34,413 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:35:34,414 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:35:34,414 INFO: Model [FSLLModel] is created.
2022-10-31 22:35:34,425 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:35:35,319 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4997, Pos_dist: 5.5324, Neg_dist: 7.0523, Acc: 0.5200, PTFixPNLoss: 3.1389, NetFixLoss: 0.0000, ]
2022-10-31 22:35:36,335 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5178, Pos_dist: 5.5641, Neg_dist: 6.8686, Acc: 0.4600, PTFixPNLoss: 3.1529, NetFixLoss: 0.6933, ]
2022-10-31 22:35:37,474 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.6236, Pos_dist: 5.3948, Neg_dist: 6.3018, Acc: 0.5200, PTFixPNLoss: 3.1405, NetFixLoss: 1.4843, ]
2022-10-31 22:35:38,572 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4279, Pos_dist: 5.5018, Neg_dist: 7.4856, Acc: 0.5800, PTFixPNLoss: 3.1375, NetFixLoss: 2.4336, ]
2022-10-31 22:35:39,295 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2866, Pos_dist: 5.4274, Neg_dist: 7.5831, Acc: 0.5200, PTFixPNLoss: 3.1383, NetFixLoss: 3.5410, ]
2022-10-31 22:35:40,437 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5471, Pos_dist: 5.5872, Neg_dist: 6.8759, Acc: 0.5400, PTFixPNLoss: 3.1449, NetFixLoss: 4.6960, ]
2022-10-31 22:35:41,579 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2359, Pos_dist: 5.6063, Neg_dist: 8.6514, Acc: 0.5000, PTFixPNLoss: 3.1527, NetFixLoss: 5.9304, ]
2022-10-31 22:35:42,604 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4724, Pos_dist: 5.4322, Neg_dist: 6.6127, Acc: 0.6000, PTFixPNLoss: 3.1481, NetFixLoss: 7.2300, ]
2022-10-31 22:35:43,704 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0927, Pos_dist: 5.3542, Neg_dist: 8.0755, Acc: 0.6400, PTFixPNLoss: 3.1401, NetFixLoss: 8.5726, ]
2022-10-31 22:35:44,971 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.5107, Pos_dist: 5.6499, Neg_dist: 6.9156, Acc: 0.4600, PTFixPNLoss: 3.1546, NetFixLoss: 9.9090, ]
2022-10-31 22:35:45,651 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4723, Pos_dist: 5.4588, Neg_dist: 6.7912, Acc: 0.5000, PTFixPNLoss: 3.1468, NetFixLoss: 11.2781, ]
2022-10-31 22:35:46,688 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2769, Pos_dist: 5.4570, Neg_dist: 7.4587, Acc: 0.5800, PTFixPNLoss: 3.1392, NetFixLoss: 12.7634, ]
2022-10-31 22:35:47,785 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4429, Pos_dist: 5.6068, Neg_dist: 7.1746, Acc: 0.5000, PTFixPNLoss: 3.1520, NetFixLoss: 14.2343, ]
2022-10-31 22:35:48,892 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4846, Pos_dist: 5.4764, Neg_dist: 6.7522, Acc: 0.5400, PTFixPNLoss: 3.1350, NetFixLoss: 15.7255, ]
2022-10-31 22:35:50,064 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3399, Pos_dist: 5.4309, Neg_dist: 7.0267, Acc: 0.5400, PTFixPNLoss: 3.1326, NetFixLoss: 17.2310, ]
2022-10-31 22:35:50,157 INFO: fine-tune procedure is finished!
2022-10-31 22:36:08,250 INFO: [Test_acc of task 1 on test 1: 0.46433][acc of former classes: 0.67900][acc of former samples in all classes: 0.63700]
[acc of novel samples in all classes: 0.11900]
2022-10-31 22:36:08,557 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:36:08,585 WARNING: Current net - loaded net:
2022-10-31 22:36:08,585 WARNING: Loaded net - current net:
2022-10-31 22:36:08,585 WARNING:   func.classifier.bias
2022-10-31 22:36:08,585 WARNING:   func.classifier.weight
2022-10-31 22:36:08,619 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_1.pth.
2022-10-31 22:36:08,682 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:36:08,714 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:36:08,714 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:36:08,714 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:36:08,714 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:36:08,714 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:36:08,714 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:36:08,714 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:36:08,714 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:36:08,714 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:36:08,715 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:36:08,716 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:36:08,717 INFO: Model [FSLLModel] is created.
2022-10-31 22:36:08,730 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:36:08,742 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:36:10,214 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2230, Pos_dist: 5.4738, Neg_dist: 7.6677, Acc: 0.4800, PTFixPNLoss: 3.4323, NetFixLoss: 0.0000, ]
2022-10-31 22:36:10,988 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3197, Pos_dist: 5.3555, Neg_dist: 7.0545, Acc: 0.5900, PTFixPNLoss: 3.4304, NetFixLoss: 0.5065, ]
2022-10-31 22:36:12,551 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1890, Pos_dist: 5.2961, Neg_dist: 7.7497, Acc: 0.6300, PTFixPNLoss: 3.4188, NetFixLoss: 1.2046, ]
2022-10-31 22:36:14,098 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4192, Pos_dist: 5.3610, Neg_dist: 7.1836, Acc: 0.5900, PTFixPNLoss: 3.4183, NetFixLoss: 1.9777, ]
2022-10-31 22:36:15,762 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3392, Pos_dist: 5.3075, Neg_dist: 7.1523, Acc: 0.6100, PTFixPNLoss: 3.4140, NetFixLoss: 2.8171, ]
2022-10-31 22:36:17,431 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3015, Pos_dist: 5.3211, Neg_dist: 7.0827, Acc: 0.5700, PTFixPNLoss: 3.4282, NetFixLoss: 3.7083, ]
2022-10-31 22:36:19,037 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2191, Pos_dist: 5.3467, Neg_dist: 7.4822, Acc: 0.6100, PTFixPNLoss: 3.4176, NetFixLoss: 4.6594, ]
2022-10-31 22:36:19,852 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.7359, Pos_dist: 5.5502, Neg_dist: 6.4292, Acc: 0.4300, PTFixPNLoss: 3.4343, NetFixLoss: 5.6585, ]
2022-10-31 22:36:21,422 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1030, Pos_dist: 5.2793, Neg_dist: 7.9822, Acc: 0.5700, PTFixPNLoss: 3.4242, NetFixLoss: 6.7351, ]
2022-10-31 22:36:23,002 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4104, Pos_dist: 5.4853, Neg_dist: 7.0697, Acc: 0.5600, PTFixPNLoss: 3.4315, NetFixLoss: 7.8336, ]
2022-10-31 22:36:25,762 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3644, Pos_dist: 5.4347, Neg_dist: 7.5244, Acc: 0.5700, PTFixPNLoss: 3.4330, NetFixLoss: 8.9725, ]
2022-10-31 22:36:26,483 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2965, Pos_dist: 5.3409, Neg_dist: 7.1126, Acc: 0.5400, PTFixPNLoss: 3.4260, NetFixLoss: 10.1355, ]
2022-10-31 22:36:28,069 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4571, Pos_dist: 5.4341, Neg_dist: 6.9077, Acc: 0.5400, PTFixPNLoss: 3.4312, NetFixLoss: 11.3340, ]
2022-10-31 22:36:29,744 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1847, Pos_dist: 5.2271, Neg_dist: 7.4704, Acc: 0.5900, PTFixPNLoss: 3.4088, NetFixLoss: 12.5667, ]
2022-10-31 22:36:31,296 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2501, Pos_dist: 5.3296, Neg_dist: 7.4481, Acc: 0.6300, PTFixPNLoss: 3.4192, NetFixLoss: 13.7898, ]
2022-10-31 22:36:31,404 INFO: fine-tune procedure is finished!
2022-10-31 22:36:54,632 INFO: [Test_acc of task 2 on test 1: 0.36975][acc of former classes: 0.68900][acc of former samples in all classes: 0.62000]
[acc of novel samples in all classes: 0.11950]
2022-10-31 22:36:54,932 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:36:54,958 WARNING: Current net - loaded net:
2022-10-31 22:36:54,958 WARNING: Loaded net - current net:
2022-10-31 22:36:54,958 WARNING:   func.classifier.bias
2022-10-31 22:36:54,958 WARNING:   func.classifier.weight
2022-10-31 22:36:54,996 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_2.pth.
2022-10-31 22:36:55,061 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:36:55,096 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:36:55,097 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:36:55,097 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:36:55,097 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:36:55,097 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:36:55,097 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:36:55,097 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:36:55,097 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:36:55,098 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:36:55,099 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:36:55,099 INFO: Model [FSLLModel] is created.
2022-10-31 22:36:55,110 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:36:55,120 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:36:55,130 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:36:56,163 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.1580, Pos_dist: 5.5084, Neg_dist: 8.3780, Acc: 0.4800, PTFixPNLoss: 3.6682, NetFixLoss: 0.0000, ]
2022-10-31 22:36:58,302 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3729, Pos_dist: 5.4599, Neg_dist: 6.9698, Acc: 0.4800, PTFixPNLoss: 3.6666, NetFixLoss: 0.4059, ]
2022-10-31 22:37:00,454 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2567, Pos_dist: 5.3868, Neg_dist: 7.7680, Acc: 0.4600, PTFixPNLoss: 3.6688, NetFixLoss: 1.0874, ]
2022-10-31 22:37:02,613 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3594, Pos_dist: 5.4586, Neg_dist: 7.3862, Acc: 0.4867, PTFixPNLoss: 3.6650, NetFixLoss: 1.8754, ]
2022-10-31 22:37:04,878 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.1538, Pos_dist: 5.3426, Neg_dist: 7.5495, Acc: 0.4933, PTFixPNLoss: 3.6586, NetFixLoss: 2.7373, ]
2022-10-31 22:37:06,530 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2381, Pos_dist: 5.3430, Neg_dist: 7.1670, Acc: 0.5067, PTFixPNLoss: 3.6617, NetFixLoss: 3.6135, ]
2022-10-31 22:37:08,676 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3188, Pos_dist: 5.4242, Neg_dist: 7.2470, Acc: 0.4800, PTFixPNLoss: 3.6676, NetFixLoss: 4.5418, ]
2022-10-31 22:37:10,855 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4458, Pos_dist: 5.4732, Neg_dist: 6.9125, Acc: 0.4667, PTFixPNLoss: 3.6626, NetFixLoss: 5.5102, ]
2022-10-31 22:37:12,986 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2246, Pos_dist: 5.4108, Neg_dist: 7.7036, Acc: 0.4733, PTFixPNLoss: 3.6646, NetFixLoss: 6.5337, ]
2022-10-31 22:37:15,180 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3931, Pos_dist: 5.4299, Neg_dist: 6.9961, Acc: 0.5667, PTFixPNLoss: 3.6671, NetFixLoss: 7.6282, ]
2022-10-31 22:37:17,400 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3800, Pos_dist: 5.4614, Neg_dist: 7.1195, Acc: 0.5133, PTFixPNLoss: 3.6688, NetFixLoss: 8.7428, ]
2022-10-31 22:37:19,551 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4769, Pos_dist: 5.5021, Neg_dist: 6.9105, Acc: 0.4467, PTFixPNLoss: 3.6576, NetFixLoss: 9.8972, ]
2022-10-31 22:37:21,714 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3631, Pos_dist: 5.3726, Neg_dist: 6.8720, Acc: 0.5333, PTFixPNLoss: 3.6561, NetFixLoss: 11.1031, ]
2022-10-31 22:37:23,825 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3384, Pos_dist: 5.3568, Neg_dist: 7.0274, Acc: 0.5800, PTFixPNLoss: 3.6607, NetFixLoss: 12.3553, ]
2022-10-31 22:37:26,087 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1606, Pos_dist: 5.3296, Neg_dist: 7.8944, Acc: 0.5467, PTFixPNLoss: 3.6573, NetFixLoss: 13.6031, ]
2022-10-31 22:37:26,196 INFO: fine-tune procedure is finished!
2022-10-31 22:37:54,718 INFO: [Test_acc of task 3 on test 1: 0.29880][acc of former classes: 0.68950][acc of former samples in all classes: 0.61150]
[acc of novel samples in all classes: 0.09033]
2022-10-31 22:37:55,026 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:37:55,068 WARNING: Current net - loaded net:
2022-10-31 22:37:55,068 WARNING: Loaded net - current net:
2022-10-31 22:37:55,068 WARNING:   func.classifier.bias
2022-10-31 22:37:55,068 WARNING:   func.classifier.weight
2022-10-31 22:37:55,107 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_3.pth.
2022-10-31 22:37:55,177 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:37:55,209 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:37:55,209 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:37:55,209 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:37:55,209 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:37:55,209 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:37:55,209 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:37:55,209 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:37:55,209 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:37:55,209 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:37:55,209 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:37:55,209 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:37:55,210 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:37:55,211 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:37:55,212 INFO: Model [FSLLModel] is created.
2022-10-31 22:37:55,224 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:37:55,234 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:37:55,244 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:37:55,254 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:37:57,854 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2509, Pos_dist: 5.4578, Neg_dist: 7.4398, Acc: 0.4650, PTFixPNLoss: 3.8542, NetFixLoss: 0.0000, ]
2022-10-31 22:37:59,306 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2121, Pos_dist: 5.3876, Neg_dist: 7.4622, Acc: 0.4800, PTFixPNLoss: 3.8537, NetFixLoss: 0.5262, ]
2022-10-31 22:38:01,902 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1795, Pos_dist: 5.5144, Neg_dist: 8.0766, Acc: 0.5100, PTFixPNLoss: 3.8579, NetFixLoss: 1.2118, ]
2022-10-31 22:38:04,537 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2846, Pos_dist: 5.5157, Neg_dist: 7.6339, Acc: 0.4550, PTFixPNLoss: 3.8531, NetFixLoss: 2.0064, ]
2022-10-31 22:38:07,319 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2299, Pos_dist: 5.4606, Neg_dist: 7.5938, Acc: 0.4600, PTFixPNLoss: 3.8531, NetFixLoss: 2.8808, ]
2022-10-31 22:38:09,883 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5205, Pos_dist: 5.4132, Neg_dist: 6.4709, Acc: 0.5250, PTFixPNLoss: 3.8496, NetFixLoss: 3.7951, ]
2022-10-31 22:38:12,526 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3477, Pos_dist: 5.4350, Neg_dist: 7.4373, Acc: 0.4500, PTFixPNLoss: 3.8570, NetFixLoss: 4.8100, ]
2022-10-31 22:38:15,172 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2101, Pos_dist: 5.4898, Neg_dist: 7.6910, Acc: 0.4550, PTFixPNLoss: 3.8639, NetFixLoss: 5.8807, ]
2022-10-31 22:38:17,813 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2961, Pos_dist: 5.4537, Neg_dist: 7.3486, Acc: 0.5050, PTFixPNLoss: 3.8523, NetFixLoss: 7.0309, ]
2022-10-31 22:38:20,453 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3456, Pos_dist: 5.4658, Neg_dist: 7.0481, Acc: 0.4800, PTFixPNLoss: 3.8576, NetFixLoss: 8.1736, ]
2022-10-31 22:38:22,294 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5349, Pos_dist: 5.5380, Neg_dist: 6.6737, Acc: 0.4400, PTFixPNLoss: 3.8673, NetFixLoss: 9.3445, ]
2022-10-31 22:38:25,177 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3116, Pos_dist: 5.4440, Neg_dist: 7.0550, Acc: 0.4950, PTFixPNLoss: 3.8583, NetFixLoss: 10.5418, ]
2022-10-31 22:38:27,942 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4138, Pos_dist: 5.5090, Neg_dist: 6.9065, Acc: 0.4400, PTFixPNLoss: 3.8588, NetFixLoss: 11.7454, ]
2022-10-31 22:38:30,758 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4394, Pos_dist: 5.4799, Neg_dist: 7.2541, Acc: 0.4650, PTFixPNLoss: 3.8660, NetFixLoss: 12.9469, ]
2022-10-31 22:38:33,612 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4803, Pos_dist: 5.4566, Neg_dist: 6.8746, Acc: 0.5200, PTFixPNLoss: 3.8557, NetFixLoss: 14.1394, ]
2022-10-31 22:38:33,714 INFO: fine-tune procedure is finished!
2022-10-31 22:39:07,804 INFO: [Test_acc of task 4 on test 1: 0.25800][acc of former classes: 0.69300][acc of former samples in all classes: 0.60400]
[acc of novel samples in all classes: 0.08500]
2022-10-31 22:39:08,107 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:39:08,136 WARNING: Current net - loaded net:
2022-10-31 22:39:08,136 WARNING: Loaded net - current net:
2022-10-31 22:39:08,136 WARNING:   func.classifier.bias
2022-10-31 22:39:08,136 WARNING:   func.classifier.weight
2022-10-31 22:39:08,168 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_4.pth.
2022-10-31 22:39:08,224 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:39:08,319 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:39:08,319 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:39:08,319 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:39:08,319 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:39:08,319 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:39:08,319 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:39:08,319 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:39:08,320 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:39:08,321 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:39:08,322 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:39:08,322 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:39:08,322 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:39:08,322 INFO: Model [FSLLModel] is created.
2022-10-31 22:39:08,333 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:39:08,343 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:39:08,353 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:39:08,363 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:39:08,373 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:39:11,285 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2926, Pos_dist: 5.4805, Neg_dist: 7.4702, Acc: 0.4280, PTFixPNLoss: 4.0208, NetFixLoss: 0.0000, ]
2022-10-31 22:39:14,374 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4067, Pos_dist: 5.4809, Neg_dist: 7.0241, Acc: 0.4280, PTFixPNLoss: 4.0179, NetFixLoss: 0.4261, ]
2022-10-31 22:39:17,361 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3147, Pos_dist: 5.4519, Neg_dist: 7.6140, Acc: 0.4600, PTFixPNLoss: 4.0133, NetFixLoss: 1.0296, ]
2022-10-31 22:39:20,208 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.1447, Pos_dist: 5.4108, Neg_dist: 8.0177, Acc: 0.5040, PTFixPNLoss: 4.0156, NetFixLoss: 1.7466, ]
2022-10-31 22:39:21,640 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2159, Pos_dist: 5.4987, Neg_dist: 7.4983, Acc: 0.4400, PTFixPNLoss: 4.0208, NetFixLoss: 2.5122, ]
2022-10-31 22:39:24,960 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3096, Pos_dist: 5.4073, Neg_dist: 7.9383, Acc: 0.4720, PTFixPNLoss: 4.0138, NetFixLoss: 3.3435, ]
2022-10-31 22:39:28,475 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1815, Pos_dist: 5.4569, Neg_dist: 7.9243, Acc: 0.4560, PTFixPNLoss: 4.0160, NetFixLoss: 4.2300, ]
2022-10-31 22:39:29,725 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2718, Pos_dist: 5.4329, Neg_dist: 7.4955, Acc: 0.4520, PTFixPNLoss: 4.0196, NetFixLoss: 5.1524, ]
2022-10-31 22:39:32,967 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2460, Pos_dist: 5.4826, Neg_dist: 7.5534, Acc: 0.4600, PTFixPNLoss: 4.0178, NetFixLoss: 6.1062, ]
2022-10-31 22:39:35,985 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3291, Pos_dist: 5.4663, Neg_dist: 7.2093, Acc: 0.4560, PTFixPNLoss: 4.0114, NetFixLoss: 7.0907, ]
2022-10-31 22:39:37,448 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3343, Pos_dist: 5.3597, Neg_dist: 7.0013, Acc: 0.5120, PTFixPNLoss: 4.0051, NetFixLoss: 8.1127, ]
2022-10-31 22:39:40,684 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3607, Pos_dist: 5.4328, Neg_dist: 7.4404, Acc: 0.4720, PTFixPNLoss: 4.0118, NetFixLoss: 9.1783, ]
2022-10-31 22:39:43,909 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4156, Pos_dist: 5.5420, Neg_dist: 6.9891, Acc: 0.4320, PTFixPNLoss: 4.0236, NetFixLoss: 10.2680, ]
2022-10-31 22:39:45,301 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3533, Pos_dist: 5.4633, Neg_dist: 7.2245, Acc: 0.4960, PTFixPNLoss: 4.0183, NetFixLoss: 11.3695, ]
2022-10-31 22:39:48,522 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4566, Pos_dist: 5.4143, Neg_dist: 6.8776, Acc: 0.5040, PTFixPNLoss: 4.0129, NetFixLoss: 12.4631, ]
2022-10-31 22:39:48,615 INFO: fine-tune procedure is finished!
2022-10-31 22:40:26,906 INFO: [Test_acc of task 5 on test 1: 0.22100][acc of former classes: 0.69150][acc of former samples in all classes: 0.58550]
[acc of novel samples in all classes: 0.07520]
2022-10-31 22:40:27,212 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:40:27,238 WARNING: Current net - loaded net:
2022-10-31 22:40:27,238 WARNING: Loaded net - current net:
2022-10-31 22:40:27,238 WARNING:   func.classifier.bias
2022-10-31 22:40:27,238 WARNING:   func.classifier.weight
2022-10-31 22:40:27,268 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_5.pth.
2022-10-31 22:40:27,307 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:40:27,320 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:40:27,321 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:40:27,321 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:40:27,321 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:40:27,321 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:40:27,321 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:40:27,321 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:40:27,321 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:40:27,322 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:40:27,323 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:40:27,323 INFO: Model [FSLLModel] is created.
2022-10-31 22:40:27,334 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:40:27,344 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:40:27,354 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:40:27,364 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:40:27,374 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:40:27,386 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:40:31,009 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3211, Pos_dist: 5.4746, Neg_dist: 7.7725, Acc: 0.4500, PTFixPNLoss: 4.1513, NetFixLoss: 0.0000, ]
2022-10-31 22:40:34,033 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4716, Pos_dist: 5.4383, Neg_dist: 6.7121, Acc: 0.4400, PTFixPNLoss: 4.1500, NetFixLoss: 0.4882, ]
2022-10-31 22:40:36,946 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4324, Pos_dist: 5.4229, Neg_dist: 6.8165, Acc: 0.4533, PTFixPNLoss: 4.1535, NetFixLoss: 1.1683, ]
2022-10-31 22:40:40,663 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4839, Pos_dist: 5.4976, Neg_dist: 6.9322, Acc: 0.4367, PTFixPNLoss: 4.1463, NetFixLoss: 2.0259, ]
2022-10-31 22:40:44,333 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2550, Pos_dist: 5.4351, Neg_dist: 7.4934, Acc: 0.4467, PTFixPNLoss: 4.1507, NetFixLoss: 3.0017, ]
2022-10-31 22:40:48,294 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3612, Pos_dist: 5.5087, Neg_dist: 7.2012, Acc: 0.3967, PTFixPNLoss: 4.1582, NetFixLoss: 4.0313, ]
2022-10-31 22:40:51,838 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2931, Pos_dist: 5.4908, Neg_dist: 7.2058, Acc: 0.4133, PTFixPNLoss: 4.1591, NetFixLoss: 5.0980, ]
2022-10-31 22:40:53,968 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2823, Pos_dist: 5.3900, Neg_dist: 7.4131, Acc: 0.4833, PTFixPNLoss: 4.1509, NetFixLoss: 6.2092, ]
2022-10-31 22:40:56,608 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3989, Pos_dist: 5.4596, Neg_dist: 7.0458, Acc: 0.3933, PTFixPNLoss: 4.1561, NetFixLoss: 7.3407, ]
2022-10-31 22:41:00,164 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2062, Pos_dist: 5.5499, Neg_dist: 7.7712, Acc: 0.4667, PTFixPNLoss: 4.1566, NetFixLoss: 8.5125, ]
2022-10-31 22:41:04,072 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2469, Pos_dist: 5.4413, Neg_dist: 7.4278, Acc: 0.4067, PTFixPNLoss: 4.1542, NetFixLoss: 9.6880, ]
2022-10-31 22:41:06,163 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3615, Pos_dist: 5.4761, Neg_dist: 7.0536, Acc: 0.4033, PTFixPNLoss: 4.1587, NetFixLoss: 10.8465, ]
2022-10-31 22:41:10,027 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2959, Pos_dist: 5.4794, Neg_dist: 7.7253, Acc: 0.4067, PTFixPNLoss: 4.1604, NetFixLoss: 11.9897, ]
2022-10-31 22:41:13,839 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1644, Pos_dist: 5.5261, Neg_dist: 8.0712, Acc: 0.4567, PTFixPNLoss: 4.1550, NetFixLoss: 13.1167, ]
2022-10-31 22:41:15,681 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4149, Pos_dist: 5.4317, Neg_dist: 7.2504, Acc: 0.4400, PTFixPNLoss: 4.1525, NetFixLoss: 14.2164, ]
2022-10-31 22:41:16,681 INFO: fine-tune procedure is finished!
2022-10-31 22:42:00,221 INFO: [Test_acc of task 6 on test 1: 0.19937][acc of former classes: 0.69200][acc of former samples in all classes: 0.58150]
[acc of novel samples in all classes: 0.07200]
2022-10-31 22:42:00,524 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:42:00,549 WARNING: Current net - loaded net:
2022-10-31 22:42:00,549 WARNING: Loaded net - current net:
2022-10-31 22:42:00,550 WARNING:   func.classifier.bias
2022-10-31 22:42:00,550 WARNING:   func.classifier.weight
2022-10-31 22:42:00,586 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_6.pth.
2022-10-31 22:42:00,649 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:42:00,679 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:42:00,679 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:42:00,679 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:42:00,679 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:42:00,679 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:42:00,679 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:42:00,679 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:42:00,679 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:42:00,680 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:42:00,681 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:42:00,681 INFO: Model [FSLLModel] is created.
2022-10-31 22:42:00,692 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:42:00,702 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:42:00,712 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:42:00,723 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:42:00,733 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:42:00,743 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:42:00,753 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:42:04,571 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2605, Pos_dist: 5.5607, Neg_dist: 8.0274, Acc: 0.4057, PTFixPNLoss: 4.2766, NetFixLoss: 0.0000, ]
2022-10-31 22:42:06,883 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5238, Pos_dist: 5.5259, Neg_dist: 6.9857, Acc: 0.4314, PTFixPNLoss: 4.2753, NetFixLoss: 0.4553, ]
2022-10-31 22:42:11,358 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3115, Pos_dist: 5.4669, Neg_dist: 7.3654, Acc: 0.4171, PTFixPNLoss: 4.2736, NetFixLoss: 1.0828, ]
2022-10-31 22:42:15,775 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5823, Pos_dist: 5.4974, Neg_dist: 6.7714, Acc: 0.4257, PTFixPNLoss: 4.2748, NetFixLoss: 1.8273, ]
2022-10-31 22:42:18,890 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3225, Pos_dist: 5.4483, Neg_dist: 7.3558, Acc: 0.4029, PTFixPNLoss: 4.2759, NetFixLoss: 2.6390, ]
2022-10-31 22:42:22,754 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2649, Pos_dist: 5.4981, Neg_dist: 7.5239, Acc: 0.4286, PTFixPNLoss: 4.2726, NetFixLoss: 3.5144, ]
2022-10-31 22:42:27,135 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3368, Pos_dist: 5.4795, Neg_dist: 7.4181, Acc: 0.3857, PTFixPNLoss: 4.2758, NetFixLoss: 4.4366, ]
2022-10-31 22:42:31,432 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3355, Pos_dist: 5.4811, Neg_dist: 7.4822, Acc: 0.4600, PTFixPNLoss: 4.2634, NetFixLoss: 5.4014, ]
2022-10-31 22:42:35,771 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.0676, Pos_dist: 5.4195, Neg_dist: 8.7818, Acc: 0.4571, PTFixPNLoss: 4.2707, NetFixLoss: 6.3728, ]
2022-10-31 22:42:40,225 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3201, Pos_dist: 5.5000, Neg_dist: 7.4997, Acc: 0.4229, PTFixPNLoss: 4.2746, NetFixLoss: 7.3179, ]
2022-10-31 22:42:44,338 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5569, Pos_dist: 5.4920, Neg_dist: 6.6966, Acc: 0.3743, PTFixPNLoss: 4.2797, NetFixLoss: 8.2491, ]
2022-10-31 22:42:48,359 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4402, Pos_dist: 5.4619, Neg_dist: 7.1787, Acc: 0.4114, PTFixPNLoss: 4.2759, NetFixLoss: 9.2185, ]
2022-10-31 22:42:51,732 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4601, Pos_dist: 5.4168, Neg_dist: 6.9147, Acc: 0.4657, PTFixPNLoss: 4.2683, NetFixLoss: 10.2178, ]
2022-10-31 22:42:54,439 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3902, Pos_dist: 5.4418, Neg_dist: 6.9318, Acc: 0.4457, PTFixPNLoss: 4.2664, NetFixLoss: 11.2311, ]
2022-10-31 22:42:58,834 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4951, Pos_dist: 5.4726, Neg_dist: 6.6647, Acc: 0.4257, PTFixPNLoss: 4.2757, NetFixLoss: 12.2687, ]
2022-10-31 22:42:58,919 INFO: fine-tune procedure is finished!
2022-10-31 22:43:47,455 INFO: [Test_acc of task 7 on test 1: 0.18133][acc of former classes: 0.69150][acc of former samples in all classes: 0.57050]
[acc of novel samples in all classes: 0.07014]
2022-10-31 22:43:47,733 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:43:47,758 WARNING: Current net - loaded net:
2022-10-31 22:43:47,758 WARNING: Loaded net - current net:
2022-10-31 22:43:47,758 WARNING:   func.classifier.bias
2022-10-31 22:43:47,758 WARNING:   func.classifier.weight
2022-10-31 22:43:47,768 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_7.pth.
2022-10-31 22:43:47,820 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:43:47,854 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:43:47,854 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:43:47,854 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:43:47,854 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:43:47,854 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:43:47,854 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:43:47,854 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:43:47,854 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:43:47,854 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:43:47,854 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:43:47,854 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:43:47,854 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:43:47,854 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:43:47,854 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:43:47,855 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:43:47,856 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:43:47,856 INFO: Model [FSLLModel] is created.
2022-10-31 22:43:47,867 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:43:47,877 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:43:47,887 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:43:47,898 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:43:47,908 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:43:47,918 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:43:47,928 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:43:47,938 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:43:52,916 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3732, Pos_dist: 5.4263, Neg_dist: 6.8991, Acc: 0.4350, PTFixPNLoss: 4.3795, NetFixLoss: 0.0000, ]
2022-10-31 22:43:57,843 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2998, Pos_dist: 5.4718, Neg_dist: 7.5101, Acc: 0.4225, PTFixPNLoss: 4.3758, NetFixLoss: 0.5765, ]
2022-10-31 22:44:01,754 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3442, Pos_dist: 5.4641, Neg_dist: 7.0997, Acc: 0.3800, PTFixPNLoss: 4.3763, NetFixLoss: 1.3222, ]
2022-10-31 22:44:06,698 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4153, Pos_dist: 5.4637, Neg_dist: 6.9829, Acc: 0.4125, PTFixPNLoss: 4.3810, NetFixLoss: 2.1658, ]
2022-10-31 22:44:11,046 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.6428, Pos_dist: 5.4624, Neg_dist: 6.4366, Acc: 0.3875, PTFixPNLoss: 4.3788, NetFixLoss: 3.0674, ]
2022-10-31 22:44:15,857 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.1994, Pos_dist: 5.5279, Neg_dist: 7.8583, Acc: 0.4100, PTFixPNLoss: 4.3827, NetFixLoss: 4.0470, ]
2022-10-31 22:44:20,820 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4364, Pos_dist: 5.4466, Neg_dist: 6.7868, Acc: 0.4100, PTFixPNLoss: 4.3725, NetFixLoss: 5.0629, ]
2022-10-31 22:44:24,637 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2615, Pos_dist: 5.3857, Neg_dist: 7.5835, Acc: 0.4275, PTFixPNLoss: 4.3728, NetFixLoss: 6.0859, ]
2022-10-31 22:44:29,370 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3029, Pos_dist: 5.3948, Neg_dist: 7.2027, Acc: 0.4500, PTFixPNLoss: 4.3666, NetFixLoss: 7.1074, ]
2022-10-31 22:44:34,400 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3055, Pos_dist: 5.4455, Neg_dist: 7.2944, Acc: 0.4150, PTFixPNLoss: 4.3741, NetFixLoss: 8.1306, ]
2022-10-31 22:44:38,875 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4225, Pos_dist: 5.4911, Neg_dist: 7.0065, Acc: 0.4250, PTFixPNLoss: 4.3773, NetFixLoss: 9.1592, ]
2022-10-31 22:44:42,976 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5519, Pos_dist: 5.4635, Neg_dist: 6.5547, Acc: 0.4050, PTFixPNLoss: 4.3835, NetFixLoss: 10.1953, ]
2022-10-31 22:44:47,863 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2269, Pos_dist: 5.3805, Neg_dist: 7.8445, Acc: 0.4225, PTFixPNLoss: 4.3710, NetFixLoss: 11.3090, ]
2022-10-31 22:44:52,580 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1849, Pos_dist: 5.4221, Neg_dist: 7.6419, Acc: 0.4250, PTFixPNLoss: 4.3728, NetFixLoss: 12.4070, ]
2022-10-31 22:44:57,373 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2223, Pos_dist: 5.5110, Neg_dist: 7.6523, Acc: 0.3550, PTFixPNLoss: 4.3798, NetFixLoss: 13.4841, ]
2022-10-31 22:44:57,509 INFO: fine-tune procedure is finished!
2022-10-31 22:45:52,014 INFO: [Test_acc of task 8 on test 1: 0.17170][acc of former classes: 0.69450][acc of former samples in all classes: 0.56200]
[acc of novel samples in all classes: 0.07412]
2022-10-31 22:45:52,292 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:45:52,317 WARNING: Current net - loaded net:
2022-10-31 22:45:52,317 WARNING: Loaded net - current net:
2022-10-31 22:45:52,317 WARNING:   func.classifier.bias
2022-10-31 22:45:52,317 WARNING:   func.classifier.weight
2022-10-31 22:45:52,327 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth.
2022-10-31 22:45:52,366 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:45:52,379 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:45:52,379 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:45:52,379 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:45:52,379 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:45:52,379 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:45:52,379 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:45:52,380 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:45:52,380 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:45:52,381 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:45:52,382 INFO: Model [FSLLModel] is created.
2022-10-31 22:45:52,393 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test1_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:45:53,297 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2497, Pos_dist: 5.4027, Neg_dist: 7.3063, Acc: 0.5600, PTFixPNLoss: 3.1386, NetFixLoss: 0.0000, ]
2022-10-31 22:45:54,277 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4022, Pos_dist: 5.3667, Neg_dist: 6.8152, Acc: 0.5400, PTFixPNLoss: 3.1318, NetFixLoss: 0.6177, ]
2022-10-31 22:45:55,422 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.1864, Pos_dist: 5.4252, Neg_dist: 7.4801, Acc: 0.6400, PTFixPNLoss: 3.1443, NetFixLoss: 1.3325, ]
2022-10-31 22:45:56,493 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3218, Pos_dist: 5.5427, Neg_dist: 7.3814, Acc: 0.5600, PTFixPNLoss: 3.1466, NetFixLoss: 2.1402, ]
2022-10-31 22:45:57,683 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.5511, Pos_dist: 5.5495, Neg_dist: 6.9722, Acc: 0.5400, PTFixPNLoss: 3.1413, NetFixLoss: 3.0802, ]
2022-10-31 22:45:58,726 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5000, Pos_dist: 5.5274, Neg_dist: 7.1633, Acc: 0.5000, PTFixPNLoss: 3.1471, NetFixLoss: 4.1834, ]
2022-10-31 22:45:59,734 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4060, Pos_dist: 5.3839, Neg_dist: 6.7007, Acc: 0.5800, PTFixPNLoss: 3.1488, NetFixLoss: 5.3857, ]
2022-10-31 22:46:00,732 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3153, Pos_dist: 5.4197, Neg_dist: 7.3727, Acc: 0.6000, PTFixPNLoss: 3.1398, NetFixLoss: 6.6339, ]
2022-10-31 22:46:01,311 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.5129, Pos_dist: 5.3630, Neg_dist: 6.4314, Acc: 0.5600, PTFixPNLoss: 3.1437, NetFixLoss: 7.9442, ]
2022-10-31 22:46:02,412 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3870, Pos_dist: 5.5010, Neg_dist: 6.9089, Acc: 0.5800, PTFixPNLoss: 3.1465, NetFixLoss: 9.3619, ]
2022-10-31 22:46:03,409 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3325, Pos_dist: 5.5174, Neg_dist: 7.2816, Acc: 0.6800, PTFixPNLoss: 3.1325, NetFixLoss: 10.8662, ]
2022-10-31 22:46:04,393 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3818, Pos_dist: 5.5338, Neg_dist: 7.1143, Acc: 0.5600, PTFixPNLoss: 3.1590, NetFixLoss: 12.4001, ]
2022-10-31 22:46:05,401 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2571, Pos_dist: 5.3684, Neg_dist: 7.5083, Acc: 0.7400, PTFixPNLoss: 3.1371, NetFixLoss: 13.9218, ]
2022-10-31 22:46:06,365 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4113, Pos_dist: 5.3071, Neg_dist: 6.7158, Acc: 0.7000, PTFixPNLoss: 3.1252, NetFixLoss: 15.3868, ]
2022-10-31 22:46:07,454 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2507, Pos_dist: 5.4204, Neg_dist: 7.4600, Acc: 0.5600, PTFixPNLoss: 3.1404, NetFixLoss: 16.8389, ]
2022-10-31 22:46:07,551 INFO: fine-tune procedure is finished!
2022-10-31 22:46:25,466 INFO: [Test_acc of task 1 on test 2: 0.47400][acc of former classes: 0.68250][acc of former samples in all classes: 0.64850]
[acc of novel samples in all classes: 0.12500]
2022-10-31 22:46:25,750 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:46:25,776 WARNING: Current net - loaded net:
2022-10-31 22:46:25,776 WARNING: Loaded net - current net:
2022-10-31 22:46:25,777 WARNING:   func.classifier.bias
2022-10-31 22:46:25,777 WARNING:   func.classifier.weight
2022-10-31 22:46:25,787 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_1.pth.
2022-10-31 22:46:25,823 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:46:25,837 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:46:25,837 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:46:25,837 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:46:25,837 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:46:25,837 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:46:25,837 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:46:25,837 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:46:25,837 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:46:25,838 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:46:25,839 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:46:25,839 INFO: Model [FSLLModel] is created.
2022-10-31 22:46:25,851 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:46:25,861 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:46:27,322 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3055, Pos_dist: 5.3627, Neg_dist: 6.9487, Acc: 0.5500, PTFixPNLoss: 3.4243, NetFixLoss: 0.0000, ]
2022-10-31 22:46:28,842 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2374, Pos_dist: 5.4083, Neg_dist: 7.4645, Acc: 0.6000, PTFixPNLoss: 3.4246, NetFixLoss: 0.5674, ]
2022-10-31 22:46:30,483 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5602, Pos_dist: 5.5226, Neg_dist: 6.6711, Acc: 0.4500, PTFixPNLoss: 3.4337, NetFixLoss: 1.2921, ]
2022-10-31 22:46:32,043 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5036, Pos_dist: 5.4433, Neg_dist: 6.9774, Acc: 0.5100, PTFixPNLoss: 3.4316, NetFixLoss: 2.2140, ]
2022-10-31 22:46:33,585 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2849, Pos_dist: 5.3995, Neg_dist: 7.2989, Acc: 0.5700, PTFixPNLoss: 3.4303, NetFixLoss: 3.2625, ]
2022-10-31 22:46:35,151 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3154, Pos_dist: 5.4647, Neg_dist: 7.2389, Acc: 0.5700, PTFixPNLoss: 3.4349, NetFixLoss: 4.4126, ]
2022-10-31 22:46:36,160 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4573, Pos_dist: 5.4400, Neg_dist: 6.8054, Acc: 0.4700, PTFixPNLoss: 3.4318, NetFixLoss: 5.6037, ]
2022-10-31 22:46:37,775 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4596, Pos_dist: 5.3820, Neg_dist: 6.6702, Acc: 0.5300, PTFixPNLoss: 3.4256, NetFixLoss: 6.8303, ]
2022-10-31 22:46:39,409 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2967, Pos_dist: 5.3872, Neg_dist: 7.6174, Acc: 0.5400, PTFixPNLoss: 3.4256, NetFixLoss: 8.0697, ]
2022-10-31 22:46:41,102 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3409, Pos_dist: 5.4783, Neg_dist: 7.1369, Acc: 0.4800, PTFixPNLoss: 3.4349, NetFixLoss: 9.3030, ]
2022-10-31 22:46:42,316 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3459, Pos_dist: 5.4854, Neg_dist: 7.2084, Acc: 0.5000, PTFixPNLoss: 3.4376, NetFixLoss: 10.5504, ]
2022-10-31 22:46:43,859 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3844, Pos_dist: 5.3005, Neg_dist: 6.7371, Acc: 0.5900, PTFixPNLoss: 3.4240, NetFixLoss: 11.7825, ]
2022-10-31 22:46:45,541 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4332, Pos_dist: 5.4485, Neg_dist: 7.3121, Acc: 0.5800, PTFixPNLoss: 3.4357, NetFixLoss: 13.0179, ]
2022-10-31 22:46:46,274 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3689, Pos_dist: 5.3887, Neg_dist: 6.9315, Acc: 0.5200, PTFixPNLoss: 3.4335, NetFixLoss: 14.2454, ]
2022-10-31 22:46:47,841 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3351, Pos_dist: 5.5044, Neg_dist: 7.7445, Acc: 0.5300, PTFixPNLoss: 3.4342, NetFixLoss: 15.4486, ]
2022-10-31 22:46:47,972 INFO: fine-tune procedure is finished!
2022-10-31 22:47:10,964 INFO: [Test_acc of task 2 on test 2: 0.37275][acc of former classes: 0.68600][acc of former samples in all classes: 0.62750]
[acc of novel samples in all classes: 0.11800]
2022-10-31 22:47:11,268 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:47:11,294 WARNING: Current net - loaded net:
2022-10-31 22:47:11,294 WARNING: Loaded net - current net:
2022-10-31 22:47:11,294 WARNING:   func.classifier.bias
2022-10-31 22:47:11,294 WARNING:   func.classifier.weight
2022-10-31 22:47:11,331 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_2.pth.
2022-10-31 22:47:11,394 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:47:11,423 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:47:11,424 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:47:11,424 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:47:11,424 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:47:11,424 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:47:11,424 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:47:11,424 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:47:11,424 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:47:11,425 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:47:11,426 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:47:11,426 INFO: Model [FSLLModel] is created.
2022-10-31 22:47:11,437 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:47:11,447 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:47:11,457 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:47:13,496 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.5195, Pos_dist: 5.4931, Neg_dist: 6.9236, Acc: 0.4533, PTFixPNLoss: 3.6692, NetFixLoss: 0.0000, ]
2022-10-31 22:47:15,569 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2157, Pos_dist: 5.4741, Neg_dist: 7.9899, Acc: 0.5133, PTFixPNLoss: 3.6718, NetFixLoss: 0.5910, ]
2022-10-31 22:47:17,652 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3869, Pos_dist: 5.4026, Neg_dist: 6.8369, Acc: 0.5200, PTFixPNLoss: 3.6714, NetFixLoss: 1.2303, ]
2022-10-31 22:47:19,831 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3505, Pos_dist: 5.4331, Neg_dist: 7.1324, Acc: 0.5067, PTFixPNLoss: 3.6720, NetFixLoss: 1.9884, ]
2022-10-31 22:47:22,082 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.5752, Pos_dist: 5.5166, Neg_dist: 6.5874, Acc: 0.5333, PTFixPNLoss: 3.6711, NetFixLoss: 2.8707, ]
2022-10-31 22:47:24,145 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3123, Pos_dist: 5.3980, Neg_dist: 7.0078, Acc: 0.5133, PTFixPNLoss: 3.6653, NetFixLoss: 3.9153, ]
2022-10-31 22:47:26,215 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.6625, Pos_dist: 5.3951, Neg_dist: 6.1984, Acc: 0.5000, PTFixPNLoss: 3.6669, NetFixLoss: 5.0471, ]
2022-10-31 22:47:28,322 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3972, Pos_dist: 5.5020, Neg_dist: 7.0902, Acc: 0.4400, PTFixPNLoss: 3.6788, NetFixLoss: 6.2872, ]
2022-10-31 22:47:30,288 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.6032, Pos_dist: 5.5570, Neg_dist: 6.7780, Acc: 0.4667, PTFixPNLoss: 3.6752, NetFixLoss: 7.5810, ]
2022-10-31 22:47:32,378 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.5317, Pos_dist: 5.5540, Neg_dist: 6.9100, Acc: 0.4933, PTFixPNLoss: 3.6810, NetFixLoss: 8.9168, ]
2022-10-31 22:47:34,552 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4581, Pos_dist: 5.4484, Neg_dist: 6.9041, Acc: 0.5400, PTFixPNLoss: 3.6602, NetFixLoss: 10.2668, ]
2022-10-31 22:47:36,499 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5239, Pos_dist: 5.5539, Neg_dist: 6.7788, Acc: 0.4533, PTFixPNLoss: 3.6769, NetFixLoss: 11.6485, ]
2022-10-31 22:47:38,492 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3632, Pos_dist: 5.4441, Neg_dist: 7.4595, Acc: 0.5267, PTFixPNLoss: 3.6688, NetFixLoss: 13.0603, ]
2022-10-31 22:47:40,443 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2464, Pos_dist: 5.5143, Neg_dist: 7.6633, Acc: 0.4000, PTFixPNLoss: 3.6713, NetFixLoss: 14.4422, ]
2022-10-31 22:47:42,414 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2111, Pos_dist: 5.4556, Neg_dist: 7.8032, Acc: 0.5000, PTFixPNLoss: 3.6705, NetFixLoss: 15.7801, ]
2022-10-31 22:47:42,489 INFO: fine-tune procedure is finished!
2022-10-31 22:48:10,518 INFO: [Test_acc of task 3 on test 2: 0.30300][acc of former classes: 0.68800][acc of former samples in all classes: 0.61600]
[acc of novel samples in all classes: 0.09433]
2022-10-31 22:48:10,813 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:48:10,839 WARNING: Current net - loaded net:
2022-10-31 22:48:10,839 WARNING: Loaded net - current net:
2022-10-31 22:48:10,839 WARNING:   func.classifier.bias
2022-10-31 22:48:10,839 WARNING:   func.classifier.weight
2022-10-31 22:48:10,877 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_3.pth.
2022-10-31 22:48:10,939 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:48:10,969 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:48:10,969 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:48:10,969 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:48:10,969 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:48:10,969 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:48:10,969 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:48:10,969 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:48:10,969 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:48:10,969 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:48:10,969 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:48:10,969 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:48:10,970 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:48:10,971 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:48:10,971 INFO: Model [FSLLModel] is created.
2022-10-31 22:48:10,982 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:48:10,992 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:48:11,002 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:48:11,012 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:48:12,271 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4112, Pos_dist: 5.3626, Neg_dist: 6.6927, Acc: 0.4700, PTFixPNLoss: 3.8545, NetFixLoss: 0.0000, ]
2022-10-31 22:48:14,925 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3014, Pos_dist: 5.4960, Neg_dist: 7.7019, Acc: 0.4750, PTFixPNLoss: 3.8489, NetFixLoss: 0.5765, ]
2022-10-31 22:48:17,576 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.6076, Pos_dist: 5.5168, Neg_dist: 6.4207, Acc: 0.4800, PTFixPNLoss: 3.8600, NetFixLoss: 1.2622, ]
2022-10-31 22:48:19,507 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3955, Pos_dist: 5.4464, Neg_dist: 7.2918, Acc: 0.4700, PTFixPNLoss: 3.8600, NetFixLoss: 2.0814, ]
2022-10-31 22:48:22,189 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.5010, Pos_dist: 5.3074, Neg_dist: 6.5771, Acc: 0.5250, PTFixPNLoss: 3.8532, NetFixLoss: 2.9880, ]
2022-10-31 22:48:24,875 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2864, Pos_dist: 5.4040, Neg_dist: 7.6334, Acc: 0.4900, PTFixPNLoss: 3.8556, NetFixLoss: 3.9479, ]
2022-10-31 22:48:27,522 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4219, Pos_dist: 5.5452, Neg_dist: 7.1015, Acc: 0.4150, PTFixPNLoss: 3.8647, NetFixLoss: 4.9189, ]
2022-10-31 22:48:30,195 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4301, Pos_dist: 5.4723, Neg_dist: 7.6059, Acc: 0.4500, PTFixPNLoss: 3.8594, NetFixLoss: 5.9126, ]
2022-10-31 22:48:32,893 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.1189, Pos_dist: 5.4063, Neg_dist: 9.2196, Acc: 0.5050, PTFixPNLoss: 3.8493, NetFixLoss: 6.9282, ]
2022-10-31 22:48:35,590 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4980, Pos_dist: 5.4525, Neg_dist: 6.9676, Acc: 0.4350, PTFixPNLoss: 3.8586, NetFixLoss: 7.9191, ]
2022-10-31 22:48:38,176 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2404, Pos_dist: 5.3813, Neg_dist: 7.5477, Acc: 0.4600, PTFixPNLoss: 3.8560, NetFixLoss: 8.9166, ]
2022-10-31 22:48:40,799 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3657, Pos_dist: 5.4136, Neg_dist: 7.4615, Acc: 0.4950, PTFixPNLoss: 3.8506, NetFixLoss: 9.8827, ]
2022-10-31 22:48:43,471 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3932, Pos_dist: 5.4836, Neg_dist: 6.9992, Acc: 0.5050, PTFixPNLoss: 3.8533, NetFixLoss: 10.8650, ]
2022-10-31 22:48:45,493 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4515, Pos_dist: 5.4469, Neg_dist: 7.0198, Acc: 0.4600, PTFixPNLoss: 3.8538, NetFixLoss: 11.8595, ]
2022-10-31 22:48:48,182 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3659, Pos_dist: 5.4168, Neg_dist: 6.9683, Acc: 0.4950, PTFixPNLoss: 3.8490, NetFixLoss: 12.8907, ]
2022-10-31 22:48:48,259 INFO: fine-tune procedure is finished!
2022-10-31 22:49:21,395 INFO: [Test_acc of task 4 on test 2: 0.25200][acc of former classes: 0.69450][acc of former samples in all classes: 0.59650]
[acc of novel samples in all classes: 0.07975]
2022-10-31 22:49:21,702 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:49:21,729 WARNING: Current net - loaded net:
2022-10-31 22:49:21,729 WARNING: Loaded net - current net:
2022-10-31 22:49:21,729 WARNING:   func.classifier.bias
2022-10-31 22:49:21,729 WARNING:   func.classifier.weight
2022-10-31 22:49:21,765 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_4.pth.
2022-10-31 22:49:21,829 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:49:21,861 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:49:21,861 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:49:21,862 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:49:21,862 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:49:21,862 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:49:21,862 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:49:21,862 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:49:21,862 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:49:21,863 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:49:21,864 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:49:21,864 INFO: Model [FSLLModel] is created.
2022-10-31 22:49:21,875 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:49:21,885 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:49:21,895 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:49:21,905 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:49:21,915 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:49:25,055 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2668, Pos_dist: 5.4358, Neg_dist: 7.2295, Acc: 0.4560, PTFixPNLoss: 4.0185, NetFixLoss: 0.0000, ]
2022-10-31 22:49:28,256 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1222, Pos_dist: 5.4143, Neg_dist: 8.3497, Acc: 0.5240, PTFixPNLoss: 4.0145, NetFixLoss: 0.5959, ]
2022-10-31 22:49:31,473 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3115, Pos_dist: 5.4653, Neg_dist: 7.8338, Acc: 0.4560, PTFixPNLoss: 4.0207, NetFixLoss: 1.2179, ]
2022-10-31 22:49:34,665 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.6391, Pos_dist: 5.4456, Neg_dist: 6.3867, Acc: 0.4320, PTFixPNLoss: 4.0133, NetFixLoss: 1.9551, ]
2022-10-31 22:49:37,063 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2000, Pos_dist: 5.4263, Neg_dist: 7.9326, Acc: 0.4520, PTFixPNLoss: 4.0269, NetFixLoss: 2.8065, ]
2022-10-31 22:49:40,343 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5426, Pos_dist: 5.4101, Neg_dist: 6.6095, Acc: 0.4640, PTFixPNLoss: 4.0116, NetFixLoss: 3.7221, ]
2022-10-31 22:49:43,595 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3751, Pos_dist: 5.4211, Neg_dist: 6.9522, Acc: 0.4440, PTFixPNLoss: 4.0102, NetFixLoss: 4.6823, ]
2022-10-31 22:49:44,967 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4633, Pos_dist: 5.4096, Neg_dist: 6.6995, Acc: 0.4560, PTFixPNLoss: 4.0162, NetFixLoss: 5.6946, ]
2022-10-31 22:49:48,101 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.5767, Pos_dist: 5.4752, Neg_dist: 6.5223, Acc: 0.4080, PTFixPNLoss: 4.0225, NetFixLoss: 6.7364, ]
2022-10-31 22:49:51,231 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3913, Pos_dist: 5.4854, Neg_dist: 7.1018, Acc: 0.5000, PTFixPNLoss: 4.0216, NetFixLoss: 7.8387, ]
2022-10-31 22:49:54,052 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4338, Pos_dist: 5.5203, Neg_dist: 7.0320, Acc: 0.4080, PTFixPNLoss: 4.0205, NetFixLoss: 8.9879, ]
2022-10-31 22:49:57,231 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5775, Pos_dist: 5.4203, Neg_dist: 6.3851, Acc: 0.4520, PTFixPNLoss: 4.0146, NetFixLoss: 10.1653, ]
2022-10-31 22:50:00,451 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2899, Pos_dist: 5.4232, Neg_dist: 7.3087, Acc: 0.4840, PTFixPNLoss: 4.0109, NetFixLoss: 11.3441, ]
2022-10-31 22:50:03,684 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.5082, Pos_dist: 5.3926, Neg_dist: 6.5323, Acc: 0.4480, PTFixPNLoss: 4.0103, NetFixLoss: 12.5228, ]
2022-10-31 22:50:07,070 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4235, Pos_dist: 5.4193, Neg_dist: 7.1352, Acc: 0.4760, PTFixPNLoss: 4.0161, NetFixLoss: 13.6815, ]
2022-10-31 22:50:07,168 INFO: fine-tune procedure is finished!
2022-10-31 22:50:46,240 INFO: [Test_acc of task 5 on test 2: 0.21957][acc of former classes: 0.69550][acc of former samples in all classes: 0.59100]
[acc of novel samples in all classes: 0.07100]
2022-10-31 22:50:46,534 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:50:46,561 WARNING: Current net - loaded net:
2022-10-31 22:50:46,561 WARNING: Loaded net - current net:
2022-10-31 22:50:46,561 WARNING:   func.classifier.bias
2022-10-31 22:50:46,561 WARNING:   func.classifier.weight
2022-10-31 22:50:46,591 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_5.pth.
2022-10-31 22:50:46,646 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:50:46,675 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:50:46,675 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:50:46,675 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:50:46,675 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:50:46,675 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:50:46,675 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:50:46,675 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:50:46,675 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:50:46,676 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:50:46,677 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:50:46,677 INFO: Model [FSLLModel] is created.
2022-10-31 22:50:46,688 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:50:46,698 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:50:46,708 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:50:46,718 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:50:46,729 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:50:46,739 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 22:50:50,286 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4563, Pos_dist: 5.4042, Neg_dist: 6.7572, Acc: 0.4167, PTFixPNLoss: 4.1473, NetFixLoss: 0.0000, ]
2022-10-31 22:50:53,064 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5522, Pos_dist: 5.4660, Neg_dist: 6.6448, Acc: 0.4300, PTFixPNLoss: 4.1494, NetFixLoss: 0.5187, ]
2022-10-31 22:50:54,618 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2983, Pos_dist: 5.4188, Neg_dist: 7.4450, Acc: 0.4700, PTFixPNLoss: 4.1491, NetFixLoss: 1.2828, ]
2022-10-31 22:50:58,533 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3027, Pos_dist: 5.4209, Neg_dist: 7.1783, Acc: 0.4000, PTFixPNLoss: 4.1542, NetFixLoss: 2.1560, ]
2022-10-31 22:51:02,368 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2229, Pos_dist: 5.4004, Neg_dist: 7.5341, Acc: 0.4100, PTFixPNLoss: 4.1456, NetFixLoss: 3.0819, ]
2022-10-31 22:51:05,648 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5938, Pos_dist: 5.4882, Neg_dist: 6.4397, Acc: 0.4367, PTFixPNLoss: 4.1590, NetFixLoss: 4.0508, ]
2022-10-31 22:51:09,522 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2154, Pos_dist: 5.4505, Neg_dist: 7.5997, Acc: 0.4267, PTFixPNLoss: 4.1521, NetFixLoss: 5.1017, ]
2022-10-31 22:51:13,365 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3681, Pos_dist: 5.4477, Neg_dist: 7.1562, Acc: 0.4633, PTFixPNLoss: 4.1557, NetFixLoss: 6.2158, ]
2022-10-31 22:51:17,413 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2477, Pos_dist: 5.4359, Neg_dist: 7.4827, Acc: 0.4300, PTFixPNLoss: 4.1561, NetFixLoss: 7.3284, ]
2022-10-31 22:51:21,275 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1820, Pos_dist: 5.3848, Neg_dist: 8.4026, Acc: 0.4533, PTFixPNLoss: 4.1472, NetFixLoss: 8.4435, ]
2022-10-31 22:51:23,062 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2831, Pos_dist: 5.4655, Neg_dist: 7.7807, Acc: 0.4300, PTFixPNLoss: 4.1542, NetFixLoss: 9.5433, ]
2022-10-31 22:51:26,914 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5052, Pos_dist: 5.4602, Neg_dist: 6.7551, Acc: 0.4133, PTFixPNLoss: 4.1560, NetFixLoss: 10.6318, ]
2022-10-31 22:51:30,983 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4415, Pos_dist: 5.4263, Neg_dist: 6.9016, Acc: 0.4300, PTFixPNLoss: 4.1519, NetFixLoss: 11.6999, ]
2022-10-31 22:51:34,105 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3797, Pos_dist: 5.4057, Neg_dist: 7.0413, Acc: 0.4467, PTFixPNLoss: 4.1518, NetFixLoss: 12.7850, ]
2022-10-31 22:51:37,967 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4767, Pos_dist: 5.4366, Neg_dist: 6.7542, Acc: 0.4400, PTFixPNLoss: 4.1539, NetFixLoss: 13.9029, ]
2022-10-31 22:51:38,041 INFO: fine-tune procedure is finished!
2022-10-31 22:52:21,721 INFO: [Test_acc of task 6 on test 2: 0.19662][acc of former classes: 0.69150][acc of former samples in all classes: 0.58050]
[acc of novel samples in all classes: 0.06867]
2022-10-31 22:52:22,026 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:52:22,051 WARNING: Current net - loaded net:
2022-10-31 22:52:22,051 WARNING: Loaded net - current net:
2022-10-31 22:52:22,051 WARNING:   func.classifier.bias
2022-10-31 22:52:22,051 WARNING:   func.classifier.weight
2022-10-31 22:52:22,088 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_6.pth.
2022-10-31 22:52:22,151 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:52:22,181 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:52:22,181 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:52:22,181 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:52:22,181 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:52:22,181 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:52:22,181 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:52:22,182 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:52:22,182 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:52:22,183 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:52:22,184 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:52:22,184 INFO: Model [FSLLModel] is created.
2022-10-31 22:52:22,195 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:52:22,205 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:52:22,215 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:52:22,225 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:52:22,235 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:52:22,245 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:52:22,255 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 22:52:25,110 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2565, Pos_dist: 5.3461, Neg_dist: 7.3530, Acc: 0.4600, PTFixPNLoss: 4.2606, NetFixLoss: 0.0000, ]
2022-10-31 22:52:29,515 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2599, Pos_dist: 5.4307, Neg_dist: 7.5704, Acc: 0.4343, PTFixPNLoss: 4.2736, NetFixLoss: 0.4439, ]
2022-10-31 22:52:33,841 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3230, Pos_dist: 5.4201, Neg_dist: 7.3841, Acc: 0.4571, PTFixPNLoss: 4.2725, NetFixLoss: 0.9941, ]
2022-10-31 22:52:38,296 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3286, Pos_dist: 5.4014, Neg_dist: 7.2271, Acc: 0.4057, PTFixPNLoss: 4.2705, NetFixLoss: 1.6253, ]
2022-10-31 22:52:42,624 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4626, Pos_dist: 5.4176, Neg_dist: 7.1548, Acc: 0.4743, PTFixPNLoss: 4.2707, NetFixLoss: 2.3451, ]
2022-10-31 22:52:46,159 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4416, Pos_dist: 5.4149, Neg_dist: 6.7769, Acc: 0.4314, PTFixPNLoss: 4.2741, NetFixLoss: 3.1709, ]
2022-10-31 22:52:50,498 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4974, Pos_dist: 5.3836, Neg_dist: 6.5928, Acc: 0.4286, PTFixPNLoss: 4.2707, NetFixLoss: 4.0886, ]
2022-10-31 22:52:54,829 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3861, Pos_dist: 5.4059, Neg_dist: 7.0105, Acc: 0.4457, PTFixPNLoss: 4.2701, NetFixLoss: 5.0564, ]
2022-10-31 22:52:58,351 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3857, Pos_dist: 5.3977, Neg_dist: 6.8320, Acc: 0.4429, PTFixPNLoss: 4.2734, NetFixLoss: 6.0585, ]
2022-10-31 22:53:02,714 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2581, Pos_dist: 5.3712, Neg_dist: 8.1334, Acc: 0.4571, PTFixPNLoss: 4.2728, NetFixLoss: 7.1190, ]
2022-10-31 22:53:06,779 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4419, Pos_dist: 5.3911, Neg_dist: 6.8148, Acc: 0.4029, PTFixPNLoss: 4.2690, NetFixLoss: 8.2005, ]
2022-10-31 22:53:11,169 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2345, Pos_dist: 5.4245, Neg_dist: 7.4075, Acc: 0.4629, PTFixPNLoss: 4.2772, NetFixLoss: 9.2960, ]
2022-10-31 22:53:15,491 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3618, Pos_dist: 5.4686, Neg_dist: 7.2938, Acc: 0.3943, PTFixPNLoss: 4.2790, NetFixLoss: 10.3914, ]
2022-10-31 22:53:18,084 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1763, Pos_dist: 5.4493, Neg_dist: 7.9897, Acc: 0.4200, PTFixPNLoss: 4.2743, NetFixLoss: 11.4951, ]
2022-10-31 22:53:22,571 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3194, Pos_dist: 5.3984, Neg_dist: 7.0732, Acc: 0.4457, PTFixPNLoss: 4.2686, NetFixLoss: 12.6043, ]
2022-10-31 22:53:22,660 INFO: fine-tune procedure is finished!
2022-10-31 22:54:12,250 INFO: [Test_acc of task 7 on test 2: 0.17378][acc of former classes: 0.69000][acc of former samples in all classes: 0.57200]
[acc of novel samples in all classes: 0.06000]
2022-10-31 22:54:12,548 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:54:12,573 WARNING: Current net - loaded net:
2022-10-31 22:54:12,574 WARNING: Loaded net - current net:
2022-10-31 22:54:12,574 WARNING:   func.classifier.bias
2022-10-31 22:54:12,574 WARNING:   func.classifier.weight
2022-10-31 22:54:12,605 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_7.pth.
2022-10-31 22:54:12,665 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:54:12,694 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:54:12,694 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:54:12,695 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:54:12,695 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:54:12,695 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:54:12,695 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:54:12,695 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:54:12,695 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:54:12,696 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:54:12,697 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:54:12,697 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:54:12,697 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:54:12,697 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:54:12,697 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:54:12,697 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:54:12,697 INFO: Model [FSLLModel] is created.
2022-10-31 22:54:12,708 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:54:12,718 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:54:12,728 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:54:12,738 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:54:12,748 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:54:12,758 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:54:12,769 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:54:12,779 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 22:54:17,330 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3026, Pos_dist: 5.4571, Neg_dist: 7.3562, Acc: 0.4375, PTFixPNLoss: 4.3689, NetFixLoss: 0.0000, ]
2022-10-31 22:54:21,906 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2026, Pos_dist: 5.4793, Neg_dist: 7.8122, Acc: 0.4175, PTFixPNLoss: 4.3749, NetFixLoss: 0.4597, ]
2022-10-31 22:54:26,493 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5072, Pos_dist: 5.3706, Neg_dist: 6.5719, Acc: 0.4625, PTFixPNLoss: 4.3699, NetFixLoss: 1.0359, ]
2022-10-31 22:54:30,929 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4149, Pos_dist: 5.3844, Neg_dist: 6.8344, Acc: 0.4650, PTFixPNLoss: 4.3730, NetFixLoss: 1.7564, ]
2022-10-31 22:54:34,050 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2996, Pos_dist: 5.4548, Neg_dist: 7.3622, Acc: 0.4300, PTFixPNLoss: 4.3753, NetFixLoss: 2.6035, ]
2022-10-31 22:54:39,153 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4129, Pos_dist: 5.4105, Neg_dist: 6.9899, Acc: 0.4175, PTFixPNLoss: 4.3696, NetFixLoss: 3.5268, ]
2022-10-31 22:54:44,096 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1994, Pos_dist: 5.4373, Neg_dist: 8.0581, Acc: 0.4050, PTFixPNLoss: 4.3721, NetFixLoss: 4.4801, ]
2022-10-31 22:54:49,023 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2568, Pos_dist: 5.3996, Neg_dist: 7.8238, Acc: 0.4300, PTFixPNLoss: 4.3769, NetFixLoss: 5.4319, ]
2022-10-31 22:54:53,905 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3156, Pos_dist: 5.4405, Neg_dist: 7.2443, Acc: 0.4075, PTFixPNLoss: 4.3691, NetFixLoss: 6.3712, ]
2022-10-31 22:54:56,871 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3637, Pos_dist: 5.3955, Neg_dist: 7.2220, Acc: 0.4350, PTFixPNLoss: 4.3726, NetFixLoss: 7.3356, ]
2022-10-31 22:55:01,771 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3995, Pos_dist: 5.4728, Neg_dist: 7.1182, Acc: 0.4050, PTFixPNLoss: 4.3720, NetFixLoss: 8.3150, ]
2022-10-31 22:55:06,701 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4100, Pos_dist: 5.3959, Neg_dist: 7.0288, Acc: 0.4775, PTFixPNLoss: 4.3709, NetFixLoss: 9.3147, ]
2022-10-31 22:55:11,876 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4373, Pos_dist: 5.4692, Neg_dist: 7.0665, Acc: 0.4450, PTFixPNLoss: 4.3771, NetFixLoss: 10.3557, ]
2022-10-31 22:55:16,823 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3655, Pos_dist: 5.3732, Neg_dist: 7.0805, Acc: 0.4400, PTFixPNLoss: 4.3703, NetFixLoss: 11.4113, ]
2022-10-31 22:55:20,124 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.1581, Pos_dist: 5.3359, Neg_dist: 8.1610, Acc: 0.4425, PTFixPNLoss: 4.3667, NetFixLoss: 12.4780, ]
2022-10-31 22:55:20,214 INFO: fine-tune procedure is finished!
2022-10-31 22:56:14,433 INFO: [Test_acc of task 8 on test 2: 0.16330][acc of former classes: 0.68850][acc of former samples in all classes: 0.55900]
[acc of novel samples in all classes: 0.06438]
2022-10-31 22:56:14,736 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:56:14,762 WARNING: Current net - loaded net:
2022-10-31 22:56:14,762 WARNING: Loaded net - current net:
2022-10-31 22:56:14,762 WARNING:   func.classifier.bias
2022-10-31 22:56:14,762 WARNING:   func.classifier.weight
2022-10-31 22:56:14,799 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth.
2022-10-31 22:56:14,863 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:56:14,894 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:56:14,894 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:56:14,894 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:56:14,894 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:56:14,894 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:56:14,894 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:56:14,894 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:56:14,894 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:56:14,894 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:56:14,894 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:56:14,895 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:56:14,896 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:56:14,897 INFO: Model [FSLLModel] is created.
2022-10-31 22:56:14,907 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test2_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 22:56:15,808 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2104, Pos_dist: 5.3651, Neg_dist: 7.5411, Acc: 0.6000, PTFixPNLoss: 3.1306, NetFixLoss: 0.0000, ]
2022-10-31 22:56:16,859 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5731, Pos_dist: 5.4417, Neg_dist: 6.6391, Acc: 0.5000, PTFixPNLoss: 3.1304, NetFixLoss: 0.5681, ]
2022-10-31 22:56:17,848 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3950, Pos_dist: 5.3831, Neg_dist: 7.0422, Acc: 0.6200, PTFixPNLoss: 3.1312, NetFixLoss: 1.2849, ]
2022-10-31 22:56:18,746 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2995, Pos_dist: 5.4044, Neg_dist: 7.0479, Acc: 0.5800, PTFixPNLoss: 3.1304, NetFixLoss: 2.1572, ]
2022-10-31 22:56:19,838 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3938, Pos_dist: 5.2200, Neg_dist: 6.5262, Acc: 0.6800, PTFixPNLoss: 3.1207, NetFixLoss: 3.1448, ]
2022-10-31 22:56:20,980 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3441, Pos_dist: 5.4010, Neg_dist: 6.9222, Acc: 0.5800, PTFixPNLoss: 3.1419, NetFixLoss: 4.2771, ]
2022-10-31 22:56:22,039 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2795, Pos_dist: 5.5547, Neg_dist: 7.2714, Acc: 0.5000, PTFixPNLoss: 3.1402, NetFixLoss: 5.5407, ]
2022-10-31 22:56:23,133 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3000, Pos_dist: 5.3971, Neg_dist: 7.1033, Acc: 0.5600, PTFixPNLoss: 3.1339, NetFixLoss: 6.9140, ]
2022-10-31 22:56:24,117 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.5038, Pos_dist: 5.4609, Neg_dist: 7.0367, Acc: 0.5200, PTFixPNLoss: 3.1420, NetFixLoss: 8.2783, ]
2022-10-31 22:56:24,703 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3951, Pos_dist: 5.2509, Neg_dist: 6.4674, Acc: 0.7200, PTFixPNLoss: 3.1264, NetFixLoss: 9.6749, ]
2022-10-31 22:56:25,708 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5358, Pos_dist: 5.3884, Neg_dist: 6.5295, Acc: 0.5400, PTFixPNLoss: 3.1248, NetFixLoss: 11.0786, ]
2022-10-31 22:56:26,768 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2934, Pos_dist: 5.4391, Neg_dist: 7.2154, Acc: 0.5800, PTFixPNLoss: 3.1367, NetFixLoss: 12.4930, ]
2022-10-31 22:56:27,902 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4167, Pos_dist: 5.4597, Neg_dist: 6.7551, Acc: 0.5800, PTFixPNLoss: 3.1283, NetFixLoss: 13.9054, ]
2022-10-31 22:56:28,971 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.1004, Pos_dist: 5.3444, Neg_dist: 7.9905, Acc: 0.6400, PTFixPNLoss: 3.1253, NetFixLoss: 15.3235, ]
2022-10-31 22:56:30,013 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4355, Pos_dist: 5.2812, Neg_dist: 6.7348, Acc: 0.6200, PTFixPNLoss: 3.1311, NetFixLoss: 16.7224, ]
2022-10-31 22:56:30,091 INFO: fine-tune procedure is finished!
2022-10-31 22:56:47,795 INFO: [Test_acc of task 1 on test 3: 0.46833][acc of former classes: 0.67250][acc of former samples in all classes: 0.63100]
[acc of novel samples in all classes: 0.14300]
2022-10-31 22:56:48,074 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:56:48,099 WARNING: Current net - loaded net:
2022-10-31 22:56:48,099 WARNING: Loaded net - current net:
2022-10-31 22:56:48,099 WARNING:   func.classifier.bias
2022-10-31 22:56:48,099 WARNING:   func.classifier.weight
2022-10-31 22:56:48,109 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_1.pth.
2022-10-31 22:56:48,146 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:56:48,163 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:56:48,164 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:56:48,164 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:56:48,164 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:56:48,164 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:56:48,164 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:56:48,164 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:56:48,164 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:56:48,165 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:56:48,166 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:56:48,166 INFO: Model [FSLLModel] is created.
2022-10-31 22:56:48,177 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:56:48,187 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 22:56:49,654 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4022, Pos_dist: 5.4235, Neg_dist: 7.0971, Acc: 0.6000, PTFixPNLoss: 3.4184, NetFixLoss: 0.0000, ]
2022-10-31 22:56:51,231 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.1948, Pos_dist: 5.3437, Neg_dist: 7.4748, Acc: 0.5500, PTFixPNLoss: 3.4090, NetFixLoss: 0.6763, ]
2022-10-31 22:56:52,805 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2076, Pos_dist: 5.2575, Neg_dist: 7.6878, Acc: 0.6600, PTFixPNLoss: 3.4137, NetFixLoss: 1.3953, ]
2022-10-31 22:56:54,338 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2388, Pos_dist: 5.4221, Neg_dist: 7.8650, Acc: 0.5200, PTFixPNLoss: 3.4324, NetFixLoss: 2.2559, ]
2022-10-31 22:56:55,972 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3644, Pos_dist: 5.3314, Neg_dist: 6.8847, Acc: 0.6300, PTFixPNLoss: 3.4248, NetFixLoss: 3.1627, ]
2022-10-31 22:56:56,710 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2923, Pos_dist: 5.2795, Neg_dist: 6.9883, Acc: 0.6700, PTFixPNLoss: 3.4175, NetFixLoss: 4.1414, ]
2022-10-31 22:56:58,294 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1952, Pos_dist: 5.4876, Neg_dist: 7.8741, Acc: 0.5500, PTFixPNLoss: 3.4261, NetFixLoss: 5.1878, ]
2022-10-31 22:56:59,817 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3644, Pos_dist: 5.4160, Neg_dist: 6.9358, Acc: 0.6000, PTFixPNLoss: 3.4226, NetFixLoss: 6.2260, ]
2022-10-31 22:57:01,699 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3302, Pos_dist: 5.3413, Neg_dist: 7.1620, Acc: 0.6000, PTFixPNLoss: 3.4186, NetFixLoss: 7.3321, ]
2022-10-31 22:57:03,494 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4443, Pos_dist: 5.4347, Neg_dist: 6.6882, Acc: 0.5600, PTFixPNLoss: 3.4371, NetFixLoss: 8.4615, ]
2022-10-31 22:57:04,619 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2889, Pos_dist: 5.3273, Neg_dist: 7.2001, Acc: 0.5400, PTFixPNLoss: 3.4193, NetFixLoss: 9.6451, ]
2022-10-31 22:57:06,194 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4587, Pos_dist: 5.3076, Neg_dist: 6.6015, Acc: 0.6300, PTFixPNLoss: 3.4229, NetFixLoss: 10.8371, ]
2022-10-31 22:57:07,794 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3798, Pos_dist: 5.3451, Neg_dist: 6.9763, Acc: 0.6200, PTFixPNLoss: 3.4143, NetFixLoss: 12.0614, ]
2022-10-31 22:57:09,358 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3706, Pos_dist: 5.4027, Neg_dist: 6.8195, Acc: 0.5500, PTFixPNLoss: 3.4245, NetFixLoss: 13.3051, ]
2022-10-31 22:57:11,022 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3983, Pos_dist: 5.2906, Neg_dist: 6.6550, Acc: 0.6300, PTFixPNLoss: 3.4251, NetFixLoss: 14.5191, ]
2022-10-31 22:57:11,113 INFO: fine-tune procedure is finished!
2022-10-31 22:57:34,195 INFO: [Test_acc of task 2 on test 3: 0.38675][acc of former classes: 0.68350][acc of former samples in all classes: 0.61500]
[acc of novel samples in all classes: 0.15850]
2022-10-31 22:57:34,498 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:57:34,523 WARNING: Current net - loaded net:
2022-10-31 22:57:34,523 WARNING: Loaded net - current net:
2022-10-31 22:57:34,523 WARNING:   func.classifier.bias
2022-10-31 22:57:34,523 WARNING:   func.classifier.weight
2022-10-31 22:57:34,560 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_2.pth.
2022-10-31 22:57:34,623 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:57:34,653 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:57:34,653 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:57:34,653 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:57:34,653 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:57:34,653 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:57:34,653 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:57:34,654 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:57:34,654 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:57:34,655 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:57:34,656 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:57:34,656 INFO: Model [FSLLModel] is created.
2022-10-31 22:57:34,666 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:57:34,677 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:57:34,687 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 22:57:36,745 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3374, Pos_dist: 5.3059, Neg_dist: 6.8546, Acc: 0.5133, PTFixPNLoss: 3.6571, NetFixLoss: 0.0000, ]
2022-10-31 22:57:39,010 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4461, Pos_dist: 5.4213, Neg_dist: 6.8569, Acc: 0.5200, PTFixPNLoss: 3.6588, NetFixLoss: 0.5297, ]
2022-10-31 22:57:41,127 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2381, Pos_dist: 5.4027, Neg_dist: 7.4469, Acc: 0.5533, PTFixPNLoss: 3.6515, NetFixLoss: 1.2413, ]
2022-10-31 22:57:43,389 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4744, Pos_dist: 5.4863, Neg_dist: 6.8774, Acc: 0.4733, PTFixPNLoss: 3.6630, NetFixLoss: 2.0832, ]
2022-10-31 22:57:45,536 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4374, Pos_dist: 5.3937, Neg_dist: 6.7962, Acc: 0.5600, PTFixPNLoss: 3.6541, NetFixLoss: 3.0546, ]
2022-10-31 22:57:47,495 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2851, Pos_dist: 5.4004, Neg_dist: 7.4137, Acc: 0.5533, PTFixPNLoss: 3.6541, NetFixLoss: 4.1292, ]
2022-10-31 22:57:49,579 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1217, Pos_dist: 5.3566, Neg_dist: 8.2347, Acc: 0.5467, PTFixPNLoss: 3.6523, NetFixLoss: 5.2317, ]
2022-10-31 22:57:51,544 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3915, Pos_dist: 5.3215, Neg_dist: 6.9409, Acc: 0.6067, PTFixPNLoss: 3.6521, NetFixLoss: 6.3254, ]
2022-10-31 22:57:53,549 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4579, Pos_dist: 5.4359, Neg_dist: 6.8466, Acc: 0.5667, PTFixPNLoss: 3.6638, NetFixLoss: 7.3969, ]
2022-10-31 22:57:55,508 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2683, Pos_dist: 5.3694, Neg_dist: 7.3769, Acc: 0.5000, PTFixPNLoss: 3.6545, NetFixLoss: 8.5420, ]
2022-10-31 22:57:57,504 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4537, Pos_dist: 5.4095, Neg_dist: 6.8513, Acc: 0.5400, PTFixPNLoss: 3.6593, NetFixLoss: 9.6906, ]
2022-10-31 22:57:59,637 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.1664, Pos_dist: 5.3621, Neg_dist: 8.0067, Acc: 0.5533, PTFixPNLoss: 3.6555, NetFixLoss: 10.8745, ]
2022-10-31 22:58:01,624 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3994, Pos_dist: 5.3152, Neg_dist: 6.7926, Acc: 0.5267, PTFixPNLoss: 3.6518, NetFixLoss: 12.0255, ]
2022-10-31 22:58:03,685 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2731, Pos_dist: 5.4528, Neg_dist: 7.1991, Acc: 0.5267, PTFixPNLoss: 3.6651, NetFixLoss: 13.1644, ]
2022-10-31 22:58:05,724 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3879, Pos_dist: 5.3357, Neg_dist: 7.0473, Acc: 0.5133, PTFixPNLoss: 3.6580, NetFixLoss: 14.2722, ]
2022-10-31 22:58:05,801 INFO: fine-tune procedure is finished!
2022-10-31 22:58:34,062 INFO: [Test_acc of task 3 on test 3: 0.31500][acc of former classes: 0.68850][acc of former samples in all classes: 0.59500]
[acc of novel samples in all classes: 0.12833]
2022-10-31 22:58:34,360 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:58:34,386 WARNING: Current net - loaded net:
2022-10-31 22:58:34,387 WARNING: Loaded net - current net:
2022-10-31 22:58:34,387 WARNING:   func.classifier.bias
2022-10-31 22:58:34,387 WARNING:   func.classifier.weight
2022-10-31 22:58:34,424 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_3.pth.
2022-10-31 22:58:34,486 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:58:34,518 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:58:34,518 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:58:34,518 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:58:34,518 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:58:34,518 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:58:34,518 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:58:34,519 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:58:34,519 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:58:34,520 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:58:34,521 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:58:34,521 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:58:34,521 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:58:34,521 INFO: Model [FSLLModel] is created.
2022-10-31 22:58:34,532 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:58:34,542 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:58:34,552 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:58:34,562 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 22:58:37,155 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.7218, Pos_dist: 5.4453, Neg_dist: 6.2233, Acc: 0.4900, PTFixPNLoss: 3.8629, NetFixLoss: 0.0000, ]
2022-10-31 22:58:39,822 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2824, Pos_dist: 5.3568, Neg_dist: 7.2539, Acc: 0.5300, PTFixPNLoss: 3.8441, NetFixLoss: 0.6264, ]
2022-10-31 22:58:42,648 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4950, Pos_dist: 5.4075, Neg_dist: 6.5797, Acc: 0.4750, PTFixPNLoss: 3.8526, NetFixLoss: 1.3675, ]
2022-10-31 22:58:45,309 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4155, Pos_dist: 5.4599, Neg_dist: 6.9330, Acc: 0.4950, PTFixPNLoss: 3.8504, NetFixLoss: 2.2280, ]
2022-10-31 22:58:47,968 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.7384, Pos_dist: 5.5054, Neg_dist: 6.2448, Acc: 0.4900, PTFixPNLoss: 3.8534, NetFixLoss: 3.1857, ]
2022-10-31 22:58:49,129 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4652, Pos_dist: 5.4003, Neg_dist: 6.5960, Acc: 0.4900, PTFixPNLoss: 3.8516, NetFixLoss: 4.2450, ]
2022-10-31 22:58:51,804 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4604, Pos_dist: 5.4364, Neg_dist: 6.7218, Acc: 0.4850, PTFixPNLoss: 3.8557, NetFixLoss: 5.3902, ]
2022-10-31 22:58:54,667 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4136, Pos_dist: 5.3276, Neg_dist: 7.0993, Acc: 0.5300, PTFixPNLoss: 3.8500, NetFixLoss: 6.5740, ]
2022-10-31 22:58:57,322 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3285, Pos_dist: 5.3829, Neg_dist: 7.2168, Acc: 0.5250, PTFixPNLoss: 3.8473, NetFixLoss: 7.7507, ]
2022-10-31 22:58:59,365 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3491, Pos_dist: 5.3747, Neg_dist: 7.1670, Acc: 0.5200, PTFixPNLoss: 3.8458, NetFixLoss: 8.9211, ]
2022-10-31 22:59:02,056 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5043, Pos_dist: 5.4521, Neg_dist: 6.7170, Acc: 0.5050, PTFixPNLoss: 3.8567, NetFixLoss: 10.0798, ]
2022-10-31 22:59:04,643 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5749, Pos_dist: 5.4237, Neg_dist: 6.5231, Acc: 0.4900, PTFixPNLoss: 3.8460, NetFixLoss: 11.2235, ]
2022-10-31 22:59:07,268 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.5012, Pos_dist: 5.4110, Neg_dist: 6.6217, Acc: 0.4750, PTFixPNLoss: 3.8492, NetFixLoss: 12.4246, ]
2022-10-31 22:59:09,919 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4110, Pos_dist: 5.3315, Neg_dist: 6.6495, Acc: 0.4850, PTFixPNLoss: 3.8477, NetFixLoss: 13.6311, ]
2022-10-31 22:59:11,207 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.7465, Pos_dist: 5.4819, Neg_dist: 6.2940, Acc: 0.4550, PTFixPNLoss: 3.8531, NetFixLoss: 14.8333, ]
2022-10-31 22:59:11,298 INFO: fine-tune procedure is finished!
2022-10-31 22:59:44,834 INFO: [Test_acc of task 4 on test 3: 0.26950][acc of former classes: 0.69050][acc of former samples in all classes: 0.59000]
[acc of novel samples in all classes: 0.10925]
2022-10-31 22:59:45,139 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 22:59:45,164 WARNING: Current net - loaded net:
2022-10-31 22:59:45,164 WARNING: Loaded net - current net:
2022-10-31 22:59:45,164 WARNING:   func.classifier.bias
2022-10-31 22:59:45,164 WARNING:   func.classifier.weight
2022-10-31 22:59:45,201 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_4.pth.
2022-10-31 22:59:45,265 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 22:59:45,297 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 22:59:45,297 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 22:59:45,297 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 22:59:45,297 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 22:59:45,297 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 22:59:45,297 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 22:59:45,298 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 22:59:45,298 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 22:59:45,299 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 22:59:45,300 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 22:59:45,300 INFO: Model [FSLLModel] is created.
2022-10-31 22:59:45,310 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:59:45,320 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:59:45,331 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:59:45,341 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 22:59:45,351 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 22:59:47,915 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3065, Pos_dist: 5.5606, Neg_dist: 7.5046, Acc: 0.4440, PTFixPNLoss: 4.0212, NetFixLoss: 0.0000, ]
2022-10-31 22:59:51,050 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.3791, Pos_dist: 5.5352, Neg_dist: 7.5165, Acc: 0.4120, PTFixPNLoss: 4.0190, NetFixLoss: 0.5207, ]
2022-10-31 22:59:54,227 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2981, Pos_dist: 5.5254, Neg_dist: 7.4829, Acc: 0.4280, PTFixPNLoss: 4.0277, NetFixLoss: 1.1486, ]
2022-10-31 22:59:57,435 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3511, Pos_dist: 5.4651, Neg_dist: 7.1831, Acc: 0.5000, PTFixPNLoss: 4.0118, NetFixLoss: 1.9264, ]
2022-10-31 22:59:59,511 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.5538, Pos_dist: 5.4558, Neg_dist: 6.6675, Acc: 0.4840, PTFixPNLoss: 4.0170, NetFixLoss: 2.8052, ]
2022-10-31 23:00:02,803 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4334, Pos_dist: 5.4261, Neg_dist: 7.3349, Acc: 0.4880, PTFixPNLoss: 4.0064, NetFixLoss: 3.7851, ]
2022-10-31 23:00:06,120 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4716, Pos_dist: 5.4880, Neg_dist: 6.8991, Acc: 0.4360, PTFixPNLoss: 4.0134, NetFixLoss: 4.8216, ]
2022-10-31 23:00:09,399 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4255, Pos_dist: 5.4648, Neg_dist: 6.8736, Acc: 0.4600, PTFixPNLoss: 4.0135, NetFixLoss: 5.9025, ]
2022-10-31 23:00:12,327 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3621, Pos_dist: 5.4209, Neg_dist: 7.1051, Acc: 0.4760, PTFixPNLoss: 4.0121, NetFixLoss: 7.0242, ]
2022-10-31 23:00:15,681 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3493, Pos_dist: 5.5040, Neg_dist: 7.1799, Acc: 0.4040, PTFixPNLoss: 4.0178, NetFixLoss: 8.1716, ]
2022-10-31 23:00:18,878 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4472, Pos_dist: 5.5022, Neg_dist: 6.8652, Acc: 0.4480, PTFixPNLoss: 4.0172, NetFixLoss: 9.2965, ]
2022-10-31 23:00:22,069 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3710, Pos_dist: 5.5098, Neg_dist: 7.0416, Acc: 0.4440, PTFixPNLoss: 4.0143, NetFixLoss: 10.4467, ]
2022-10-31 23:00:24,564 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4334, Pos_dist: 5.4349, Neg_dist: 7.2954, Acc: 0.4640, PTFixPNLoss: 4.0132, NetFixLoss: 11.6519, ]
2022-10-31 23:00:27,944 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3656, Pos_dist: 5.4497, Neg_dist: 7.2130, Acc: 0.4440, PTFixPNLoss: 4.0151, NetFixLoss: 12.8535, ]
2022-10-31 23:00:31,262 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3934, Pos_dist: 5.4825, Neg_dist: 6.9293, Acc: 0.4200, PTFixPNLoss: 4.0198, NetFixLoss: 14.0501, ]
2022-10-31 23:00:31,346 INFO: fine-tune procedure is finished!
2022-10-31 23:01:09,998 INFO: [Test_acc of task 5 on test 3: 0.22843][acc of former classes: 0.69150][acc of former samples in all classes: 0.58150]
[acc of novel samples in all classes: 0.08720]
2022-10-31 23:01:10,300 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:01:10,326 WARNING: Current net - loaded net:
2022-10-31 23:01:10,326 WARNING: Loaded net - current net:
2022-10-31 23:01:10,327 WARNING:   func.classifier.bias
2022-10-31 23:01:10,327 WARNING:   func.classifier.weight
2022-10-31 23:01:10,362 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_5.pth.
2022-10-31 23:01:10,425 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:01:10,457 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:01:10,457 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:01:10,457 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:01:10,457 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:01:10,457 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:01:10,457 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:01:10,457 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:01:10,457 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:01:10,458 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:01:10,459 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:01:10,459 INFO: Model [FSLLModel] is created.
2022-10-31 23:01:10,470 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:01:10,480 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:01:10,490 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:01:10,500 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:01:10,510 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:01:10,521 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 23:01:12,538 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4430, Pos_dist: 5.4362, Neg_dist: 6.8345, Acc: 0.4633, PTFixPNLoss: 4.1399, NetFixLoss: 0.0000, ]
2022-10-31 23:01:16,516 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4274, Pos_dist: 5.4297, Neg_dist: 6.8382, Acc: 0.4800, PTFixPNLoss: 4.1532, NetFixLoss: 0.5400, ]
2022-10-31 23:01:20,297 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2279, Pos_dist: 5.4316, Neg_dist: 7.6161, Acc: 0.4567, PTFixPNLoss: 4.1444, NetFixLoss: 1.2852, ]
2022-10-31 23:01:23,892 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3717, Pos_dist: 5.4829, Neg_dist: 7.0877, Acc: 0.4467, PTFixPNLoss: 4.1488, NetFixLoss: 2.1065, ]
2022-10-31 23:01:27,786 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2937, Pos_dist: 5.4605, Neg_dist: 7.3801, Acc: 0.4433, PTFixPNLoss: 4.1443, NetFixLoss: 3.0065, ]
2022-10-31 23:01:31,571 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3028, Pos_dist: 5.4808, Neg_dist: 7.4302, Acc: 0.4333, PTFixPNLoss: 4.1488, NetFixLoss: 3.9775, ]
2022-10-31 23:01:35,336 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.5393, Pos_dist: 5.4447, Neg_dist: 6.6425, Acc: 0.4367, PTFixPNLoss: 4.1508, NetFixLoss: 5.0079, ]
2022-10-31 23:01:36,821 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4366, Pos_dist: 5.4386, Neg_dist: 6.9336, Acc: 0.5033, PTFixPNLoss: 4.1446, NetFixLoss: 6.0714, ]
2022-10-31 23:01:40,612 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.6811, Pos_dist: 5.4681, Neg_dist: 6.3722, Acc: 0.4433, PTFixPNLoss: 4.1476, NetFixLoss: 7.1893, ]
2022-10-31 23:01:44,301 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4000, Pos_dist: 5.4490, Neg_dist: 7.0174, Acc: 0.4867, PTFixPNLoss: 4.1503, NetFixLoss: 8.3323, ]
2022-10-31 23:01:48,228 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.6447, Pos_dist: 5.4064, Neg_dist: 6.2771, Acc: 0.4867, PTFixPNLoss: 4.1375, NetFixLoss: 9.4898, ]
2022-10-31 23:01:52,180 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3395, Pos_dist: 5.4624, Neg_dist: 7.6506, Acc: 0.4600, PTFixPNLoss: 4.1461, NetFixLoss: 10.6462, ]
2022-10-31 23:01:55,952 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.5190, Pos_dist: 5.4513, Neg_dist: 6.5669, Acc: 0.4533, PTFixPNLoss: 4.1465, NetFixLoss: 11.7852, ]
2022-10-31 23:01:59,791 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.5087, Pos_dist: 5.3595, Neg_dist: 6.5635, Acc: 0.4800, PTFixPNLoss: 4.1395, NetFixLoss: 12.9362, ]
2022-10-31 23:02:03,757 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3783, Pos_dist: 5.4366, Neg_dist: 6.9957, Acc: 0.4633, PTFixPNLoss: 4.1484, NetFixLoss: 14.1094, ]
2022-10-31 23:02:03,849 INFO: fine-tune procedure is finished!
2022-10-31 23:02:47,569 INFO: [Test_acc of task 6 on test 3: 0.20800][acc of former classes: 0.69450][acc of former samples in all classes: 0.57250]
[acc of novel samples in all classes: 0.08650]
2022-10-31 23:02:47,848 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:02:47,874 WARNING: Current net - loaded net:
2022-10-31 23:02:47,874 WARNING: Loaded net - current net:
2022-10-31 23:02:47,874 WARNING:   func.classifier.bias
2022-10-31 23:02:47,874 WARNING:   func.classifier.weight
2022-10-31 23:02:47,884 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_6.pth.
2022-10-31 23:02:47,922 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:02:47,938 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:02:47,938 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:02:47,938 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:02:47,938 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:02:47,938 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:02:47,938 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:02:47,938 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:02:47,938 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:02:47,939 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:02:47,940 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:02:47,940 INFO: Model [FSLLModel] is created.
2022-10-31 23:02:47,951 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:02:47,961 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:02:47,972 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:02:47,982 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:02:47,992 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:02:48,002 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:02:48,012 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 23:02:51,723 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2309, Pos_dist: 5.4176, Neg_dist: 7.7765, Acc: 0.4114, PTFixPNLoss: 4.2650, NetFixLoss: 0.0000, ]
2022-10-31 23:02:54,333 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4383, Pos_dist: 5.4471, Neg_dist: 7.5060, Acc: 0.4200, PTFixPNLoss: 4.2724, NetFixLoss: 0.3865, ]
2022-10-31 23:02:56,775 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4561, Pos_dist: 5.4795, Neg_dist: 6.8754, Acc: 0.4314, PTFixPNLoss: 4.2678, NetFixLoss: 0.9144, ]
2022-10-31 23:03:00,877 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2065, Pos_dist: 5.4397, Neg_dist: 7.7936, Acc: 0.4314, PTFixPNLoss: 4.2732, NetFixLoss: 1.6099, ]
2022-10-31 23:03:05,259 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4872, Pos_dist: 5.4315, Neg_dist: 7.0623, Acc: 0.4200, PTFixPNLoss: 4.2658, NetFixLoss: 2.3799, ]
2022-10-31 23:03:09,583 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5649, Pos_dist: 5.3972, Neg_dist: 6.6163, Acc: 0.4943, PTFixPNLoss: 4.2638, NetFixLoss: 3.2480, ]
2022-10-31 23:03:12,783 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3406, Pos_dist: 5.3982, Neg_dist: 6.9681, Acc: 0.4486, PTFixPNLoss: 4.2623, NetFixLoss: 4.1921, ]
2022-10-31 23:03:15,083 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.4149, Pos_dist: 5.3332, Neg_dist: 6.8986, Acc: 0.4686, PTFixPNLoss: 4.2574, NetFixLoss: 5.1784, ]
2022-10-31 23:03:18,236 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2825, Pos_dist: 5.4415, Neg_dist: 7.2477, Acc: 0.4314, PTFixPNLoss: 4.2725, NetFixLoss: 6.2082, ]
2022-10-31 23:03:22,613 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3556, Pos_dist: 5.4496, Neg_dist: 7.0703, Acc: 0.4143, PTFixPNLoss: 4.2655, NetFixLoss: 7.2599, ]
2022-10-31 23:03:26,973 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4901, Pos_dist: 5.4157, Neg_dist: 6.8624, Acc: 0.4571, PTFixPNLoss: 4.2634, NetFixLoss: 8.3231, ]
2022-10-31 23:03:31,334 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4987, Pos_dist: 5.4595, Neg_dist: 6.7853, Acc: 0.4457, PTFixPNLoss: 4.2693, NetFixLoss: 9.4039, ]
2022-10-31 23:03:34,625 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3361, Pos_dist: 5.4155, Neg_dist: 7.1649, Acc: 0.4543, PTFixPNLoss: 4.2625, NetFixLoss: 10.4896, ]
2022-10-31 23:03:37,063 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4590, Pos_dist: 5.4313, Neg_dist: 6.8486, Acc: 0.4114, PTFixPNLoss: 4.2672, NetFixLoss: 11.5909, ]
2022-10-31 23:03:39,336 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4721, Pos_dist: 5.4222, Neg_dist: 6.8828, Acc: 0.4657, PTFixPNLoss: 4.2661, NetFixLoss: 12.7005, ]
2022-10-31 23:03:39,424 INFO: fine-tune procedure is finished!
2022-10-31 23:04:28,253 INFO: [Test_acc of task 7 on test 3: 0.18544][acc of former classes: 0.69000][acc of former samples in all classes: 0.56400]
[acc of novel samples in all classes: 0.07729]
2022-10-31 23:04:28,557 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:04:28,582 WARNING: Current net - loaded net:
2022-10-31 23:04:28,582 WARNING: Loaded net - current net:
2022-10-31 23:04:28,582 WARNING:   func.classifier.bias
2022-10-31 23:04:28,582 WARNING:   func.classifier.weight
2022-10-31 23:04:28,618 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_7.pth.
2022-10-31 23:04:28,683 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:04:28,714 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:04:28,714 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:04:28,714 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:04:28,714 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:04:28,714 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:04:28,714 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:04:28,715 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:04:28,715 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:04:28,716 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:04:28,717 INFO: Model [FSLLModel] is created.
2022-10-31 23:04:28,727 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:04:28,738 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:04:28,748 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:04:28,758 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:04:28,768 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:04:28,778 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:04:28,788 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:04:28,798 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 23:04:32,372 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4175, Pos_dist: 5.4226, Neg_dist: 6.8659, Acc: 0.4200, PTFixPNLoss: 4.3704, NetFixLoss: 0.0000, ]
2022-10-31 23:04:35,496 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2137, Pos_dist: 5.4339, Neg_dist: 7.5239, Acc: 0.4350, PTFixPNLoss: 4.3753, NetFixLoss: 0.5477, ]
2022-10-31 23:04:40,363 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5036, Pos_dist: 5.4421, Neg_dist: 6.7633, Acc: 0.4300, PTFixPNLoss: 4.3782, NetFixLoss: 1.2067, ]
2022-10-31 23:04:45,318 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2655, Pos_dist: 5.3963, Neg_dist: 7.3690, Acc: 0.4450, PTFixPNLoss: 4.3734, NetFixLoss: 1.9833, ]
2022-10-31 23:04:49,173 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4888, Pos_dist: 5.4369, Neg_dist: 6.6088, Acc: 0.4075, PTFixPNLoss: 4.3767, NetFixLoss: 2.8371, ]
2022-10-31 23:04:51,968 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4245, Pos_dist: 5.4119, Neg_dist: 6.9383, Acc: 0.4000, PTFixPNLoss: 4.3758, NetFixLoss: 3.8075, ]
2022-10-31 23:04:56,824 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.1832, Pos_dist: 5.3973, Neg_dist: 7.6001, Acc: 0.4425, PTFixPNLoss: 4.3729, NetFixLoss: 4.8616, ]
2022-10-31 23:05:01,731 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.6032, Pos_dist: 5.4689, Neg_dist: 6.7762, Acc: 0.4050, PTFixPNLoss: 4.3788, NetFixLoss: 5.9067, ]
2022-10-31 23:05:05,940 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2353, Pos_dist: 5.4498, Neg_dist: 7.6604, Acc: 0.4175, PTFixPNLoss: 4.3687, NetFixLoss: 6.9743, ]
2022-10-31 23:05:08,932 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.7516, Pos_dist: 5.5134, Neg_dist: 6.2162, Acc: 0.4250, PTFixPNLoss: 4.3794, NetFixLoss: 8.0437, ]
2022-10-31 23:05:12,358 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2226, Pos_dist: 5.4511, Neg_dist: 7.5350, Acc: 0.4300, PTFixPNLoss: 4.3751, NetFixLoss: 9.1231, ]
2022-10-31 23:05:17,285 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5405, Pos_dist: 5.4685, Neg_dist: 6.7816, Acc: 0.4150, PTFixPNLoss: 4.3740, NetFixLoss: 10.2091, ]
2022-10-31 23:05:22,256 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.6271, Pos_dist: 5.4166, Neg_dist: 6.3081, Acc: 0.4000, PTFixPNLoss: 4.3754, NetFixLoss: 11.3003, ]
2022-10-31 23:05:26,397 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4768, Pos_dist: 5.4331, Neg_dist: 6.8268, Acc: 0.4300, PTFixPNLoss: 4.3771, NetFixLoss: 12.4015, ]
2022-10-31 23:05:29,195 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3763, Pos_dist: 5.4228, Neg_dist: 6.9638, Acc: 0.4475, PTFixPNLoss: 4.3776, NetFixLoss: 13.5107, ]
2022-10-31 23:05:29,278 INFO: fine-tune procedure is finished!
2022-10-31 23:06:23,519 INFO: [Test_acc of task 8 on test 3: 0.17310][acc of former classes: 0.68900][acc of former samples in all classes: 0.55850]
[acc of novel samples in all classes: 0.07675]
2022-10-31 23:06:23,823 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:06:23,849 WARNING: Current net - loaded net:
2022-10-31 23:06:23,849 WARNING: Loaded net - current net:
2022-10-31 23:06:23,849 WARNING:   func.classifier.bias
2022-10-31 23:06:23,849 WARNING:   func.classifier.weight
2022-10-31 23:06:23,886 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth.
2022-10-31 23:06:23,948 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:06:23,979 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:06:23,979 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:06:23,979 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:06:23,980 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:06:23,980 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:06:23,980 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:06:23,980 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:06:23,980 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:06:23,981 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:06:23,982 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:06:23,982 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:06:23,982 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:06:23,982 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:06:23,982 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:06:23,982 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:06:23,982 INFO: Model [FSLLModel] is created.
2022-10-31 23:06:23,993 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test3_session_8.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test0_session_0.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2022-10-31 23:06:24,895 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3522, Pos_dist: 5.5315, Neg_dist: 7.3673, Acc: 0.5400, PTFixPNLoss: 3.1353, NetFixLoss: 0.0000, ]
2022-10-31 23:06:25,507 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4000, Pos_dist: 5.6344, Neg_dist: 7.3459, Acc: 0.5200, PTFixPNLoss: 3.1324, NetFixLoss: 0.6134, ]
2022-10-31 23:06:26,492 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4213, Pos_dist: 5.5417, Neg_dist: 7.0284, Acc: 0.6000, PTFixPNLoss: 3.1509, NetFixLoss: 1.4190, ]
2022-10-31 23:06:27,602 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4076, Pos_dist: 5.5736, Neg_dist: 7.4457, Acc: 0.5600, PTFixPNLoss: 3.1307, NetFixLoss: 2.3860, ]
2022-10-31 23:06:28,756 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.5302, Pos_dist: 5.4770, Neg_dist: 6.8466, Acc: 0.5400, PTFixPNLoss: 3.1395, NetFixLoss: 3.4515, ]
2022-10-31 23:06:29,674 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2976, Pos_dist: 5.5409, Neg_dist: 7.3121, Acc: 0.5200, PTFixPNLoss: 3.1334, NetFixLoss: 4.5875, ]
2022-10-31 23:06:30,656 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4462, Pos_dist: 5.4242, Neg_dist: 6.8954, Acc: 0.6600, PTFixPNLoss: 3.1241, NetFixLoss: 5.7781, ]
2022-10-31 23:06:31,656 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3178, Pos_dist: 5.4158, Neg_dist: 6.8878, Acc: 0.5000, PTFixPNLoss: 3.1497, NetFixLoss: 7.0332, ]
2022-10-31 23:06:32,652 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.5668, Pos_dist: 5.4283, Neg_dist: 6.7789, Acc: 0.6000, PTFixPNLoss: 3.1240, NetFixLoss: 8.3208, ]
2022-10-31 23:06:33,611 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3663, Pos_dist: 5.4197, Neg_dist: 7.2024, Acc: 0.5400, PTFixPNLoss: 3.1393, NetFixLoss: 9.6579, ]
2022-10-31 23:06:34,617 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5166, Pos_dist: 5.5016, Neg_dist: 7.1000, Acc: 0.5200, PTFixPNLoss: 3.1505, NetFixLoss: 10.9860, ]
2022-10-31 23:06:35,602 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3284, Pos_dist: 5.4381, Neg_dist: 7.0670, Acc: 0.6200, PTFixPNLoss: 3.1365, NetFixLoss: 12.3286, ]
2022-10-31 23:06:36,253 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2468, Pos_dist: 5.4047, Neg_dist: 7.4452, Acc: 0.5000, PTFixPNLoss: 3.1303, NetFixLoss: 13.6636, ]
2022-10-31 23:06:37,355 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.2839, Pos_dist: 5.4215, Neg_dist: 7.2572, Acc: 0.5000, PTFixPNLoss: 3.1423, NetFixLoss: 15.0034, ]
2022-10-31 23:06:38,448 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3610, Pos_dist: 5.5223, Neg_dist: 7.2780, Acc: 0.6000, PTFixPNLoss: 3.1369, NetFixLoss: 16.3563, ]
2022-10-31 23:06:38,532 INFO: fine-tune procedure is finished!
2022-10-31 23:06:56,106 INFO: [Test_acc of task 1 on test 4: 0.47200][acc of former classes: 0.68000][acc of former samples in all classes: 0.64250]
[acc of novel samples in all classes: 0.13100]
2022-10-31 23:06:56,411 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:06:56,437 WARNING: Current net - loaded net:
2022-10-31 23:06:56,437 WARNING: Loaded net - current net:
2022-10-31 23:06:56,437 WARNING:   func.classifier.bias
2022-10-31 23:06:56,437 WARNING:   func.classifier.weight
2022-10-31 23:06:56,473 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_1.pth.
2022-10-31 23:06:56,536 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:06:56,568 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:06:56,568 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:06:56,568 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:06:56,568 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:06:56,568 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:06:56,568 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:06:56,568 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:06:56,568 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:06:56,569 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:06:56,570 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:06:56,570 INFO: Model [FSLLModel] is created.
2022-10-31 23:06:56,581 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:06:56,591 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_1.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_1.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
2022-10-31 23:06:58,004 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4275, Pos_dist: 5.4552, Neg_dist: 6.7856, Acc: 0.5500, PTFixPNLoss: 3.4245, NetFixLoss: 0.0000, ]
2022-10-31 23:06:58,722 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4487, Pos_dist: 5.6192, Neg_dist: 7.2598, Acc: 0.5000, PTFixPNLoss: 3.4380, NetFixLoss: 0.6149, ]
2022-10-31 23:07:00,316 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.5012, Pos_dist: 5.3822, Neg_dist: 6.6874, Acc: 0.5600, PTFixPNLoss: 3.4201, NetFixLoss: 1.3928, ]
2022-10-31 23:07:01,820 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3989, Pos_dist: 5.4882, Neg_dist: 7.3336, Acc: 0.5300, PTFixPNLoss: 3.4363, NetFixLoss: 2.3269, ]
2022-10-31 23:07:02,535 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4134, Pos_dist: 5.3826, Neg_dist: 6.7659, Acc: 0.5900, PTFixPNLoss: 3.4197, NetFixLoss: 3.3291, ]
2022-10-31 23:07:04,085 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.2234, Pos_dist: 5.4963, Neg_dist: 7.8171, Acc: 0.5500, PTFixPNLoss: 3.4357, NetFixLoss: 4.4021, ]
2022-10-31 23:07:05,839 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.5200, Pos_dist: 5.4593, Neg_dist: 6.6746, Acc: 0.5700, PTFixPNLoss: 3.4247, NetFixLoss: 5.4713, ]
2022-10-31 23:07:06,673 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3493, Pos_dist: 5.4865, Neg_dist: 7.4161, Acc: 0.5900, PTFixPNLoss: 3.4261, NetFixLoss: 6.5508, ]
2022-10-31 23:07:08,297 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3237, Pos_dist: 5.4691, Neg_dist: 7.4904, Acc: 0.4900, PTFixPNLoss: 3.4352, NetFixLoss: 7.6396, ]
2022-10-31 23:07:09,835 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3169, Pos_dist: 5.4304, Neg_dist: 7.5633, Acc: 0.5200, PTFixPNLoss: 3.4272, NetFixLoss: 8.7792, ]
2022-10-31 23:07:10,726 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3599, Pos_dist: 5.4409, Neg_dist: 7.2291, Acc: 0.5500, PTFixPNLoss: 3.4274, NetFixLoss: 9.9291, ]
2022-10-31 23:07:12,349 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.4274, Pos_dist: 5.4487, Neg_dist: 6.9095, Acc: 0.5400, PTFixPNLoss: 3.4164, NetFixLoss: 11.0930, ]
2022-10-31 23:07:13,960 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4147, Pos_dist: 5.4847, Neg_dist: 7.0579, Acc: 0.5500, PTFixPNLoss: 3.4275, NetFixLoss: 12.2779, ]
2022-10-31 23:07:14,809 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3342, Pos_dist: 5.4712, Neg_dist: 7.2710, Acc: 0.5400, PTFixPNLoss: 3.4418, NetFixLoss: 13.5069, ]
2022-10-31 23:07:16,345 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2955, Pos_dist: 5.4751, Neg_dist: 7.3287, Acc: 0.5700, PTFixPNLoss: 3.4217, NetFixLoss: 14.7479, ]
2022-10-31 23:07:16,437 INFO: fine-tune procedure is finished!
2022-10-31 23:07:39,090 INFO: [Test_acc of task 2 on test 4: 0.37850][acc of former classes: 0.68750][acc of former samples in all classes: 0.61950]
[acc of novel samples in all classes: 0.13750]
2022-10-31 23:07:39,393 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:07:39,419 WARNING: Current net - loaded net:
2022-10-31 23:07:39,419 WARNING: Loaded net - current net:
2022-10-31 23:07:39,419 WARNING:   func.classifier.bias
2022-10-31 23:07:39,419 WARNING:   func.classifier.weight
2022-10-31 23:07:39,442 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_2.pth.
2022-10-31 23:07:39,507 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:07:39,541 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:07:39,541 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:07:39,541 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:07:39,541 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:07:39,541 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:07:39,541 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:07:39,541 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:07:39,541 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:07:39,542 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:07:39,543 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:07:39,543 INFO: Model [FSLLModel] is created.
2022-10-31 23:07:39,554 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:07:39,564 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:07:39,574 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_2.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_2.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2022-10-31 23:07:41,531 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.6148, Pos_dist: 5.4996, Neg_dist: 6.8280, Acc: 0.4867, PTFixPNLoss: 3.6578, NetFixLoss: 0.0000, ]
2022-10-31 23:07:43,574 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.2958, Pos_dist: 5.4454, Neg_dist: 7.2993, Acc: 0.5200, PTFixPNLoss: 3.6598, NetFixLoss: 0.4871, ]
2022-10-31 23:07:45,703 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3250, Pos_dist: 5.4917, Neg_dist: 7.4241, Acc: 0.4333, PTFixPNLoss: 3.6699, NetFixLoss: 1.1543, ]
2022-10-31 23:07:47,674 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.5422, Pos_dist: 5.5516, Neg_dist: 6.8885, Acc: 0.4800, PTFixPNLoss: 3.6662, NetFixLoss: 1.9171, ]
2022-10-31 23:07:49,684 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4494, Pos_dist: 5.4850, Neg_dist: 6.9952, Acc: 0.5133, PTFixPNLoss: 3.6642, NetFixLoss: 2.7827, ]
2022-10-31 23:07:51,633 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3103, Pos_dist: 5.4030, Neg_dist: 7.6607, Acc: 0.5067, PTFixPNLoss: 3.6673, NetFixLoss: 3.7415, ]
2022-10-31 23:07:53,709 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3181, Pos_dist: 5.3982, Neg_dist: 7.3102, Acc: 0.4867, PTFixPNLoss: 3.6656, NetFixLoss: 4.7727, ]
2022-10-31 23:07:55,614 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.6195, Pos_dist: 5.3938, Neg_dist: 6.3298, Acc: 0.5600, PTFixPNLoss: 3.6647, NetFixLoss: 5.8214, ]
2022-10-31 23:07:57,678 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.2732, Pos_dist: 5.5955, Neg_dist: 8.2167, Acc: 0.4933, PTFixPNLoss: 3.6738, NetFixLoss: 6.9155, ]
2022-10-31 23:07:59,594 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2089, Pos_dist: 5.3640, Neg_dist: 7.9272, Acc: 0.5067, PTFixPNLoss: 3.6667, NetFixLoss: 8.0365, ]
2022-10-31 23:08:01,574 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.4168, Pos_dist: 5.5474, Neg_dist: 7.3172, Acc: 0.4400, PTFixPNLoss: 3.6637, NetFixLoss: 9.1470, ]
2022-10-31 23:08:03,580 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2603, Pos_dist: 5.3843, Neg_dist: 7.4086, Acc: 0.5467, PTFixPNLoss: 3.6509, NetFixLoss: 10.2464, ]
2022-10-31 23:08:05,618 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.5552, Pos_dist: 5.4923, Neg_dist: 6.7670, Acc: 0.5067, PTFixPNLoss: 3.6659, NetFixLoss: 11.3253, ]
2022-10-31 23:08:07,563 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3643, Pos_dist: 5.3834, Neg_dist: 7.0472, Acc: 0.5133, PTFixPNLoss: 3.6616, NetFixLoss: 12.4155, ]
2022-10-31 23:08:08,953 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2851, Pos_dist: 5.4097, Neg_dist: 7.3221, Acc: 0.4933, PTFixPNLoss: 3.6603, NetFixLoss: 13.5006, ]
2022-10-31 23:08:09,031 INFO: fine-tune procedure is finished!
2022-10-31 23:08:37,050 INFO: [Test_acc of task 3 on test 4: 0.30620][acc of former classes: 0.69300][acc of former samples in all classes: 0.60800]
[acc of novel samples in all classes: 0.10500]
2022-10-31 23:08:37,352 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:08:37,379 WARNING: Current net - loaded net:
2022-10-31 23:08:37,380 WARNING: Loaded net - current net:
2022-10-31 23:08:37,380 WARNING:   func.classifier.bias
2022-10-31 23:08:37,380 WARNING:   func.classifier.weight
2022-10-31 23:08:37,416 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_3.pth.
2022-10-31 23:08:37,481 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:08:37,512 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:08:37,512 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:08:37,512 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:08:37,512 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:08:37,512 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:08:37,512 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:08:37,512 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:08:37,512 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:08:37,513 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:08:37,514 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:08:37,514 INFO: Model [FSLLModel] is created.
2022-10-31 23:08:37,525 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:08:37,535 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:08:37,545 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:08:37,555 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_3.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_3.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
2022-10-31 23:08:40,132 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2645, Pos_dist: 5.4636, Neg_dist: 7.4501, Acc: 0.4950, PTFixPNLoss: 3.8507, NetFixLoss: 0.0000, ]
2022-10-31 23:08:42,792 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5158, Pos_dist: 5.4173, Neg_dist: 6.8676, Acc: 0.5200, PTFixPNLoss: 3.8498, NetFixLoss: 0.4623, ]
2022-10-31 23:08:45,471 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.4743, Pos_dist: 5.4216, Neg_dist: 6.6783, Acc: 0.4850, PTFixPNLoss: 3.8505, NetFixLoss: 1.0732, ]
2022-10-31 23:08:47,693 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3943, Pos_dist: 5.4836, Neg_dist: 6.9717, Acc: 0.5500, PTFixPNLoss: 3.8531, NetFixLoss: 1.8476, ]
2022-10-31 23:08:50,358 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4643, Pos_dist: 5.4744, Neg_dist: 6.9584, Acc: 0.4400, PTFixPNLoss: 3.8523, NetFixLoss: 2.7448, ]
2022-10-31 23:08:52,942 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4079, Pos_dist: 5.4188, Neg_dist: 7.1763, Acc: 0.5200, PTFixPNLoss: 3.8450, NetFixLoss: 3.7023, ]
2022-10-31 23:08:54,113 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4650, Pos_dist: 5.4981, Neg_dist: 6.8157, Acc: 0.5050, PTFixPNLoss: 3.8505, NetFixLoss: 4.7136, ]
2022-10-31 23:08:56,924 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.3026, Pos_dist: 5.4829, Neg_dist: 7.5765, Acc: 0.5000, PTFixPNLoss: 3.8540, NetFixLoss: 5.7546, ]
2022-10-31 23:08:59,520 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4094, Pos_dist: 5.4750, Neg_dist: 7.0701, Acc: 0.4900, PTFixPNLoss: 3.8559, NetFixLoss: 6.8298, ]
2022-10-31 23:09:01,319 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.1812, Pos_dist: 5.4445, Neg_dist: 7.5914, Acc: 0.4550, PTFixPNLoss: 3.8546, NetFixLoss: 7.9294, ]
2022-10-31 23:09:03,940 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2970, Pos_dist: 5.4587, Neg_dist: 7.3790, Acc: 0.5250, PTFixPNLoss: 3.8536, NetFixLoss: 9.0007, ]
2022-10-31 23:09:06,563 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.3058, Pos_dist: 5.4895, Neg_dist: 7.6080, Acc: 0.4850, PTFixPNLoss: 3.8586, NetFixLoss: 10.0874, ]
2022-10-31 23:09:08,817 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3009, Pos_dist: 5.4240, Neg_dist: 7.6342, Acc: 0.4850, PTFixPNLoss: 3.8507, NetFixLoss: 11.1761, ]
2022-10-31 23:09:11,501 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3408, Pos_dist: 5.4917, Neg_dist: 7.3973, Acc: 0.4750, PTFixPNLoss: 3.8584, NetFixLoss: 12.2475, ]
2022-10-31 23:09:13,710 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3162, Pos_dist: 5.4321, Neg_dist: 7.1645, Acc: 0.4550, PTFixPNLoss: 3.8493, NetFixLoss: 13.3033, ]
2022-10-31 23:09:13,804 INFO: fine-tune procedure is finished!
2022-10-31 23:09:47,106 INFO: [Test_acc of task 4 on test 4: 0.25900][acc of former classes: 0.69300][acc of former samples in all classes: 0.60200]
[acc of novel samples in all classes: 0.08750]
2022-10-31 23:09:47,382 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:09:47,408 WARNING: Current net - loaded net:
2022-10-31 23:09:47,408 WARNING: Loaded net - current net:
2022-10-31 23:09:47,408 WARNING:   func.classifier.bias
2022-10-31 23:09:47,408 WARNING:   func.classifier.weight
2022-10-31 23:09:47,418 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_4.pth.
2022-10-31 23:09:47,454 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:09:47,468 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:09:47,468 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:09:47,468 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:09:47,468 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:09:47,468 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:09:47,468 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:09:47,468 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:09:47,468 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:09:47,469 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:09:47,470 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:09:47,470 INFO: Model [FSLLModel] is created.
2022-10-31 23:09:47,481 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:09:47,491 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:09:47,501 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:09:47,511 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:09:47,521 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_4.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_4.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69]
2022-10-31 23:09:50,652 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3669, Pos_dist: 5.4574, Neg_dist: 7.2132, Acc: 0.4640, PTFixPNLoss: 4.0131, NetFixLoss: 0.0000, ]
2022-10-31 23:09:53,816 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4128, Pos_dist: 5.5484, Neg_dist: 7.1856, Acc: 0.4360, PTFixPNLoss: 4.0218, NetFixLoss: 0.4958, ]
2022-10-31 23:09:56,596 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3386, Pos_dist: 5.4755, Neg_dist: 7.2987, Acc: 0.4840, PTFixPNLoss: 4.0152, NetFixLoss: 1.1665, ]
2022-10-31 23:09:59,973 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.3894, Pos_dist: 5.4966, Neg_dist: 7.3857, Acc: 0.4520, PTFixPNLoss: 4.0192, NetFixLoss: 1.9829, ]
2022-10-31 23:10:01,754 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4979, Pos_dist: 5.5003, Neg_dist: 6.9159, Acc: 0.4120, PTFixPNLoss: 4.0199, NetFixLoss: 2.8452, ]
2022-10-31 23:10:05,038 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4126, Pos_dist: 5.4751, Neg_dist: 6.9384, Acc: 0.4560, PTFixPNLoss: 4.0195, NetFixLoss: 3.7582, ]
2022-10-31 23:10:07,480 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.2288, Pos_dist: 5.4538, Neg_dist: 7.8746, Acc: 0.4640, PTFixPNLoss: 4.0100, NetFixLoss: 4.7386, ]
2022-10-31 23:10:10,867 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2082, Pos_dist: 5.4697, Neg_dist: 7.6741, Acc: 0.4600, PTFixPNLoss: 4.0145, NetFixLoss: 5.7922, ]
2022-10-31 23:10:14,209 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3190, Pos_dist: 5.4589, Neg_dist: 7.2009, Acc: 0.4560, PTFixPNLoss: 4.0169, NetFixLoss: 6.8793, ]
2022-10-31 23:10:17,537 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3479, Pos_dist: 5.4331, Neg_dist: 7.2032, Acc: 0.4280, PTFixPNLoss: 4.0188, NetFixLoss: 7.9552, ]
2022-10-31 23:10:20,707 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2607, Pos_dist: 5.5123, Neg_dist: 7.6936, Acc: 0.4680, PTFixPNLoss: 4.0181, NetFixLoss: 9.0604, ]
2022-10-31 23:10:23,929 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2512, Pos_dist: 5.4518, Neg_dist: 7.6677, Acc: 0.4440, PTFixPNLoss: 4.0131, NetFixLoss: 10.1732, ]
2022-10-31 23:10:27,215 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3630, Pos_dist: 5.4308, Neg_dist: 7.1678, Acc: 0.4720, PTFixPNLoss: 4.0079, NetFixLoss: 11.2853, ]
2022-10-31 23:10:30,334 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3963, Pos_dist: 5.4335, Neg_dist: 6.9087, Acc: 0.5080, PTFixPNLoss: 4.0134, NetFixLoss: 12.3917, ]
2022-10-31 23:10:33,224 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.2128, Pos_dist: 5.4272, Neg_dist: 7.8447, Acc: 0.4240, PTFixPNLoss: 4.0160, NetFixLoss: 13.4909, ]
2022-10-31 23:10:33,299 INFO: fine-tune procedure is finished!
2022-10-31 23:11:11,962 INFO: [Test_acc of task 5 on test 4: 0.22414][acc of former classes: 0.69150][acc of former samples in all classes: 0.58850]
[acc of novel samples in all classes: 0.07840]
2022-10-31 23:11:12,263 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:11:12,287 WARNING: Current net - loaded net:
2022-10-31 23:11:12,287 WARNING: Loaded net - current net:
2022-10-31 23:11:12,287 WARNING:   func.classifier.bias
2022-10-31 23:11:12,287 WARNING:   func.classifier.weight
2022-10-31 23:11:12,324 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_5.pth.
2022-10-31 23:11:12,387 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:11:12,417 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:11:12,417 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:11:12,417 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:11:12,417 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:11:12,417 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:11:12,417 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:11:12,418 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:11:12,418 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:11:12,419 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:11:12,420 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:11:12,420 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:11:12,420 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:11:12,420 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:11:12,420 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:11:12,420 INFO: Model [FSLLModel] is created.
2022-10-31 23:11:12,431 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:11:12,441 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:11:12,451 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:11:12,461 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:11:12,471 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:11:12,481 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_5.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_5.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
2022-10-31 23:11:14,325 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.2455, Pos_dist: 5.4773, Neg_dist: 7.5847, Acc: 0.4767, PTFixPNLoss: 4.1502, NetFixLoss: 0.0000, ]
2022-10-31 23:11:18,053 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.5606, Pos_dist: 5.4886, Neg_dist: 6.6317, Acc: 0.4833, PTFixPNLoss: 4.1517, NetFixLoss: 0.4288, ]
2022-10-31 23:11:21,870 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3281, Pos_dist: 5.4429, Neg_dist: 7.2339, Acc: 0.4300, PTFixPNLoss: 4.1484, NetFixLoss: 1.0726, ]
2022-10-31 23:11:25,821 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2548, Pos_dist: 5.4394, Neg_dist: 7.3555, Acc: 0.4200, PTFixPNLoss: 4.1413, NetFixLoss: 1.8537, ]
2022-10-31 23:11:29,527 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.4284, Pos_dist: 5.5080, Neg_dist: 7.4474, Acc: 0.4467, PTFixPNLoss: 4.1478, NetFixLoss: 2.7268, ]
2022-10-31 23:11:31,466 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.3256, Pos_dist: 5.4662, Neg_dist: 7.2364, Acc: 0.4433, PTFixPNLoss: 4.1473, NetFixLoss: 3.6645, ]
2022-10-31 23:11:35,198 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.4264, Pos_dist: 5.4840, Neg_dist: 7.0031, Acc: 0.4800, PTFixPNLoss: 4.1465, NetFixLoss: 4.6388, ]
2022-10-31 23:11:38,242 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.6006, Pos_dist: 5.5200, Neg_dist: 6.5156, Acc: 0.3833, PTFixPNLoss: 4.1564, NetFixLoss: 5.6594, ]
2022-10-31 23:11:42,006 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3149, Pos_dist: 5.4706, Neg_dist: 7.1694, Acc: 0.4967, PTFixPNLoss: 4.1456, NetFixLoss: 6.7304, ]
2022-10-31 23:11:45,787 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.4231, Pos_dist: 5.4668, Neg_dist: 7.0250, Acc: 0.4567, PTFixPNLoss: 4.1534, NetFixLoss: 7.8062, ]
2022-10-31 23:11:48,422 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.5303, Pos_dist: 5.4718, Neg_dist: 6.8095, Acc: 0.4367, PTFixPNLoss: 4.1458, NetFixLoss: 8.9193, ]
2022-10-31 23:11:52,196 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.2060, Pos_dist: 5.4265, Neg_dist: 7.5647, Acc: 0.4233, PTFixPNLoss: 4.1483, NetFixLoss: 10.0604, ]
2022-10-31 23:11:55,827 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.3553, Pos_dist: 5.4395, Neg_dist: 7.2000, Acc: 0.4300, PTFixPNLoss: 4.1491, NetFixLoss: 11.1727, ]
2022-10-31 23:11:59,618 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.3656, Pos_dist: 5.4308, Neg_dist: 6.9554, Acc: 0.4500, PTFixPNLoss: 4.1453, NetFixLoss: 12.3029, ]
2022-10-31 23:12:03,649 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.4203, Pos_dist: 5.4598, Neg_dist: 7.2055, Acc: 0.4567, PTFixPNLoss: 4.1470, NetFixLoss: 13.4324, ]
2022-10-31 23:12:03,748 INFO: fine-tune procedure is finished!
2022-10-31 23:12:47,341 INFO: [Test_acc of task 6 on test 4: 0.20025][acc of former classes: 0.69250][acc of former samples in all classes: 0.57700]
[acc of novel samples in all classes: 0.07467]
2022-10-31 23:12:47,639 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:12:47,664 WARNING: Current net - loaded net:
2022-10-31 23:12:47,664 WARNING: Loaded net - current net:
2022-10-31 23:12:47,664 WARNING:   func.classifier.bias
2022-10-31 23:12:47,664 WARNING:   func.classifier.weight
2022-10-31 23:12:47,699 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_6.pth.
2022-10-31 23:12:47,763 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:12:47,794 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:12:47,794 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:12:47,794 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:12:47,794 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:12:47,794 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:12:47,794 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:12:47,794 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:12:47,795 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:12:47,796 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:12:47,797 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:12:47,797 INFO: Model [FSLLModel] is created.
2022-10-31 23:12:47,808 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:12:47,818 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:12:47,828 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:12:47,838 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:12:47,848 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:12:47,858 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:12:47,868 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_6.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_6.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]
2022-10-31 23:12:52,119 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.4660, Pos_dist: 5.4911, Neg_dist: 7.0500, Acc: 0.4229, PTFixPNLoss: 4.2665, NetFixLoss: 0.0000, ]
2022-10-31 23:12:55,195 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4761, Pos_dist: 5.4649, Neg_dist: 6.8337, Acc: 0.4543, PTFixPNLoss: 4.2688, NetFixLoss: 0.4710, ]
2022-10-31 23:12:59,513 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.3704, Pos_dist: 5.5463, Neg_dist: 7.3954, Acc: 0.4200, PTFixPNLoss: 4.2717, NetFixLoss: 1.0995, ]
2022-10-31 23:13:01,714 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.2943, Pos_dist: 5.5573, Neg_dist: 7.7236, Acc: 0.4000, PTFixPNLoss: 4.2786, NetFixLoss: 1.8556, ]
2022-10-31 23:13:06,007 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.3027, Pos_dist: 5.5199, Neg_dist: 7.2757, Acc: 0.4543, PTFixPNLoss: 4.2679, NetFixLoss: 2.7007, ]
2022-10-31 23:13:08,984 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.5081, Pos_dist: 5.5298, Neg_dist: 6.9606, Acc: 0.4029, PTFixPNLoss: 4.2732, NetFixLoss: 3.6045, ]
2022-10-31 23:13:13,302 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3906, Pos_dist: 5.4370, Neg_dist: 6.9471, Acc: 0.4343, PTFixPNLoss: 4.2624, NetFixLoss: 4.5739, ]
2022-10-31 23:13:17,894 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.5022, Pos_dist: 5.4296, Neg_dist: 6.6147, Acc: 0.4400, PTFixPNLoss: 4.2661, NetFixLoss: 5.5867, ]
2022-10-31 23:13:22,290 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.4323, Pos_dist: 5.4678, Neg_dist: 7.1859, Acc: 0.4400, PTFixPNLoss: 4.2653, NetFixLoss: 6.6560, ]
2022-10-31 23:13:26,561 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.3671, Pos_dist: 5.5036, Neg_dist: 7.1478, Acc: 0.4457, PTFixPNLoss: 4.2722, NetFixLoss: 7.7705, ]
2022-10-31 23:13:30,839 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.2717, Pos_dist: 5.4504, Neg_dist: 7.4839, Acc: 0.4314, PTFixPNLoss: 4.2668, NetFixLoss: 8.9004, ]
2022-10-31 23:13:35,120 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5353, Pos_dist: 5.4828, Neg_dist: 6.9170, Acc: 0.4114, PTFixPNLoss: 4.2644, NetFixLoss: 10.0362, ]
2022-10-31 23:13:39,075 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.4266, Pos_dist: 5.4699, Neg_dist: 6.9680, Acc: 0.4371, PTFixPNLoss: 4.2661, NetFixLoss: 11.1825, ]
2022-10-31 23:13:42,965 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.5639, Pos_dist: 5.4063, Neg_dist: 6.4700, Acc: 0.4314, PTFixPNLoss: 4.2693, NetFixLoss: 12.3380, ]
2022-10-31 23:13:46,969 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3928, Pos_dist: 5.4889, Neg_dist: 7.4289, Acc: 0.4057, PTFixPNLoss: 4.2744, NetFixLoss: 13.4962, ]
2022-10-31 23:13:47,167 INFO: fine-tune procedure is finished!
2022-10-31 23:14:36,367 INFO: [Test_acc of task 7 on test 4: 0.18133][acc of former classes: 0.69200][acc of former samples in all classes: 0.56900]
[acc of novel samples in all classes: 0.07057]
2022-10-31 23:14:36,660 INFO: Loading Resnet18_softmax model from ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth.
2022-10-31 23:14:36,686 WARNING: Current net - loaded net:
2022-10-31 23:14:36,686 WARNING: Loaded net - current net:
2022-10-31 23:14:36,686 WARNING:   func.classifier.bias
2022-10-31 23:14:36,687 WARNING:   func.classifier.weight
2022-10-31 23:14:36,723 INFO: Loading Resnet18_softmax model from /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_7.pth.
2022-10-31 23:14:36,785 INFO: Load prototypes: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/prototypes/test0_session0.pt
2022-10-31 23:14:36,820 INFO: Optimize parameters: func.base.layer3.1.conv2.weight.
2022-10-31 23:14:36,820 INFO: Optimize parameters: func.base.layer4.0.conv1.weight.
2022-10-31 23:14:36,820 INFO: Optimize parameters: func.base.layer4.0.conv2.weight.
2022-10-31 23:14:36,820 INFO: Optimize parameters: func.base.layer4.1.conv1.weight.
2022-10-31 23:14:36,820 INFO: Optimize parameters: func.base.layer4.1.conv2.weight.
2022-10-31 23:14:36,820 INFO: Optimize parameters: func.base.layer4.1.bn2.bias.
2022-10-31 23:14:36,820 WARNING: Params func.base.conv1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.bn1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.bn1.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.0.conv1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.0.bn1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.0.bn1.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.0.conv2.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.0.bn2.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.0.bn2.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.1.conv1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.1.bn1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.1.bn1.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.1.conv2.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.1.bn2.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer1.1.bn2.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.conv1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.bn1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.bn1.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.conv2.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.bn2.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.bn2.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.downsample.0.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.downsample.1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.0.downsample.1.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.1.conv1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.1.bn1.weight will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.1.bn1.bias will not be optimized.
2022-10-31 23:14:36,821 WARNING: Params func.base.layer2.1.conv2.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer2.1.bn2.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer2.1.bn2.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.conv1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.bn1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.bn1.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.conv2.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.bn2.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.bn2.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.downsample.0.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.downsample.1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.0.downsample.1.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.1.conv1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.1.bn1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.1.bn1.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.1.bn2.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer3.1.bn2.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.0.bn1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.0.bn1.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.0.bn2.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.0.bn2.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.0.downsample.0.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.0.downsample.1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.0.downsample.1.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.1.bn1.weight will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.1.bn1.bias will not be optimized.
2022-10-31 23:14:36,822 WARNING: Params func.base.layer4.1.bn2.weight will not be optimized.
2022-10-31 23:14:36,823 INFO: Model [FSLLModel] is created.
2022-10-31 23:14:36,834 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:14:36,844 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:14:36,854 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:14:36,864 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:14:36,874 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:14:36,884 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:14:36,893 INFO: Dataset NormalDataset - miniImageNet is created.
2022-10-31 23:14:36,904 INFO: Dataset NormalDataset - miniImageNet is created.
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_7.pth
Load NETWORK MODEL From: ./exp/miniImageNet_bases20/FSIL_CFRPModel_res18_miniImageNet_baseline_20base_wandb_001/models/best_net_latest.pth
Load NETWORK MODEL From: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_7.pth
Trainset classes:
[20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
Testset classes:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2022-10-31 23:14:41,695 INFO: [epoch:  0, iter:   1, lr:(1.000e-03)] [ TripletLoss: 0.3774, Pos_dist: 5.4313, Neg_dist: 6.9916, Acc: 0.4250, PTFixPNLoss: 4.3730, NetFixLoss: 0.0000, ]
2022-10-31 23:14:46,585 INFO: [epoch:  1, iter:   2, lr:(1.000e-03)] [ TripletLoss: 0.4200, Pos_dist: 5.3946, Neg_dist: 6.8568, Acc: 0.4525, PTFixPNLoss: 4.3687, NetFixLoss: 0.5005, ]
2022-10-31 23:14:51,520 INFO: [epoch:  2, iter:   3, lr:(1.000e-03)] [ TripletLoss: 0.2863, Pos_dist: 5.4473, Neg_dist: 7.2122, Acc: 0.4350, PTFixPNLoss: 4.3731, NetFixLoss: 1.1300, ]
2022-10-31 23:14:55,846 INFO: [epoch:  3, iter:   4, lr:(1.000e-03)] [ TripletLoss: 0.4919, Pos_dist: 5.4358, Neg_dist: 6.6285, Acc: 0.4175, PTFixPNLoss: 4.3719, NetFixLoss: 1.9201, ]
2022-10-31 23:15:00,733 INFO: [epoch:  4, iter:   5, lr:(1.000e-03)] [ TripletLoss: 0.2485, Pos_dist: 5.4595, Neg_dist: 7.5236, Acc: 0.4200, PTFixPNLoss: 4.3714, NetFixLoss: 2.8251, ]
2022-10-31 23:15:03,771 INFO: [epoch:  5, iter:   6, lr:(1.000e-03)] [ TripletLoss: 0.4588, Pos_dist: 5.4899, Neg_dist: 6.7684, Acc: 0.4225, PTFixPNLoss: 4.3746, NetFixLoss: 3.7998, ]
2022-10-31 23:15:08,688 INFO: [epoch:  6, iter:   7, lr:(1.000e-03)] [ TripletLoss: 0.3683, Pos_dist: 5.4029, Neg_dist: 7.0312, Acc: 0.4475, PTFixPNLoss: 4.3663, NetFixLoss: 4.8624, ]
2022-10-31 23:15:12,902 INFO: [epoch:  7, iter:   8, lr:(1.000e-03)] [ TripletLoss: 0.2485, Pos_dist: 5.4209, Neg_dist: 8.1510, Acc: 0.4250, PTFixPNLoss: 4.3731, NetFixLoss: 5.9818, ]
2022-10-31 23:15:17,787 INFO: [epoch:  8, iter:   9, lr:(1.000e-03)] [ TripletLoss: 0.3393, Pos_dist: 5.4532, Neg_dist: 7.2984, Acc: 0.4275, PTFixPNLoss: 4.3732, NetFixLoss: 7.0786, ]
2022-10-31 23:15:22,670 INFO: [epoch:  9, iter:  10, lr:(1.000e-03)] [ TripletLoss: 0.2512, Pos_dist: 5.4559, Neg_dist: 7.4625, Acc: 0.3975, PTFixPNLoss: 4.3709, NetFixLoss: 8.1323, ]
2022-10-31 23:15:27,056 INFO: [epoch: 10, iter:  11, lr:(1.000e-03)] [ TripletLoss: 0.3004, Pos_dist: 5.4153, Neg_dist: 7.1069, Acc: 0.4375, PTFixPNLoss: 4.3769, NetFixLoss: 9.1656, ]
2022-10-31 23:15:31,941 INFO: [epoch: 11, iter:  12, lr:(1.000e-03)] [ TripletLoss: 0.5819, Pos_dist: 5.4351, Neg_dist: 6.5513, Acc: 0.4375, PTFixPNLoss: 4.3724, NetFixLoss: 10.1857, ]
2022-10-31 23:15:34,741 INFO: [epoch: 12, iter:  13, lr:(1.000e-03)] [ TripletLoss: 0.2852, Pos_dist: 5.4754, Neg_dist: 7.7842, Acc: 0.4350, PTFixPNLoss: 4.3723, NetFixLoss: 11.2594, ]
2022-10-31 23:15:39,557 INFO: [epoch: 13, iter:  14, lr:(1.000e-03)] [ TripletLoss: 0.4370, Pos_dist: 5.4044, Neg_dist: 7.0838, Acc: 0.4400, PTFixPNLoss: 4.3698, NetFixLoss: 12.3137, ]
2022-10-31 23:15:43,862 INFO: [epoch: 14, iter:  15, lr:(1.000e-03)] [ TripletLoss: 0.3594, Pos_dist: 5.4124, Neg_dist: 6.9625, Acc: 0.4075, PTFixPNLoss: 4.3682, NetFixLoss: 13.3577, ]
2022-10-31 23:15:43,971 INFO: fine-tune procedure is finished!
2022-10-31 23:16:38,517 INFO: [Test_acc of task 8 on test 4: 0.16860][acc of former classes: 0.68950][acc of former samples in all classes: 0.56100]
[acc of novel samples in all classes: 0.07050]
2022-10-31 23:16:38,622 INFO: --------------------------Final Avg Acc-------------------------
2022-10-31 23:16:38,623 INFO: Session 1: 68.05+-0.00[acc of former classes: 0.0000][acc of former samples in all classes: 0.0000]
[acc of novel samples in all classes: 0.6805]
2022-10-31 23:16:38,623 INFO: Session 2: 47.05+-0.33[acc of former classes: 0.6784][acc of former samples in all classes: 0.6398]
[acc of novel samples in all classes: 0.1320]
2022-10-31 23:16:38,623 INFO: Session 3: 37.74+-0.52[acc of former classes: 0.6862][acc of former samples in all classes: 0.6205]
[acc of novel samples in all classes: 0.1344]
2022-10-31 23:16:38,623 INFO: Session 4: 30.70+-0.52[acc of former classes: 0.6892][acc of former samples in all classes: 0.6081]
[acc of novel samples in all classes: 0.1063]
2022-10-31 23:16:38,623 INFO: Session 5: 26.00+-0.50[acc of former classes: 0.6921][acc of former samples in all classes: 0.5982]
[acc of novel samples in all classes: 0.0909]
2022-10-31 23:16:38,623 INFO: Session 6: 22.43+-0.32[acc of former classes: 0.6925][acc of former samples in all classes: 0.5860]
[acc of novel samples in all classes: 0.0797]
2022-10-31 23:16:38,623 INFO: Session 7: 20.26+-0.42[acc of former classes: 0.6927][acc of former samples in all classes: 0.5766]
[acc of novel samples in all classes: 0.0779]
2022-10-31 23:16:38,624 INFO: Session 8: 18.22+-0.45[acc of former classes: 0.6908][acc of former samples in all classes: 0.5680]
[acc of novel samples in all classes: 0.0720]
2022-10-31 23:16:38,624 INFO: Session 9: 17.11+-0.44[acc of former classes: 0.6907][acc of former samples in all classes: 0.5605]
[acc of novel samples in all classes: 0.0737]
2022-10-31 23:16:38,624 INFO: random seed: 1997
save network to: /workspace/FLOWER/f2m/increment/miniImageNet_bases20/FSIL_FSLLModel_res18_miniimagenet_baseline_20base_{UDF}_wandb_debug/models/test4_session_8.pth
finish!!
